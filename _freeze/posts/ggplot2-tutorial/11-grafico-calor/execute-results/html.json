{
  "hash": "a00f153be3f57c59a324efcad31af6cb",
  "result": {
    "markdown": "---\ntitle: 'Indo além: mapas de calor'\nauthor: Vinicius Oike\ndate: '2023-01-05'\ncategories: ['data visualization', 'ggplot2', 'turorial-R']\ndescription: \"Facets são pequenos gráficos que, lado a lado, ajudam a comparar várias informações ao mesmo tempo. Este post intermediário ensina a fazer gráficos de facets no R usando o ggplot2.\"\ntitle-block-banner: true\npage-layout: article\nexecute: \n  message: false\n  warning: false\nformat:\n  html:\n    code-fold: false\n    code-tools: true\nfreeze: true\ndraft: true\n---\n\n\n\n\n# Graficos ou mapas de calor\n\nMapas de calor apresentam a variação de uma variável num plano bidimensional. Há dois tipos principais de mapas de calor: o mapa de calor espacial e o mapa de calor de clusters. O primeiro tipicamente é superimposto sobre um mapa e **representa a intensidade de alguma variável**, como a pluviosidade, temperatura, concentração de C02 e assim por diante. Já o *mapa de calor de clusters* é disposto numa **matriz bidimensional para sugerir padrões**, tendências, ou mesmo para visualizar a evolução de uma variável num grupo de classes.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-1-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nO pacote `ggplot2` não tem uma função única para montar mapas de calor, então vamos explorar uma abordagem simples focada na função `geom_tile()`. Contudo, é possível montar mapas de calor também com as funções `geom_bin_2d()`, `geom_density_2d()`, `geom_raster()` ou `geom_hex()`.\n\nNeste post vamos nos focar em **mapas de clusters**. A discussão de mapas de calor será apresentada no post subsequente que trata sobre mapas.\n\nO código abaixo carrega os pacotes necessários. Para a paleta de cores vou utilizar o pacote `MetBrewer`, que oferece algumas paletas de cores interessantes, inspiradas em artistas famosos do [Metropolitan Museum de NY](https://github.com/BlakeRMills/MetBrewer). O pacote `pwt10` carrega a base de dados da [Penn World Table](https://www.rug.nl/ggdc/productivity/pwt/?lang=en) que traz uma série de informações socioeconômicas dos países ao longo dos anos. Por fim, os pacotes `astsa`, `wooldridge` e `GetBCBData` são utilizados para conseguir acesso a base de dados para os exemplos.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Para instalar um pacote do GitHub\nremotes::install_github(\"BlakeRMills/MetBrewer\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Carrega os pacotes\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(forcats)\nlibrary(stringr)\nlibrary(ggplot2)\n\n# Paletas de cores (ver acima como instalar)\nlibrary(MetBrewer)\n\n# Para carregar bases de dados para os exemplos\n# Dados da Penn World Table\nlibrary(pwt10)\n# Aquecimento global\nlibrary(astsa)\n# Séries do Banco Central do Brasil\nlibrary(GetBCBData)\n# Preços de imóveis\nlibrary(wooldridge)\n\n# Colors\ncolors_hiroshige <- met.brewer(name = \"Hiroshige\")\n```\n:::\n\n\n# Gráfico de calor (clusters)\n\n## Exemplo: Crescimento Econômico\n\nPrimeiro vamos importar a base de dados da Penn World Table usando o pacote `pwt10`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# A base de dados\npwt <- as_tibble(pwt10::pwt10.0)\n```\n:::\n\n\nA base tem várias colunas mas vamos nos focar somente nas colunas `country`, `pop` (população do país em milhões de habitante) e `rgdpe`, que o é o PIB (pela ótica da despesa) em milhões de US\\$ constantes (2017).\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; \"><table class=\"table table-condensed table-responsive table-hover table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> country </th>\n   <th style=\"text-align:center;\"> isocode </th>\n   <th style=\"text-align:center;\"> year </th>\n   <th style=\"text-align:center;\"> currency </th>\n   <th style=\"text-align:center;\"> rgdpe </th>\n   <th style=\"text-align:center;\"> rgdpo </th>\n   <th style=\"text-align:center;\"> pop </th>\n   <th style=\"text-align:center;\"> emp </th>\n   <th style=\"text-align:center;\"> avh </th>\n   <th style=\"text-align:center;\"> hc </th>\n   <th style=\"text-align:center;\"> ccon </th>\n   <th style=\"text-align:center;\"> cda </th>\n   <th style=\"text-align:center;\"> cgdpe </th>\n   <th style=\"text-align:center;\"> cgdpo </th>\n   <th style=\"text-align:center;\"> cn </th>\n   <th style=\"text-align:center;\"> ck </th>\n   <th style=\"text-align:center;\"> ctfp </th>\n   <th style=\"text-align:center;\"> cwtfp </th>\n   <th style=\"text-align:center;\"> rgdpna </th>\n   <th style=\"text-align:center;\"> rconna </th>\n   <th style=\"text-align:center;\"> rdana </th>\n   <th style=\"text-align:center;\"> rnna </th>\n   <th style=\"text-align:center;\"> rkna </th>\n   <th style=\"text-align:center;\"> rtfpna </th>\n   <th style=\"text-align:center;\"> rwtfpna </th>\n   <th style=\"text-align:center;\"> labsh </th>\n   <th style=\"text-align:center;\"> irr </th>\n   <th style=\"text-align:center;\"> delta </th>\n   <th style=\"text-align:center;\"> xr </th>\n   <th style=\"text-align:center;\"> pl_con </th>\n   <th style=\"text-align:center;\"> pl_da </th>\n   <th style=\"text-align:center;\"> pl_gdpo </th>\n   <th style=\"text-align:center;\"> i_cig </th>\n   <th style=\"text-align:center;\"> i_xm </th>\n   <th style=\"text-align:center;\"> i_xr </th>\n   <th style=\"text-align:center;\"> i_outlier </th>\n   <th style=\"text-align:center;\"> i_irr </th>\n   <th style=\"text-align:center;\"> cor_exp </th>\n   <th style=\"text-align:center;\"> statcap </th>\n   <th style=\"text-align:center;\"> csh_c </th>\n   <th style=\"text-align:center;\"> csh_i </th>\n   <th style=\"text-align:center;\"> csh_g </th>\n   <th style=\"text-align:center;\"> csh_x </th>\n   <th style=\"text-align:center;\"> csh_m </th>\n   <th style=\"text-align:center;\"> csh_r </th>\n   <th style=\"text-align:center;\"> pl_c </th>\n   <th style=\"text-align:center;\"> pl_i </th>\n   <th style=\"text-align:center;\"> pl_g </th>\n   <th style=\"text-align:center;\"> pl_x </th>\n   <th style=\"text-align:center;\"> pl_m </th>\n   <th style=\"text-align:center;\"> pl_n </th>\n   <th style=\"text-align:center;\"> pl_k </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1950 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 92711 </td>\n   <td style=\"text-align:center;\"> 89223 </td>\n   <td style=\"text-align:center;\"> 53 </td>\n   <td style=\"text-align:center;\"> 17 </td>\n   <td style=\"text-align:center;\"> 2042 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 67102 </td>\n   <td style=\"text-align:center;\"> 83933 </td>\n   <td style=\"text-align:center;\"> 87798 </td>\n   <td style=\"text-align:center;\"> 85324 </td>\n   <td style=\"text-align:center;\"> 227373 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 145828 </td>\n   <td style=\"text-align:center;\"> 108970 </td>\n   <td style=\"text-align:center;\"> 144486 </td>\n   <td style=\"text-align:center;\"> 608567 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1951 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 96889 </td>\n   <td style=\"text-align:center;\"> 91904 </td>\n   <td style=\"text-align:center;\"> 55 </td>\n   <td style=\"text-align:center;\"> 17 </td>\n   <td style=\"text-align:center;\"> 2051 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 70038 </td>\n   <td style=\"text-align:center;\"> 91417 </td>\n   <td style=\"text-align:center;\"> 92312 </td>\n   <td style=\"text-align:center;\"> 87631 </td>\n   <td style=\"text-align:center;\"> 242814 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 152969 </td>\n   <td style=\"text-align:center;\"> 113887 </td>\n   <td style=\"text-align:center;\"> 155273 </td>\n   <td style=\"text-align:center;\"> 654280 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1952 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 105943 </td>\n   <td style=\"text-align:center;\"> 101667 </td>\n   <td style=\"text-align:center;\"> 56 </td>\n   <td style=\"text-align:center;\"> 18 </td>\n   <td style=\"text-align:center;\"> 2060 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 76213 </td>\n   <td style=\"text-align:center;\"> 100796 </td>\n   <td style=\"text-align:center;\"> 101407 </td>\n   <td style=\"text-align:center;\"> 97895 </td>\n   <td style=\"text-align:center;\"> 261085 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 167515 </td>\n   <td style=\"text-align:center;\"> 123881 </td>\n   <td style=\"text-align:center;\"> 170169 </td>\n   <td style=\"text-align:center;\"> 705852 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1953 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 108931 </td>\n   <td style=\"text-align:center;\"> 105003 </td>\n   <td style=\"text-align:center;\"> 58 </td>\n   <td style=\"text-align:center;\"> 18 </td>\n   <td style=\"text-align:center;\"> 2069 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 80936 </td>\n   <td style=\"text-align:center;\"> 100441 </td>\n   <td style=\"text-align:center;\"> 104321 </td>\n   <td style=\"text-align:center;\"> 101629 </td>\n   <td style=\"text-align:center;\"> 272078 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 176028 </td>\n   <td style=\"text-align:center;\"> 130481 </td>\n   <td style=\"text-align:center;\"> 171026 </td>\n   <td style=\"text-align:center;\"> 737951 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1954 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 118686 </td>\n   <td style=\"text-align:center;\"> 113983 </td>\n   <td style=\"text-align:center;\"> 60 </td>\n   <td style=\"text-align:center;\"> 19 </td>\n   <td style=\"text-align:center;\"> 2078 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 88946 </td>\n   <td style=\"text-align:center;\"> 111934 </td>\n   <td style=\"text-align:center;\"> 113384 </td>\n   <td style=\"text-align:center;\"> 110080 </td>\n   <td style=\"text-align:center;\"> 287037 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 190468 </td>\n   <td style=\"text-align:center;\"> 143957 </td>\n   <td style=\"text-align:center;\"> 191257 </td>\n   <td style=\"text-align:center;\"> 780613 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1955 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 127384 </td>\n   <td style=\"text-align:center;\"> 122678 </td>\n   <td style=\"text-align:center;\"> 61 </td>\n   <td style=\"text-align:center;\"> 20 </td>\n   <td style=\"text-align:center;\"> 2087 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 94400 </td>\n   <td style=\"text-align:center;\"> 117254 </td>\n   <td style=\"text-align:center;\"> 121279 </td>\n   <td style=\"text-align:center;\"> 118126 </td>\n   <td style=\"text-align:center;\"> 301169 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 202763 </td>\n   <td style=\"text-align:center;\"> 153006 </td>\n   <td style=\"text-align:center;\"> 201258 </td>\n   <td style=\"text-align:center;\"> 820627 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1956 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 131865 </td>\n   <td style=\"text-align:center;\"> 127205 </td>\n   <td style=\"text-align:center;\"> 63 </td>\n   <td style=\"text-align:center;\"> 20 </td>\n   <td style=\"text-align:center;\"> 2097 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 97827 </td>\n   <td style=\"text-align:center;\"> 119971 </td>\n   <td style=\"text-align:center;\"> 125158 </td>\n   <td style=\"text-align:center;\"> 122067 </td>\n   <td style=\"text-align:center;\"> 313178 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 210124 </td>\n   <td style=\"text-align:center;\"> 159465 </td>\n   <td style=\"text-align:center;\"> 206719 </td>\n   <td style=\"text-align:center;\"> 854692 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1957 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 143384 </td>\n   <td style=\"text-align:center;\"> 138373 </td>\n   <td style=\"text-align:center;\"> 65 </td>\n   <td style=\"text-align:center;\"> 21 </td>\n   <td style=\"text-align:center;\"> 2106 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 104123 </td>\n   <td style=\"text-align:center;\"> 133653 </td>\n   <td style=\"text-align:center;\"> 136122 </td>\n   <td style=\"text-align:center;\"> 132684 </td>\n   <td style=\"text-align:center;\"> 332711 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 231221 </td>\n   <td style=\"text-align:center;\"> 170139 </td>\n   <td style=\"text-align:center;\"> 228611 </td>\n   <td style=\"text-align:center;\"> 911217 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1958 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 151546 </td>\n   <td style=\"text-align:center;\"> 146430 </td>\n   <td style=\"text-align:center;\"> 67 </td>\n   <td style=\"text-align:center;\"> 21 </td>\n   <td style=\"text-align:center;\"> 2115 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 113085 </td>\n   <td style=\"text-align:center;\"> 142400 </td>\n   <td style=\"text-align:center;\"> 144065 </td>\n   <td style=\"text-align:center;\"> 141124 </td>\n   <td style=\"text-align:center;\"> 350683 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 245978 </td>\n   <td style=\"text-align:center;\"> 184877 </td>\n   <td style=\"text-align:center;\"> 244075 </td>\n   <td style=\"text-align:center;\"> 963159 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Brazil </td>\n   <td style=\"text-align:center;\"> BRA </td>\n   <td style=\"text-align:center;\"> 1959 </td>\n   <td style=\"text-align:center;\"> Brazilian Real </td>\n   <td style=\"text-align:center;\"> 158732 </td>\n   <td style=\"text-align:center;\"> 153143 </td>\n   <td style=\"text-align:center;\"> 69 </td>\n   <td style=\"text-align:center;\"> 22 </td>\n   <td style=\"text-align:center;\"> 2125 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 116669 </td>\n   <td style=\"text-align:center;\"> 152878 </td>\n   <td style=\"text-align:center;\"> 150332 </td>\n   <td style=\"text-align:center;\"> 147218 </td>\n   <td style=\"text-align:center;\"> 376789 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 264945 </td>\n   <td style=\"text-align:center;\"> 191877 </td>\n   <td style=\"text-align:center;\"> 262297 </td>\n   <td style=\"text-align:center;\"> 1033868 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> extrapolated </td>\n   <td style=\"text-align:center;\"> market </td>\n   <td style=\"text-align:center;\"> no </td>\n   <td style=\"text-align:center;\"> regular </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\nVamos selecionar apenas os principais países da América Latina para montar nossa visualização.\n\nO primeiro painel que iremos explorar vai exibir os ciclos de expansão e de recessão nos países latino-americanos ao longo dos anos, desde 1950. Para isto vamos primeiro calcular o PIB per capital real de cada país e depois criar uma variável *dummy* que indica com o valor 1 se o país teve crescimento do PIB per capita real e 0 caso contrário.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Vetor com países\nlatam_countries <- c(\n  \"ARG\", \"BOL\", \"BRA\", \"CHL\", \"COL\", \"CUB\", \"DOM\", \"ECU\", \"GTM\", \"HND\", \"HTI\",\n  \"MEX\", \"PER\", \"VEN\")\n\nlatam <- pwt |> \n  # Filtra apenas as linhas dos países selecionados\n  filter(isocode %in% latam_countries) |> \n  # Agrupa por país\n  group_by(country) |> \n  mutate(\n    # Calcula o PIB per capita de cada país\n    gdppc = rgdpe / pop,\n    # Calcula a variação do PIB per capita de cada país\n    d_gdppc = gdppc / lag(gdppc) - 1,\n    # Cria uma variável binária para indicar se houve crescimento \n    growth = factor(if_else(d_gdppc > 0, 1L, 0L)),\n    # Remove parêntesis e o texto dentro dele\n    country = str_remove(country, \" \\\\(.+\\\\)\"),\n    # Abrevia o nome da República Dominicana\n    country = str_replace(country, \"Dominican Republic\", \"Dominican Rep.\")\n  ) |> \n  ungroup()\n```\n:::\n\n\n## Gráfico de Calor\n\nApesar de bidimensional, um heatmap serve para representar dados em três dimensões. No nosso caso, a função `geom_tile()` mapeia as variáveis `x` e `y` nas coordenadas enquanto a variável `fill` representa uma variável numérica adicional, seja ela categórica ou contínua.\n\nO código abaixo monta um heatmap simples. No gráfico, os anos de crescimento e de recessão são destacados em cada país.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = latam, aes(x = year, y = country)) +\n  geom_tile(aes(fill = growth))\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nO gráfico acima é bastante interessante, mas pode ser melhorado em diversos aspectos. Vamos implementar as melhorias sequencialmente.\n\n### Reordenar as colunas\n\nNote que os países no gráfico acima estão organizados de forma alfabética, mas a ordem está invertida. Para alterar a ordem de uma variável categórica temos que alterar os seus níveis. No `R` variáveis categóricas tem uma classe especial `factor` e seus níveis são definidos pelo argumento `levels`.\n\nTipicamente, isto envolve definir um vetor com a ordem dos níveis e criar uma variável nova como no exemplo abaixo.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Vetor com o nome de todos os países latino-americanos\nlvls <- unique(latam[[\"country\"]])\n# Inverte a ordem do vetor\nlvls <- rev(lvls)\n# Redefine os níveis da variável country\nlatam <- latam |> \n  mutate(country = factor(country, levels = lvls))\n```\n:::\n\n\nHá, contudo, vários atalhos para melhor lidar com `factors`. Em particular, o pacote `forcats` carregado junto no `tidyverse` tem uma série de funções que facilitam o trato de variáveis categóricas. A função `fct_rev()`, por exemplo, serve para inverter a ordem de uma variável categórica.\n\nAssim, o código abaixo chega no mesmo resultado.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Inverte a ordem da variável country\nlatam <- latam |> \n  mutate(country = fct_rev(country))\n```\n:::\n\n\nNote que o gráfico está em ordem alfabética, começando na Argentina e terminando na Venezuela.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Monta o gráfico\nggplot(data = latam, aes(x = year, y = country)) +\n  geom_tile(aes(fill = growth))\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Dimensionar o gráfico\n\nPodemos inserir um pouco de espaço entre as séries de cada país alterando o argumento `height` da função `geom_tile()`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = latam, aes(x = year, y = country)) +\n  geom_tile(aes(fill = growth), height = 0.9)\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Alterar as cores\n\nA escolha do esquema de cores é talvez o aspecto mais importante de um heat map. Não é fácil encontrar boas cores que sejam intuitivas e que também sejam inclusivas. Aqui utilizamos uma paleta inspirada no artista plástico Hiroshige Utagawa para conseguir alguns tons de azul/vermelho para representar os anos de expansão/recessão.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Colors\ncolors_hiroshige <- met.brewer(name = \"Hiroshige\")\ncolors_binary <- colors_hiroshige[c(1, 8)]\n\np <- ggplot(data = latam, aes(x = year, y = country)) +\n  geom_tile(aes(fill = growth), height = 0.9) +\n  # Altera a paleta de cores e controla a legenda  \n  scale_fill_manual(\n    # Título da legenda (opcional)\n    name = \"\",\n    # Paleta de cores\n    values = colors_binary,\n    # Nome das classes na legenda\n    labels = c(\"Recession\", \"Growth\"),\n    # Omite o grupo NA\n    na.translate = FALSE\n  )\n\np\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Ajustar e duplicar o eixo\n\nA leitura dos anos no gráfico acima pode ser melhorada. Primeiro, vamos inserir mais quebras no eixo-x e sinalizar que a série tem início em 1951 e tem fim em 2019. Para ajustar o eixo usamos a função `scale_x_continuous()` variando o argumento `breaks`.\n\nQuando temos um gráfico grande, pode ser útil duplicar os eixos para facilitar a sua leitura. Vamos duplicar o eixo-x (anos) usando `sec.axis = dup_axis()`.\n\nPor fim, note que há espaço ocioso tanto no lado esquerdo como no lado direito do gráfico (espaço entre os \"tiles\" e a borda do painel do gráfico). O argumento `expand = c(0, 0)` remove o espaço entre as barras e o limite do painel.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlatam_na <- latam |> \n  filter(!is.na(growth))\n\np <- p +\n  # Controla o eixo-x (anos)\n  scale_x_continuous(\n    # Define as quebras do gráfico \n    breaks = c(1951, seq(1960, 2010, 10), 2019),\n    # Preenche 100% do painel\n    expand = c(0, 0),\n    # Duplica o eixo\n    sec.axis = dup_axis()\n    )\n\np\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Ajustar o tema\n\nOs ajustes finos de um gráfico são feitos com a função `theme()`. Neste caso, queremos um gráfico com poucos elementos. Uma abordagem simples para modificar os detalhes do gráfico é inicar com um template, um tema padrão. Neste caso, começamos como um tema chamado `theme_minimal()`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- p +\n  # Tema minimalista que serve de template\n  theme_minimal() +\n  theme(\n    # Remove o título dos eixos x e y\n    axis.title = element_blank(),\n    # Remove as linhas horizontais e verticais no fundo do gráfico\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    # Coloca a legenda acima do gráfico\n    legend.position = \"top\"\n  )\n\np\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Adicionar linhas de grade\n\nAs linhas de grade de um gráfico facilitam a interpretação dos dados, mas a função `geom_tile()` fica por cima delas. Podemos sobrepor linhas verticais no gráfico para sinalizar o início de cada uma das décadas.\n\nO código abaixo faz isto com a função `geom_vline()` que serve para desenhar linhas verticais num gráfico com o argumento `xintercept`. O argumento `linetype = 2` indica que a linha deve ser tracejada.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- p +\n  # Desenha linhas verticais no gráfico\n  geom_vline(\n    # Define a posição das linhas verticais\n    xintercept = c(1951, seq(1960, 2010, 10), 2019),\n    # Tipo de linha (2 = tracejado)\n    linetype = 2,\n    # Cor da linha\n    colour = \"gray75\"\n    )\n\np\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Ajustar o nome dos eixos\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- p + \n  labs(\n    title = \"Growth/Recession across Latin America\",\n    subtitle = \"Cycles are synchronized across countries. The 1980s was a difficult period for most countries, while the mid 2000s\\nonwards was more positive overall due to the commodtiy boom.\",\n    caption = \"Source: Penn World Table (pwt10)\"\n  )\n\np\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### O gráfico final\n\nO código abaixo gera o gráfico finalizado.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = latam, aes(x = year, y = country)) +\n  geom_tile(aes(fill = growth), height = 0.9) +\n  geom_vline(\n    xintercept = c(1951, seq(1960, 2010, 10), 2019),\n    linetype = 2,\n    colour = \"gray75\") +\n  scale_fill_manual(\n    name = \"\",\n    values = colors_binary,\n    labels = c(\"Recession\", \"Growth\"),\n    na.translate = FALSE\n    ) +\n  scale_x_continuous(\n    breaks = c(1951, seq(1960, 2010, 10), 2019),\n    expand = c(0, 0),\n    sec.axis = dup_axis()\n    ) +\n  labs(\n    title = \"Growth/Recession across Latin America\",\n    subtitle = \"Cycles are synchronized across countries. The 1980s was a difficult period for most countries, while the mid 2000s\\nonwards was more positive due to the commodtiy boom.\",\n    caption = \"Source: Penn World Table (pwt10)\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.title = element_blank(),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-17-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Usando variáveis contínuas\n\nO exemplo acima mostra os ciclos de expansão e recessão usando uma simples variável binária. Este tipo de variável é também chamada de \"discreta\" (ou, às vezes, \"contável\").\n\nPode-se adaptar o código acima para montar gráficos de calor para variáveis contínuas. Para evitar a repetição excessiva de código podemos criar uma função. Funções permitem que você automatize tarefas repetitivas; no fundo, evita que você tenha que ficar copiando e colando código.\n\nVou criar uma função simples que: (1) adiciona as linhas verticais tracejadas sempre nos mesmos anos; (2) ajusta e duplica o eixo-x do gráfico; e (3) aplica um tema padrão sobre o gráfico. O nome desta função será `gg_heatmap()` e o argumento da função será um gráfico \"base\" de `ggplot2`. Isto deve ficar mais compreensível após os exemplos.\n\nO código abaixo mostra a implementação da função.\n\n### Funções\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Cria um tema para os gráficos\ntheme_heatmap <- theme_minimal() +\n  theme(\n    axis.title = element_blank(),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    legend.position = \"top\",\n    legend.key.size = unit(1, \"cm\"),\n    legend.title = element_text(vjust = 0.75, hjust = 0.5)\n  )\n\ngg_heatmap <- function(plot) {\n  \n  plot <- plot +\n    # Desenha linhas verticais no gráfico\n    geom_vline(\n      # Define a posição das linhas verticais\n      xintercept = c(1951, seq(1960, 2010, 10), 2019),\n      # Tipo de linha (2 = tracejado)\n      linetype = 2,\n      # Cor da linha\n      colour = \"gray75\"\n      ) +\n    # Controla o eixo-x (anos)\n    scale_x_continuous(\n      # Define as quebras do gráfico \n      breaks = c(seq(1950, 2010, 10), 2019),\n      # Preenche 100% do painel\n      expand = c(0, 0),\n      # Duplica o eixo\n      sec.axis = dup_axis()) +\n    # Adiciona o tema\n    theme_heatmap\n  \n  return(plot)\n  \n}\n```\n:::\n\n\n### PIB per capita\n\nComo exemplo vamos olhar para o PIB per capita dos países da América Latina. Para melhorar a visualização uso os dados em escala logarítmica.\n\nNo código abaixo eu utilizo a função `gg_heatmap()` criada acima. Primeiro eu crio um gráfico de calor \"base\" usando apenas `geom_tile()` e modificando a escala de cor. Depois, aplico a função neste objeto e o resultado é o gráfico final.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Monta o mapa\np <- ggplot(data = latam, aes(x = year, y = country)) +\n  geom_tile(aes(fill = log(gdppc)), height = 0.9) +\n  scale_fill_gradientn(\n    name = \"PIB per capita (log)\",\n    colours = met.brewer(\"Hokusai1\")\n    )\n\n# Aplica a função\ngg_heatmap(p)\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nO gráfico de calor abaixo apresenta o PIB per capita em nível e com uma paleta de cores diferente. Note como o uso da função `gg_heatmap()` economiza muitas linhas de código.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- ggplot(data = latam, aes(x = year, y = country)) +\n  geom_tile(aes(fill = gdppc / 1000), height = 0.9) +\n  scale_fill_viridis_c(name = \"PIB per capita (mil)\")\n\ngg_heatmap(p)\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-20-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Inflação\n\nMapas de calor também podem servir para construir visualizações no formato de um \"calendário de observações\". A visualização abaixo é adaptada do meu post [Visualizando o IPCA](https://restateinsight.com/posts/general-posts/repost-ipca-visualizacao/) e mostra o valor acumulado do IPCA em 12 meses a cada mês, desde janeiro de 2010. Os dados são importados do Banco Central do Brasil usando o pacote `GetBCBData` e uso o pacote `lubridate` para transformar os dados.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n#> Importa a série do IPCA a partir da API do Banco Central\nipca <- GetBCBData::gbcbd_get_series(\n  id = 433,\n  first.date = as.Date(\"1998-01-01\")\n  )\n\n#> Limpeza de dados\nipca <- ipca |> \n  mutate(\n    #> Cria uma coluna com o ano da observação\n    year = lubridate::year(ref.date),\n    #> Cria uma coluna com o mês da obervação\n    month = lubridate::month(ref.date, label = TRUE, locale = \"pt_BR\"),\n    #> Acumula os valores do IPCA em 12 meses\n    acum12m = RcppRoll::roll_prodr(1 + value / 100, n = 12) - 1,\n    acum12m = acum12m * 100\n    ) |> \n  filter(ref.date >= as.Date(\"2010-01-01\"))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(ipca, aes(x = month, y = year, fill = acum12m)) +\n  geom_tile(color = \"gray90\") +\n  scale_x_discrete(position = \"top\") +\n  scale_y_reverse(breaks = 2010:2023, expand = c(0, 0)) +\n  scale_fill_viridis_c(\n    name = \"Var. percentual\\ndo IPCA acumulada\\nem 12 meses\",\n    option = \"magma\",\n    breaks = seq(2, 12, 2),\n    labels = paste0(seq(2, 12, 2), \"%\")) +\n  labs(title = \"Inflação no Brasil\") +\n  theme_heatmap +\n  theme(\n    axis.text = element_text(size = 11, color = \"gray15\")\n    )\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-22-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nNa visualização vê-se como os anos iniciais de 2010-14 foram marcados por uma inflação moderadamente alta, oscilando entre 4-6%. Em 2015, libera-se os preços administrados, que ficaram artificialmente represados durante o período eleitoral, e a inflação estoura, chegando e depois superando a casa de 10%. Nos anos seguintes, a inflação é mais baixa, caindo até a casa de 2-3%. A quebra da série acontece durante a pandemia, quando a inflação chega a 12% e passa vários meses acima de 10%.\n\nTecnicamente, vale notar o uso da função `scale_x_discrete` já que a variável de mês é armazenada como `factor`. Inverte-se a escala dos anos usando `scale_y_reverse`, assim os anos vão \"de cima para baixo\", na direção mais natural de leitura. Por fim, especifico manualmente os valores de quebras na legenda de cores, dentro da função `scale_fill_viridis_c`.\n\n### Energia elétrica\n\nPode-se usar mapas de calor para explorar a presença de padrões sazonais nos dados. A visualização abaixo é adaptada do meu post sobre [nascimentos no Brasil](https://restateinsight.com/posts/general-posts/2023-10-wv-nascimentos-brasil/) mas olha para o consumo mensal de energia elétrica. Mais especificamente, a série apresenta o consumo residencial de energia elétrica desde 2002: escolhe-se este ano para evitar o apagão de 2021, que distorceria muito a visualização. Cada quadrado apresenta o consumo do mês, relativamente ao consumo total naquele ano.\n\nComo podia-se imaginar, o consumo de energia é mais elevado nos meses quentes: dezembro, janeiro, fevereiro e março apresentam os maiores valores. Já nos meses de inverno, em contraste, o consumo costuma ser menor. O pico da série aparece em janeiro de 2015, quande [houve um verão particularmente quente](https://g1.globo.com/sao-paulo/noticia/2015/01/janeiro-de-2015-e-o-4-mes-mais-quente-da-historia-em-sp-diz-inmet.html)[^1].\n\n[^1]: Vale reforçar que este não foi o pico absoluto de consumo de energia no país: os dados representam o consumo percentual de energia em relação ao total de energia consumida no ano.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n#> Importa a série de consumo residencial de energia elétrica a partir da\n#> API do Banco Central\nenergia <- GetBCBData::gbcbd_get_series(\n  id = 1403,\n  first.date = as.Date(\"1980-01-01\")\n  )\n\n#> Limpeza de dados\nenergia <- energia |> \n  mutate(\n    mes = lubridate::month(ref.date, label = TRUE, locale = \"pt_BR\"),\n    mes = fct_rev(mes),\n    ano = lubridate::year(ref.date)\n  ) |> \n  #> Agrupa por ano e calcula o consumo percentual em cada mês relativamente ao ano\n  group_by(ano) |> \n  mutate(cons_rel = value / sum(value) * 100) |> \n  ungroup() |> \n  #> Começa a série em 2002 para evitar o \"apagão\" em 2001.\n  filter(ano > 2002, ano < 2023)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(energia, aes(x = ano, y = mes, fill = cons_rel)) +\n  geom_tile(color = \"gray90\") +\n  scale_x_continuous(breaks = 2001:2022, expand = c(0, 0), position = \"top\") +\n  scale_fill_viridis_c(name = \"Consumo de Energia\\nem relação ao ano (%)\") +\n  theme_heatmap +\n  theme(\n    legend.title = element_text(vjust = 0.8),\n    axis.text = element_text(size = 11, color = \"gray15\")\n    )\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-24-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Escala divergente\n\nOutra aplicação de gráficos de calor é de mostrar uma variável num gradiente de cores \"divergente\". Um caso comum é quando quer-se mostrar uma variável como um desvio em relação a alguma média. Em geral, há duas possibilidades para visualizar os dados:\n\n1.  **O desvio dos valores em relação à média na \"coluna\", isto é, entre os grupos**. No caso do mapa de calor do PIB per capita isto seria equivalente a comparar o crescimento dos países (grupo) no mesmo ano.\n2.  **O desvio dos valores em relação à média na \"linha\", isto é, dentro de um mesmo grupo**. Novamente, no caso do mapa de calor do PIB per capita, isto seria equivalente a comparar o crescimento do país num ano em relação ao histórico de crescimento do país.\n\nNão há uma escolha certa ou errada com este tipo de visualização. É preciso saber somente qual tipo de relação que se quer visualizar. Em casos mais simples, a própria variável de interesse pode estar expressa na forma de desvios em relação a alguma média. Por fim, há também casos de variáveis que tem valores padronizados, ou indexados, que funcionam bem com escalas divergentes.\n\n### Aquecimento Global\n\nO exemplo abaixo usa a base `globtemp` que mensura as \"anomalias de temperatura\" nos últimos anos. Por anomalia de temperatura, entende-se, o desvio da temperatura média anual em relação à média histórica (1951-1980). Esta visualização é adaptada do meu post [Aquecimento Global](https://restateinsight.com/posts/general-posts/repost-aquecimento-global/).\n\nNa visualização, fica evidente que os anos recentes concentram um grande número de \"anomalias positivas\", isto é, anos em que a temperatura média esteve acima da média histórica. Este exemplo é bastante simples pois existe apenas um \"grupo\", logo, os valores estão representados como desvios em relação à média na \"linha\".\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Carrega a base de dados 'globtemp'\ndata(\"globtemp\")\n# Converte o objeto para data.frame\ndf <- data.frame(ano = as.numeric(time(globtemp)),\n temp = as.numeric(globtemp))\n\n# Monta o gráfico\nggplot(data = df, aes(x = ano, y = 0, fill = temp)) +\n geom_tile() +\n  scale_fill_gradientn(\n    name = \"Percent Deviation\\nin relation to\\nWorld average\",\n    breaks = seq(-1, 1, 0.25),\n    colors = rev(met.brewer(\"Hiroshige\")), \n  ) +\n  theme_heatmap\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-25-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Correlação\n\nA correlação é uma medida da relação linear entre um par de variáveis. Na construção de um modelo linear, ou modelo de regressão de forma geral, é interessante visualizar a relação de correlação entre as variáveis. Por construção, a correlação (de Pearson) é padronizada pelo desvio-padrão das variáveis, logo, varia entre -1 e 1. Uma correlação igual a -1 indica uma correlação negativa \"perfeita\" e uma correlação igual a 1 indica uma correlação positiva \"perfeita\". Se a correlação entre duas variáveis for próxima de 0, não há dependência linear entre as variáveis.\n\nO código abaixo seleciona algumas das colunas da base de dados `hprice2` exportada junto com o pacote wooldridge. Esta base contém o preço de alguns imóveis junto de algumas outras variáveis. Para consultar a definição das variáveis use `?hprice2`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\ndat <- wooldridge::hprice2\n\n#> Seleciona colunas\nnum_cols <- c(\"stratio\", \"dist\", \"nox\", \"crime\", \"rooms\", \"lprice\")\nsub <- select(dat, all_of(num_cols))\n\ntbl_cor <- sub |> \n  #> Calcula matriz de correlação\n  cor(method = \"pearson\") |> \n  as_tibble() |> \n  #> Converte para longitudinal e adapta variáveis\n  mutate(name_1 = num_cols) |> \n  pivot_longer(cols = -\"name_1\", names_to = \"name_2\", values_to = \"correl\") |> \n  mutate(\n    name_1 = factor(name_1, levels = num_cols, labels = str_to_title(num_cols)),\n    name_2 = factor(name_2, levels = num_cols, labels = str_to_title(num_cols)),\n    correl = if_else(correl == 1, NA_real_, correl)\n  )\n```\n:::\n\n\nO mapa de calor abaixo mostra a correlação entre algumas variáveis. A variável `lprice` é o logaritmo natural do preço do imóvel. Nota-se que esta variável tem uma correlação positiva com `rooms` (número de quartos) e `dist` (distância até polo de emprego). Por outro lado, há uma correlação negativa entre o preço e `nox` (medida de poluição do ar) e `crime` (proporção de crimes).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(tbl_cor, aes(x = name_1, y = name_2, fill = correl)) +\n  geom_tile() +\n  geom_text(aes(label = round(correl, 2)), size = 4) +\n  scale_fill_gradient2(\n    name = \"\",\n    low = colors_hiroshige[1],\n    high = colors_hiroshige[10],\n    limits = c(-1, 1),\n    na.value = \"gray90\"\n    ) +\n  guides(fill = \"none\") +\n  labs(title = \"Correlação entre variáveis\") +\n  theme_heatmap +\n  theme(axis.text = element_text(size = 12))\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-27-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nO valor da correlação foi plotado usando `geom_text`. Como a escala da correlação varia sempre entre -1 e 1, suprime-se a legenda de cores. Para construir a escala divergente utiliza-se `scale_fill_gradient2` com a mesma paleta de cores do Met Brewer (Hiroshige). Vale notar que existe um pacote dedicado a este tipo de visualização chamado `ggcorplot` - para mais detalhes [veja o GitHub do pacote](https://rpkgs.datanovia.com/ggcorrplot/index.html).\n\n### PIB per capita\n\nVamos retornar, novamente, ao exemplo do PIB per capita. Restringindo a análise somente à América Latina, há duas maneiras intuitivas de olhar os dados: (1) relativamente ao ano (coluna); (2) relativamente ao país (linha).\n\nNo primeiro caso, compara-se a **performance entre os países em cada ano**: vê-se quais foram os países que cresceram mais ou menos em determinado ano. No segundo caso, **compara-se a trajetória de cada país individualmente**: fica mais evidente quais foram os anos de maior ou de menor crescimento.\n\nO código abaixo usa a função `scale` para \"normalizar\" os dados[^2].\n\n[^2]: O termo \"normalizar\" é um tanto abusado hoje em dia, em contextos estatísticos. A função `scale` subtrai cada valor pela sua média e divide o resultado pelo desvio padrão.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Escala os dados em relação ao país\nscale_country <- latam |> \n  group_by(country) |> \n  mutate(scaled = as.numeric(scale(d_gdppc)))\n\n# Escala os dados em relação ao ano\nscale_year <- latam |> \n  group_by(year) |> \n  mutate(scaled = as.numeric(scale(d_gdppc)))\n```\n:::\n\n\nO primeiro gráfico mostra o crescimento do PIB per capita anual relativamente ao crescimento médio do país. Note como oscila o crescimento da Argentina: anos de crescimento acima da média são imediatamente seguidos por anos de crescimento abaixo da média durante quase toda a sua história.\n\nJá o Brasil parece ter um crescimento mais ao estilo \"voos de galinha\", com alguns poucos anos de crescimento excepcionais aglomerados. Vale notar, também, como a presença da Venezuela entre os países acaba distorcendo a escala.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- ggplot(data = scale_country, aes(x = year, y = country)) +\n  geom_tile(aes(fill = scaled)) +\n  scale_fill_gradientn(\n    name = \"Desvio em relação\\nao crescimento\\nmédio do país\",\n    breaks = seq(-4, 4, 1),\n    colours = colors_hiroshige\n    )\n\ngg_heatmap(p) +\n  ggtitle(\"Crescimento relativo ao país\")\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-29-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nO segundo gráfico mostra o crescimento anual de cada país em comparação com os demais países latinoamericanos. O padrão revela quais países cresceram mais ou menos em cada ano.\n\nDe maneira geral, o Brasil parece crescer ligeiramente acima da média da região. A Venezuela, que no gráfico anterior parecia exibir um crescimento relativamente estável ao longo dos anos, agora apresenta um padrão com maior oscilação. Dos anos 2000 em diante, Bolivia, Chile, Colombia e Peru são os países que consistentemente crescem acima da média da região. Novamente o colapso econômico da Venezuela acaba distorcendo a escala de cores.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- ggplot(data = scale_year, aes(x = year, y = country)) +\n  geom_tile(aes(fill = scaled)) +\n  scale_fill_gradientn(\n    name = \"Desvio em relação\\nao crescimento\\nmédio de cada ano\",\n    breaks = seq(-4, 4, 1),\n    colours = colors_hiroshige\n    )\n\ngg_heatmap(p) +\n  ggtitle(\"Crescimento relativo ao ano\")\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-30-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nSuponha que seja interessante descobrir quais países estão crescendo acima ou abaixo da média mundial. Para chegar nesta resposta precisa-se primeiro fazer um pouco de manipulação nos dados.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Calcula o PIB per capita mundial e o seu crescimento \nworld <- pwt |> \n  group_by(year) |> \n  summarise(\n    gdp = sum(rgdpe, na.rm = TRUE),\n    n = sum(pop, na.rm = TRUE)) |> \n  mutate(\n    gdppc_world = gdp / n,\n    d_gdppc_world = gdppc_world / lag(gdppc_world) - 1) |> \n  select(year, gdppc_world, d_gdppc_world)\n\n# Calcula a razão do PIB per capita local x mundial e o desvio do \n# crescimento do PIB per capita em relação à média mundial\n# \nlatam_scaled <- latam |> \n  left_join(world, by = \"year\") |> \n  mutate(\n    scaled = gdppc / gdppc_world * 100,\n    deviation = (d_gdppc - d_gdppc_world) / d_gdppc_world)\n\n# Trunca os outliers para melhorar a visualização\noutlier <- boxplot.stats(latam_scaled$deviation)$stats[c(1, 5)]\n\nlatam_scaled <- latam_scaled %>%\n  mutate(\n    deviation_trunc = if_else(deviation > 5, 5, deviation),\n    deviation_trunc = if_else(deviation < -5, -5, deviation_trunc)\n  )\n```\n:::\n\n\nApós a manipulação de dados acima, pode-se visualizar o crescimento da América Latina em relação ao resto do mundo. O primeiro gráfico abaixo mostra o desvio percentual do crescimento doméstico em relação à média mundial naquele ano.\n\nVê-se como, de maneira geral, os países latino-americanos tiveram dificuldades para acompanhar o resto do mundo nos anos 1980. Além disso, a maior parte dos países parece ficar próxima ou abaixo da média. A exceção é durante o começo dos anos 1990 e os anos do boom de commodities (2000-2012). Além disso, vê-se como a recessão brasileira de 2015-17, apesar de ter sido influenciada por uma leve desaceleração global, foi majoritariamente uma crise interna.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- ggplot(data = latam_scaled, aes(x = year, y = country)) +\n  geom_tile(aes(fill = deviation_trunc), height = 0.8) +\n  scale_fill_gradientn(\n    name = \"Percent Deviation\\nin relation to\\nWorld average\",\n    breaks = seq(-5, 5, 1),\n    colors = met.brewer(\"Hiroshige\")\n  )\n\ngg_heatmap(p)\n```\n\n::: {.cell-output-display}\n![](11-grafico-calor_files/figure-html/unnamed-chunk-32-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n# Resumo\n\nMapas de calor de clusters são uma visualização interessante e versátil. Este tipo de visualização permite detectar padrões e tendências nos dados de maneira bastante intuitiva. Nos exemplos vimos como encontrar padrões sazonais, macrotendências entre grupos e até correlações entre variáveis. Este tipo de visualização parece estar ganhando mais popularidade recentemente, mas ainda é subutilizada.\n\nA escolha da escala de cores é particularmente importante neste tipo de gráfico: a depender das cores pode ser difícil verificar pequenas variações no valores, sobretudo, se os valores estiverem adjacentes no gráfico. Neste sentido, o mapa de calor de clusters não é apropriado quando se quer ver pequenas variações nos dados. Além disso, pode ser necessário testar várias paletas de cores alternativas até chegar num resultado satisfatório.\n\n## Posts relacionados\n\n-   [Nascimentos no Brasil](https://restateinsight.com/posts/general-posts/2023-10-wv-nascimentos-brasil/)\n\n-   [Crescimento do PIB per capita no mundo](https://restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/)\n\n-   [Visualizando o IPCA](https://restateinsight.com/posts/general-posts/repost-ipca-visualizacao/)\n\n-   [Estético: destacando informação](https://restateinsight.com/posts/ggplot2-tutorial/5-grafico-text)\n\n-   [Estético: tipografia e temas](https://restateinsight.com/posts/ggplot2-tutorial/7-themes-fonts)\n",
    "supporting": [
      "11-grafico-calor_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}