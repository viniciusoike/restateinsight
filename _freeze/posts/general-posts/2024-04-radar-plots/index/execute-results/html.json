{
  "hash": "bcaae23e1d537f656d4a7ea99e3635f3",
  "result": {
    "markdown": "---\ntitle: \"\"\ndate: \"2024-04-15\"\ncategories: ['data-visualization', 'ggplot2', 'real-estate']\ndescription: \"\"\nexecute: \n  message: false\n  warning: false\n  eval: false\ndraft: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(realestatebr)\nlibrary(ggradar)\nlibrary(showtext)\nfont_add_google(\"Lato\", \"Lato\")\nshowtext_auto()\n\nabrainc <- get_abrainc_indicators()\n\nradar <- abrainc$radar\n\ncurrent_period <- radar |> \n  filter(date == max(date)) |> \n  pivot_wider(id_cols = date, names_from = variable, values_from = value)\n\nlatest_date <- max(radar$date)\nlast_year <- latest_date - lubridate::years(1)\n\nbest_year <- radar |> \n  mutate(month = lubridate::month(date)) |> \n  filter(month == lubridate::month(latest_date)) |> \n  group_by(date) |> \n  summarise(total = sum(value)) |> \n  slice_max(total, n = 1) |> \n  pull(date)\n\ncompare_best <- radar |> \n  filter(date %in% c(latest_date, best_year)) |> \n  pivot_wider(id_cols = year, names_from = variable, values_from = value)\n\ncompare <- radar |> \n  mutate(month = lubridate::month(date)) |> \n  filter(year >= lubridate::year(latest_date) - 1,\n         month == lubridate::month(latest_date)) |> \n  pivot_wider(id_cols = year, names_from = variable, values_from = value)\n\nradar_labels <- c(\n  \"Confidence Index\", \"Activity (GDP)\", \"Interest Rate\", \"Financing Conditions\",\n  \"Real Concessions\", \"Atractivity\", \"Employment\", \"Wages\", \"Real Estate Investing\",\n  \"Input Costs\", \"New Launches\", \"Real estate Prices\")\n\nradar_labels <- str_wrap(radar_labels, width = 10)\n\nplot_radar_current <- \n  ggradar(\n    current_period,\n    values.radar = c(\"0\", \"5\", \"10\"),\n    axis.labels = radar_labels,\n    font.radar = \"Lato\",\n    grid.label.size = 3,\n    axis.label.size = 3,\n    plot.extent.x.sf = 1.5,\n    plot.extent.y.sf = 1.4,\n    group.colours = \"#264653\",\n    grid.min = 0,\n    grid.mid = 5,\n    grid.max = 10,\n    group.point.size = 3)\n\nplot_radar_current\n\nplot_radar_yoy <- \n  ggradar(\n    compare,\n    values.radar = c(\"0\", \"5\", \"10\"),\n    axis.labels = radar_labels,\n    font.radar = \"Lato\",\n    grid.label.size = 3,\n    axis.label.size = 3,\n    legend.text.size = 10,\n    plot.extent.x.sf = 1.5,\n    plot.extent.y.sf = 1.5,\n    group.colours = c(\"#264653\", \"#e76f51\"),\n    grid.min = 0,\n    grid.mid = 5,\n    grid.max = 10.5,\n    group.point.size = 2) +\n  theme(legend.position = \"top\")\n\nplot_radar_yoy\n\nggradar(compare, group.colours = c(\"#264653\", \"#e76f51\"), axis.labels = radar_labels,) +\n  theme(legend.position = \"top\")\n\ndat = compare |> \n  pivot_longer(cols = -year) |> \n  mutate(year = factor(year))\n\nggplot(dat, aes(name, value, color = year)) +\n  geom_line(aes(group = name), color = \"gray30\") +\n  geom_point(size = 3) +\n  coord_flip() +\n  scale_color_manual(\n    name = \"Ano\",\n    values = c(\"#2A9D8F\", \"#E9C46A\")\n    )\n    \nggplot(dat, aes(name, value, color = year, group = year)) +\n  geom_line()\n\nggplot(dat, aes(name, value, fill = year)) +\n  geom_col(position = position_dodge())\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}