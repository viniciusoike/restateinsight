{
  "hash": "9dfc370e02306fff95195ec507230654",
  "result": {
    "markdown": "---\ntitle: \"OLS com matrizes\"\ndate: '2020-01-01'\ncategories: ['econometria', 'repost']\n---\n\n\nUma forma instrutiva de entender o modelo de regressão linear é expressando ele em forma matricial. Os cursos introdutórios de econometria costumam omitir esta abordagem e expressam todas as derivações usando somatórios, deixando a abordagem matricial para cursos mais avançados. É bastante simples computar uma regressão usando apenas matrizes no R.\n\nDe fato, um dos objetos fundamentais do R é a e muitas das operações matriciais (decomposições, inversa, transposta, etc.) já estão implementadas em funções base. Uma var $k$ .\n\nNeste post vou mostrar como fazer uma regressão linear usando somente matrizes no R. Além disso, vou computar algumas estatísticas típicas (t, F)\n\nO modelo linear é da forma\n\n$$\ny_{t} = x^\\intercal_{t} \\beta + e_{t}\n$$\n\nonde $x^\\intercal$ é o vetor transposto de $x$ . É importante sempre ter em mente a dimensão destes vetores. O vetor $y_{t}$ é $n\\times1$ onde $n$ representa o número de observações na amostra. O vetor $\\beta$ é $k\\times1$ onde $k$ é o número de regressores (ou variáveis explicativas). Como há $n$ observações para cada uma dos $k$ regressores, $x$ é $k\\times1$ ; o detalhe é que $x = (1 \\, \\,x_{1} \\, \\dots \\,x_{k-1})$ , onde cada $x_{i}$ é $n\\times 1$ e $1$ é um vetor de uns $n\\times1$ . Finalmente, $e_{t}$ é $n\\times1$ . Temos então que:\n\n$$\n\\begin{pmatrix}\ny_{1} \\\\ \ny_{2}\\\\ \n\\vdots\\\\\ny_{n}\n\\end{pmatrix}= \n\\begin{pmatrix}\n1\\\\ \nx_{1}\\\\ \n\\vdots\\\\\nx_{k-1}\n\\end{pmatrix}^\\intercal\n\\begin{pmatrix}\n\\beta_{0}\\\\ \n\\beta_{1}\\\\ \n\\vdots\\\\\n\\beta_{k-1}\n\\end{pmatrix}+\n\\begin{pmatrix}\ne_{1}\\\\ \ne_{2}\\\\ \n\\vdots\\\\\ne_{n}\n\\end{pmatrix}\n$$\n\nonde:\n\n$$\n\\begin{bmatrix} \nx_{1} & = (x_{11} & x_{12} & x_{13} & \\dots & x_{1n})\\\\\nx_{2} & = (x_{21} & x_{22} & x_{23} & \\dots & x_{2n})\\\\\nx_{3} & = (x_{31} & x_{32} & x_{33} & \\dots & x_{3n})\\\\\n\\vdots\\\\\nx_{k-1} & = (x_{(k-1)1} & x_{(k-1)2} & x_{(k-1)3} & \\dots & x_{(k-1)n})\n\\end{bmatrix}\n$$\n\nQueremos encontrar o vetor $\\hat{\\beta}$ que minimiza o a soma do quadrado dos erros, isto é, que minimiza\n\n$$\nS(\\beta) = \\sum_{t = 1}^{T}(y_{t} - x^\\intercal_{t}\\beta)^{2}\n$$\n\nEncontramos o ponto crítico derivando a expressão acima e igualando-a a zero. O resultado é o conhecido estimador de mínimos quadrados:\n\n$$\n\\hat{\\beta} = \\left ( \\sum_{t = 1}^{T}x_{t}x_{t}^{^\\intercal} \\right )^{-1} \\sum_{t = 1}^{T}x_{t}y_{t}\n$$\n\nPara reescrever as equações acima usando matrizes usamos os seguintes fatos:\n\n$$\n\\sum_{t = 1}^{T}x_{t}x_{t}^{^\\intercal} = X^\\intercal X\n$$\n\nonde $X$ é uma matriz $n \\times k$\n\n$$\n\\sum_{t = 1}^{T}x_{t}y_{t} = X^\\intercal y\n$$\n\nonde $X^\\intercal y$ é $k \\times 1$ . Lembre-se que uma hipótese do modelo linear é de que $X$ é uma matriz de posto completo, logo $X^\\intercal X$ possui inversa e podemos escrever:\n\n$$\n\\hat{\\beta} = (X^\\intercal X)^{-1}X^\\intercal y\n$$\n\n## Exemplo: salário (Wooldridge)\n\nComo exemplo vou usar um exemplo clássico de livro texto de econometria: uma regressão de salário (rendimento) contra algumas variáveis explicativas convencionais: anos de educação, sexo, anos de experiência, etc. As bases de dados do livro [Introductory Econometrics](https://www.cengagebrain.com.mx/shop/isbn/9781337558860) estão disponíveis no pacote `wooldridge`. O código abaixo carrega a base de dados .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(wooldridge)\n# Carrega a base\ndata(wage2)\n# Remove os valores ausentes (NAs)\nsal <- na.omit(wage2)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:80%; \"><table class=\"table table-hover table-bordered table-striped\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> wage </th>\n   <th style=\"text-align:center;\"> hours </th>\n   <th style=\"text-align:center;\"> IQ </th>\n   <th style=\"text-align:center;\"> KWW </th>\n   <th style=\"text-align:center;\"> educ </th>\n   <th style=\"text-align:center;\"> exper </th>\n   <th style=\"text-align:center;\"> tenure </th>\n   <th style=\"text-align:center;\"> age </th>\n   <th style=\"text-align:center;\"> married </th>\n   <th style=\"text-align:center;\"> black </th>\n   <th style=\"text-align:center;\"> south </th>\n   <th style=\"text-align:center;\"> urban </th>\n   <th style=\"text-align:center;\"> sibs </th>\n   <th style=\"text-align:center;\"> brthord </th>\n   <th style=\"text-align:center;\"> meduc </th>\n   <th style=\"text-align:center;\"> feduc </th>\n   <th style=\"text-align:center;\"> lwage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:center;\"> 769 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 93 </td>\n   <td style=\"text-align:center;\"> 35 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 31 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 6.645091 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:center;\"> 825 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 108 </td>\n   <td style=\"text-align:center;\"> 46 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> 33 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 6.715383 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:center;\"> 650 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 96 </td>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 13 </td>\n   <td style=\"text-align:center;\"> 7 </td>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 6.476973 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:center;\"> 562 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 74 </td>\n   <td style=\"text-align:center;\"> 27 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 34 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 6.331502 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:center;\"> 600 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 91 </td>\n   <td style=\"text-align:center;\"> 24 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 13 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 30 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 6.396930 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:center;\"> 1154 </td>\n   <td style=\"text-align:center;\"> 45 </td>\n   <td style=\"text-align:center;\"> 111 </td>\n   <td style=\"text-align:center;\"> 37 </td>\n   <td style=\"text-align:center;\"> 15 </td>\n   <td style=\"text-align:center;\"> 13 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 36 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 7.050990 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:center;\"> 1000 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 95 </td>\n   <td style=\"text-align:center;\"> 44 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 36 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 6.907755 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:center;\"> 930 </td>\n   <td style=\"text-align:center;\"> 43 </td>\n   <td style=\"text-align:center;\"> 132 </td>\n   <td style=\"text-align:center;\"> 44 </td>\n   <td style=\"text-align:center;\"> 18 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 13 </td>\n   <td style=\"text-align:center;\"> 38 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 13 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 6.835185 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 14 </td>\n   <td style=\"text-align:center;\"> 1318 </td>\n   <td style=\"text-align:center;\"> 38 </td>\n   <td style=\"text-align:center;\"> 119 </td>\n   <td style=\"text-align:center;\"> 24 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 7 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 28 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 7.183871 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 15 </td>\n   <td style=\"text-align:center;\"> 1792 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 118 </td>\n   <td style=\"text-align:center;\"> 47 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> 34 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 7.491087 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\nA base traz 663 observações de 17 variáveis. A função `str` é útil para entender a estrutura dos dados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dimensão da base (# linhas  # colunas)\ndim(sal)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 663  17\n```\n:::\n\n```{.r .cell-code}\n# Descrição da base\nstr(sal)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t663 obs. of  17 variables:\n $ wage   : int  769 825 650 562 600 1154 1000 930 1318 1792 ...\n $ hours  : int  40 40 40 40 40 45 40 43 38 40 ...\n $ IQ     : int  93 108 96 74 91 111 95 132 119 118 ...\n $ KWW    : int  35 46 32 27 24 37 44 44 24 47 ...\n $ educ   : int  12 14 12 11 10 15 12 18 16 16 ...\n $ exper  : int  11 11 13 14 13 13 16 8 7 9 ...\n $ tenure : int  2 9 7 5 0 1 16 13 2 9 ...\n $ age    : int  31 33 32 34 30 36 36 38 28 34 ...\n $ married: int  1 1 1 1 0 1 1 1 1 1 ...\n $ black  : int  0 0 0 0 0 0 0 0 0 0 ...\n $ south  : int  0 0 0 0 0 0 0 0 0 0 ...\n $ urban  : int  1 1 1 1 1 0 1 0 1 1 ...\n $ sibs   : int  1 1 4 10 1 2 1 1 3 1 ...\n $ brthord: int  2 2 3 6 2 3 1 1 1 1 ...\n $ meduc  : int  8 14 12 6 8 14 12 13 10 12 ...\n $ feduc  : int  8 14 12 11 8 5 11 14 10 12 ...\n $ lwage  : num  6.65 6.72 6.48 6.33 6.4 ...\n - attr(*, \"time.stamp\")= chr \"25 Jun 2011 23:03\"\n - attr(*, \"na.action\")= 'omit' Named int [1:272] 2 6 8 12 13 19 20 21 31 36 ...\n  ..- attr(*, \"names\")= chr [1:272] \"2\" \"6\" \"8\" \"12\" ...\n```\n:::\n:::\n\n\nO modelo proposto é o abaixo:\n\n$$\n\\text{lwage}_{t} = \\beta_{0} + \\beta_{1}\\text{educ}_{t} + \\beta_{2}\\text{exper}_{t} + \\beta_{3}\\text{exper}^{2}_{t} + \\beta_{4}\\text{tenure}_{t} + \\beta{5}\\text{married}_{t} + u_{t}\n$$\n\nonde:\n\n-   lwage = logaritmo natural do salário\n\n-   educ = anos de educação\n\n-   exper = anos de experiência (trabalhando)\n\n-   tenure = anos trabalhando com o empregador atual\n\n-   married = dummy (1 = casado, 0 = não-casado)\n\nHá 6 coeficientes para estimar logo $k = 6$ . Além disso, como há $663$ observações temos que $n = 663$ . A matriz de \"dados\" é da forma:\n\n$$\nX = \\begin{bmatrix} \n1 & 12 & 11 & 121 & 2 & 1\\\\\\\\\n1 & 14 & 11 & 121 & 9 & 1\\\\\\\\\n1 & 12 & 13 & 169 & 7 & 1\\\\\\\\\n\\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots \\\\\\\\\n1 & 13 & 10 & 100 & 3 & 1\n\\end{bmatrix}_{663\\times 6}\n$$\n\nO código abaixo monta a matriz $X$ acima. As funções `head` e `tail` podem ser usadas para verificar as primeiras e últimas linhas da matriz. Vale esclarecer dois pontos sobre o código a ser usado neste post. Primeiro, quando se cria um objeto usando o operador `<-` pode-se forçar o R a imprimir o seu valor colocando a expressão entre parêntesis. Por exemplo, teste `(x <- 3)`. O segundo ponto é que o operador de multiplicação matricial é `%*%`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define alguns valores úteis: \n## N = número de observações\n## k = número de regressores\n## const = vetor com 1^\\intercals (uns)\nN <- 663; k <- 6; const <- rep(1, 663)\n# Monta a matriz de observações da regressão\nX <- cbind(const, sal$educ, sal$exper, sal$exper^2, sal$tenure, sal$married)\nX <- as.matrix(X)\n# Define o nome das colunas da matriz de observações\ncolnames(X) <- c(\"const\", \"educ\", \"exper\", \"exper2\", \"tenure\", \"married\")\n# Função para verificar as primeiras linhas da matriz X\nhead(X)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     const educ exper exper2 tenure married\n[1,]     1   12    11    121      2       1\n[2,]     1   14    11    121      9       1\n[3,]     1   12    13    169      7       1\n[4,]     1   11    14    196      5       1\n[5,]     1   10    13    169      0       0\n[6,]     1   15    13    169      1       1\n```\n:::\n\n```{.r .cell-code}\n# Função para verificar as últimas linhas da matriz X\ntail(X)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       const educ exper exper2 tenure married\n[658,]     1   12     9     81      2       1\n[659,]     1   16     8     64     10       1\n[660,]     1   12    11    121      3       1\n[661,]     1   12     9     81      3       1\n[662,]     1   16    10    100      9       1\n[663,]     1   13    10    100      3       1\n```\n:::\n:::\n\n\nLembrando que o problema de mínimos quadrados é de encontrar os valores de $\\beta$ que minimizam a soma dos erros ao quadrado.\n\n$$\n\\underset{\\beta}{\\text{Min }} e^\\intercal e\n$$\n\nAbrindo mais a expressão acima:\n\n$$\n\\begin{align}\n  e^\\intercal e & = (y - X\\beta )^\\intercal(y - X\\beta ) \\\\\\\\\n      & = y^\\intercal y - y^\\intercal X\\beta - \\beta ^\\intercal X^\\intercal y + \\beta ^\\intercal X^\\intercal X \\beta \\\\\\\\\n      & = y^\\intercal y - 2 y^\\intercal X \\beta + \\beta^\\intercal X^\\intercal X \\beta \n\\end{align}\n$$\n\nDerivando em relação a $\\beta$ e igualando a zero chega-se no estimador de MQO\n\n$$\n\\beta_{\\text{MQO}} = (X^\\intercal X)^{-1}X^\\intercal y\n$$\n\nO código abaixo computa $\\beta_{\\text{MQO}}$ . Note que os parêntesis por fora da expressão forçam o R a imprimir o valor do objeto. Além disso, como estamos multiplicando matrizes/vetores usamos `%*%`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define o vetor y (log do salário)\ny <- sal$lwage\n# Computa a estimativa para os betas\n(beta <- solve(t(X) %*% X) %*% t(X) %*% y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                [,1]\nconst   5.3563606713\neduc    0.0767258959\nexper   0.0104985672\nexper2  0.0002881339\ntenure  0.0091039254\nmarried 0.2002468574\n```\n:::\n:::\n\n\nOs valores estimados dos betas são reportados na tabela abaixo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntabela <- as.data.frame(round(beta, 4))\ncolnames(tabela) <- c(\"Coeficiente estimado\")\nround(beta, 4) %>%\n  kable(align = \"c\") %>%\n  kable_styling(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> const </td>\n   <td style=\"text-align:center;\"> 5.3564 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> educ </td>\n   <td style=\"text-align:center;\"> 0.0767 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> exper </td>\n   <td style=\"text-align:center;\"> 0.0105 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> exper2 </td>\n   <td style=\"text-align:center;\"> 0.0003 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> tenure </td>\n   <td style=\"text-align:center;\"> 0.0091 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> married </td>\n   <td style=\"text-align:center;\"> 0.2002 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Resíduo e variância\n\nO resíduo do modelo é simplesmente a diferença entre o observado $y_{t}$ e o estimado $\\hat{y_{t}}$ . Isto é,\n\n$$\n\\hat{e}_{t} = y_{t} - \\hat{y}_{t} = y_{t} - x_{t}^\\intercal\\hat{\\beta}\n$$\n\nou, de forma equivalente,\n\n$$\n\\hat{e} = y - X\\hat{\\beta}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Computa o resíduo da regressão\nu_hat <- y - X %*% beta\n```\n:::\n\n\nUsando o histograma pode-se visualizar a distribuição dos resíduos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(u_hat, breaks = 30, freq = FALSE, main = \"Histograma dos resíduos\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nO estimador da variância é dado por:\n\n$$\n\\hat{\\sigma}^{2} = \\frac{1}{N-k}\\sum_{t = 1}^{N}\\hat{e}_{t}^{2}\n$$\n\nSubstituindo os valores calculados acima chegamos em:\n\n$$\n\\hat{\\sigma}^{2} = \\frac{\\hat{e}^\\intercal\\hat{e}}{N-k} = 0.1403927\n$$\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}