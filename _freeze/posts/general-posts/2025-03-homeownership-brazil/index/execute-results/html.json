{
  "hash": "f912f24c1e317ab86d835ad77042f24f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"index\"\nformat: html\ndraft: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(stringr)\nimport::from(sidrar, get_sidra)\n\nget_info <- function(code_region) {\n  get_sidra(\n    9930,\n    variable = 381,\n    category = list(c(\"c63\"), c(\"c125\")),\n    geo = \"State\",\n    geo.filter = list(\"Region\" = code_region)\n    )\n}\n\ndat <- lapply(1:5, get_info)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nConsidering all categories once 'classific' was set to 'all' (default)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nConsidering all categories once 'classific' was set to 'all' (default)\nConsidering all categories once 'classific' was set to 'all' (default)\nConsidering all categories once 'classific' was set to 'all' (default)\nConsidering all categories once 'classific' was set to 'all' (default)\n```\n\n\n:::\n\n```{.r .cell-code}\ndat <- bind_rows(dat)\ndat <- as_tibble(dat)\ndat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 15,120 × 17\n   `Nível Territorial (Código)` `Nível Territorial` \n   <chr>                        <chr>               \n 1 3                            Unidade da Federação\n 2 3                            Unidade da Federação\n 3 3                            Unidade da Federação\n 4 3                            Unidade da Federação\n 5 3                            Unidade da Federação\n 6 3                            Unidade da Federação\n 7 3                            Unidade da Federação\n 8 3                            Unidade da Federação\n 9 3                            Unidade da Federação\n10 3                            Unidade da Federação\n   `Unidade de Medida (Código)` `Unidade de Medida`  Valor\n   <chr>                        <chr>                <dbl>\n 1 1020                         Unidades            555567\n 2 1020                         Unidades            505512\n 3 1020                         Unidades             13043\n 4 1020                         Unidades             36305\n 5 1020                         Unidades               559\n 6 1020                         Unidades                28\n 7 1020                         Unidades               120\n 8 1020                         Unidades            391208\n 9 1020                         Unidades            372037\n10 1020                         Unidades              7477\n   `Unidade da Federação (Código)` `Unidade da Federação` `Ano (Código)` Ano  \n   <chr>                           <chr>                  <chr>          <chr>\n 1 11                              Rondônia               2022           2022 \n 2 11                              Rondônia               2022           2022 \n 3 11                              Rondônia               2022           2022 \n 4 11                              Rondônia               2022           2022 \n 5 11                              Rondônia               2022           2022 \n 6 11                              Rondônia               2022           2022 \n 7 11                              Rondônia               2022           2022 \n 8 11                              Rondônia               2022           2022 \n 9 11                              Rondônia               2022           2022 \n10 11                              Rondônia               2022           2022 \n   `Variável (Código)` Variável                                    \n   <chr>               <chr>                                       \n 1 381                 Domicílios particulares permanentes ocupados\n 2 381                 Domicílios particulares permanentes ocupados\n 3 381                 Domicílios particulares permanentes ocupados\n 4 381                 Domicílios particulares permanentes ocupados\n 5 381                 Domicílios particulares permanentes ocupados\n 6 381                 Domicílios particulares permanentes ocupados\n 7 381                 Domicílios particulares permanentes ocupados\n 8 381                 Domicílios particulares permanentes ocupados\n 9 381                 Domicílios particulares permanentes ocupados\n10 381                 Domicílios particulares permanentes ocupados\n   `Número de cômodos (Código)` `Número de cômodos`\n   <chr>                        <chr>              \n 1 95810                        Total              \n 2 95810                        Total              \n 3 95810                        Total              \n 4 95810                        Total              \n 5 95810                        Total              \n 6 95810                        Total              \n 7 95810                        Total              \n 8 95810                        Total              \n 9 95810                        Total              \n10 95810                        Total              \n   `Condição de ocupação do domicílio (Código)`\n   <chr>                                       \n 1 95826                                       \n 2 95826                                       \n 3 95826                                       \n 4 95826                                       \n 5 95826                                       \n 6 95826                                       \n 7 95826                                       \n 8 73554                                       \n 9 73554                                       \n10 73554                                       \n   `Condição de ocupação do domicílio` `Tipo de domicílio (Código)`\n   <chr>                               <chr>                       \n 1 Total                               2932                        \n 2 Total                               6815                        \n 3 Total                               121264                      \n 4 Total                               3247                        \n 5 Total                               71975                       \n 6 Total                               71976                       \n 7 Total                               71977                       \n 8 Próprio de algum morador            2932                        \n 9 Próprio de algum morador            6815                        \n10 Próprio de algum morador            121264                      \n   `Tipo de domicílio`                                    \n   <chr>                                                  \n 1 Total                                                  \n 2 Casa                                                   \n 3 Casa de vila ou em condomínio                          \n 4 Apartamento                                            \n 5 Habitação em casa de cômodos ou cortiço                \n 6 Habitação indígena sem paredes ou maloca               \n 7 Estrutura residencial permanente degradada ou inacabada\n 8 Total                                                  \n 9 Casa                                                   \n10 Casa de vila ou em condomínio                          \n# ℹ 15,110 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- dat |> \n  janitor::clean_names()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nibge9930 <- dat |> \n  rename(\n    code_state = unidade_da_federacao_codigo,\n    name_state = unidade_da_federacao,\n    year = ano,\n    value = valor,\n    variable = variavel,\n    code_variable = variavel_codigo,\n    house_dwellings = numero_de_comodos,\n    code_house_ownership = condicao_de_ocupacao_do_domicilio_codigo,\n    house_ownership = condicao_de_ocupacao_do_domicilio,\n    house_type = tipo_de_domicilio,\n    code_house_type = tipo_de_domicilio_codigo\n  ) |> \n  select(\n    code_state, name_state, code_variable, variable, value,\n    house_dwellings, code_house_ownership, house_ownership,\n    code_house_type, house_type\n  ) |> \n  mutate(across(starts_with(\"code\"), as.numeric))\n\nget_unique_pairs <- function(dat, x, y) {\n  \n  dat |> \n    count({{x}}, {{y}}) |> \n    arrange({{x}}) |> \n    select(-n)\n  \n}\n\nibge9930 <- ibge9930 |> \n  mutate(\n    house_rooms = if_else(house_dwellings == \"Total\", \"total\", str_extract(house_dwellings, \".+(?= cô)\")),\n    house_rooms_num = case_when(\n      house_rooms == \"total\" ~ NA,\n      house_rooms %in% c(\"6 a 9\") ~ 7,\n      TRUE ~ as.numeric(house_rooms)\n    ),\n    house_rooms_trunc = if_else(house_rooms_num > 4, 4, house_rooms_num)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `house_rooms_num = case_when(...)`.\nCaused by warning:\n! NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\ndim_ownership <- get_unique_pairs(ibge9930, code_house_ownership, house_ownership)\ndim_type <- get_unique_pairs(ibge9930, code_house_type, house_type)\n\ndim_type |> \n  rename(\n    house_type_ibge = house_type\n  ) |> \n  mutate(\n    house_type = case_when(\n      house_type_ibge == \"Total\" ~ \"total\",\n      house_type_ibge == \"Apartamento\" ~ \"apartment\",\n      house_type_ibge == \"Casa\" ~ \"house\",\n      TRUE ~ \"other\"\n    )\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 3\n  code_house_type house_type_ibge                                        \n            <dbl> <chr>                                                  \n1            2932 Total                                                  \n2            3247 Apartamento                                            \n3            6815 Casa                                                   \n4           71975 Habitação em casa de cômodos ou cortiço                \n5           71976 Habitação indígena sem paredes ou maloca               \n6           71977 Estrutura residencial permanente degradada ou inacabada\n7          121264 Casa de vila ou em condomínio                          \n  house_type\n  <chr>     \n1 total     \n2 apartment \n3 house     \n4 other     \n5 other     \n6 other     \n7 other     \n```\n\n\n:::\n\n```{.r .cell-code}\nibge9930 |> \n  count(code_house_ownership, house_ownership) |> \n  arrange(code_house_ownership) |> \n  select(-n) |> \n  mutate()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 2\n   code_house_ownership house_ownership                                     \n                  <dbl> <chr>                                               \n 1                 1055 Alugado                                             \n 2                 1058 Outra condição                                      \n 3                 4343 Próprio de algum morador - ainda pagando            \n 4                73126 Próprio de algum morador - já pago, herdado ou ganho\n 5                73127 Cedido ou emprestado - por empregador               \n 6                73128 Cedido ou emprestado - por familiar                 \n 7                73129 Cedido ou emprestado - outra forma                  \n 8                73553 Cedido ou emprestado                                \n 9                73554 Próprio de algum morador                            \n10                95826 Total                                               \n```\n\n\n:::\n\n```{.r .cell-code}\ndat |> \n  count(condicao_de_ocupacao_do_domicilio_codigo, condicao_de_ocupacao_do_domicilio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 3\n   condicao_de_ocupacao_do_domicilio_codigo\n   <chr>                                   \n 1 1055                                    \n 2 1058                                    \n 3 4343                                    \n 4 73126                                   \n 5 73127                                   \n 6 73128                                   \n 7 73129                                   \n 8 73553                                   \n 9 73554                                   \n10 95826                                   \n   condicao_de_ocupacao_do_domicilio                        n\n   <chr>                                                <int>\n 1 Alugado                                               1512\n 2 Outra condição                                        1512\n 3 Próprio de algum morador - ainda pagando              1512\n 4 Próprio de algum morador - já pago, herdado ou ganho  1512\n 5 Cedido ou emprestado - por empregador                 1512\n 6 Cedido ou emprestado - por familiar                   1512\n 7 Cedido ou emprestado - outra forma                    1512\n 8 Cedido ou emprestado                                  1512\n 9 Próprio de algum morador                              1512\n10 Total                                                 1512\n```\n\n\n:::\n\n```{.r .cell-code}\n# dat |> \n#   count(tipo_de_domicilio_codigo, tipo_de_domicilio) |> \n#   select(-n) |> \n#   mutate(tipo_de_domicilio_codigo = )\n#   arrange(tipo_de_domicilio_codigo)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}