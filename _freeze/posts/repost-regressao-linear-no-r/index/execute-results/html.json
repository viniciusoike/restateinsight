{
  "hash": "e8d56fd9c046617802a1b190f4c5e0a9",
  "result": {
    "markdown": "---\ntitle: \"Regressão Linear no R\"\ndate: '2019-03-21'\ncategories: ['econometria', 'tutorial-r']\ndescription: 'Fazendo regressão linear simples no R'\nexecute: \n  message: false\n  warning: false\ndraft: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(stargazer)\nlibrary(kableExtra)\nlibrary(magrittr)\n```\n:::\n\n\n# Introdução \n\n## Pacotes\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Instalar os pacotes se necessário\ninstall.packages(c(\"AER\", \"lmtest\", \"stargazer\", \"wooldridge\"))\n\nlibrary(AER)\nlibrary(lmtest)\nlibrary(stargazer)\nlibrary(wooldridge)\n```\n:::\n\n\n## Teoria\n\nEm econometria queremos explicar uma variável $y$ em função de um conjunto de regressores, ou variáveis explicativas, $x_{1}, x_{2}, \\dots, x_{k}$. Isto é, criamos um modelo matemático que explica $y$ em função destes regressores, $y = f(x_{1}, x_{2}, \\dots, x_{k})$. A forma mais simples para $f(\\dot)$ é a linear, isto é,\n\n\\begin{equation}\n  y_{t} = \\beta_{0} + \\beta_{1}x_{1,t} + \\beta_{2}x_{2,t} + \\dots + \\beta_{k}x_{k,t} + u_{t}\n\\end{equation}\n\nonde queremos estimar os valores de $\\beta_{0}, \\beta_{1}, \\dots, \\beta_{k}$. O último termo da equação, $u_{t}$, é geralmente denominado \"ruído\" ou \"erro\". Os parâmetros $\\beta_{0}, \\beta_{1}, \\dots, \\beta_{k}$ nos informam os \"efeitos marginais\" que a variável $x_{i}$ respectiva tem sobre a variável de interesse $y$. Em alguns casos, pode-se inclusive afirmar que o valor estimado de $\\beta_{i}$ é o efeito *causal* que $x_{i}$ tem sobre $y$.\n\n### Exemplo: Cigarros\n\nDigamos que o consumo de cigarros seja linearmente relacionado ao preço do maço. A base `CigarettesB` traz informações do preço do maço de cigarros e do consumo (per capita) de cigarros para 46 estados dos EUA no ano de 1992. Para carregar esta precisamos primeiro do pactoe `AER`.\n\nPara carregar pacotes no R use a função `library()`, caso ainda não tenha instalado o pacote use `install.packages(\"AER\")` e depois carregue o pacote. Para carregar a base de dados usamos a função `data()` com o nome da base de dados como argumento, isto é, `data(\"CigarettesB\")`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"AER\")\ndata(\"CigarettesB\")\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-bordered\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> packs </th>\n   <th style=\"text-align:center;\"> price </th>\n   <th style=\"text-align:center;\"> income </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> AL </td>\n   <td style=\"text-align:center;\"> 4.96213 </td>\n   <td style=\"text-align:center;\"> 0.20487 </td>\n   <td style=\"text-align:center;\"> 4.64039 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AZ </td>\n   <td style=\"text-align:center;\"> 4.66312 </td>\n   <td style=\"text-align:center;\"> 0.16640 </td>\n   <td style=\"text-align:center;\"> 4.68389 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AR </td>\n   <td style=\"text-align:center;\"> 5.10709 </td>\n   <td style=\"text-align:center;\"> 0.23406 </td>\n   <td style=\"text-align:center;\"> 4.59435 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CA </td>\n   <td style=\"text-align:center;\"> 4.50449 </td>\n   <td style=\"text-align:center;\"> 0.36399 </td>\n   <td style=\"text-align:center;\"> 4.88147 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CT </td>\n   <td style=\"text-align:center;\"> 4.66983 </td>\n   <td style=\"text-align:center;\"> 0.32149 </td>\n   <td style=\"text-align:center;\"> 5.09472 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> DE </td>\n   <td style=\"text-align:center;\"> 5.04705 </td>\n   <td style=\"text-align:center;\"> 0.21929 </td>\n   <td style=\"text-align:center;\"> 4.87087 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> DC </td>\n   <td style=\"text-align:center;\"> 4.65637 </td>\n   <td style=\"text-align:center;\"> 0.28946 </td>\n   <td style=\"text-align:center;\"> 5.05960 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> FL </td>\n   <td style=\"text-align:center;\"> 4.80081 </td>\n   <td style=\"text-align:center;\"> 0.28733 </td>\n   <td style=\"text-align:center;\"> 4.81155 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> GA </td>\n   <td style=\"text-align:center;\"> 4.97974 </td>\n   <td style=\"text-align:center;\"> 0.12826 </td>\n   <td style=\"text-align:center;\"> 4.73299 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ID </td>\n   <td style=\"text-align:center;\"> 4.74902 </td>\n   <td style=\"text-align:center;\"> 0.17541 </td>\n   <td style=\"text-align:center;\"> 4.64307 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n\nTemos 46 observações de cada uma das três variáveis. Indexando cada uma delas pela letra $i = 1, 2, \\dots, 46$ queremos estimar o seguinte modelo:\n\n$$\n  \\text{Packs}_{i} = \\beta_{0} + \\beta_{1}\\text{Price}_{i} + u_{t}\n$$\n\nIsto é, queremos estimar $\\beta_{0}$ e $\\beta_{1}$ acima. Adicionalmente, como se trata de um modelo de regressão simples (i.e., com apenas uma variável explicativa) queremos também visualizar a relação linear graficamente. Vamos começar com um gráfico de dispersão. Para montar o gráfico usamos a função `plot()`. Além disso, é conveniente trabalhar com um nome mais simples do que \"CigarettesB\". Recomenda-se, em geral, que se crie objetos com nomes curtos e com letras minúsculas. Neste caso, uma opção intuitiva seria \"cigar\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# \"Renomeia\" a tabela CigarettesB\ncigar <- CigarettesB\n# Gráfico de dispersão\nplot(\n  packs ~ price,\n  data = cigar,\n  main = \"Gráfico de dispersão entre consumo de cigarros e seu preço\",\n  xlab = \"Consumo agregado\",\n  ylab = \"Renda disponível\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nPara estimar o modelo usamos a função `lm()`. Esta função devolve um objeto do tipo \"lm\", que é, essencialmente, uma lista de valores. Usando o operador \"$\" podemos acessar os diferentes valores guardados dentro do objeto \"lm\" criado. Usando a função a summary em torno do \"lm\" retorna uma saída com informações gerais sobre a regressão.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Regressão linear\nfit <- lm(packs ~ price, data = cigar)\n# Exibe os principais resultados da regressão\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = packs ~ price, data = cigar)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.45472 -0.09968  0.00612  0.11553  0.29346 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   5.0941     0.0627  81.247  < 2e-16 ***\nprice        -1.1983     0.2818  -4.253 0.000108 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.163 on 44 degrees of freedom\nMultiple R-squared:  0.2913,\tAdjusted R-squared:  0.2752 \nF-statistic: 18.08 on 1 and 44 DF,  p-value: 0.0001085\n```\n:::\n:::\n\n\nComo se vê parece haver uma relação linear significante entre o preço do pacote de cigarro e o seu consumo per-capita. Em particular, esta relação é negativa, como seria esperado. Para visualizar graficamente o ajuste do modelo usamos a função `abline()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Regressão linear\nplot(\n  packs ~ price,\n  data = cigar,\n  main = \"Gráfico de dispersão entre consumo de cigarros e seu preço\", \n  xlab = \"Consumo agregado\",\n  ylab = \"Renda disponível\"\n  )\nabline(fit$coefficients, col = 'red')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nPodemos facilmente visualizar o resíduo desta regressão. A função `residuals()` ou `resid()` captura os resíduos do modelo. Assim, o código abaixo salva o resíduo da estimação acima num objeto chamada `residuo`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresiduo <- resid(fit)\n# Histograma do resíduo\nhist(residuo, breaks = \"FD\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nExistem outras funções que facilitam a extração de elementos específicos da estimação da regressão. O código abaixo mostra alguns exemplos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extrair coeficientes\ncoefficients(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)       price \n   5.094108   -1.198316 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Computa o critério de Akaike\nAIC(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -32.39041\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extrai o R2\nsummary(fit)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2912836\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extrai os valores ajustados\ny_estimado <- fitted(fit)\n# Plota no gráfico contra os valores observados\nplot(y_estimado, cigar$packs)\nabline(a = 0, b = 1, lty = 2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot do resíduo contra a variável explicativa\nplot(residuo, cigar$price)\nabline(h = 0)\nabline(v = 0)\ngrid()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Alguns gráficos úteis para detectar outliers e o ajuste do modelo\nplot(fit)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-4.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(fit, data.frame(price = 0.5), se.fit = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$fit\n      1 \n4.49495 \n\n$se.fit\n[1] 0.08639435\n\n$df\n[1] 44\n\n$residual.scale\n[1] 0.1630009\n```\n:::\n:::\n\n\n## Regressão múltipla\n\n### Exemplo: cigarros (de novo)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Regressão linear\nfit_mult <- lm(packs ~ price + income, data = cigar)\n# Exibe os principais resultados da regressão\nsummary(fit_mult)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = packs ~ price + income, data = cigar)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.41867 -0.10683  0.00757  0.11738  0.32868 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   4.2997     0.9089   4.730 2.43e-05 ***\nprice        -1.3383     0.3246  -4.123 0.000168 ***\nincome        0.1724     0.1968   0.876 0.385818    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1634 on 43 degrees of freedom\nMultiple R-squared:  0.3037,\tAdjusted R-squared:  0.2713 \nF-statistic: 9.378 on 2 and 43 DF,  p-value: 0.0004168\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlmtest::waldtest(fit, fit_mult)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWald test\n\nModel 1: packs ~ price\nModel 2: packs ~ price + income\n  Res.Df Df      F Pr(>F)\n1     44                 \n2     43  1 0.7676 0.3858\n```\n:::\n\n```{.r .cell-code}\nlmtest::coeftest(fit_mult)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nt test of coefficients:\n\n            Estimate Std. Error t value  Pr(>|t|)    \n(Intercept)  4.29966    0.90893  4.7305 2.434e-05 ***\nprice       -1.33833    0.32460 -4.1230 0.0001676 ***\nincome       0.17239    0.19675  0.8761 0.3858180    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n### Exemplo: salário\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(wooldridge)\ndata(\"wage2\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-bordered table-striped\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> wage </th>\n   <th style=\"text-align:center;\"> hours </th>\n   <th style=\"text-align:center;\"> IQ </th>\n   <th style=\"text-align:center;\"> KWW </th>\n   <th style=\"text-align:center;\"> educ </th>\n   <th style=\"text-align:center;\"> exper </th>\n   <th style=\"text-align:center;\"> tenure </th>\n   <th style=\"text-align:center;\"> age </th>\n   <th style=\"text-align:center;\"> married </th>\n   <th style=\"text-align:center;\"> black </th>\n   <th style=\"text-align:center;\"> south </th>\n   <th style=\"text-align:center;\"> urban </th>\n   <th style=\"text-align:center;\"> sibs </th>\n   <th style=\"text-align:center;\"> brthord </th>\n   <th style=\"text-align:center;\"> meduc </th>\n   <th style=\"text-align:center;\"> feduc </th>\n   <th style=\"text-align:center;\"> lwage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 769 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 93 </td>\n   <td style=\"text-align:center;\"> 35 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 31 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 6.645091 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 808 </td>\n   <td style=\"text-align:center;\"> 50 </td>\n   <td style=\"text-align:center;\"> 119 </td>\n   <td style=\"text-align:center;\"> 41 </td>\n   <td style=\"text-align:center;\"> 18 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 37 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 6.694562 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 825 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 108 </td>\n   <td style=\"text-align:center;\"> 46 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> 33 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 6.715383 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 650 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 96 </td>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 13 </td>\n   <td style=\"text-align:center;\"> 7 </td>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 6.476973 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 562 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 74 </td>\n   <td style=\"text-align:center;\"> 27 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 34 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 6.331502 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1400 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 116 </td>\n   <td style=\"text-align:center;\"> 43 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 35 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 7.244227 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(wage2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"wage\"    \"hours\"   \"IQ\"      \"KWW\"     \"educ\"    \"exper\"   \"tenure\" \n [8] \"age\"     \"married\" \"black\"   \"south\"   \"urban\"   \"sibs\"    \"brthord\"\n[15] \"meduc\"   \"feduc\"   \"lwage\"  \n```\n:::\n\n```{.r .cell-code}\nfit <- lm(lwage ~ educ + exper + IQ + tenure + age + married, data = wage2)\n```\n:::\n\n\n## Não-linearidades\n\nA restrição de linearidade do modelo é somente sobre os *parâmetros*, isto é, sobre os betas. Pode-se incorporar não-linearidades de outras forma. O modelo abaixo, por exemplo, continua sendo um modelo de regressão linear:\n\n$$\n  y_{t} = \\beta_{0} + \\beta_{1}x_{1t}^{3} + \\beta_{2}\\frac{1}{x_{2t}} + \\beta_{3}\\text{log}(x_{3t}) + \\epsilon_{t} \n$$\n\n### Logaritmos e potências\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"wooldridge\")\ndata(\"hprice2\")\n\nfit <- lm(\n  log(price) ~ log(nox) + log(dist) + rooms + I(rooms^2) + stratio,\n  data = hprice2)\n\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(price) ~ log(nox) + log(dist) + rooms + I(rooms^2) + \n    stratio, data = hprice2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.04285 -0.12774  0.02038  0.12650  1.25272 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 13.385477   0.566473  23.630  < 2e-16 ***\nlog(nox)    -0.901682   0.114687  -7.862 2.34e-14 ***\nlog(dist)   -0.086781   0.043281  -2.005  0.04549 *  \nrooms       -0.545113   0.165454  -3.295  0.00106 ** \nI(rooms^2)   0.062261   0.012805   4.862 1.56e-06 ***\nstratio     -0.047590   0.005854  -8.129 3.42e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2592 on 500 degrees of freedom\nMultiple R-squared:  0.6028,\tAdjusted R-squared:  0.5988 \nF-statistic: 151.8 on 5 and 500 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n$$\n  \\frac{\\partial log(y_{t})}{\\partial log(x_{1t})}\n$$\n\n### Interações entre variáveis\n\n### Exemplo: variáveis dummy\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"lawsch85\")\nd <- lawsch85\nd$top10   <- ifelse(test = d$rank <= 10, yes = 1, no = 0)\nd$r11_25  <- ifelse(test = d$rank > 10 & d$rank <= 25, yes = 1, no = 0)\nd$r26_40  <- ifelse(test = d$rank > 25 & d$rank <= 40, yes = 1, no = 0)\nd$r41_60  <- ifelse(test = d$rank > 40 & d$rank <= 60, yes = 1, no = 0)\nd$r61_100 <- ifelse(test = d$rank > 60 & d$rank <= 100, yes = 1, no = 0)\n\nfit <- lm(\n  log(salary) ~ top10 + r11_25 + r26_40 + r41_60 + r61_100 + LSAT +\n                GPA + log(llibvol) + lcost,\n  data = d)\n\nfit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(salary) ~ top10 + r11_25 + r26_40 + r41_60 + \n    r61_100 + LSAT + GPA + log(llibvol) + lcost, data = d)\n\nCoefficients:\n (Intercept)         top10        r11_25        r26_40        r41_60  \n   9.0089365     0.7005341     0.5937752     0.3747281     0.2623565  \n     r61_100          LSAT           GPA  log(llibvol)         lcost  \n   0.1312513     0.0056522     0.0147991     0.2110607     0.0007824  \n```\n:::\n:::\n\n\n## Testes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(wooldridge)\ndata(\"wage2\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-striped table-bordered\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> wage </th>\n   <th style=\"text-align:center;\"> hours </th>\n   <th style=\"text-align:center;\"> IQ </th>\n   <th style=\"text-align:center;\"> KWW </th>\n   <th style=\"text-align:center;\"> educ </th>\n   <th style=\"text-align:center;\"> exper </th>\n   <th style=\"text-align:center;\"> tenure </th>\n   <th style=\"text-align:center;\"> age </th>\n   <th style=\"text-align:center;\"> married </th>\n   <th style=\"text-align:center;\"> black </th>\n   <th style=\"text-align:center;\"> south </th>\n   <th style=\"text-align:center;\"> urban </th>\n   <th style=\"text-align:center;\"> sibs </th>\n   <th style=\"text-align:center;\"> brthord </th>\n   <th style=\"text-align:center;\"> meduc </th>\n   <th style=\"text-align:center;\"> feduc </th>\n   <th style=\"text-align:center;\"> lwage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 769 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 93 </td>\n   <td style=\"text-align:center;\"> 35 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 31 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 6.645091 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 808 </td>\n   <td style=\"text-align:center;\"> 50 </td>\n   <td style=\"text-align:center;\"> 119 </td>\n   <td style=\"text-align:center;\"> 41 </td>\n   <td style=\"text-align:center;\"> 18 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 37 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 6.694562 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 825 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 108 </td>\n   <td style=\"text-align:center;\"> 46 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> 33 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 6.715383 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 650 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 96 </td>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 13 </td>\n   <td style=\"text-align:center;\"> 7 </td>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 6.476973 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 562 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 74 </td>\n   <td style=\"text-align:center;\"> 27 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 34 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:center;\"> 6.331502 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1400 </td>\n   <td style=\"text-align:center;\"> 40 </td>\n   <td style=\"text-align:center;\"> 116 </td>\n   <td style=\"text-align:center;\"> 43 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 35 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 7.244227 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Usando o stargazer\n\nO pacote `stargazer` facilita muito a publicação dos resultados de uma regressão. Depois de carregar o pacote simplesmente use a função `stargazer()` num objeto `lm`. Lembre-se que para verificar a classe de um objeto usamos a função `class()`.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar pacote adicional de temas\nclass(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"lm\"\n```\n:::\n:::\n\n\nNote que abaixo chamo a função usando o argumento `type = 'html'`, pois estou usando o RMarkdown para fazer este site. Outras opções incluem `type = 'text'`, que retorna uma tabela simples estilo .txt, e `type = 'latex'`, que retorna uma tabela no formato [LaTeX](https://www.latex-project.org/).\n\n\n\n```{.r .cell-code}\n# Carregar pacote adicional de temas\nstargazer(fit,\n          type = \"html\",\n          title = \"Resultados da regressão\",\n          covariate.labels = c(\"Preço\", \"Renda individual\", \"constante\"),\n          dep.var.labels = \"Pacotes de cigarro\"\n          )\n```\n\n\n<table style=\"text-align:center\"><caption><strong>Resultados da regressão</strong></caption>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"1\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td>Pacotes de cigarro</td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Preço</td><td>0.701<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.053)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">Renda individual</td><td>0.594<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.039)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">constante</td><td>0.375<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.034)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">r41_60</td><td>0.262<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.028)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">r61_100</td><td>0.131<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.021)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">LSAT</td><td>0.006<sup>*</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.003)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">GPA</td><td>0.015</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.074)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">log(llibvol)</td><td>0.211</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.152)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">lcost</td><td>0.001</td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.025)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td style=\"text-align:left\">Constant</td><td>9.009<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.445)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>136</td></tr>\n<tr><td style=\"text-align:left\">R<sup>2</sup></td><td>0.911</td></tr>\n<tr><td style=\"text-align:left\">Adjusted R<sup>2</sup></td><td>0.905</td></tr>\n<tr><td style=\"text-align:left\">Residual Std. Error</td><td>0.086 (df = 126)</td></tr>\n<tr><td style=\"text-align:left\">F Statistic</td><td>143.176<sup>***</sup> (df = 9; 126)</td></tr>\n<tr><td colspan=\"2\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n\n\n### Usando o ggplot2\n\nO pacote `ggplot2` oferece formas alternativas de visualizar a mesma relação linear que encontramos acima. Em particular, a função `qplot()` tem uma sintaxe muito similar à da função `plot()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carrega o pacote\nlibrary(ggplot2)\n# Função qplot\np <- qplot(x = price, y = packs, data = cigar, geom = \"point\")\np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nPara adicionar uma linha de regressão acrescentamos `geom_smooth`. Especificamos que queremos um modelo linear adicionando o argumento 'lm'\n\n\n::: {.cell}\n\n```{.r .cell-code}\np +\n  geom_smooth(method = \"lm\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}