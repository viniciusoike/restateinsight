<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vinicius Oike">
<meta name="dcterms.date" content="2021-03-01">
<meta name="description" content="Neste post mostro como modelar um ARMA simples no R usando o pacote {astsa}.">

<title>Vinicius Oike - ARMA: um exemplo simples</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Vinicius Oike</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../my_apps.html" rel="" target="">
 <span class="menu-text">Apps</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../aboutme.html" rel="" target="">
 <span class="menu-text">Sobre</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/viniciusoike" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/viniciusoike" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../archive.html" rel="" target="">
 <span class="menu-text">Archive</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ARMA: um exemplo simples</h1>
                  <div>
        <div class="description">
          Neste post mostro como modelar um ARMA simples no R usando o pacote {astsa}.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">econometria</div>
                <div class="quarto-category">time-series</div>
                <div class="quarto-category">repost</div>
                <div class="quarto-category">tutorial-R</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vinicius Oike </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 1, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução">Introdução</a></li>
  <li><a href="#crescimento-do-pnb" id="toc-crescimento-do-pnb" class="nav-link" data-scroll-target="#crescimento-do-pnb">Crescimento do PNB</a></li>
  <li><a href="#identificação" id="toc-identificação" class="nav-link" data-scroll-target="#identificação">Identificação</a></li>
  <li><a href="#estimação-e-diagnóstico" id="toc-estimação-e-diagnóstico" class="nav-link" data-scroll-target="#estimação-e-diagnóstico">Estimação e diagnóstico</a>
  <ul class="collapse">
  <li><a href="#modelo-1" id="toc-modelo-1" class="nav-link" data-scroll-target="#modelo-1">Modelo 1</a>
  <ul class="collapse">
  <li><a href="#diagnóstico-de-resíduos" id="toc-diagnóstico-de-resíduos" class="nav-link" data-scroll-target="#diagnóstico-de-resíduos">Diagnóstico de resíduos</a></li>
  <li><a href="#usando-o-pacote-astsa" id="toc-usando-o-pacote-astsa" class="nav-link" data-scroll-target="#usando-o-pacote-astsa">Usando o pacote <code>astsa</code></a></li>
  </ul></li>
  <li><a href="#modelo-2" id="toc-modelo-2" class="nav-link" data-scroll-target="#modelo-2">Modelo 2</a></li>
  <li><a href="#modelo-3" id="toc-modelo-3" class="nav-link" data-scroll-target="#modelo-3">Modelo 3</a>
  <ul class="collapse">
  <li><a href="#seleção" id="toc-seleção" class="nav-link" data-scroll-target="#seleção">Seleção</a></li>
  <li><a href="#previsão" id="toc-previsão" class="nav-link" data-scroll-target="#previsão">Previsão</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusão" id="toc-conclusão" class="nav-link" data-scroll-target="#conclusão">Conclusão</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introdução" class="level1">
<h1>Introdução</h1>
<p>Neste post apresento como estimar e diagnosticar um modelo ARMA simples no R. O modelo ARMA decompõe uma série em função de suas observações passadas e de “passados” (às vezes chamados de inovações). O ARMA(1, 1) com constante tem a seguinte forma.</p>
<p><span class="math display">\[
y_{t} = \phi_{0} +\phi_{1}y_{t-1} + \varepsilon_{t} + \theta_{1}\varepsilon_{t - 1}
\]</span></p>
<p>onde ambas as condições de estacionaridade como de invertibilidade devem ser atendidas. Assume-se que o termo <span class="math inline">\(\varepsilon_{t}\)</span> é um ruído branco. De maneira mais geral, um modelo ARMA(p, q) tem a forma:</p>
<p><span class="math display">\[
y_{t} = \phi_{0} +\phi_{1}y_{t-1} + \dots + \phi_{p}y_{t-p} + \varepsilon_{t} + \theta_{1}\varepsilon_{t - 1} + \dots + \theta_{q}\varepsilon_{t- q}
\]</span></p>
</section>
<section id="crescimento-do-pnb" class="level1">
<h1>Crescimento do PNB</h1>
<p>Vamos usar a série do PNB disponbilizada pelo pacote <code>astsa</code>. Este pacote foi montado pelos autores do livro <a href="https://www.stat.pitt.edu/stoffer/tsa4/">Time Series Analysis</a>. Para visualizar a série usamos a função <code>plot.ts</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"gnp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(gnp,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Produto Nacional Bruto EUA (trimestre)"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"US$ (bilhões)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Precisamos transformar a série primeiro. Para encontrar a variação percentual de uma variável <span class="math inline">\(y_{t}\)</span> qualquer fazemos</p>
<p><span class="math display">\[
  \Delta y_{t} = \frac{y_{t} - y_{t-1}}{y_{t-1}}
\]</span></p>
<p>Uma aproximação comumumente usada no lugar da equação acima é a diferença em log. Na literatura de finanças a equação acima também é conhecida como <em>retorno</em> e a diferença em log como <em>log-retorno</em>. Na prática, além da aproximação ser boa para valores pequenos (em torno de zero) costuma ser mais cômodo trabalhar com log-retornos.</p>
<p><span class="math display">\[
  \Delta y_{t} = \frac{y_{t} - y_{t-1}}{y_{t-1}} \approx \text{ln}(1 + \Delta y_{t}) = \text{ln}(y_{t}/y_{t-1}) = \text{ln}(y_{t}) - \text{ln}(y_{t-1})
\]</span></p>
<p>No R podemos combinar duas funções para facilitar o cômputo da diferença dos logs: usamos <code>diff()</code> que computa <span class="math inline">\(y_{t} - y_{t - 1}\)</span> junto com a função <code>log()</code> que computa o logaritmo. Note que a função <code>log()</code> usa o número <span class="math inline">\(e\)</span> como base; é possível trocar a base usando o argumento <code>base = 10</code>, por exemplo, ou usar simplesmente uma outra função <code>log10()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computa log(y[t]) - log(y[t-1])</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(gnp))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico da série transformada</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(y <span class="sc">*</span> <span class="dv">100</span>, <span class="at">main =</span> <span class="st">"Variação percentual do PIB"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"(%)"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray30"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para avaliar a qualidade do modelo vamos reservar a parte final dos dados: a ideia é gerar previsões usando apenas a informação da primeira parte da amostra e então comparar estas previsões com as observações. Esta metodologia às vezes é denominada de <em>train</em> (treino) e <em>test</em> (teste).</p>
<p>Treinamos o modelo com as primeiras observações e depois testamos as suas previsões contra as observações finais (que ficaram fora do modelo). Aqui também cabe uma breve observação sobre dados em série de tempo. Se tivéssemos dados em cross-section o correto seria formar as bases <em>train</em> e <em>test</em> usando algum tipo de amostragem aleatória. Como os dados de série de tempo são encadeados não podemos fazer isto: por isto “cortamos” as observações num determinado instante do tempo.</p>
<p>Abaixo escolho um tanto arbitrariamente cortar os dados em janeiro de 1992. Em azul destaco os dados que serão utilizados para alimentar o modelo. As previsões serão testasdas contra as observações em vermelho.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cria a janela temporal</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">window</span>(y, <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="dv">4</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> <span class="fu">window</span>(y, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plota o gráfico destacando as observações finais que foram removidas.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(y)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(train, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(teste, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="identificação" class="level1">
<h1>Identificação</h1>
<p>O primeiro trabalho que temos é o de identificar a ordem do modelo, isto é, encontrar os valores verdadeiros de <span class="math inline">\(p\)</span> e <span class="math inline">\(q\)</span>. A maneira mais comum de começar é tentar comparar os gráficos das funções de autocorrelação (FAC) e autocorrelação parcial (FACP) com suas contrapartidas teóricas. O R tem as funções <code>acf()</code> e <code>pacf()</code> que calculam estes valores junto com intervalos de confiança assintóticos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modifica parâmetros para apresentar dois gráficos numa mesma figura</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(train,  <span class="at">main =</span> <span class="st">"Função de autocorrelação"</span>, <span class="at">xlab =</span> <span class="st">"Defasagem"</span>, <span class="at">ylab =</span> <span class="st">"ACF"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(train, <span class="at">main =</span> <span class="st">"Função de autocorrelação parcial"</span>, <span class="at">xlab =</span> <span class="st">"Defasagem"</span>, <span class="at">ylab =</span> <span class="st">"PACF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note que a escala das defasagens é agrupada pela frequência dos dados, isto é, são contadas de quatro em quatro. Há alguns problemas com a visualização acima. Primeiro, a função de autocorrelãção começa no lag zero, isto é, <span class="math inline">\(\rho(0)\)</span>. Sabemos que este valor sempre será igual a um pois, por definição: <span class="math inline">\(\rho(0) = \frac{\gamma(0)}{\gamma(0)} = 1\)</span>. Logo, seria melhor que esta defasagem fosse suprimida. Além disso, é um tanto inconveniente ter que modificar os parâmetros gráficos usando <code>par(mfrow = c(2, 1))</code>. Uma saída é usar a função <code>acf2()</code> do pacote <code>astsa</code>. Esta função também imprime uma lista com os valores estimados da FAC e da FACP.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf2</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<pre><code>#&gt;      [,1] [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8] [,9] [,10] [,11] [,12] [,13]
#&gt; ACF  0.36 0.19 -0.01 -0.13 -0.17 -0.11 -0.09 -0.05 0.04  0.05  0.03 -0.12 -0.13
#&gt; PACF 0.36 0.07 -0.12 -0.12 -0.08  0.00 -0.03 -0.02 0.05  0.01 -0.03 -0.18 -0.05
#&gt;      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
#&gt; ACF  -0.10 -0.11  0.05  0.08  0.11  0.06  0.07 -0.08 -0.05 -0.10 -0.06
#&gt; PACF  0.02 -0.07  0.10  0.02  0.02 -0.04  0.02 -0.11  0.03 -0.03 -0.01</code></pre>
</div>
<p>Agora está mais claro que as duas primeiras defasagens da FAC são significantes e que a primeira defasagem da FACP é significante. Note também que a 5ª defasagem na FAC é um pouco significante e há uma defasagem de ordem elevada (lag 12) que é um pouco significante na FACP. Em geral, podemos desprezar estas autocorrelações de ordens muito elevadas até porque vamos querer modelos mais parcimoniosos (i.e.&nbsp;com poucos parâmetros).</p>
<p>Apenas olhando para os gráficos acima poderíamos chutar um modelo ARMA(1,1), ARMA(1,2) ou mesmo um AR(1). Depois disto teríamos que checar os resíduos para ver se o modelo está bem ajustado. Por fim, poderíamos escolher o melhor modelo segundo algum critério de informação como o Critério de Akaike (AIC). Alternativamente, poderíamos identificar a ordem do modelo usando algum algoritmo. A função <code>auto.arima()</code> do pacote <code>forecast()</code> verifica vários modelos e compara eles via uma série de critérios.</p>
</section>
<section id="estimação-e-diagnóstico" class="level1">
<h1>Estimação e diagnóstico</h1>
<section id="modelo-1" class="level2">
<h2 class="anchored" data-anchor-id="modelo-1">Modelo 1</h2>
<p>Vou primeiro estimar o ARMA(1, 2) usando a função <code>arima()</code> do R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(m1 <span class="ot">&lt;-</span> <span class="fu">arima</span>(train, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>)))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; arima(x = train, order = c(1, 0, 2))</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          ar1     ma1     ma2  intercept</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.2324  0.0971  0.1623     0.0084</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.  0.2294  0.2247  0.0958     0.0012</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 estimated as 0.0001038:  log likelihood = 566.91,  aic = -1123.82</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A estimativa tem a forma: <span class="math display">\[
  y_{t} = \underset{(0.0012)}{0.0084} + \underset{(0.2324)}{0.2294}y_{t - 1} + \underset{(0.2247)}{0.0971}\epsilon_{t-1} + \underset{(0.0958)}{0.1623}\epsilon_{t-2}
\]</span> Note que os erros-padrão de <span class="math inline">\(\hat{\phi_{1}}\)</span> e <span class="math inline">\(\hat{\theta_{1}}\)</span> são bastante elevados. De fato, um teste-t revela que estes coeficientes não são significantes.</p>
<section id="diagnóstico-de-resíduos" class="level3">
<h3 class="anchored" data-anchor-id="diagnóstico-de-resíduos">Diagnóstico de resíduos</h3>
<p>Pode-se verificar os resíduos do modelo de muitas formas. Idealmente, quer-se que os resíduos não apresentem autocorrelação alguma. Uma forma gráfica de ver isto é usando a função <code>lag1.plot</code> que apresenta gráficos de dispersão entre o resíduo <span class="math inline">\(u_{t}\)</span> contra suas defasagens <span class="math inline">\(u_{t-1}, u_{t-2}, \dots\)</span>. Abaixo faço isto para as primieras quatro defasagens.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>residuos <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lag1.plot</span>(residuos, <span class="at">max.lag =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Na prática, é mais conveniente analisar diretamente os gráficos da FAC e da FACP dos resíduos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf2</span>(residuos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<pre><code>#&gt;      [,1]  [,2] [,3]  [,4]  [,5]  [,6]  [,7]  [,8] [,9] [,10] [,11] [,12] [,13]
#&gt; ACF  0.01 -0.01    0 -0.09 -0.12 -0.03 -0.04 -0.05 0.04  0.06  0.07 -0.12 -0.07
#&gt; PACF 0.01 -0.01    0 -0.09 -0.12 -0.03 -0.05 -0.06 0.02  0.04  0.06 -0.15 -0.09
#&gt;      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
#&gt; ACF  -0.03 -0.12  0.07  0.06  0.06  0.02  0.09  -0.1  0.00 -0.07 -0.04
#&gt; PACF -0.02 -0.11  0.06  0.02  0.04 -0.02  0.05  -0.1  0.01 -0.05 -0.01</code></pre>
</div>
<p>Um teste basatante usual para verificar a presença de autocorrelação nos resíduos é o Ljung-Box. Para computá-lo uso a função <code>Box.test()</code> do pacote <code>tseries</code>. Note que é preciso suplementar o argumento <code>fitdf</code> com o número de parâmetros estimados do modelo. Isto serve para corrigir a estatística do teste. A escolha da ordem do teste é um tanto arbitrária e, na prática, seria recomendado fazer o teste para várias ordens diferentes. O código abaixo computa a estatística do teste para uma defasagem igual a 8.</p>
<p>Note o uso do argumento <code>fitdf</code> que leva em conta o número de parâmetros estimados no modelo. Segundo o p-valor, não temos evidência para rejeitar a hipótese nula de que os resíduos <em>não</em> são conjuntamente autocorrelacionados. Isto é, temos evidência de que o modelo está bem ajustado pois os resíduos parecem se comportar como ruído branco.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(residuos, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>, <span class="at">lag =</span> <span class="dv">8</span>, <span class="at">fitdf =</span> <span class="dv">4</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Box-Ljung test</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  residuos</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared = 4.9486, df = 4, p-value = 0.2926</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Na prática, é bom repetir o teste para várias defasagens diferentes. A tabela abaixo resume os valores do teste para várias ordens de defasagem. Vale lembrar que o teste Ljung-Box tende a não-rejeitar H0 para defasagens muito elevadas.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-bordered table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Defasagem</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Estatística de teste</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">P-valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">4.9486</td>
<td style="text-align: center;">0.2926</td>
</tr>
<tr class="even">
<td style="text-align: center;">9</td>
<td style="text-align: center;">5.2251</td>
<td style="text-align: center;">0.3890</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">5.8669</td>
<td style="text-align: center;">0.4383</td>
</tr>
<tr class="even">
<td style="text-align: center;">11</td>
<td style="text-align: center;">6.7991</td>
<td style="text-align: center;">0.4501</td>
</tr>
<tr class="odd">
<td style="text-align: center;">12</td>
<td style="text-align: center;">9.7788</td>
<td style="text-align: center;">0.2809</td>
</tr>
<tr class="even">
<td style="text-align: center;">13</td>
<td style="text-align: center;">10.8054</td>
<td style="text-align: center;">0.2893</td>
</tr>
<tr class="odd">
<td style="text-align: center;">14</td>
<td style="text-align: center;">10.9313</td>
<td style="text-align: center;">0.3629</td>
</tr>
<tr class="even">
<td style="text-align: center;">15</td>
<td style="text-align: center;">13.6377</td>
<td style="text-align: center;">0.2537</td>
</tr>
<tr class="odd">
<td style="text-align: center;">16</td>
<td style="text-align: center;">14.5903</td>
<td style="text-align: center;">0.2646</td>
</tr>
<tr class="even">
<td style="text-align: center;">17</td>
<td style="text-align: center;">15.2158</td>
<td style="text-align: center;">0.2941</td>
</tr>
<tr class="odd">
<td style="text-align: center;">18</td>
<td style="text-align: center;">15.8735</td>
<td style="text-align: center;">0.3212</td>
</tr>
<tr class="even">
<td style="text-align: center;">19</td>
<td style="text-align: center;">15.9294</td>
<td style="text-align: center;">0.3868</td>
</tr>
<tr class="odd">
<td style="text-align: center;">20</td>
<td style="text-align: center;">17.4548</td>
<td style="text-align: center;">0.3568</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="usando-o-pacote-astsa" class="level3">
<h3 class="anchored" data-anchor-id="usando-o-pacote-astsa">Usando o pacote <code>astsa</code></h3>
<p>Uma forma bastante conveniente de trabalhar com modelos ARMA é com a função <code>sarima</code> do pacote <code>astsa</code>. Esta função apresenta automaticamente algumas valiosas informações para o diagnóstico dos resíduos: o gráfico do ACF, o gráfico qq-plot (para verificar a normalidade dos resíduos) e os p-valores do teste Ljung-Box para várias ordens de defasagem.</p>
<p>A saída abaixo reúne quatro gráficos. O primeiro deles apresenta o resíduo normalizado (ou escalado). Este gráfico não deve apresentar um padrão claro. O segundo gráfico é a FAC do resíduo: idealmente, nenhuma defasagem deve ser significativa neste gráfico. Ao lado da FAC temos o QQ-plot: se todos os pontos caem sobre a linha azul temos evidência de que os resíduos são normalmente distribuídos.</p>
<p>Por fim, o último gráfico mostra o p-valor do teste Ljung-Box (já ajustado pelo número de parâmetros do modelo estimado) para diferentes defasagens. A linha tracejada em azul indica o valor 0.05. Idealmente, todos os pontos devem estar acima desta linha.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(train, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="dv">0</span>, <span class="at">q =</span> <span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; initial  value -4.507231 </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   2 value -4.512000</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   3 value -4.582718</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   4 value -4.583615</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   5 value -4.583727</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   6 value -4.583754</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   7 value -4.583896</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   8 value -4.583941</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   9 value -4.583957</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter  10 value -4.583958</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter  10 value -4.583958</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; final  value -4.583958 </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; converged</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; initial  value -4.586016 </span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   2 value -4.586020</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   3 value -4.586022</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   4 value -4.586023</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   5 value -4.586025</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   6 value -4.586026</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   7 value -4.586027</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   8 value -4.586027</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   9 value -4.586028</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   9 value -4.586028</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iter   9 value -4.586028</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; final  value -4.586028 </span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; converged</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<pre><code>#&gt; $fit
#&gt; 
#&gt; Call:
#&gt; arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
#&gt;     xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, 
#&gt;     optim.control = list(trace = trc, REPORT = 1, reltol = tol))
#&gt; 
#&gt; Coefficients:
#&gt;          ar1     ma1     ma2   xmean
#&gt;       0.2324  0.0971  0.1623  0.0084
#&gt; s.e.  0.2294  0.2247  0.0958  0.0012
#&gt; 
#&gt; sigma^2 estimated as 0.0001038:  log likelihood = 566.91,  aic = -1123.82
#&gt; 
#&gt; $degrees_of_freedom
#&gt; [1] 175
#&gt; 
#&gt; $ttable
#&gt;       Estimate     SE t.value p.value
#&gt; ar1     0.2324 0.2294  1.0130  0.3125
#&gt; ma1     0.0971 0.2247  0.4319  0.6664
#&gt; ma2     0.1623 0.0958  1.6946  0.0919
#&gt; xmean   0.0084 0.0012  6.7491  0.0000
#&gt; 
#&gt; $AIC
#&gt; [1] -6.278312
#&gt; 
#&gt; $AICc
#&gt; [1] -6.277028
#&gt; 
#&gt; $BIC
#&gt; [1] -6.189279</code></pre>
</div>
</section>
</section>
<section id="modelo-2" class="level2">
<h2 class="anchored" data-anchor-id="modelo-2">Modelo 2</h2>
<p>Estimo também o modelo ARMA(1, 1). A análise de resíduos é análoga à apresentada acima.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(train, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelo-3" class="level2">
<h2 class="anchored" data-anchor-id="modelo-3">Modelo 3</h2>
<p>Para o terceiro modelo uso o método automático do <code>auto.arima()</code>. A função escolhe o AR(1) com constante como melhor modelo para representar os dados. Note que a na inspeação visual também tínhamos verificado que o AR(1) seria um possível candidato.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(m3 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(train))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Series: train </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ARIMA(1,0,0) with non-zero mean </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          ar1    mean</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.3568  0.0084</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.  0.0695  0.0012</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 = 0.0001066:  log likelihood = 565.52</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC=-1125.04   AICc=-1124.91   BIC=-1115.48</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="seleção" class="level3">
<h3 class="anchored" data-anchor-id="seleção">Seleção</h3>
<p>Para escolher o melhor modelo pode-se usar algum critério de informação. Abaixo comparo os modelos segundo os critérios AIC, AICc (AIC corrigido) e BIC (Bayesian Information Criterion). Na prática, não é comum que os três critérios escolham o mesmo modelo; em particular, o BIC penaliza o número de parâmetros mais fortemente que o AIC. Neste caso específico, os três critérios escolhem o AR(1).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-bordered table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AICc</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ARMA(1, 2)</td>
<td style="text-align: center;">-1123.818</td>
<td style="text-align: center;">-1124.908</td>
<td style="text-align: center;">-1115.483</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARMA(1, 1)</td>
<td style="text-align: center;">-1123.563</td>
<td style="text-align: center;">-1124.908</td>
<td style="text-align: center;">-1115.483</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AR(1)</td>
<td style="text-align: center;">-1125.045</td>
<td style="text-align: center;">-1124.908</td>
<td style="text-align: center;">-1115.483</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="previsão" class="level3">
<h3 class="anchored" data-anchor-id="previsão">Previsão</h3>
<p>Para gerar previsões usamos a função <code>forecast()</code> (outra opção é usar a função base <code>predict()</code>). Abaixo computo previsões para os três modelos acima mais um modelo ingênuo que será usado como bench-mark. O modelo ingênuo é simplesmente um random-walk que prevê sempre o valor anterior, isto é, <span class="math inline">\(\hat{y_{T+1}} = y_{T}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>prev1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(m1, <span class="at">h =</span> <span class="fu">length</span>(teste))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>prev2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(m2, <span class="at">h =</span> <span class="fu">length</span>(teste))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>prev3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(m3, <span class="at">h =</span> <span class="fu">length</span>(teste))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>prev4 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(<span class="fu">naive</span>(train, <span class="at">h =</span> <span class="fu">length</span>(teste)), <span class="at">h =</span> <span class="fu">length</span>(teste))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>erros <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(teste <span class="sc">-</span> prev1<span class="sc">$</span>mean,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                    teste <span class="sc">-</span> prev2<span class="sc">$</span>mean,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                    teste <span class="sc">-</span> prev3<span class="sc">$</span>mean,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                    teste <span class="sc">-</span> prev4<span class="sc">$</span>mean),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="dv">4</span>))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>erros <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(erros)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(erros) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"t ="</span>, <span class="fu">as.numeric</span>(<span class="fu">time</span>(teste)))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(erros) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ARMA(1, 2)"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"ARMA(1, 1)"</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"AR(1)"</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Y[t+1] = Y[t]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Os erros de previsão são apresentados na tabela abaixo.</p>
<div class="cell" data-layout-align="center" data-asis="true">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-bordered table-hover table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1992</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1992.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1992.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1992.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1993</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1993.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1993.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1993.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1994</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1994.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1994.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1994.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1995</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1995.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1995.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1995.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1996</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1996.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1996.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1996.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1997</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1997.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1997.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1997.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1998</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1998.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1998.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1998.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1999</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1999.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1999.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1999.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2000</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2000.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2000.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2000.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2001</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2001.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2001.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2001.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2002</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2002.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2002.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ARMA(1, 2)</td>
<td style="text-align: center;">0.0017385</td>
<td style="text-align: center;">0.0009996</td>
<td style="text-align: center;">-0.0011832</td>
<td style="text-align: center;">0.0047685</td>
<td style="text-align: center;">-0.0075880</td>
<td style="text-align: center;">-0.0034300</td>
<td style="text-align: center;">-0.0032720</td>
<td style="text-align: center;">0.0041505</td>
<td style="text-align: center;">0.0009645</td>
<td style="text-align: center;">0.0048053</td>
<td style="text-align: center;">-0.0031499</td>
<td style="text-align: center;">0.0038158</td>
<td style="text-align: center;">-0.0038534</td>
<td style="text-align: center;">-0.0059706</td>
<td style="text-align: center;">-0.0026298</td>
<td style="text-align: center;">0.0011636</td>
<td style="text-align: center;">-0.0008728</td>
<td style="text-align: center;">0.0066953</td>
<td style="text-align: center;">-0.0041940</td>
<td style="text-align: center;">0.0035309</td>
<td style="text-align: center;">0.0012488</td>
<td style="text-align: center;">0.0064862</td>
<td style="text-align: center;">0.0012950</td>
<td style="text-align: center;">-0.0021395</td>
<td style="text-align: center;">0.0069883</td>
<td style="text-align: center;">-0.0032794</td>
<td style="text-align: center;">-0.0002956</td>
<td style="text-align: center;">0.0083934</td>
<td style="text-align: center;">0.0023188</td>
<td style="text-align: center;">-0.0031434</td>
<td style="text-align: center;">0.0033963</td>
<td style="text-align: center;">0.0099058</td>
<td style="text-align: center;">-0.0030742</td>
<td style="text-align: center;">0.0039295</td>
<td style="text-align: center;">-0.0078546</td>
<td style="text-align: center;">-0.0045499</td>
<td style="text-align: center;">-0.0119065</td>
<td style="text-align: center;">-0.0103021</td>
<td style="text-align: center;">-0.0110772</td>
<td style="text-align: center;">0.0006393</td>
<td style="text-align: center;">0.0005900</td>
<td style="text-align: center;">-0.0074360</td>
<td style="text-align: center;">0.0023173</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARMA(1, 1)</td>
<td style="text-align: center;">0.0015678</td>
<td style="text-align: center;">0.0011472</td>
<td style="text-align: center;">-0.0010609</td>
<td style="text-align: center;">0.0048359</td>
<td style="text-align: center;">-0.0075556</td>
<td style="text-align: center;">-0.0034158</td>
<td style="text-align: center;">-0.0032667</td>
<td style="text-align: center;">0.0041516</td>
<td style="text-align: center;">0.0009637</td>
<td style="text-align: center;">0.0048036</td>
<td style="text-align: center;">-0.0031520</td>
<td style="text-align: center;">0.0038136</td>
<td style="text-align: center;">-0.0038557</td>
<td style="text-align: center;">-0.0059730</td>
<td style="text-align: center;">-0.0026323</td>
<td style="text-align: center;">0.0011611</td>
<td style="text-align: center;">-0.0008752</td>
<td style="text-align: center;">0.0066928</td>
<td style="text-align: center;">-0.0041964</td>
<td style="text-align: center;">0.0035284</td>
<td style="text-align: center;">0.0012464</td>
<td style="text-align: center;">0.0064838</td>
<td style="text-align: center;">0.0012925</td>
<td style="text-align: center;">-0.0021420</td>
<td style="text-align: center;">0.0069858</td>
<td style="text-align: center;">-0.0032818</td>
<td style="text-align: center;">-0.0002980</td>
<td style="text-align: center;">0.0083910</td>
<td style="text-align: center;">0.0023164</td>
<td style="text-align: center;">-0.0031458</td>
<td style="text-align: center;">0.0033939</td>
<td style="text-align: center;">0.0099034</td>
<td style="text-align: center;">-0.0030766</td>
<td style="text-align: center;">0.0039271</td>
<td style="text-align: center;">-0.0078570</td>
<td style="text-align: center;">-0.0045523</td>
<td style="text-align: center;">-0.0119090</td>
<td style="text-align: center;">-0.0103046</td>
<td style="text-align: center;">-0.0110796</td>
<td style="text-align: center;">0.0006369</td>
<td style="text-align: center;">0.0005876</td>
<td style="text-align: center;">-0.0074384</td>
<td style="text-align: center;">0.0023149</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AR(1)</td>
<td style="text-align: center;">0.0013079</td>
<td style="text-align: center;">0.0009620</td>
<td style="text-align: center;">-0.0011721</td>
<td style="text-align: center;">0.0047728</td>
<td style="text-align: center;">-0.0075918</td>
<td style="text-align: center;">-0.0034379</td>
<td style="text-align: center;">-0.0032817</td>
<td style="text-align: center;">0.0041400</td>
<td style="text-align: center;">0.0009537</td>
<td style="text-align: center;">0.0047944</td>
<td style="text-align: center;">-0.0031608</td>
<td style="text-align: center;">0.0038049</td>
<td style="text-align: center;">-0.0038643</td>
<td style="text-align: center;">-0.0059815</td>
<td style="text-align: center;">-0.0026408</td>
<td style="text-align: center;">0.0011526</td>
<td style="text-align: center;">-0.0008837</td>
<td style="text-align: center;">0.0066843</td>
<td style="text-align: center;">-0.0042049</td>
<td style="text-align: center;">0.0035199</td>
<td style="text-align: center;">0.0012379</td>
<td style="text-align: center;">0.0064753</td>
<td style="text-align: center;">0.0012840</td>
<td style="text-align: center;">-0.0021505</td>
<td style="text-align: center;">0.0069773</td>
<td style="text-align: center;">-0.0032903</td>
<td style="text-align: center;">-0.0003065</td>
<td style="text-align: center;">0.0083825</td>
<td style="text-align: center;">0.0023079</td>
<td style="text-align: center;">-0.0031543</td>
<td style="text-align: center;">0.0033854</td>
<td style="text-align: center;">0.0098949</td>
<td style="text-align: center;">-0.0030851</td>
<td style="text-align: center;">0.0039186</td>
<td style="text-align: center;">-0.0078655</td>
<td style="text-align: center;">-0.0045608</td>
<td style="text-align: center;">-0.0119175</td>
<td style="text-align: center;">-0.0103131</td>
<td style="text-align: center;">-0.0110881</td>
<td style="text-align: center;">0.0006284</td>
<td style="text-align: center;">0.0005791</td>
<td style="text-align: center;">-0.0074469</td>
<td style="text-align: center;">0.0023064</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y[t+1] = Y[t]</td>
<td style="text-align: center;">0.0024552</td>
<td style="text-align: center;">0.0025186</td>
<td style="text-align: center;">0.0005306</td>
<td style="text-align: center;">0.0065276</td>
<td style="text-align: center;">-0.0058184</td>
<td style="text-align: center;">-0.0016579</td>
<td style="text-align: center;">-0.0014994</td>
<td style="text-align: center;">0.0059232</td>
<td style="text-align: center;">0.0027372</td>
<td style="text-align: center;">0.0065781</td>
<td style="text-align: center;">-0.0013772</td>
<td style="text-align: center;">0.0055886</td>
<td style="text-align: center;">-0.0020806</td>
<td style="text-align: center;">-0.0041978</td>
<td style="text-align: center;">-0.0008571</td>
<td style="text-align: center;">0.0029363</td>
<td style="text-align: center;">0.0009000</td>
<td style="text-align: center;">0.0084680</td>
<td style="text-align: center;">-0.0024213</td>
<td style="text-align: center;">0.0053036</td>
<td style="text-align: center;">0.0030215</td>
<td style="text-align: center;">0.0082589</td>
<td style="text-align: center;">0.0030677</td>
<td style="text-align: center;">-0.0003668</td>
<td style="text-align: center;">0.0087610</td>
<td style="text-align: center;">-0.0015066</td>
<td style="text-align: center;">0.0014772</td>
<td style="text-align: center;">0.0101662</td>
<td style="text-align: center;">0.0040916</td>
<td style="text-align: center;">-0.0013707</td>
<td style="text-align: center;">0.0051690</td>
<td style="text-align: center;">0.0116786</td>
<td style="text-align: center;">-0.0013015</td>
<td style="text-align: center;">0.0057023</td>
<td style="text-align: center;">-0.0060818</td>
<td style="text-align: center;">-0.0027771</td>
<td style="text-align: center;">-0.0101338</td>
<td style="text-align: center;">-0.0085294</td>
<td style="text-align: center;">-0.0093044</td>
<td style="text-align: center;">0.0024120</td>
<td style="text-align: center;">0.0023628</td>
<td style="text-align: center;">-0.0056632</td>
<td style="text-align: center;">0.0040900</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>Pode-se melhor comparar a performance das previsões usando alguma medida agregada de erro. Duas medidas bastante comuns são o Erro Absoluto Médio (EAM) e o Erro Quadrático Médio. A primeira toma o módulo da diferença entre o previsto (<span class="math inline">\(\hat{y}\)</span>) e o observado (<span class="math inline">\(y\)</span>) e tira uma média, enquanto a última toma a diferença quadrática. Formalmente, para um horizonte de previsão <span class="math inline">\(h\)</span> começando na última observação <span class="math inline">\(T\)</span>:</p>
<span class="math display">\[\begin{align}
\text{EAM} &amp; = \frac{1}{h}\sum_{i = T + 1}^{T + h} |y_{i} - \hat{y}_{i}| \\
\text{EQM} &amp; = \frac{1}{h}\sum_{i = T + 1}^{T + h} (y_{i} - \hat{y}_{i})^2
\end{align}\]</span>
<p>A tabela abaixo compara os modelos segundo estas medidas de erro.</p>
<div class="cell" data-layout-align="center" data-asis="true">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-bordered table-hover table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">EAM</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">EQM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ARMA(1, 2)</td>
<td style="text-align: center;">0.0042173</td>
<td style="text-align: center;">0.0042062</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARMA(1, 1)</td>
<td style="text-align: center;">0.0000268</td>
<td style="text-align: center;">0.0000268</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AR(1)</td>
<td style="text-align: center;">0.0042143</td>
<td style="text-align: center;">0.0043644</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y[t+1] = Y[t]</td>
<td style="text-align: center;">0.0000268</td>
<td style="text-align: center;">0.0000280</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>Nem sempre é fácil comparar estas medidas, i.e., verificar se elas são estatisticamente significantes. Pode-se usar o teste Diebold-Mariano para comparar estas medidas de erro, mas é importante frisar que ele contém uma série de hipóteses sobre a distribuição dos erros. A função <code>dm.test</code> do pacote <code>forecast</code> faz este teste e mais informações sobre ele podem ser encontradas usando <code>?dm.test</code>.</p>
<p>Pode-se visualizar as previsões usando as funções <code>autoplot()</code> e <code>autolayer()</code> do pacote <code>forecast</code>. Abaixo mostro os resultados para o modelo AR(1) e também para o modelo ingênuo. note como o erros-padrão deste último cresce muito rapidamente (pois a variância de um processo random-walk cresce sem limite).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(prev2, <span class="at">include =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(teste) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(prev3, <span class="at">include =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(teste) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"(%)"</span>) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-2.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(prev4, <span class="at">include =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(teste) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"(%)"</span>) <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-3.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="conclusão" class="level1">
<h1>Conclusão</h1>
<p>Os modelos da classe ARMA são bastante populares em séries de tempo pois geram boas previsões de curto prazo. Além disso, estes modelos são estimados facilmente e usam apenas a informação da própria série. No post acima, vimos como estimar um modelo ARMA e algumas das facilidades que tanto o pacote <code>astsa</code> como o <code>forecast</code> nos oferecem.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="viniciusoike/restateinsight" data-repo-id="R_kgDOJ9Lnfw" data-category="General" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>