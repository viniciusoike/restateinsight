<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vinicius Oike">
<meta name="dcterms.date" content="2019-03-11">

<title>Vinicius Oike - Equações a diferenças</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Vinicius Oike</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../my_apps.html" rel="" target="">
 <span class="menu-text">Apps</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../aboutme.html" rel="" target="">
 <span class="menu-text">Sobre</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/viniciusoike" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/viniciusoike" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../archive.html" rel="" target="">
 <span class="menu-text">Archive</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Equações a diferenças</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">time-series</div>
                <div class="quarto-category">repost</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vinicius Oike </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 11, 2019</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#equações-a-diferenças-estocásticas" id="toc-equações-a-diferenças-estocásticas" class="nav-link active" data-scroll-target="#equações-a-diferenças-estocásticas">Equações a diferenças estocásticas</a></li>
  <li><a href="#equações-a-diferenças-estocásticas-de-1ª-ordem" id="toc-equações-a-diferenças-estocásticas-de-1ª-ordem" class="nav-link" data-scroll-target="#equações-a-diferenças-estocásticas-de-1ª-ordem">Equações a diferenças estocásticas de 1ª ordem</a></li>
  <li><a href="#equações-a-diferenças-de-2ª-ordem" id="toc-equações-a-diferenças-de-2ª-ordem" class="nav-link" data-scroll-target="#equações-a-diferenças-de-2ª-ordem">Equações a diferenças de 2ª ordem</a>
  <ul class="collapse">
  <li><a href="#caso-1-raízes-reais-e-distintas" id="toc-caso-1-raízes-reais-e-distintas" class="nav-link" data-scroll-target="#caso-1-raízes-reais-e-distintas">Caso 1: raízes reais e distintas</a></li>
  <li><a href="#caso-2-raízes-reais-repetidas" id="toc-caso-2-raízes-reais-repetidas" class="nav-link" data-scroll-target="#caso-2-raízes-reais-repetidas">Caso 2: raízes reais repetidas</a></li>
  <li><a href="#caso-3-raízes-complexas" id="toc-caso-3-raízes-complexas" class="nav-link" data-scroll-target="#caso-3-raízes-complexas">Caso 3: raízes complexas</a></li>
  <li><a href="#caso-geral-equação-a-diferença-de-ordem-n" id="toc-caso-geral-equação-a-diferença-de-ordem-n" class="nav-link" data-scroll-target="#caso-geral-equação-a-diferença-de-ordem-n">Caso geral: equação a diferença de ordem n</a></li>
  <li><a href="#relação-com-séries-de-tempo" id="toc-relação-com-séries-de-tempo" class="nav-link" data-scroll-target="#relação-com-séries-de-tempo">Relação com séries de tempo</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="equações-a-diferenças-estocásticas" class="level1">
<h1>Equações a diferenças estocásticas</h1>
<p>Equações a diferenças estocásticas surgem naturalmente em modelos lineares de séries de tempo. Um modelo linear bastante simples para descrever uma série de tempo é o chamado <em>random walk</em>. Ele pode ser expresso como:</p>
<span class="math display">\[\begin{equation}
  y_{t} = y_{t-1} + \epsilon_{t}
\end{equation}\]</span>
<p>onde <span class="math inline">\(\epsilon_{t}\)</span> é um ruído branco, isto é, <span class="math inline">\(\epsilon_{t}\)</span> é um processo com média zero e sem autocorrelação. O modelo random-walk diz simplesmente que o valor de <span class="math inline">\(y(t)\)</span> é igual a seu valor no período imediatamente anterior, <span class="math inline">\(y_{t-1}\)</span>, somado a um “choque aletório”. Uma aplicação famosa deste modelo é na teoria de consumo do economista Robert Hall (1943-). Uma de suas hípóteses, em Hall (1988), é de que o consumo segue a seguinte equação</p>
<span class="math display">\[\begin{equation}
  c_{t}^{-1/\sigma} = \gamma c_{t-1}^{-1/\sigma} + \epsilon_{t}
\end{equation}\]</span>
<p>onde <span class="math inline">\(c_{t}\)</span> é o consumo em <span class="math inline">\(t\)</span>, <span class="math inline">\(1/\sigma\)</span> é o parâmetro que mede o coeficiente de elasticidade de substituição (vem da forma CES de utilidade) e <span class="math inline">\(\epsilon_{t}\)</span> é um termo de ruído. As estimativas encontram um valor muito próximo de 1 para <span class="math inline">\(\gamma\)</span> para diferentes valores de <span class="math inline">\(\gamma\)</span>.</p>
<p>Nossa análise de equações diferenciais estocásticas tem como foco a análise da estabilidade. Em linhas gerais, queremos descobrir se as soluções para determinada equação convergem ou divergem (explodem). O estudo de equações a diferenças guarda várias similaridades com as equações diferenciais. Então, ainda que o conhecimento prévio de equações diferenciais não seja necessário, uma familiaridade prévia com equações diferenciais pode auxiliar no entendimento de alguns conceitos das equações a diferenças.</p>
<p>Vamos analisar em detalhes o comportamento de equações de 1ª e 2ª ordens e depois generalizar para os casos de ordens mais elevadas.</p>
</section>
<section id="equações-a-diferenças-estocásticas-de-1ª-ordem" class="level1">
<h1>Equações a diferenças estocásticas de 1ª ordem</h1>
<p>Uma equação a diferenças de 1ª ordem tem a forma geral: <span class="math display">\[\begin{equation} \label{eq:1ord}
  y_{t} = a_{0} + a_{1}y_{t-1}
\end{equation}\]</span> Podemos resolver esta equação por recursão, isto é, encontrando <span class="math inline">\(y_{t-1}\)</span>, substituindo na equação acima, depois encontrando <span class="math inline">\(y_{t-2}\)</span>, substituindo novamente até chegarmos em <span class="math inline">\(y_{0}\)</span>. <span class="math display">\[\begin{align*}
  y_{t} &amp; = a_{0} + a_{1}y_{t-1} \\
  y_{t} &amp; = a_{0} + a_{1}(a_{0} + a_{1}y_{t-2}) = a_{0}(1 + a_{1}) + a_{1}^{2}y_{t-2}\\
  y_{t} &amp; = a_{0}(1 + a_{1}) + a_{1}^{2}(a_{0} + a_{1}y_{t-3}) = a_{0}(1 + a_{1} + a_{1}^{2}) + a_{1}^{3}y_{t-3} \\
  \vdots &amp; \\
  y_{t} &amp; = a_{0}(1 + a_{1} + a_{1}^{2} + \dots + a_{1}^{t-1}) + a_{1}^{t}y_{t-t}\\
        &amp; = a_{0}\sum_{i = 0}^{t-1}(a_{1})^{i} + a_1^{t}y_{0}
\end{align*}\]</span> Podemos acrescentar um termo aleatório (de ruído) na equação acima para torná-la estocástica. Talvez o exemplo mais simples de processo estocástico seja o ruído branco. Formalmente, uma sequência de variáveis aleatórias <span class="math inline">\(\{ w_{t}\} = w_{1}, w_{2}, \dots, w_{T}\)</span> segue um processo de ruído branco se a esperança de <span class="math inline">\(w_{t}\)</span> for zero e a autocovariância entre quaisquer tempos distintos for zero (e igual a <span class="math inline">\(\sigma^{2}\)</span> entre tempos iguais), isto é,</p>
<span class="math display">\[\begin{aligned}
\mathbb{E}(w_{t}) &amp; = 0,  \quad \forall t \\
\mathbb{E}(w_{t}w_{s}) &amp; = 0 , \quad \forall s\neq t \\
\mathbb{E}(w_{t}^{2}) &amp; = \sigma^{2} , \quad \forall t
\end{aligned}\]</span>
<p>A notação usual é <span class="math inline">\(w_{t} \sim RB(0,\sigma^{2})\)</span>. Não é necessário, mas é bastante comum supor que <span class="math inline">\(w_{t}\sim N(0,1)\)</span>, isto é, que <span class="math inline">\(w_{t}\)</span> segue uma distribuição normal padrão (alguns livros sequer fazem a distinção entre um e outro). Note que, por exemplo, supor que o ruído segue uma distribuição uniforme também seria admissível.</p>
<p>Para gerar uma série de ruído branco gaussiano no R podemos usar a função <code>rnorm()</code> que sorteia valores aleatórios a partir de uma distribuição normal. Lembre-se que se for informado somente o tamanho da sequência <span class="math inline">\(n\)</span> a função assume que a distribuição desejada é a normal-padrão (média zero e variância unitária). A ideia é que o ruído branco é uma sequência sem padrão discernível.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33</span>) <span class="co"># para reproduzir os resultados</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">500</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Ruído branco Gaussiano"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Considere agora a equação a difereneças estocásticas de 1ª ordem abaixo em que <span class="math inline">\(w_{t}\)</span> é ruído branco.</p>
<span class="math display">\[\begin{equation} \label{eq:1ord_sto}
  y_{t} = a_{0} + a_{1}y_{t-1} + w_{t}
\end{equation}\]</span>
<p>Novamente, podemos resolver esta equação por substituição recursiva: <span class="math display">\[\begin{align*}
  y_{t} &amp; = a_{0} + a_{1}y_{t-1} + w_{t}\\
  y_{t} &amp; = a_{0} + a_{1}(a_{0} + a_{1}y_{t-2} + w_{t-1}) + w_{t} = a_{0}(1 + a_{1}) + a_{1}^{2}y_{t-2} + a_{1}w_{t-1} + w_{t}\\
  y_{t} &amp; = a_{0}(1 + a_{1} + a_{1}^{2}) + a_{1}^{3}y_{t-3} + a_{1}^{2}w_{t-2} + a_{1}w_{t-1} + w_{t}\\
  \vdots &amp; \\
  y_{t} &amp; = a_{0}(1 + a_{1} + a_{1}^{2} + \dots + a_{1}^{t-1}) + a_{1}^{t}y_{t-t} + a_{1}^{t-1}\epsilon_{1} + a_{1}^{t-2}\epsilon_{2} + \dots + a_{1}^{0}\epsilon_{t}\\
        &amp; = a_{0}\sum_{i = 0}^{t-1}(a_{1})^{i} + a_1^{t}y_{0} + \sum_{i = 0}^{t-1}a_{1}^{i}\epsilon_{t-i}
\end{align*}\]</span> Note que quando <span class="math inline">\(t \to \infty\)</span> a estabilidade da solução depende da magnitude de <span class="math inline">\(a_{1}\)</span>. Em particular, se <span class="math inline">\(a_{1}\)</span> for maior do que um em módulo a série não converge. Isto pode ser visto de várias maneiras. Talvez a mais simples seja notar que: <span class="math display">\[\begin{equation}
  \lim_{t \to \infty} \sum_{i = 0}^{t - 1}a_{1}^{i} = 1 + a_{1} + (a_{1})^{2} + (a_{1})^{3} + \dots + (a_{1})^{n} + \dots
\end{equation}\]</span> Se <span class="math inline">\(a_{1} &gt; 1\)</span> os termos entre parênteses vão crescendo sem fim e a soma não converge para nenhum valor finito. Da mesma forma se <span class="math inline">\(a_{1} &lt; -1\)</span> os valores entre parênteses vão crescendo sem limite, ainda que eles oscilem entre negativos e positivos. Logo, teremos estabilidade somente se <span class="math inline">\(|a_{1}| &lt; 1\)</span>.</p>
<p>Outra maneira de visualizar este resultado é usando o operador defasagem (<em>lag</em>). Seja o operador defasagem definido como <span class="math inline">\(\mathbb{L}x_{t} = x_{t-1}\)</span>. Lembre-se que o operador defasagem tem a seguinte propriedade: <span class="math inline">\(\mathbb{L}c = c\)</span> se <span class="math inline">\(c\)</span> for uma constante. Além disso, vamos usar um resultado de somas geométricas infinitas; como muitas demonstrações em séries de tempo usam este resultado vale a pena revisá-lo. Considere a soma infinita abaixo <span class="math display">\[1 + \frac{1}{2} + \frac{1}{4} + \frac{1}{8} + \dots\]</span> Queremos descobrir se esta soma converge para algum valor e, idealmente, queremos também saber qual valor é este. Tome primeiro a soma finita: <span class="math display">\[\begin{equation}
  s = a + ar + ar^2 + ar^3 + \dots + ar^{n-1} = \sum_{i = 0}^{n - 1}ar^{i}
\end{equation}\]</span> onde <span class="math inline">\(r \neq 1\)</span>. Multiplicando os dois lados desta igualdade por <span class="math inline">\((1 - r)\)</span> temos: <span class="math display">\[\begin{align*}
  s(1-r) &amp; = (a + ar + ar^2 + ar^3 + \dots + ar^{n-1})(1-r)\\
         &amp; = (a + ar + ar^2 + ar^3 + \dots + ar^{n-1} - ar - ar^2 - ar^3 - ar^4 - \dots - ar^{n}) \\
         &amp; = a - ar^{n} \\
         &amp; = a(1 - r^{n})
\end{align*}\]</span> Rearranjando esta expressão chegamos no seguinte resultado <span class="math display">\[\begin{equation}
  s = \sum_{i = 0}^{n - 1}ar^{i} = a\frac{1 - r^{n}}{1 - r}
\end{equation}\]</span> Tomando o limite desta expressão para <span class="math inline">\(n \to \infty\)</span> chegamos em <span class="math display">\[\begin{equation}
  a + ar + ar^2 + ar^3 + \dots = a\sum_{i = 0}^{\infty}r^{i} = \frac{1}{1 - r}
\end{equation}\]</span> onde agora impomos <span class="math inline">\(|r| &lt; 1\)</span>. Para o caso particular em que <span class="math inline">\(a = 1\)</span> e <span class="math inline">\(r = 1/2\)</span> temos que <span class="math display">\[1 + \frac{1}{2} + \frac{1}{4} + \frac{1}{8} + \dots = \frac{1}{1 - 1/2} = 2\]</span></p>
<p>Seja a equação a diferença estocástica de 1ª ordem: <span class="math inline">\(x_{t} = a_{0} + a_{1}x_{t-1} + w_{t}\)</span>, onde <span class="math inline">\(w_{t} \sim \text{RB}(0, \sigma^{2})\)</span>. Então podemos encontrar a solução para esta equação usando o operador defasagem.</p>
<span class="math display">\[\begin{align}
  x_{t} &amp; = a_{1}\mathbb{L}x_{t} +  a_{0} + w_{t} \\
  x_{t}(1 - a_{1}\mathbb{L}) &amp; =  a_{0} + w_{t} \\
  x_{t} &amp; = \frac{a_{0}}{1 - a_{1}\mathbb{L}} + \frac{w_{t}}{1 - a_{1}\mathbb{L}} \\
  x_{t} &amp; = a_{0}\sum_{i = 0}^{\infty}(a_{1}\mathbb{L})^{i} + \sum_{i = 0}^{\infty}(a_{1}\mathbb{L})^{i}w_{t} \\
  x_{t} &amp; = \frac{a_{0}}{1 - a_{1}} + w_{t} + a_{1}w_{t-1} + a_{1}^{2}w_{t-2} + \dots \\
  x_{t} &amp; = \frac{a_{0}}{1 - a_{1}} + \sum^{\infty}_{i = 0}(a_{1})^{i}w_{t-i}
\end{align}\]</span>
<p>Se <span class="math inline">\(|a_{1}|&lt;1\)</span> sabemos que as somas infinitas existem e são finitas. Abaixo há dois exemplos deste caso, um em que <span class="math inline">\(a_{1} = -.6\)</span> e outro em que <span class="math inline">\(a_{1} = .8\)</span>. Note como o coeficiente negativo na primeira equação resulta num gráfico com mais oscilações. Para simular a série precisamos impor, arbitrariamente, alguma condição inicial, i.e., um valor para <span class="math inline">\(y_{0}\)</span>. Para um valor grande de <span class="math inline">\(t\)</span> a escolha não carrega grandes consequências; ainda assim, o correto seria simular a série com a condição inicial e depois descartar algumas das primeiras observações. Nos exemplos abaixo simulo <span class="math inline">\(300\)</span> observações para cada série e depois descarto as primeiras <span class="math inline">\(100\)</span> para limpar o efeito da escolha de valor inicial <span class="math inline">\(y_{0} = 2\)</span>.</p>
<p>Para nossas finalidades isto não impacta os resultados então nos exemplos futuros vou ignorar esta correção.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(); y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># cria o vetor y com a condição inicial y0 = 2</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(); z[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># cria o vetor z com a condição inicial z0 = 2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">299</span>) { <span class="co"># monta a série yt</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    y[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">5</span> <span class="sc">-</span> .<span class="dv">6</span> <span class="sc">*</span> y[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">299</span>) { <span class="co"># monta a série zt</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    z[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> .<span class="dv">8</span> <span class="sc">*</span> z[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Descarta as primeiras 100 observações para limpar o efeito da escolha</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; de y0 = z0 = 2</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> y[<span class="dv">101</span><span class="sc">:</span><span class="dv">300</span>]</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> z[<span class="dv">101</span><span class="sc">:</span><span class="dv">300</span>]</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(y, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="fu">bquote</span>(y[t] <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="sc">-</span>.<span class="dv">6</span><span class="sc">*</span>y[t<span class="dv">-1</span>] <span class="sc">+</span> w[t]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(z, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="fu">bquote</span>(z[t] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="sc">+</span>.<span class="dv">8</span><span class="sc">*</span>z[t<span class="dv">-1</span>] <span class="sc">+</span> w[t]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-2.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Quando <span class="math inline">\(|a_{1}|&gt;1\)</span> a trajetória seria explosiva, isto é, não vai convergir. Abaixo segue um exemplo deste caso. Note como mesmo com <span class="math inline">\(a_{1}\)</span> pequeno o processo cresce muito rapidamente. A linha tracejada em azul indica a mesma equação sem o termo estocástico <span class="math inline">\(w_{t}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note que o exemplo acima é literalmente uma possível realização do processo. Como o termo <span class="math inline">\(w_{t}\)</span> é estocástico, ele pode assumir valores diferentes quando formos “calcular” novamente a trajetória da equação acima. Abaixo segue um gráfico com 100 possíveis trajetórias - note o comportamento divergente das trajetórias.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cria uma matriz 50x100 com 1 em todas as entradas (cada série é uma coluna)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">50</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop para substituir os valores da matriz</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {   <span class="co"># para cada coluna j</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">49</span>) {  <span class="co"># para cada linha i</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&gt; Substitui o valor da linha i + 1 da coluna j por 1.05 vezes</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&gt; o valor da linha anterior e soma um choque</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  X[i <span class="sc">+</span> <span class="dv">1</span>, j] <span class="ot">&lt;-</span> <span class="fl">1.05</span> <span class="sc">*</span> X[i, j] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(X, </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">100</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="fu">bquote</span>(<span class="st">"100 realizações do processo"</span> <span class="sc">~</span> y[t] <span class="sc">==</span> <span class="fl">1.05</span><span class="sc">~</span>y[t<span class="dv">-1</span>]<span class="sc">+</span>w[t]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Podemos repetir o mesmo exercício para um caso estável. Uma forma de pensar na estabilidade é de que é possível encobrir todas as observações entre duas linhas.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Quando <span class="math inline">\(a_{1} = 1\)</span> temos o importante - já mencionado - caso do <em>random walk</em>. Usando o mesmo raciocínio recursivo acima podemos mostrar que este processo é instável. Seja <span class="math inline">\(y_{t}\)</span> definido como: <span class="math display">\[\begin{equation}
  y_{t} = a_{0} + y_{t-1} + w_{t}
\end{equation}\]</span> Esta expressão também é chamada de random walk com tendência. Então temos que:</p>
<span class="math display">\[\begin{align}
y_{t} &amp; = y_{t-1} +  a_{0} + w_{t}\\
y_{t} &amp; = y_{t-2} +  a_{0} + w_{t-1} +  a_{0} + w_{t}\\
y_{t} &amp; = y_{t-2} + 2 a_{0} + w_{t-1} + w_{t}\\
      &amp; \ldots \\
y_{t} &amp; = y_{0} + t a_{0} + w_{t} + w_{t-1} + w_{t-2} + \ldots + w_{0}\\
y_{t} &amp; = y_{0} + a_{0}t + \sum^{t}_{i = 0} w_{t-i}
\end{align}\]</span>
<p>Note que o termo <span class="math inline">\(a_{0}t\)</span> é uma função linear do tempo; por este motivo, ele dá a tendência do processo.</p>
<p>Omitindo o termo constante <span class="math inline">\(a_{0}\)</span> vemos que a cada período a série é acrescida de um choque, isto é, <span class="math inline">\(y_{t} - y_{t-1} = w_{t}\)</span>. De fato, o random walk pode ser expresso como um somatório destes vários choques aleatórios: <span class="math display">\[\begin{equation}
  y_{t} = \sum^{t}_{i = 0} w_{t-i}
\end{equation}\]</span></p>
<p>Novamente, o limite para <span class="math inline">\(t \to \infty\)</span> não converge. Abaixo segue uma simulação de um random walk com condição inicial <span class="math inline">\(y_{0} = 0\)</span>. Ploto o processo com e sem tendência. A linha tracejada é a tendência <span class="math inline">\(a_{0}t\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">200</span>); x <span class="ot">=</span> <span class="fu">cumsum</span>(w)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>yd <span class="ot">=</span> .<span class="dv">2</span> <span class="sc">+</span> w; y <span class="ot">=</span> <span class="fu">cumsum</span>(yd)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  y,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">bquote</span>(<span class="st">"Random Walk, "</span> <span class="sc">~</span> y[t] <span class="sc">==</span> <span class="fl">0.2</span> <span class="sc">+</span> y[t<span class="dv">-1</span>] <span class="sc">+</span> w[t]),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="dv">4</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> .<span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"topleft"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Com tendência"</span>, <span class="st">"Sem tendência"</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="dv">1</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Quando <span class="math inline">\(a = -1\)</span> temos um processo oscilatório. Note como o aumento da variância do termo de ruído altera a série - o processo determinístico fica, cada vez mais, obscurecido.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="equações-a-diferenças-de-2ª-ordem" class="level1">
<h1>Equações a diferenças de 2ª ordem</h1>
<p>Uma equação a diferenças de 2ª ordem tem a forma geral: <span class="math display">\[\begin{equation} \label{eq:2nd}
  y_{t} = a_{0} + a_{1}y_{t-1} + a_{2}y_{t-2}
\end{equation}\]</span> Para encontrar as soluções da equação acima, vamos primeiro buscar as soluções da equação homogênea. Reescrevemos: <span class="math display">\[\begin{equation}
  y_{t} - a_{1}y_{t-1} - a_{2}y_{t-2} = 0
\end{equation}\]</span> E agora chutamos a solução da forma <span class="math inline">\(y_{t} = A\alpha^{t}\)</span>. Assim, <span class="math display">\[\begin{align}
  A\alpha^{t} - a_{1}A\alpha^{t-1} - a_{2}A\alpha^{t-2} &amp; = 0 \\
  A\alpha^{t-2}(\alpha^{2} - a_{1}\alpha - a_{2}) &amp; = 0
\end{align}\]</span> Supondo que <span class="math inline">\(A \neq 0\)</span> temos que a equação acima será satisfeita se a expressão entre parênteses for igual a zero. Note que isto é simplesmente um polinômio de segunda ordem em <span class="math inline">\(\alpha\)</span>, isto é <span class="math inline">\(P(\alpha) = \alpha^{2} - a_{1}\alpha - a_{2}\)</span> cujas raízes <span class="math inline">\(\alpha_{1}\)</span> e <span class="math inline">\(\alpha_{2}\)</span> são dadas pela equação quadrática: <span class="math display">\[\begin{equation}
  \alpha_{1} \text{, } \alpha_{2} = \frac{a_{1} \pm \sqrt{a_{1}^2 + 4a_{2}}}{2}
\end{equation}\]</span> A solução geral de <span class="math inline">\(\eqref{eq:2nd}\)</span> incorpora todas as combinações lineares das raízes: <span class="math display">\[\begin{equation}
  y_{t}^{h} = A_{1}(\alpha_{1})^{t} + A_{2}(\alpha_{2})^{t}
\end{equation}\]</span> Onde <span class="math inline">\(A_{1}\)</span> e <span class="math inline">\(A_{2}\)</span> são constantes arbitrárias que podem ser determinadas usando as condições inicias do problema. Como sabemos, há três casos possíveis para as raízes de <span class="math inline">\(P(\alpha)\)</span>:</p>
<ul>
<li><em>Caso 1:</em> duas raízes reais e distintas</li>
<li><em>Caso 2:</em> duas raízes reais repetidas</li>
<li><em>Caso 3:</em> um par conjugado de raízes complexas</li>
</ul>
<p>Intuitivamente, já podemos antecipar alguns resultados. Note que se tomarmos o limite, com <span class="math inline">\(t \to \infty\)</span>, da solução geral precisamos que as raízes <span class="math inline">\(\alpha_{1}\)</span> e <span class="math inline">\(\alpha_{2}\)</span> sejam menores que <span class="math inline">\(1\)</span> em módulo. Usualmente, refere-se à essa condição como a do círculo unitário, isto é, de que as raízes do polinômio caracterísitico estejam dentro do círculo unitário. Isto porque podemos plotar estas raízes num plano cartesiano como pontos dentro de um círculo com raio igual a um.</p>
<p>Lembre-se que uma raíz complexa é um par conjugado da forma <span class="math inline">\(z = a \pm bi\)</span> onde <span class="math inline">\(i\)</span> é o número imaginário definido como <span class="math inline">\(i = \sqrt{-1}\)</span>. Além disso, podemos definir a distância de um ponto a outro usando a norma euclideana, isto é, <span class="math inline">\(\left \| z \right \| = \sqrt{a^2 + (bi)^2}\)</span>.</p>
<p>Se tomarmos a norma de <span class="math inline">\(\alpha\)</span> como <span class="math inline">\(a^2 + (bi)^2 = a^2 - b^2\)</span></p>
<section id="caso-1-raízes-reais-e-distintas" class="level2">
<h2 class="anchored" data-anchor-id="caso-1-raízes-reais-e-distintas">Caso 1: raízes reais e distintas</h2>
<p>Tome a equação a diferenças de 2ª ordem: <span class="math display">\[\begin{equation} \label{eq:caso1}
  y_{t} = 0.2y_{t-1} + 0.35y_{t-2}
\end{equation}\]</span> A forma homogênea é: <span class="math display">\[\begin{equation}
  \alpha^{2} - 0.2\alpha - 0.35
\end{equation}\]</span> Para encontrar as raízes deste polinômio podemos usar a função <code>polyroot</code> do R. Ela leva como argumento os coeficientes do polinômio em ordem ‘crescente’, isto é, dado um polinômio da forma <span class="math inline">\(P(x) = c_{0} + c_{1}x + c_{2}x^{2} + \dots + c_{n}x^{n}\)</span>, informamos os coeficientes na ordem <span class="math inline">\(c_{0}, c_{1}, \dots, c_{n}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.35</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">polyroot</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.7-0i -0.5+0i</code></pre>
</div>
</div>
<p>Ou seja, as soluções são da forma: <span class="math display">\[\begin{equation}\label{eq:caso1sol}
  y_{t} = A_{1}(0.7)^{t} + A_{2}(-0.5)^{t}
\end{equation}\]</span> A equação acima define uma família de soluções parametrizada por <span class="math inline">\(A_{1}\)</span> e <span class="math inline">\(A_{2}\)</span>, isto é, temos diferentes soluções para diferentes valores de <span class="math inline">\(A_{1}\)</span> e <span class="math inline">\(A_{2}\)</span>. Estas constantes arbitrárias podem ser resolvidas usando as condições iniciais do problema, mas, em geral, nosso interesse está em interpretar a estabilidade da solução. Note que como ambas as raízes são menores do que <span class="math inline">\(1\)</span> em módulo, todas as soluções possíveis devem convergir para zero.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Podemos visualizar a equação <span class="math inline">\(\eqref{eq:caso1}\)</span> com auxílio de um loop no R. Para isto vamos ter de impor, arbitrariamente, alguma condição inicial para o problema. Aqui escolho <span class="math inline">\(y_{0} = 0\)</span> e <span class="math inline">\(y_{1} = 1\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(); y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>; y[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>a0 <span class="ot">&lt;-</span> <span class="dv">0</span>; a1 <span class="ot">&lt;-</span> <span class="fl">0.2</span>; a2 <span class="ot">&lt;-</span> <span class="fl">0.35</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>){</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  y[t<span class="sc">+</span><span class="dv">2</span>] <span class="ot">=</span> a0 <span class="sc">+</span> a1<span class="sc">*</span>y[t<span class="sc">+</span><span class="dv">1</span>] <span class="sc">+</span> a2<span class="sc">*</span>y[t]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(y, <span class="at">main =</span> <span class="fu">bquote</span>(y[t] <span class="sc">==</span> <span class="er">~</span> <span class="fl">0.2</span><span class="sc">*</span>y[t<span class="dv">-1</span>] <span class="sc">+</span> <span class="fl">0.35</span><span class="sc">*</span>y[t<span class="dv">-2</span>]), </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"Converge para zero"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Temos mais dois subcasos a analisar, a ver: quando uma das raízes é maior do que um (em módulo) e quando as duas raízes são maiores do que um (em módulo). Podemos já antecipar que estas soluções serão <em>instáveis</em>.</p>
<p>Se qualquer uma das raízes for maior do que um, as trajetórias serão instáveis. Abaixo seguem 100 realizações segundo a equação <span class="math display">\[y_{t+2} = .5y_{t+1} + 1.05y_{t} + w_{t}\]</span></p>
<p>As raízes desta equação são <span class="math inline">\(r_{1} = -1\)</span> e <span class="math inline">\(r_{2} = 1.05\)</span>. Como uma delas é maior do que um, as trajetórias serão instáveis. Este último gráfico usa o pacote ggplot2 para uma melhor visualização.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">20</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>) {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    X[i<span class="sc">+</span><span class="dv">2</span>, j] <span class="ot">=</span> .<span class="dv">5</span> <span class="sc">*</span> X[i<span class="sc">+</span><span class="dv">1</span>,j] <span class="sc">+</span> <span class="fl">1.05</span> <span class="sc">*</span> X[i, j] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(X)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>ano <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ano, dados)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">melt</span>(dados, <span class="at">id.vars =</span> <span class="st">"ano"</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(ano, value)) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> variable), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_gdocs</span>() <span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Duas raízes reais distintas (r1 = 1.05 e r2 = -1). </span><span class="sc">\n</span><span class="st">Como uma das raízes é maior do que um, as trajetórias são instáveis."</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="caso-2-raízes-reais-repetidas" class="level2">
<h2 class="anchored" data-anchor-id="caso-2-raízes-reais-repetidas">Caso 2: raízes reais repetidas</h2>
<p>Pela notação acima, como <span class="math inline">\(\alpha_{1} = \alpha_{2} = \alpha\)</span> temos que <span class="math inline">\(\alpha = \frac{a_{1}}{2}\)</span></p>
<p><span class="math display">\[
  y_{t} = A_{1}(\alpha)^{t} + tA_{2}(\alpha)^{t}
\]</span></p>
<p>Novamente, a condição de estabilidade exige que <span class="math inline">\(| \alpha | &lt; 1\)</span>, ou, neste caso específico, que <span class="math inline">\(| \frac{a_{1}}{2} | &lt; 1\)</span>, isto é, que <span class="math inline">\(|a_{1}|&lt;2\)</span>. Considere o caso abaixo:</p>
<p><span class="math display">\[
y_{t} = y_{t-1}-\frac{1}{4}y_{t-2}
\]</span></p>
<p>A equação da forma homogênea é então:</p>
<p><span class="math display">\[
\alpha^{2} - \alpha + 0.25 = 0
\]</span></p>
<p>Cujas raízes são <span class="math inline">\(\alpha = 0.5\)</span> como se pode verificar abaixo</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">polyroot</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5+0i 0.5-0i</code></pre>
</div>
</div>
<p>Ou seja, temos uma solução geral da forma:</p>
<p><span class="math display">\[
y_{t} = A_{1}0.5^{t} + A_{2}t0.5^{t}
\]</span></p>
<p>Usando as condições iniciais pode-se determinar os valores precisos de <span class="math inline">\(A_{1}\)</span> e <span class="math inline">\(A_{2}\)</span>. Supondo, por exemplo, que <span class="math inline">\(y_{0} = 1\)</span> e <span class="math inline">\(y_{1} = 0\)</span> podemos determinar os valores de <span class="math inline">\(A_{1} = 1\)</span> e <span class="math inline">\(A_{2} = -1\)</span> . Note, contudo, que o valor destas constantes não é importante para analisar o comportamento de convergência.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">### raizes iguais</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(); y[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span>; y[<span class="dv">2</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  y[t] <span class="ot">=</span> (<span class="fl">0.5</span>)<span class="sc">^</span>(t) <span class="sc">-</span> t <span class="sc">*</span> (<span class="fl">0.5</span>)<span class="sc">^</span>(t)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  y,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Raiz repetida menor que um em módulo. Estável"</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se tivermos uma raiz unitária ela será dupla. Este é o caso em a equação homogêna tem a forma <span class="math inline">\((x + 1)^{2}\)</span> ou <span class="math inline">\((x - 1)^{2}\)</span>. No primeiro caso, a equação a diferenças seria:</p>
<p><span class="math display">\[
y_{t} = - 2y_{t-1}-y_{t-2}
\]</span></p>
<p>Olhando para o gráfico da solução geral vemos que ele não converge.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">### raizes iguais</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(); y[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span>; y[<span class="dv">2</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  y[t] <span class="ot">=</span> (<span class="dv">1</span>)<span class="sc">^</span>(t) <span class="sc">-</span> t <span class="sc">*</span> (<span class="dv">1</span>)<span class="sc">^</span>(t)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  y,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Raiz repetida menor que um em módulo. Estável"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>De fato, esta equação oscila entre valores positivos e negativos e vai divergindo.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="caso-3-raízes-complexas" class="level2">
<h2 class="anchored" data-anchor-id="caso-3-raízes-complexas">Caso 3: raízes complexas</h2>
<p>Quando há raízes complexas, analisamos a parte real destas para verificar a estabilidade. Da equação quadrática temos que <span class="math display">\[
\alpha_{1} \text{, } \alpha_{2} = \frac{a_{1} \pm \sqrt{a_{1}^2 + 4a_{2}}}{2}
\]</span> Se temos raízes complexas, então <span class="math display">\[
a_{1}^2 + 4a_{2} &lt; 0
\]</span></p>
<p>Isto é, seja <span class="math inline">\(z = a \pm bi\)</span> a forma das raízes. Então o valor de a indica a estabilidade do processo. Novamente, caso <span class="math inline">\(|a|&lt;1\)</span> o processo será estável, e, caso contrário, o processo será instável.</p>
<p><span class="math display">\[
y_{t} = 1.6y_{t - 1} - 1.64 y_{t - 2} + w_{t}
\]</span></p>
<p>O polinômio característico da equação acima:</p>
<p><span class="math display">\[
P(z) = 1 - 1.6z + 1.64z^2
\]</span></p>
<p>As raízes deste polinômio são <span class="math inline">\(\alpha_{1} = 0.4878049+0.6097561i\)</span> e <span class="math inline">\(\alpha_{2} = 0.4878049-0.6097561i\)</span>. A norma de cada raiz (a distância entre o ponto e a origem) é <span class="math display">\[
\|\alpha\| = \sqrt{0.4878049^{2} + (0.6097561)^2} = 0.6097561
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(z <span class="ot">&lt;-</span> <span class="fu">polyroot</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">1.6</span>, <span class="fl">1.64</span>)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4878049+0.6097561i 0.4878049-0.6097561i</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Re</span>(z)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">Im</span>(z)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6097561 0.6097561</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-2.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-3.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Novamente, podemos ver a condição de estabilidade no círculo unitário. Plotamos a parte real no eixo-x e a parte imaginária no eixo-y</p>
</section>
<section id="caso-geral-equação-a-diferença-de-ordem-n" class="level2">
<h2 class="anchored" data-anchor-id="caso-geral-equação-a-diferença-de-ordem-n">Caso geral: equação a diferença de ordem n</h2>
</section>
<section id="relação-com-séries-de-tempo" class="level2">
<h2 class="anchored" data-anchor-id="relação-com-séries-de-tempo">Relação com séries de tempo</h2>
<p>Um processo AR(p) é, essencialmente, uma equação a diferenças. Para o caso específico do AR(2)</p>
<p><span class="math display">\[
y_{t} = \phi_{1}y_{t-1} + \phi_{2}y_{t-2} + \epsilon_{t}
\]</span></p>
<p>onde <span class="math inline">\(\epsilon_{t}\)</span> é um ruído branco gaussiano, isto é <span class="math inline">\(\epsilon_{t} \sim N(0,\sigma^{2})\)</span>. Usando operador defagem podemos ver que:</p>
<span class="math display">\[\begin{align}
  y_{t} = \phi_{1}y_{t-1} + \phi_{2}y_{t-2} + \epsilon_{t}\\
      &amp; = \phi_{1}Ly_{t} + \phi_{2}L^{2}y_{t} + \epsilon_{t} \\
  y_{t}(1 - \phi_{1}L - \phi_{2}L^{2})  &amp; = \epsilon_{t}
\end{align}\]</span>
<p>O termo entre parêntesis é um “polinômio” em L. Analogamente ao caso determinístico anaisamos a estabilidade do AR(2) pelas raízes deste polinômio. Note, contudo, que como L é um operador - o operador defasagem - não podemos tratá-lo como um número. Então vamos trocá-lo por <span class="math inline">\(z\)</span>. <span class="math display">\[
P(z) = 1 - \phi_{1}z - \phi_{2}z^{2}
\]</span> As raízes <span class="math inline">\(r_{1}\)</span>, <span class="math inline">\(r_{2}\)</span> deste polinômio são:</p>
<p><span class="math display">\[
r_{1}\text{, }r_{2} = \frac{\phi_{1} \pm \sqrt{\phi_{1}^{2} + 4 \phi_{2}}}{2}
\]</span></p>
<p>Note que esta expressão é a mesma que encontramos anteriormente. A condição de estabilidade continua a mesma: as raízes do polinômio característico devem estar dentro do círculo unitário. Da mesma forma, as condições que encontramos para os coeficientes <span class="math inline">\(a_{1}\)</span> e <span class="math inline">\(a_{2}\)</span> acima também valem para o AR(2). Repetindo elas aqui por conveniência, um AR(2) será estável se:</p>
<ul>
<li><span class="math inline">\(\phi_{1} + \phi_{2} &lt; 1\)</span></li>
<li><span class="math inline">\(\phi_{2} - \phi_{1} &lt; 1\)</span></li>
<li><span class="math inline">\(\phi_{2} &gt; -1\)</span></li>
</ul>
<p>Note que aqui estabilidade é intercambiável com <em>estacionaridade</em>. Ainda que as condições que definem estacionaridade sejam diferentes, elas são equivalentes a garantir que as raízes do polinômio característico estejam dentro do círculo unitário.</p>
<p><span class="math display">\[
y_{t} = 0.3 y_{t-1} + 0.65 y_{t-2} + \epsilon_{t}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = y, order = c(2, 0, 0))

Coefficients:
         ar1     ar2  intercept
      0.2883  0.6345     0.9528
s.e.  0.0542  0.0544     0.8808

sigma^2 estimated as 1.095:  log likelihood = -293.86,  aic = 595.72

Training set error measures:
                      ME   RMSE       MAE      MPE     MAPE      MASE
Training set 0.008318959 1.0464 0.8579949 34.99348 118.0388 0.7439671
                    ACF1
Training set -0.00874765</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-2.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Lembre-se também que não é necessário fazer este tipo de análise para modelos MA(q), pois eles sempre são estacionários. Para verificar isto é mais simples considerar o caso em que <span class="math inline">\(q = 1\)</span>.</p>
<p><span class="math display">\[
  y_{t} = \epsilon_{t} + \theta\epsilon_{t - 1}
\]</span></p>
<p>A esperança desta expressão:</p>
<p><span class="math display">\[
\mathbb{E}(y_{t}) = \mathbb{E}(\epsilon_{t} + \theta\epsilon_{t - 1}) = \mathbb{E}(\epsilon_{t}) + \theta\mathbb{E}(\epsilon_{t - 1}) = 0
\]</span></p>
<p>A autocovariância:</p>
<span class="math display">\[\begin{align}
  \mathbb{E}(y_{t}^2) &amp; = \mathbb{E}\left { (\epsilon_{t} + \theta\epsilon_{t - 1})^2 \right } \\
                      &amp; = \mathbb{E}\left { \epsilon_{t}^2 + \theta^2\epsilon_{t - 1}^2 + \theta\epsilon_{t}\epsilon_{t - 1} \right } \\
                      &amp; = \mathbb{E}(\epsilon_{t}^2) + \theta^{2}\mathbb{E}(\epsilon_{t - 1}^2) + \theta\mathbb{E}(\epsilon_{t}\epsilon_{t - 1}) \\
                      &amp; = \sigma^{2} + \theta^{2} \sigma^{2} \\
                      &amp; = \sigma^{2}(1 + \theta^{2})
\end{align}\]</span>
<span class="math display">\[\begin{align}
  \gamma(1) &amp; = \mathbb{E}(y_{t}y_{t-1}) \\
            &amp; = \mathbb{E}\left { (\epsilon_{t} + \theta\epsilon_{t - 1})(\epsilon_{t - 1} + \theta\epsilon_{t - 2}) \right } \\
            &amp; = \mathbb{E}\left { \epsilon_{t}\epsilon_{t - 1} +  \theta\epsilon_{t}\epsilon_{t - 2} + \theta\epsilon_{t - 1}^2 + \theta^{2}\epsilon_{t - 1}\epsilon_{t - 2} \right } \\
            &amp; = \theta \sigma^{2}
\end{align}\]</span>
<p>Note que as demais autocovariâncias serão todas iguais a zero. Isto se generaliza para o caso genérico de um MA(q). Todas as autocovariâncias de ordem maior do que <span class="math inline">\(q\)</span> serão iguais a zero.</p>
<p><span class="math display">\[
y_{t} = \epsilon_{t} + \theta_{1}\epsilon_{t - 1} + \theta_{2}\epsilon_{t - 2} + \dots + \theta_{q}\epsilon_{t - q}
\]</span></p>
<p>Onde <span class="math inline">\(\epsilon_{t} \sim RB(0, \sigma^{2})\)</span>. A esperança será independente do tempo pois,</p>
<span class="math display">\[\begin{align}
  \mathbb{E}(y_{t}) &amp; = \mathbb{E}(\epsilon_{t} + \theta_{1}\epsilon_{t - 1} + \theta_{2}\epsilon_{t - 2} + \dots + \theta_{q}\epsilon_{t - q})\\
                   &amp; = \mathbb{E}(\epsilon_{t}) + \theta_{1}\mathbb{E}(\epsilon_{t-1}) + \theta_{2}\mathbb{E}(\epsilon_{t-2}) + \dots + \theta_{q}\mathbb{E}(\epsilon_{t-q}) \\
                   &amp; = 0
\end{align}\]</span>
<p>A autocovariância também só depende da distância.</p>
<span class="math display">\[\begin{align}
\mathbb{E}(y_{t}^{2}) &amp; = \mathbb{E}\left  \{ (\epsilon_{t} + \theta_{1}\epsilon_{t - 1} + \theta_{2}\epsilon_{t - 2} + \dots + \theta_{q}\epsilon_{t - q})^2\right \} \\
                      &amp; = \mathbb{E}\left \{ \epsilon_{t}^2 + (\theta_{1}\epsilon_{t - 1})^2 + (\theta_{2}\epsilon_{t - 2})^2 + \dots + (\theta_{q}\epsilon_{t - q})^2 + \dots)\right \} \\
                      &amp; = \sigma^{2} + \theta_{1}^{2}\sigma^{2} + \theta_{2}^{2}\sigma^{2} + \dots + \theta_{q}^{2}\sigma^{2} \\
                      &amp; = \sigma^{2} (1 + \theta_{1}^{2} + \theta_{2}^{2} + \dots + \theta_{q}^{2})
\end{align}\]</span>
<span class="math display">\[\begin{align}
\mathbb{E}(y_{t}y_{t - k}) &amp; = \mathbb{E}\left \{ (\epsilon_{t} + \theta_{1}\epsilon_{t - 1} + \theta_{2}\epsilon_{t - 2} + \dots + \theta_{q}\epsilon_{t - q}) (\epsilon_{t - k} + \theta_{1}\epsilon_{t - k - 1} + \theta_{2}\epsilon_{t - k - 2} + \dots + \theta_{q}\epsilon_{t - k - q})\right \} \\
                      &amp; = \mathbb{E} ( \theta_{k}\epsilon_{t - k}^2 + \theta_{1}\theta_{k + 1}\epsilon_{t - 1}^2 + \theta_{2}\theta_{k - 2}\epsilon_{t - 2}^2 + \dots + \theta_{q - k}\theta_{q}\epsilon_{t - q})^2 \\
                      &amp; = \theta_{k}\sigma^{2} + \theta_{1}\theta_{k - 1}\sigma^{2} + \theta_{2}\theta_{k - 2}\sigma^{2} + \dots + \theta_{q}\theta_{k - q}\sigma^{2} \\
                      &amp; = \sigma^{2} (1 + \theta_{1}^{2} + \theta_{2}^{2} + \dots + \theta_{q}^{2})
\end{align}\]</span>
<p>Contudo é preciso verificar a condição de invertibilidade. Tome o caso mais simples do MA(1) sem constante. Usando o operador defasagem podemos ver que:</p>
<span class="math display">\[\begin{align}
  y_{t} &amp; = \epsilon_{t} + \theta\epsilon_{t - 1} \\
  y_{t} &amp; = \epsilon_{t} + \theta L\epsilon_{t} \\
  y_{t} &amp; = \epsilon_{t} \\
  \frac{y_{t}}{1 + \theta L} &amp; = \epsilon_{t} \\
\end{align}\]</span>
<p>Agora vemos que <span class="math display">\[\begin{align}
\epsilon_{t} &amp; = \frac{y_{t}}{(1 - (-\theta L)} \\
             &amp; = y_{t} + (-\theta L)y_{t} + (-\theta L)^2y_{t} + (-\theta L)^3y_{t} + \dots \\
             &amp; = y_{t} -\theta y_{t-1} + \theta^2y_{t-2} -\theta^3y_{t-3} + \dots \\
             &amp; = \sum_{i = 0}^{\infty} (-\theta)^{i}y_{t - i}
\end{align}\]</span></p>
<p>Novamente, a condição para que a soma infinita acima convergente é que <span class="math inline">\(| \theta | &lt; 1\)</span>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="viniciusoike/restateinsight" data-repo-id="R_kgDOJ9Lnfw" data-category="General" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>