<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Vinicius Oike</title>
<link>https:://www.restateinsight.com/blog.html</link>
<atom:link href="https:://www.restateinsight.com/blog.xml" rel="self" type="application/rss+xml"/>
<description>A blog on economics and cities</description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Sun, 03 Sep 2023 03:00:00 GMT</lastBuildDate>
<item>
  <title>Mapa de altitude de ruas de Brasília</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/2022-09-brasilia/index.html</link>
  <description><![CDATA[ 




<p>Inspirado num antigo post de <a href="https://www.blakerobertmills.com/my-work/visualizations">BlakeRMills</a>, criador do pacote <a href="https://github.com/BlakeRMills/MetBrewer">{MetBrewer}</a>, criei um mapa com a altitude das ruas em Brasília.</p>
<p>Em breve farei um post com tutorial detalhado e também pretendo replicar este tipo de mapa para outras cidades interessantes. O código para replicar o gráfico está abaixo.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(osmdata)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(purrr)</span>
<span id="cb1-6">sf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_use_s2</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb1-7">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>)</span>
<span id="cb1-8">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb1-9"></span>
<span id="cb1-10">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://pt.wikipedia.org/wiki/Lista_de_municípios_do_Brasil_por_população"</span></span>
<span id="cb1-11"></span>
<span id="cb1-12">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> xml2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>(url) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-13">  rvest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_table</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-14">  purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pluck</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-15"></span>
<span id="cb1-16">as_numeric_char <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vectorize</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb1-17">  ls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract_all</span>(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[[:digit:]]"</span>)</span>
<span id="cb1-18">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(ls[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb1-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(y)</span>
<span id="cb1-20">})</span>
<span id="cb1-21"></span>
<span id="cb1-22">clean_tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> tab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-23">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb1-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code_muni =</span> codigo_ibge,</span>
<span id="cb1-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name_muni =</span> municipio,</span>
<span id="cb1-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> posicao,</span>
<span id="cb1-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name_state =</span> unidade_federativa,</span>
<span id="cb1-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop =</span> populacao</span>
<span id="cb1-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(name_muni <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brasil"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb1-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code_muni =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(code_muni),</span>
<span id="cb1-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_numeric_char</span>(pop),</span>
<span id="cb1-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rank</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>pop)</span>
<span id="cb1-36">  )</span>
<span id="cb1-37"></span>
<span id="cb1-38">top20 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(clean_tab, pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb1-39"></span>
<span id="cb1-40">get_border <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(city) {</span>
<span id="cb1-41">  </span>
<span id="cb1-42">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Encontra o código do município</span></span>
<span id="cb1-43">  code_muni <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> top20 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-44">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(name_muni <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> city) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-45">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(code_muni) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-46">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb1-47">  </span>
<span id="cb1-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stopifnot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(code_muni) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-49">  </span>
<span id="cb1-50">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Baixa o shapefile do município</span></span>
<span id="cb1-51">  border <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> geobr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_municipality</span>(code_muni, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showProgress =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb1-52">  </span>
<span id="cb1-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(border)</span>
<span id="cb1-54">}</span>
<span id="cb1-55"></span>
<span id="cb1-56">get_streets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(city, border) {</span>
<span id="cb1-57">  </span>
<span id="cb1-58">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Encontra o nome da Unidade Federativa</span></span>
<span id="cb1-59">  nome_uf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> top20 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-60">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(name_muni <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> city) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-61">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(name_state)</span>
<span id="cb1-62">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Monta o nome do local</span></span>
<span id="cb1-63">  name_place <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{city}, {nome_uf}, Brazil"</span>)</span>
<span id="cb1-64">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Monta a query</span></span>
<span id="cb1-65">  place <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bbox =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getbb</span>(name_place))</span>
<span id="cb1-66">  </span>
<span id="cb1-67">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Importa todas as principais vias da cidade</span></span>
<span id="cb1-68">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># streets = add_osm_feature(</span></span>
<span id="cb1-69">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   place,</span></span>
<span id="cb1-70">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   key = "highway",</span></span>
<span id="cb1-71">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   value = c(</span></span>
<span id="cb1-72">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "motorway", "primary", "motorway_link", "primary_link",</span></span>
<span id="cb1-73">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "secondary", "tertiary", "secondary_link", "tertiary_link",</span></span>
<span id="cb1-74">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "residential"</span></span>
<span id="cb1-75">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     )</span></span>
<span id="cb1-76">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb1-77">  </span>
<span id="cb1-78">  streets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_osm_feature</span>(place, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"highway"</span>)</span>
<span id="cb1-79">  </span>
<span id="cb1-80">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Converte o dado</span></span>
<span id="cb1-81">  streets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> streets <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-82">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">osmdata_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-83">    .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>osm_lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-84">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(osm_id, name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-85">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4674</span>)</span>
<span id="cb1-86">  </span>
<span id="cb1-87">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Enconrtra a intersecção entre as estradas e o limites do município</span></span>
<span id="cb1-88">  streets_border <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(streets, border)</span>
<span id="cb1-89">  </span>
<span id="cb1-90">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># out = list(streets = streets, streets_border = streets_border)</span></span>
<span id="cb1-91">  </span>
<span id="cb1-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(streets_border)</span>
<span id="cb1-93">  </span>
<span id="cb1-94">}</span>
<span id="cb1-95"></span>
<span id="cb1-96">get_elevation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(border, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) {</span>
<span id="cb1-97">  </span>
<span id="cb1-98">  altitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> elevatr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_elev_raster</span>(border, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bbox"</span>)</span>
<span id="cb1-99">  altitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> raster<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterToPolygons</span>(altitude)</span>
<span id="cb1-100">  altitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(altitude)</span>
<span id="cb1-101">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(altitude)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elevation"</span></span>
<span id="cb1-102">  </span>
<span id="cb1-103">  altitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(altitude, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4674</span>)</span>
<span id="cb1-104">  altitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">suppressWarnings</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(altitude, border))</span>
<span id="cb1-105">  altitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(altitude, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_valid</span>(altitude))</span>
<span id="cb1-106">  </span>
<span id="cb1-107">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(altitude)</span>
<span id="cb1-108">  </span>
<span id="cb1-109">}</span>
<span id="cb1-110"></span>
<span id="cb1-111">add_jenks_breaks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(shp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">round =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb1-112">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Classifica os dados de altitude em k grupos segundo o algo. de Jenks</span></span>
<span id="cb1-113">  jbreaks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> BAMMtools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getJenksBreaks</span>(shp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>elevation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k =</span> k)</span>
<span id="cb1-114">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Arredonda os números para chegar numa legenda menos quebrada</span></span>
<span id="cb1-115">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (round) {</span>
<span id="cb1-116">    jbreaks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(jbreaks, r)</span>
<span id="cb1-117">  }</span>
<span id="cb1-118">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Cria a coluna 'jenks_group' que classifica cada valor num grupo</span></span>
<span id="cb1-119">  shp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(shp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">jenks_group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(elevation, jbreaks))</span>
<span id="cb1-120">  </span>
<span id="cb1-121">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Verifica se todas as observações tem um grupo</span></span>
<span id="cb1-122">  check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(shp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>jenks_group))</span>
<span id="cb1-123">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (check) {</span>
<span id="cb1-124">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Some observations have failed to be grouped"</span>)</span>
<span id="cb1-125">  }</span>
<span id="cb1-126">  </span>
<span id="cb1-127">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Transforma os groups em legendas</span></span>
<span id="cb1-128">  labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_jenks_labels</span>(jbreaks)</span>
<span id="cb1-129">  </span>
<span id="cb1-130">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Retorna o output numa lista</span></span>
<span id="cb1-131">  out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shp =</span> shp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> labels)</span>
<span id="cb1-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(out)</span>
<span id="cb1-133">  </span>
<span id="cb1-134">}</span>
<span id="cb1-135"></span>
<span id="cb1-136">get_jenks_labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb1-137">  labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(x, x[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"–"</span>)</span>
<span id="cb1-138">  labels[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;"</span>, x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb1-139">  labels[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(labels)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(x))</span>
<span id="cb1-140">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(labels)</span>
<span id="cb1-141">}</span>
<span id="cb1-142"></span>
<span id="cb1-143">get_streets_altitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(altitude, streets) {</span>
<span id="cb1-144">  </span>
<span id="cb1-145">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stopifnot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(altitude) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jenks_group"</span>))</span>
<span id="cb1-146">  </span>
<span id="cb1-147">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Get all groups</span></span>
<span id="cb1-148">  groups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(altitude<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>jenks_group)</span>
<span id="cb1-149">  </span>
<span id="cb1-150">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; For each group get the full polygon and join with streets</span></span>
<span id="cb1-151">  join_streets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(group) {</span>
<span id="cb1-152">    </span>
<span id="cb1-153">    poly <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> altitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-154">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(jenks_group <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> group) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-155">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(.) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-156">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-157">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_make_valid</span>()</span>
<span id="cb1-158">    </span>
<span id="cb1-159">    joined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">suppressWarnings</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(streets, poly))</span>
<span id="cb1-160">    </span>
<span id="cb1-161">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(joined)</span>
<span id="cb1-162">    </span>
<span id="cb1-163">  }</span>
<span id="cb1-164">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Apply the function to all groups</span></span>
<span id="cb1-165">  street_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(groups, join_streets)</span>
<span id="cb1-166">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Bind all results together</span></span>
<span id="cb1-167">  out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(street_levels, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"level"</span>)</span>
<span id="cb1-168">  </span>
<span id="cb1-169">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(out)</span>
<span id="cb1-170">  </span>
<span id="cb1-171">}</span>
<span id="cb1-172"></span>
<span id="cb1-173">map_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(shp, labels, title, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showtext =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) {</span>
<span id="cb1-174">  </span>
<span id="cb1-175">  colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> viridis<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plasma</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(labels) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-176">  colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> colors[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(colors)]</span>
<span id="cb1-177">  </span>
<span id="cb1-178">  font <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(showtext <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sans"</span>)</span>
<span id="cb1-179">  </span>
<span id="cb1-180">  plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span></span>
<span id="cb1-181">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> shp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-182">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> level, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> level), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-183">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(</span>
<span id="cb1-184">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Altitude"</span>,</span>
<span id="cb1-185">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> labels,</span>
<span id="cb1-186">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-187">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb1-188">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Altitude"</span>,</span>
<span id="cb1-189">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> labels,</span>
<span id="cb1-190">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-191">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-192">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(title) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-193">    ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-194">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-195">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb1-196">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb1-197">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb1-198">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb1-199">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> font</span>
<span id="cb1-200">      ),</span>
<span id="cb1-201">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb1-202">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb1-203">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> font,</span>
<span id="cb1-204">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray10"</span></span>
<span id="cb1-205">      ),</span>
<span id="cb1-206">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb1-207">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,</span>
<span id="cb1-208">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> font,</span>
<span id="cb1-209">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray10"</span></span>
<span id="cb1-210">      ),</span>
<span id="cb1-211">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb1-212">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horizontal"</span>,</span>
<span id="cb1-213">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f6eee3"</span>),</span>
<span id="cb1-214">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f6eee3"</span>),</span>
<span id="cb1-215">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f6eee3"</span>)</span>
<span id="cb1-216">    )</span>
<span id="cb1-217">  </span>
<span id="cb1-218">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(plot)</span>
<span id="cb1-219">  </span>
<span id="cb1-220">}</span>
<span id="cb1-221"></span>
<span id="cb1-222">map_altitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(city, k, z) {</span>
<span id="cb1-223">  </span>
<span id="cb1-224">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Importa o shape do limite do município</span></span>
<span id="cb1-225">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Importando os limites do município: "</span>, city)</span>
<span id="cb1-226">  city_border <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_border</span>(city)</span>
<span id="cb1-227">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Importa as principais vias da cidade e junta com o limite do muni</span></span>
<span id="cb1-228">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Importando as vias."</span>)</span>
<span id="cb1-229">  city_street <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_streets</span>(city, city_border)</span>
<span id="cb1-230">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Importa a altitude da cidade</span></span>
<span id="cb1-231">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Importando a altitude."</span>)</span>
<span id="cb1-232">  city_elevation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">suppressMessages</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_elevation</span>(city_border, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z))</span>
<span id="cb1-233">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Classifica a altitude em grupos</span></span>
<span id="cb1-234">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Classificando e juntando os shapefiles."</span>)</span>
<span id="cb1-235">  jenks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_jenks_breaks</span>(city_elevation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k =</span> k)</span>
<span id="cb1-236">  city_elevation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> jenks[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shp"</span>]]</span>
<span id="cb1-237">  labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> jenks[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"labels"</span>]]</span>
<span id="cb1-238">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Junta a altitude (agrupada) com as vias</span></span>
<span id="cb1-239">  city_street_elevation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_streets_altitude</span>(city_elevation, city_street)</span>
<span id="cb1-240">  </span>
<span id="cb1-241">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Monta o mapa final</span></span>
<span id="cb1-242">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gerando o mapa final."</span>)</span>
<span id="cb1-243">  plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_plot</span>(city_street_elevation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> labels, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> city)</span>
<span id="cb1-244">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Feito."</span>)</span>
<span id="cb1-245">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Retorna o output numa lista</span></span>
<span id="cb1-246">  out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb1-247">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shp =</span> city_street_elevation,</span>
<span id="cb1-248">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">streets =</span> city_street,</span>
<span id="cb1-249">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation =</span> city_elevation,</span>
<span id="cb1-250">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> plot</span>
<span id="cb1-251">  )</span>
<span id="cb1-252">  </span>
<span id="cb1-253">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(out)</span>
<span id="cb1-254">  </span>
<span id="cb1-255">}</span>
<span id="cb1-256"></span>
<span id="cb1-257">export_citymap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(city, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, ...) {</span>
<span id="cb1-258">  </span>
<span id="cb1-259">  plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_altitude</span>(city, ...)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot</span>
<span id="cb1-260">  </span>
<span id="cb1-261">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.numeric</span>(city)) {</span>
<span id="cb1-262">    name_city <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> cities_brasil <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-263">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(code_muni <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> city) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-264">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(name_muni)</span>
<span id="cb1-265">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(city)) {</span>
<span id="cb1-266">    name_city <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> city</span>
<span id="cb1-267">  }</span>
<span id="cb1-268">  </span>
<span id="cb1-269">  name_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(</span>
<span id="cb1-270">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elevation_{janitor::make_clean_names(name_city)}.svg"</span></span>
<span id="cb1-271">  )</span>
<span id="cb1-272">  </span>
<span id="cb1-273">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb1-274">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"graphics/altitude"</span>, name_file),</span>
<span id="cb1-275">    plot,</span>
<span id="cb1-276">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> w,</span>
<span id="cb1-277">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> h</span>
<span id="cb1-278">  )</span>
<span id="cb1-279">  </span>
<span id="cb1-280">  name_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(</span>
<span id="cb1-281">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elevation_{janitor::make_clean_names(name_city)}.png"</span></span>
<span id="cb1-282">  )</span>
<span id="cb1-283">  </span>
<span id="cb1-284">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb1-285">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"graphics/altitude"</span>, name_file),</span>
<span id="cb1-286">    plot,</span>
<span id="cb1-287">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> w,</span>
<span id="cb1-288">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> h</span>
<span id="cb1-289">  )</span>
<span id="cb1-290">}</span>
<span id="cb1-291"></span>
<span id="cb1-292">safe_export <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">safely</span>(export_citymap)</span>
<span id="cb1-293"></span>
<span id="cb1-294">params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(</span>
<span id="cb1-295">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>city,       <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>z, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>k,</span>
<span id="cb1-296">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#----------------#---#---#</span></span>
<span id="cb1-297">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"São Paulo"</span>,       <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-298">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rio de Janeiro"</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-299">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brasília"</span>,        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-300">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fortaleza"</span>,      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-301">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Salvador"</span>,       <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-302">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Belo Horizonte"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-303">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manaus"</span>,          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-304">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Curitiba"</span>,       <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-305">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Recife"</span>,         <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-306">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Goiânia"</span>,         <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-307">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Porto Alegre"</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-308">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Belém"</span>,           <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-309">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Guarulhos"</span>,       <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-310">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Campinas"</span>,        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-311">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"São Luís"</span>,        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-312">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maceió"</span>,         <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb1-313">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Campo Grande"</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-314">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"São Gonçalo"</span>,     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-315">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Teresina"</span>,        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-316">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"João Pessoa"</span>,     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb1-317">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Joinville"</span>,       <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb1-318">  )</span>
<span id="cb1-319"></span>
<span id="cb1-320"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Exportar todas as cidades listadas acima</span></span>
<span id="cb1-321"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pmap(params, safe_export)</span></span>
<span id="cb1-322"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Exportar uma cidade em particular</span></span>
<span id="cb1-323"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#safe_export("Brasília", z = 8, k = 7)</span></span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/2022-09-brasilia/images/elevation_brasilia.svg" class="img-fluid figure-img"></p>
</figure>
</div>



 ]]></description>
  <category>data-visualization</category>
  <category>mapas</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/2022-09-brasilia/index.html</guid>
  <pubDate>Sun, 03 Sep 2023 03:00:00 GMT</pubDate>
</item>
<item>
  <title>Weekly Viz: Recife em mapas</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/2022-08-recife/index.html</link>
  <description><![CDATA[ 




<section id="recife" class="level1">
<h1>Recife</h1>
<p>Semana que vem vou estar no Recife a trabalho e para conhecer um pouco da cidade resolvi tirar um tempo para fazer alguns mapas da cidade.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_recife.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<section id="detalhes-do-mapa" class="level2">
<h2 class="anchored" data-anchor-id="detalhes-do-mapa">Detalhes do mapa</h2>
<p>Os dados dos dois primeiros mapas, das principais vias e dos corpos d’água, são do <a href="OpenStreetMap OpenStreetMap https://www.openstreetmap.org">OpenStreetMap</a>. Pode-se ver, por exemplo, a Rodovia Mario Covas, que corta a cidade de norte a sul e o famoso Rio Capibaribe que atravessa a cidade.</p>
<p>Para o terceiro mapa puxei os dados do <a href="https://ciclomapa.org.br/?lat=-8.0584930&amp;lng=-34.8848190&amp;z=12.00">Ciclomapa</a>. Apesar do título, eu incluí tanto ciclovias, ciclofaixas e ciclorrotas.</p>
<p>Os mapas da segunda linha foram todos feitos com dados do projeto de <a href="https://github.com/ipeaGIT/aopdata">Acesso a Oportunidades</a> do IPEA. Os dados de população e renda são do Censo de 2010 e espacialmente interpolados com os hexágonos H3, da Uber. Para facilitar a visualização usei o algoritmo de Jenks para agrupar os dados em 7 grupos. Além disso, usei uma transformação log tanto na renda como na população para reduzir um pouco da variância nos dados.</p>
<p>A renda da cidade é visivelmente concentrada na região sul-sudeste, próxima do litoral e na região centro-leste, no que me parece ser a região dos bairros Madalena e Boa Vista. Já a densidade populacional não segue um padrão simples; a população está espalhada por toda a cidade.</p>
<p>Como medida de acesso a empregos usei o percentual de oportunidades de emprego acessíveis a 15 minutos de carro em horário de pico. Segundo os dados do Censo, a maior parte dos deslocamentos casa-trabalho na RM de Recife são de menos de uma hora (83,4%). Assim, 15 minutos de carro (em horário de pico) me parece ser um “luxo” que as pessoas estão dispostas a pagar e que deve se refletir, em algum nível, no preço dos imóveis.</p>
<p>O mapa sugere que Recife é uma cidade monocêntrica, com a maior parte dos empregos concentrada na região central. Interessante notar que, apesar da distância geográfica, a região sul, de Boa Viagem, Pina, etc. continua com indicadores de acessibilidade relativamente altos.</p>
<p>Para tentar mensurar a verticalização calculei a proporção de apartamentos em relação ao total de domicílios em cada região. Novamente os dados vem do Censo e são agrupados a nível de setor censitário. Eu faço uma interpolação espacial simples com os hexágonos H3, na mesma resolução 9 do projeto do IPEA, para manter o padrão. Grosso modo, parece que as regiões de rendas mais altas coincidem com as regiões mais verticalizadas.</p>
<p>Por fim, os dados de anúncios e preço provém de anúncios online de venda de imóveis ativos entre janeiro e junho de 2023. Por simplicidade, eu escolhi trabalhar apenas com anúncios de apartamentos e removi algumas observações discrepantes para conseguir um valor médio mais razoável. O preço médio observado na cidade neste período foi de R$7.900, com a maior parte das observações caindo dentro do intervalo R$3.800-R$12.700.</p>
</section>
<section id="mapas" class="level2">
<h2 class="anchored" data-anchor-id="mapas">Mapas</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_rec_1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_rec_2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_rec_3.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_rec_4.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_rec_5.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_rec_6.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_rec_7.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/maps/summary_rec_8.svg" class="img-fluid figure-img"></p>
</figure>
</div>


</section>
</section>

 ]]></description>
  <guid>https:://www.restateinsight.com/posts/general-posts/2022-08-recife/index.html</guid>
  <pubDate>Wed, 23 Aug 2023 03:00:00 GMT</pubDate>
</item>
<item>
  <title>O impacto dos juros na demanda imobiliário</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/2023-08-juros-affordability/index.html</link>
  <description><![CDATA[ 




<section id="juros-e-financiamento-imobiliário" class="level1">
<h1>Juros e financiamento imobiliário</h1>
<p>A taxa de juros é talvez a variável macroeconômica mais importante para se observar quando se pensa em financiamento imobiliário. Quanto maior for a taxa de juros, mais “caro” fica o financiamento habitacional. Ou seja, mais difícil fica de comprar um imóvel.</p>
<p>O financiamento imobiliário nada mais é do que um empréstimo que uma família contrai com o sistema financeiro (um banco); este empréstimo é uma dívida que a família deve repagar em parcelas mensais e sobre cada pagamento incide um valor de juros.</p>
<section id="um-pouco-sobre-juros" class="level2">
<h2 class="anchored" data-anchor-id="um-pouco-sobre-juros">Um pouco sobre juros</h2>
<p>A taxa de juros tem um efeito geral sobre a economia, mas o seu efeito é mais notável para o consumidor na hora de fazer compras grandes, de longo prazo: caso de um automóvel ou de um imóvel. Uma taxa menor significa que fica mais “barato” tomar crédito, enquanto uma taxa maior significa o contrário.</p>
<p>Quem define a taxa de juros “geral” da economia, a taxa SELIC, é o Cômite de Política Monetária (COPOM). A SELIC é, na verdade, uma meta de taxa de juros, que o Banco Central do Brasil (BCB) deve perseguir. O COPOM se reúne periodicamente para definir a taxa SELIC; na ocasião mais recente, no início de agosto, decidiu-se reduzir a taxa de 13,75% a.a. para 13,25% a.a. - a primeira queda depois de um ciclo de alta de 3 anos.</p>
<p>Tipicamente, a taxa de juros é a ferramenta de política monetária que se usa para controlar a inflação: quando a taxa de inflação aumenta muito, o COPOM decide aumentar a taxa de juros. Foi isto o que aconteceu em 2014-16 e também em 2021-23.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/2023-08-juros-affordability/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>O gráfico acima mostra as oscilações recentes da SELIC. No final de 2016 encerrou-se um longo ciclo de alta que começou em reação à escalada da inflação em 2014. A taxa, então, chegou a cair até 2% a.a. no final de 2020, acompanhando a tendência internacional de taxas de juros baixíssimas, muito próximas de 0% a.a. A volta da inflação com a pandemia levou o COPOM a agressivamente aumentar a taxa SELIC nos meses seguintes. A taxa manteve-se estável em 13,75% a.a. desde agosto do ano passado.</p>
<p>A taxa SELIC influencia as demais taxas de juros da economia indiretamente. Como será mostrado mais adiante, há várias taxas de financiamento imobiliário disponíveis.</p>
</section>
</section>
<section id="financiamento-de-um-imóvel" class="level1">
<h1>Financiamento de um imóvel</h1>
<p>O típico financiamento de um imóvel envolve o pagamento de um valor de entrada e a contratação de uma dívida que será paga mensalmente ao longo de um período de tempo, tipicamente em torno de 25 a 30 anos. A modalidade de financiamento mais comum envolve um sistema de parcelas decrescentes com amortização constante, chamado, assim, de Sistema de Amortização Constante (SAC).</p>
<p>A matemática por trás deste sistema é bastante simples. Do preço do imóvel <img src="https://latex.codecogs.com/png.latex?P"> subtraí-se o valor de entrada <img src="https://latex.codecogs.com/png.latex?E">. O valor restante forma a dívida <img src="https://latex.codecogs.com/png.latex?D%20=%20P-E"> que deve ser paga de volta. A razão entre estes valores é chamada de “loan-to-value ratio” (LTV), isto é <img src="https://latex.codecogs.com/png.latex?LTV%20=%20%5Cfrac%7BD%7D%7BP%7D%20=%20%5Cfrac%7BP-E%7D%7BP%7D%20=%201-%5Cfrac%7BE%7D%7BP%7D">.</p>
<p>Valores comuns de LTV giram em torno de 70-80%, mas isto varia bastante. Um LTV de 80%, essencialmente, significa que o devedor pagou 20% do valor de imóvel como entrada; assim, um <em>LTV alto</em> significa um <em>valor de entrada baixo</em> e uma <em>dívida grande</em>; inversamente, um <em>LTV baixo</em> significa um <em>valor entrada elevado</em> e uma <em>dívida pequena</em>.</p>
<p>No típico financiamento SAC, o valor da dívida é amortizado em “parcelas” constantes, isto é, o valor da amortização é <img src="https://latex.codecogs.com/png.latex?A%20=%20D%20/%20N"> onde <img src="https://latex.codecogs.com/png.latex?N"> é o número de períodos do financiamento. No caso de um financiamento de 30 anos com pagamentos mensais, <img src="https://latex.codecogs.com/png.latex?A%20=%20%5Cfrac%7BD%7D%7B360%7D">.</p>
<p>O pagamento de juros que incide sobre a dívida costuma ser a soma de uma parcela pré-fixada com uma parte variável, atrelada a algum indexador monetário. O caso mais comum é de uma parte fixa (e.g.&nbsp;8,99%) somada à TR (taxa referencial)<sup>1</sup>. O valor da TR depende de outros fatores, mas não costuma passar de 0,2% a.m.</p>
<section id="exemplo-guiado" class="level2">
<h2 class="anchored" data-anchor-id="exemplo-guiado">Exemplo Guiado</h2>
<section id="o-empréstimo" class="level3">
<h3 class="anchored" data-anchor-id="o-empréstimo">O empréstimo</h3>
<p>Vamos simular o financiamento de um imóvel de R$450.000. Supondo um LTV de 80%, o valor da entrada é de R$90.000 e o valor a ser financiado, portanto, é de R$360.000. Num contrato de 30 anos, o valor da amortização é de:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cfrac%7BR%5C$360.000%7D%7BR%5C$360%7D%20=%20R%5C$1.000%0A"></p>
<p>Vamos começar assumindo que a taxa de juros seja de 10% a.a. A tabela abaixo mostra o fluxo de pagamentos do primeiro ano do empréstimo. Note como o valor da amortização é sempre o mesmo. À medida que a dívida vai sendo paga, o valor cobrado de juros também diminui e, por conseguinte, diminui também o valor da parcela mensal.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div id="txqaswsdov" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#txqaswsdov table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#txqaswsdov thead, #txqaswsdov tbody, #txqaswsdov tfoot, #txqaswsdov tr, #txqaswsdov td, #txqaswsdov th {
  border-style: none;
}

#txqaswsdov p {
  margin: 0;
  padding: 0;
}

#txqaswsdov .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #D5D5D5;
  border-right-style: solid;
  border-right-width: 3px;
  border-right-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #D5D5D5;
  border-left-style: solid;
  border-left-width: 3px;
  border-left-color: #D5D5D5;
}

#txqaswsdov .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#txqaswsdov .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#txqaswsdov .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#txqaswsdov .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#txqaswsdov .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#txqaswsdov .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#txqaswsdov .gt_col_heading {
  color: #FFFFFF;
  background-color: #016763;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#txqaswsdov .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #016763;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#txqaswsdov .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#txqaswsdov .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#txqaswsdov .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#txqaswsdov .gt_spanner_row {
  border-bottom-style: hidden;
}

#txqaswsdov .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#txqaswsdov .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  vertical-align: middle;
}

#txqaswsdov .gt_from_md > :first-child {
  margin-top: 0;
}

#txqaswsdov .gt_from_md > :last-child {
  margin-bottom: 0;
}

#txqaswsdov .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D5D5D5;
  border-left-style: solid;
  border-left-width: 1px;
  border-left-color: #D5D5D5;
  border-right-style: solid;
  border-right-width: 1px;
  border-right-color: #D5D5D5;
  vertical-align: middle;
  overflow-x: hidden;
}

#txqaswsdov .gt_stub {
  color: #FFFFFF;
  background-color: #929292;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D5D5D5;
  padding-left: 5px;
  padding-right: 5px;
}

#txqaswsdov .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#txqaswsdov .gt_row_group_first td {
  border-top-width: 2px;
}

#txqaswsdov .gt_row_group_first th {
  border-top-width: 2px;
}

#txqaswsdov .gt_summary_row {
  color: #FFFFFF;
  background-color: #5F5F5F;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#txqaswsdov .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D5D5D5;
}

#txqaswsdov .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#txqaswsdov .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#txqaswsdov .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #929292;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#txqaswsdov .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D5D5D5;
}

#txqaswsdov .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D5D5D5;
}

#txqaswsdov .gt_striped {
  background-color: #F4F4F4;
}

#txqaswsdov .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#txqaswsdov .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#txqaswsdov .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#txqaswsdov .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#txqaswsdov .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#txqaswsdov .gt_left {
  text-align: left;
}

#txqaswsdov .gt_center {
  text-align: center;
}

#txqaswsdov .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#txqaswsdov .gt_font_normal {
  font-weight: normal;
}

#txqaswsdov .gt_font_bold {
  font-weight: bold;
}

#txqaswsdov .gt_font_italic {
  font-style: italic;
}

#txqaswsdov .gt_super {
  font-size: 65%;
}

#txqaswsdov .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#txqaswsdov .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#txqaswsdov .gt_indent_1 {
  text-indent: 5px;
}

#txqaswsdov .gt_indent_2 {
  text-indent: 10px;
}

#txqaswsdov .gt_indent_3 {
  text-indent: 15px;
}

#txqaswsdov .gt_indent_4 {
  text-indent: 20px;
}

#txqaswsdov .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption>Fluxo de pagamento do financiamento de um imóvel de 450.000 (SAC).</caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Período (mês)">Período (mês)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Amortização">Amortização</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Juros">Juros</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Parcela">Parcela</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Dívida">Dívida</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="periodo" class="gt_row gt_right">1</td>
<td headers="amort" class="gt_row gt_right">R$1.000</td>
<td headers="juros" class="gt_row gt_right">R$2.870,69</td>
<td headers="pmt" class="gt_row gt_right">R$3.870,69</td>
<td headers="divida" class="gt_row gt_right">R$360.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right gt_striped">2</td>
<td headers="amort" class="gt_row gt_right gt_striped">R$1.000</td>
<td headers="juros" class="gt_row gt_right gt_striped">R$2.862,72</td>
<td headers="pmt" class="gt_row gt_right gt_striped">R$3.862,72</td>
<td headers="divida" class="gt_row gt_right gt_striped">R$359.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right">3</td>
<td headers="amort" class="gt_row gt_right">R$1.000</td>
<td headers="juros" class="gt_row gt_right">R$2.854,74</td>
<td headers="pmt" class="gt_row gt_right">R$3.854,74</td>
<td headers="divida" class="gt_row gt_right">R$358.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right gt_striped">4</td>
<td headers="amort" class="gt_row gt_right gt_striped">R$1.000</td>
<td headers="juros" class="gt_row gt_right gt_striped">R$2.846,77</td>
<td headers="pmt" class="gt_row gt_right gt_striped">R$3.846,77</td>
<td headers="divida" class="gt_row gt_right gt_striped">R$357.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right">5</td>
<td headers="amort" class="gt_row gt_right">R$1.000</td>
<td headers="juros" class="gt_row gt_right">R$2.838,79</td>
<td headers="pmt" class="gt_row gt_right">R$3.838,79</td>
<td headers="divida" class="gt_row gt_right">R$356.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right gt_striped">6</td>
<td headers="amort" class="gt_row gt_right gt_striped">R$1.000</td>
<td headers="juros" class="gt_row gt_right gt_striped">R$2.830,82</td>
<td headers="pmt" class="gt_row gt_right gt_striped">R$3.830,82</td>
<td headers="divida" class="gt_row gt_right gt_striped">R$355.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right">7</td>
<td headers="amort" class="gt_row gt_right">R$1.000</td>
<td headers="juros" class="gt_row gt_right">R$2.822,85</td>
<td headers="pmt" class="gt_row gt_right">R$3.822,85</td>
<td headers="divida" class="gt_row gt_right">R$354.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right gt_striped">8</td>
<td headers="amort" class="gt_row gt_right gt_striped">R$1.000</td>
<td headers="juros" class="gt_row gt_right gt_striped">R$2.814,87</td>
<td headers="pmt" class="gt_row gt_right gt_striped">R$3.814,87</td>
<td headers="divida" class="gt_row gt_right gt_striped">R$353.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right">9</td>
<td headers="amort" class="gt_row gt_right">R$1.000</td>
<td headers="juros" class="gt_row gt_right">R$2.806,90</td>
<td headers="pmt" class="gt_row gt_right">R$3.806,90</td>
<td headers="divida" class="gt_row gt_right">R$352.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right gt_striped">10</td>
<td headers="amort" class="gt_row gt_right gt_striped">R$1.000</td>
<td headers="juros" class="gt_row gt_right gt_striped">R$2.798,92</td>
<td headers="pmt" class="gt_row gt_right gt_striped">R$3.798,92</td>
<td headers="divida" class="gt_row gt_right gt_striped">R$351.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right">11</td>
<td headers="amort" class="gt_row gt_right">R$1.000</td>
<td headers="juros" class="gt_row gt_right">R$2.790,95</td>
<td headers="pmt" class="gt_row gt_right">R$3.790,95</td>
<td headers="divida" class="gt_row gt_right">R$350.000</td></tr>
    <tr><td headers="periodo" class="gt_row gt_right gt_striped">12</td>
<td headers="amort" class="gt_row gt_right gt_striped">R$1.000</td>
<td headers="juros" class="gt_row gt_right gt_striped">R$2.782,98</td>
<td headers="pmt" class="gt_row gt_right gt_striped">R$3.782,98</td>
<td headers="divida" class="gt_row gt_right gt_striped">R$349.000</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Ao longo dos 360 meses do financiamento, o valor dos juros e da parcela vão diminuindo até que a dívida tenha sido totalmente paga. Note como no início do financiamento, a parcela mensal está na faixa de R$3800, mas já no final está próxima de R$1000.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/2023-08-juros-affordability/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="renda-necessária" class="level3">
<h3 class="anchored" data-anchor-id="renda-necessária">Renda necessária</h3>
<p>Agora podemos responder uma dúvida importante: qual a renda necessária para financiar este imóvel? Cada banco ou instituição financeira usa regras próprias para decidir se libera ou não o valor do financiamento imobiliário. Uma regra de bolso comum é de que o valor da parcela inicial não pode ser maior do que 30% da renda do requerente.</p>
<p>No exemplo acima, o valor da primeira parcela é de R$3870. A renda mínima necessária (RMN) para estar elegível a este financiamento é:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ARMN%20=%20%5Cfrac%7BR%5C$%203.870,69%7D%7B0,3%7D%20=%20R%5C$%2012.902,3%0A"></p>
<p>Como que este resultado final depende da taxa de juros? Podemos simular o mesmo financiamento para diferentes taxas juros e calcular novamente a renda mínima necessária. A tabela abaixo mostra como a renda varia para valores de taxa de juros de 7% a 12%. É notável como a taxa de juros tem impacto direto no poder de compra e capacidade de pagamento das famílias. A uma taxa favorável de 7%, é necessário ter uma renda de R$10 mil para ser aprovado no financimento; já a uma taxa de 12% é necessário ter quase R$15 mil.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div id="mpdsdafruc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mpdsdafruc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mpdsdafruc thead, #mpdsdafruc tbody, #mpdsdafruc tfoot, #mpdsdafruc tr, #mpdsdafruc td, #mpdsdafruc th {
  border-style: none;
}

#mpdsdafruc p {
  margin: 0;
  padding: 0;
}

#mpdsdafruc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #D5D5D5;
  border-right-style: solid;
  border-right-width: 3px;
  border-right-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #D5D5D5;
  border-left-style: solid;
  border-left-width: 3px;
  border-left-color: #D5D5D5;
}

#mpdsdafruc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mpdsdafruc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mpdsdafruc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mpdsdafruc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mpdsdafruc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#mpdsdafruc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mpdsdafruc .gt_col_heading {
  color: #FFFFFF;
  background-color: #016763;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mpdsdafruc .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #016763;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mpdsdafruc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mpdsdafruc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mpdsdafruc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mpdsdafruc .gt_spanner_row {
  border-bottom-style: hidden;
}

#mpdsdafruc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mpdsdafruc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  vertical-align: middle;
}

#mpdsdafruc .gt_from_md > :first-child {
  margin-top: 0;
}

#mpdsdafruc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mpdsdafruc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D5D5D5;
  border-left-style: solid;
  border-left-width: 1px;
  border-left-color: #D5D5D5;
  border-right-style: solid;
  border-right-width: 1px;
  border-right-color: #D5D5D5;
  vertical-align: middle;
  overflow-x: hidden;
}

#mpdsdafruc .gt_stub {
  color: #FFFFFF;
  background-color: #929292;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D5D5D5;
  padding-left: 5px;
  padding-right: 5px;
}

#mpdsdafruc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mpdsdafruc .gt_row_group_first td {
  border-top-width: 2px;
}

#mpdsdafruc .gt_row_group_first th {
  border-top-width: 2px;
}

#mpdsdafruc .gt_summary_row {
  color: #FFFFFF;
  background-color: #5F5F5F;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mpdsdafruc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D5D5D5;
}

#mpdsdafruc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mpdsdafruc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#mpdsdafruc .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #929292;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mpdsdafruc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D5D5D5;
}

#mpdsdafruc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D5D5D5;
}

#mpdsdafruc .gt_striped {
  background-color: #F4F4F4;
}

#mpdsdafruc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#mpdsdafruc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mpdsdafruc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mpdsdafruc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mpdsdafruc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mpdsdafruc .gt_left {
  text-align: left;
}

#mpdsdafruc .gt_center {
  text-align: center;
}

#mpdsdafruc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mpdsdafruc .gt_font_normal {
  font-weight: normal;
}

#mpdsdafruc .gt_font_bold {
  font-weight: bold;
}

#mpdsdafruc .gt_font_italic {
  font-style: italic;
}

#mpdsdafruc .gt_super {
  font-size: 65%;
}

#mpdsdafruc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mpdsdafruc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mpdsdafruc .gt_indent_1 {
  text-indent: 5px;
}

#mpdsdafruc .gt_indent_2 {
  text-indent: 10px;
}

#mpdsdafruc .gt_indent_3 {
  text-indent: 15px;
}

#mpdsdafruc .gt_indent_4 {
  text-indent: 20px;
}

#mpdsdafruc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption>Renda mínima necessária para financiar um imóvel de R$450.000 a diferentes taxas de juros.</caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Juros (% a.a)">Juros (% a.a)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Renda Mínima">Renda Mínima</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="i" class="gt_row gt_right">7,00%</td>
<td headers="renda" class="gt_row gt_right">R$10.118,31</td></tr>
    <tr><td headers="i" class="gt_row gt_right gt_striped">7,50%</td>
<td headers="renda" class="gt_row gt_right gt_striped">R$10.587,24</td></tr>
    <tr><td headers="i" class="gt_row gt_right">8,00%</td>
<td headers="renda" class="gt_row gt_right">R$11.054,17</td></tr>
    <tr><td headers="i" class="gt_row gt_right gt_striped">8,50%</td>
<td headers="renda" class="gt_row gt_right gt_striped">R$11.519,13</td></tr>
    <tr><td headers="i" class="gt_row gt_right">9,00%</td>
<td headers="renda" class="gt_row gt_right">R$11.982,12</td></tr>
    <tr><td headers="i" class="gt_row gt_right gt_striped">9,50%</td>
<td headers="renda" class="gt_row gt_right gt_striped">R$12.443,17</td></tr>
    <tr><td headers="i" class="gt_row gt_right">10,00%</td>
<td headers="renda" class="gt_row gt_right">R$12.902,30</td></tr>
    <tr><td headers="i" class="gt_row gt_right gt_striped">10,50%</td>
<td headers="renda" class="gt_row gt_right gt_striped">R$13.359,52</td></tr>
    <tr><td headers="i" class="gt_row gt_right">11,00%</td>
<td headers="renda" class="gt_row gt_right">R$13.814,85</td></tr>
    <tr><td headers="i" class="gt_row gt_right gt_striped">11,50%</td>
<td headers="renda" class="gt_row gt_right gt_striped">R$14.268,30</td></tr>
    <tr><td headers="i" class="gt_row gt_right">12,00%</td>
<td headers="renda" class="gt_row gt_right">R$14.719,88</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="acessibilidade-à-moradia" class="level1">
<h1>Acessibilidade à moradia</h1>
<p>O Brasil, historicamente, tem taxas de juros bastante elevadas e isto também é verdadeiro sobre as taxas do financiamento habitacional. É importante notar que há múltiplas taxas de juros que se aplicam sobre financiamentos habitacionais, porque há várias linhas de crédito. O Banco Central do Brasil reconhece cinco linhas distintas: comercial, livre, Home Equity, FGTS e SFH. As duas últimas linhas são as mais conhecidas e representativas do mercado: em abril de 2023, elas acontavam conjuntamente por 90% do estoque de contratos de financiamento imobiliários para pessoas físicas.</p>
<p>O gráfico abaixo mostra a evolução destas linhas de financiamento. As linhas são as médias móveis suavaizadas de cada série. Pelo comportamento do gráfico, nota-se como todas as taxas tendem a subir em períodos de alta da SELIC, como durante o período 2016-2017, quando a taxa SELIC chegou a 14,25%. Já nos períodos de baixa, como em 2020, as taxas livres tendem a cair enquanto a taxa do FGTS não se altera, já que ela é vinculada ao programa habitacional.</p>
<p>Por fim, é interessante perceber que, a despeito da alta recente da SELIC, as taxas de juros das linhas de financiamento habitacional estão abaixo dos seus picos de 2016. Isto pode ser um indício de que houve uma melhoria institucional no sistema de crédito habitacional, relacionado a várias mudanças positivas levadas a cabo nos últimos anos pelo Banco Central do Brasil<sup>2</sup>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/2023-08-juros-affordability/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Grosso modo, todas as taxas de juros da economia são balizadas pela taxa SELIC. O gráfico abaixo mostra como as taxas de financiamento habitacional reguladas (FGTS, SFH) e de mercado reagem às mudanças na SELIC.</p>
<p>É interessante perceber como a distância entre as taxas de mercado e as taxas reguladas diminuiu ao longo dos anos. Além disso, nota-se como o tempo de repasse da SELIC para o consumidor final varia ao longo dos ciclos econômicos. Mais recentemente, vê-se como houve uma defasagem inicial entre os aumentos da SELIC e os respectivos aumentos das taxas de financiamento.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/2023-08-juros-affordability/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<section id="o-impacto-do-aumento-dos-juros" class="level2">
<h2 class="anchored" data-anchor-id="o-impacto-do-aumento-dos-juros">O impacto do aumento dos juros</h2>
<p>Nos últimos anos vimos uma alta significativa das taxas de juros. A taxa média de financiamento habitacional era próxima de 7% em 2020 e subiu para 11,6%. Considerando o imóvel do exemplo acima, seria necessário um aumento de mais de R$4000 na renda para conseguir comprar o mesmo imóvel - sem levar em conta o aumento de preço do imóvel.</p>
<p>Vamos retomar o exemplo do imóvel de R$450.000 acima. Mantendo este preço constante, podemos calcular qual a renda necessária para financiar este mesmo imóvel à medida que a taxa de juros foi aumentando. Por simplicidade, uso a taxa de juros média mensal em cada período<sup>3</sup>.</p>
<p>O gráfico abaixo apresenta, a cada mês, a renda necessária para financiar um imóvel de R$450.000<sup>4</sup>. No ponto mais baixo da taxa, seria necessário R$8.550 (a uma taxa de 6,63%) para ser aprovado num financiamento; já no ponto mais recente, seria necessário R$12.600 (a uma taxa de 11,6%).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/2023-08-juros-affordability/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>A análise acima olha somente o impacto do aumento dos juros e não leva em consideração o aumento médio do preços dos imóveis durante este período. Segundo o IGMI-R (Abrainc/FGV), de janeiro de 2018 a abril 2023, houve um aumento médio de 58% no preços dos imóveis. A tabela abaixo mostra a variação acumulada do IGMI-R em cada ano. Nota-se como os preços aumentam significativamente a partir de 2020.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div id="qdxfszhtwa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qdxfszhtwa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qdxfszhtwa thead, #qdxfszhtwa tbody, #qdxfszhtwa tfoot, #qdxfszhtwa tr, #qdxfszhtwa td, #qdxfszhtwa th {
  border-style: none;
}

#qdxfszhtwa p {
  margin: 0;
  padding: 0;
}

#qdxfszhtwa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #D5D5D5;
  border-right-style: solid;
  border-right-width: 3px;
  border-right-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #D5D5D5;
  border-left-style: solid;
  border-left-width: 3px;
  border-left-color: #D5D5D5;
}

#qdxfszhtwa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qdxfszhtwa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qdxfszhtwa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qdxfszhtwa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qdxfszhtwa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#qdxfszhtwa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qdxfszhtwa .gt_col_heading {
  color: #FFFFFF;
  background-color: #016763;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qdxfszhtwa .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #016763;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qdxfszhtwa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qdxfszhtwa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qdxfszhtwa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qdxfszhtwa .gt_spanner_row {
  border-bottom-style: hidden;
}

#qdxfszhtwa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qdxfszhtwa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
  vertical-align: middle;
}

#qdxfszhtwa .gt_from_md > :first-child {
  margin-top: 0;
}

#qdxfszhtwa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qdxfszhtwa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D5D5D5;
  border-left-style: solid;
  border-left-width: 1px;
  border-left-color: #D5D5D5;
  border-right-style: solid;
  border-right-width: 1px;
  border-right-color: #D5D5D5;
  vertical-align: middle;
  overflow-x: hidden;
}

#qdxfszhtwa .gt_stub {
  color: #FFFFFF;
  background-color: #929292;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D5D5D5;
  padding-left: 5px;
  padding-right: 5px;
}

#qdxfszhtwa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qdxfszhtwa .gt_row_group_first td {
  border-top-width: 2px;
}

#qdxfszhtwa .gt_row_group_first th {
  border-top-width: 2px;
}

#qdxfszhtwa .gt_summary_row {
  color: #FFFFFF;
  background-color: #5F5F5F;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qdxfszhtwa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D5D5D5;
}

#qdxfszhtwa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qdxfszhtwa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#qdxfszhtwa .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #929292;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qdxfszhtwa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D5D5D5;
}

#qdxfszhtwa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D5D5D5;
}

#qdxfszhtwa .gt_striped {
  background-color: #F4F4F4;
}

#qdxfszhtwa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D5D5D5;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D5D5D5;
}

#qdxfszhtwa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qdxfszhtwa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qdxfszhtwa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qdxfszhtwa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qdxfszhtwa .gt_left {
  text-align: left;
}

#qdxfszhtwa .gt_center {
  text-align: center;
}

#qdxfszhtwa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qdxfszhtwa .gt_font_normal {
  font-weight: normal;
}

#qdxfszhtwa .gt_font_bold {
  font-weight: bold;
}

#qdxfszhtwa .gt_font_italic {
  font-style: italic;
}

#qdxfszhtwa .gt_super {
  font-size: 65%;
}

#qdxfszhtwa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qdxfszhtwa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qdxfszhtwa .gt_indent_1 {
  text-indent: 5px;
}

#qdxfszhtwa .gt_indent_2 {
  text-indent: 10px;
}

#qdxfszhtwa .gt_indent_3 {
  text-indent: 15px;
}

#qdxfszhtwa .gt_indent_4 {
  text-indent: 20px;
}

#qdxfszhtwa .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption>Variação acumulada do IGMI-R por ano.</caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Ano">Ano</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Var. Acum. (%)">Var. Acum. (%)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="year" class="gt_row gt_right">2018</td>
<td headers="total" class="gt_row gt_right">0.64%</td></tr>
    <tr><td headers="year" class="gt_row gt_right gt_striped">2019</td>
<td headers="total" class="gt_row gt_right gt_striped">4.11%</td></tr>
    <tr><td headers="year" class="gt_row gt_right">2020</td>
<td headers="total" class="gt_row gt_right">10.28%</td></tr>
    <tr><td headers="year" class="gt_row gt_right gt_striped">2021</td>
<td headers="total" class="gt_row gt_right gt_striped">16.25%</td></tr>
    <tr><td headers="year" class="gt_row gt_right">2022</td>
<td headers="total" class="gt_row gt_right">15.06%</td></tr>
    <tr><td headers="year" class="gt_row gt_right gt_striped">2023</td>
<td headers="total" class="gt_row gt_right gt_striped">2.52%</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>O gráfico abaixo refaz o experimento acima, mas leva em conta também o aumento médio do preços dos imóveis. Em cada mês vê-se a renda necessária para financiar um imóvel médio, que em janeiro de 2018 valia R\$450.000.</p>
<p>Fica evidente como a combinação simultânea de aumento de juros e de preços tornou os imóveis menos acessíveis. Em abril de 2023, seria necessário uma renda em torno de R\$20.000 para financiar o mesmo imóvel<sup>5</sup>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/2023-08-juros-affordability/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>A análise omite ainda um fator: o crescimento médio da renda ao longo do tempo. No Brasil, o salário mínimo é indexado à variação da inflação e, de maneira geral, quando a economia vai bem a renda média costuma crescer. Deixo esta última etapa da análise de acessibilidade financeira para outro post.</p>
<p>Além disso, o programa habitacional do Brasil, o Minha Casa Minha Vida (MCMV) oferece empréstimos com taxas mais atrativas do que as taxas médias de mercado, conforme a renda da família e o preço do imóvel<sup>6</sup>. Como o programa foi revisto recentemente, vou dedicar um post somente ao MCMV e como ele deve impactar a acessibilidade à moradia no Brasil.</p>
</section>
<section id="o-caminho-futuro" class="level2">
<h2 class="anchored" data-anchor-id="o-caminho-futuro">O caminho futuro</h2>
<p>Na última semana o COPOM decidiu reduzir a taxa SELIC em 0.5 p.p., diminuindo a taxa de 13,75% para 13,25%. Esta foi a primeira queda desde que se iniciou o ciclo de altas no início de 2021. Espera-se que o Banco Central agora entre num ciclo de queda de taxa de juros que devem se estabilizar em torno de 8,5% no longo prazo.</p>
<p>Como se viu na análise acima, as oscilações de SELIC eventualmente traduzem-se em mudanças nas taxas do financiamento imobiliário. Além da queda na taxa de juros, os índices de preços imobiliários, como o IGMI-R e o IVGR, começam a apontar para uma relativa estabilidade nos preços dos imóveis. Esta combinação deve aumentar o poder de compras das famílias e melhorar a acessibilidade financeira à moradia.</p>
<p>Há um último componente, da equação da acessibilidade à moradia, que ficou inexplorado neste post: a renda das famílias. Evidentemente, um aumento da renda média das famílias permite que elas tenham acesso a imóveis melhores e mais caros. Além disso, para imóveis com ticket menores, o MCMV oferece condições mais favoráveis de financiamento. Deixo esta discussão, contudo, para um outro momento.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Em abril de 2023, cerca de 95% do estoque de contratos de financiamentos imobiliários para pessoas físicas era indexado pela TR. O IPCA era utilizado em cerca de 2% e outros indexadores eram utilizados em 2,2% dos contratos. Apenas 0,8% dos contratos eram pré-fixados.↩︎</p></li>
<li id="fn2"><p>Alguns exemplos incluem: cadastro positivo, regulamentação das fintechs de crédito, regulamentação das Letras Imobiliárias Garantidas (LIGs), portabilidade de crédito. Para mais informações veja a <a href="https://www.bcb.gov.br/acessoinformacao/bchashtag?modalAberto=sobre_agenda">Agenda BC#</a>.↩︎</p></li>
<li id="fn3"><p>A taxa de juros média do financiamento habitacional para pessoas físicas toma as cinco taxas apresentadas e pondera elas pelo volume de crédito. Assim, as principais linhas (FGTS e SFH) têm maior peso.↩︎</p></li>
<li id="fn4"><p>Por simplicidade, suponho um financiamento estilo SAC com LTV de 70% e prazo de 360 meses. Para ser aprovado no financiamento, suponho que o valor da primeira parcela não possa ser maior do que 30% da renda familiar bruta.↩︎</p></li>
<li id="fn5"><p>Vale notar que o IGMI-R é um índice de preços hedônico então ele provê um índice de preços “ajustado pela qualidade”, isto é, um quality adjusted price index. Assim, este aumento de preços não reflete meramente uma mudança no mix de imóveis disponíveis no mercado.↩︎</p></li>
<li id="fn6"><p>O preço de R\$450.000 não foi escolhido ao acaso já que ele supera o teto atual do Minha Casa Minha Vida e não estaria elegível ao programa.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>real-estate</category>
  <category>economia</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/2023-08-juros-affordability/index.html</guid>
  <pubDate>Thu, 17 Aug 2023 03:00:00 GMT</pubDate>
</item>
<item>
  <title>Importando dados do SIDRA</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/2023-08-importando-dados-sidra/index.html</link>
  <description><![CDATA[ 




<p>O SIDRA, ou Sistema IBGE de Recuperação Automática, é um sistema automatizado de coleta de dados do IBGE, que disponbiliza tabelas das várias pesquisas feitas pelo IBGE. O sistema é centralizado no <a href="https://sidra.ibge.gov.br/home/pnadcm">site</a>. Encontrar pesquisas e dados pode não ser fácil e, em geral, exige conhecimento prévio sobre as pesquisas do IBGE. O site oferece uma página de <a href="https://sidra.ibge.gov.br/ajuda">ajuda</a>.</p>
<p>Neste post vou comentar mais especificamente sobre o pacote <code>sidrar</code> que dialoga diretamente com a API do SIDRA para importar tabelas diretamente para dentro do <code>R</code>. O pacote tem duas funções centrais:</p>
<ul>
<li><code>info_sidra()</code> - busca os metadados e informações de uma tabela.</li>
<li><code>get_sidra()</code> - importa uma tabela do SIDRA seguindo um conjunto de parâmetros.</li>
</ul>
<section id="r" class="level1">
<h1>R</h1>
<p>Primeiro, temos que instalar o pacote <code>sidrar</code> e chamá-lo usando a função <code>library()</code>. Além disso, para a primeira parte deste tutorial mostro também como utilizar os pacotes <code>dplyr</code>, <code>tidyr</code> e <code>janitor</code> para limpar os dados.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Instale o pacote (caso necessário)</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sidrar"</span>)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Outros pacotes usados neste tutorial</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"janitor"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dplyr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyr"</span>))</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sidrar"</span>)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"janitor"</span>)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dplyr"</span>)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyr"</span>)</span></code></pre></div>
</div>
</section>
<section id="importando-dados" class="level1">
<h1>Importando dados</h1>
<p>Vamos começar olhando para a tabela de estimativas da população dos municípios. A tabela <a href="https://sidra.ibge.gov.br/tabela/6579">6579</a> reúne os dados da pesquisa “Estimativas da População”, uma contagem anual da população de todos os municípios do Brasil.</p>
<p>Primeiro vamos usar a função <code>info_sidra</code> para verificar o conteúdo desta tabela.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">info_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6579</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$table
[1] "Tabela 6579: População residente estimada"

$period
[1] "2001, 2002, 2003, 2004, 2005, 2006, 2008, 2009, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021"

$variable
   cod                                   desc
1 9324 População residente estimada (Pessoas)

$classific_category
NULL

$geo
     cod                      desc
1 Brazil                Brasil (1)
2 Region         Grande Região (5)
3  State Unidade da Federação (27)
4   City         Município (5.570)</code></pre>
</div>
</div>
<p>A tabela, neste caso, é bastante simples. Os dados são anuais e estão disponíveis de 2001 a 2021. Há apenas uma variável: <code>População residente estimada (Pessoas)</code> com código <code>9324</code>. Por fim, os dados estão desagregados no nível nacional, regional, estadual e municipal.</p>
<p>Vamos importar a população de todos os municipios em 2021. Note que no código abaixo o argumento do ano é inserido como um <code>character</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">pop21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6579</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2021"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"City"</span>)</span>
<span id="cb4-2"></span>
<span id="cb4-3">pop21</span></code></pre></div>
</div>
<p>A tabela já vem formatada dentro do R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">pop21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6579</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2021"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"City"</span>)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(pop21)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Nível Territorial (Código) Nível Territorial Unidade de Medida (Código)
2                          6         Município                         45
3                          6         Município                         45
4                          6         Município                         45
5                          6         Município                         45
6                          6         Município                         45
7                          6         Município                         45
  Unidade de Medida  Valor Município (Código)                  Município
2           Pessoas  22516            1100015 Alta Floresta D'Oeste - RO
3           Pessoas 111148            1100023             Ariquemes - RO
4           Pessoas   5067            1100031                Cabixi - RO
5           Pessoas  86416            1100049                Cacoal - RO
6           Pessoas  16088            1100056            Cerejeiras - RO
7           Pessoas  15213            1100064     Colorado do Oeste - RO
  Ano (Código)  Ano Variável (Código)                     Variável
2         2021 2021              9324 População residente estimada
3         2021 2021              9324 População residente estimada
4         2021 2021              9324 População residente estimada
5         2021 2021              9324 População residente estimada
6         2021 2021              9324 População residente estimada
7         2021 2021              9324 População residente estimada</code></pre>
</div>
</div>
<p>Ainda que os dados não estejam “sujos”, eles não estão num formato agradável para se trabalhar. Vamos fazer uma limpeza básica dos dados. Primeiro, vamos simplificar os nomes das colunas e selecionar apenas as colunas de maior interesse.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">pop21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(pop21)</span>
<span id="cb7-2">pop21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(pop21, municipio_codigo, municipio, ano, valor)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-condensed table-hover table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">municipio_codigo</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">municipio</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ano</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: center;">1100015</td>
<td style="text-align: center;">Alta Floresta D'Oeste - RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">22516</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: center;">1100023</td>
<td style="text-align: center;">Ariquemes - RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">111148</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: center;">1100031</td>
<td style="text-align: center;">Cabixi - RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">5067</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: center;">1100049</td>
<td style="text-align: center;">Cacoal - RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">86416</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: center;">1100056</td>
<td style="text-align: center;">Cerejeiras - RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">16088</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: center;">1100064</td>
<td style="text-align: center;">Colorado do Oeste - RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">15213</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Note que o nome dos municípios contém também a abreviação do estado ao qual o município pertence. Podemos deixar isto mais claro separando esta informação em duas colunas distintas.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">pop21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(</span>
<span id="cb8-2">  pop21,</span>
<span id="cb8-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"municipio"</span>,</span>
<span id="cb8-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nome_muni"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"abr_estado"</span>),</span>
<span id="cb8-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" - "</span>)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-condensed table-hover table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">municipio_codigo</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">nome_muni</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">abr_estado</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ano</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: center;">1100015</td>
<td style="text-align: center;">Alta Floresta D'Oeste</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">22516</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: center;">1100023</td>
<td style="text-align: center;">Ariquemes</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">111148</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: center;">1100031</td>
<td style="text-align: center;">Cabixi</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">5067</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: center;">1100049</td>
<td style="text-align: center;">Cacoal</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">86416</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: center;">1100056</td>
<td style="text-align: center;">Cerejeiras</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">16088</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: center;">1100064</td>
<td style="text-align: center;">Colorado do Oeste</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">15213</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Por fim, podemos padronizar melhor o nome das colunas. Vamos utilizar as convenções do pacote <code>geobr</code>, por exemplo, e traduzir as variáveis para o inglês.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">pop21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb9-2">  pop21,</span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name_muni =</span> nome_muni,</span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">abbrev_state =</span> abr_estado,</span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code_muni =</span> municipio_codigo,</span>
<span id="cb9-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> ano,</span>
<span id="cb9-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population =</span> valor)</span></code></pre></div>
</div>
<p>A tabela final aparece abaixo.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-condensed table-hover table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">code_muni</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">name_muni</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">abbrev_state</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: center;">1100015</td>
<td style="text-align: center;">Alta Floresta D'Oeste</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">22516</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: center;">1100023</td>
<td style="text-align: center;">Ariquemes</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">111148</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: center;">1100031</td>
<td style="text-align: center;">Cabixi</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">5067</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: center;">1100049</td>
<td style="text-align: center;">Cacoal</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">86416</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: center;">1100056</td>
<td style="text-align: center;">Cerejeiras</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">16088</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: center;">1100064</td>
<td style="text-align: center;">Colorado do Oeste</td>
<td style="text-align: center;">RO</td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">15213</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>A padronização dos nomes traz como vantagem facilitar o <code>join</code> com o shapefile dos municípios usando o pacote <code>geobr</code>.</p>
<section id="variando-os-parâmetros-de-busca" class="level2">
<h2 class="anchored" data-anchor-id="variando-os-parâmetros-de-busca">Variando os parâmetros de busca</h2>
<p>A função <code>get_sidra()</code> permite refinar a query que gera a tabela final que é importada dentro do <code>R</code>. Os principais argumentos são:</p>
<ul>
<li><code>period</code> - escolhe a janela temporal dos dados.</li>
<li><code>variable</code> - escolhe a variável a ser importada.</li>
<li><code>geo</code> - nível geográfico dos dados (e.g.&nbsp;<code>"Brazil"</code>, <code>"City"</code>, <code>"Neighborhood"</code>, etc.).</li>
<li><code>geo.filter</code> - lista com filtros geográficos.</li>
<li><code>classific</code> - classificação dos dados.</li>
<li><code>category</code> - escolhe quais categorias (do <code>classific</code>) importar.</li>
</ul>
<p>De maneira geral, todos os parâmetros acima tem algumas nuances. Vamos explorá-los caso a caso</p>
</section>
<section id="importando-dados-de-vários-períodos" class="level2">
<h2 class="anchored" data-anchor-id="importando-dados-de-vários-períodos">Importando dados de vários períodos</h2>
<p>Para selecionar múltiplos períodos podemos montar um vetor <code>character</code> com os períodos desejados. Para selecionar uma sequência de períodos deve-se montar um string único encadeando os períodos com o sinal de “-”. O código abaixo deve deixar isto mais claro.</p>
<p>Note que se você rodar o código abaixo, provavelmente, vai enfrentar um problema de limite de query. A API do SIDRA restringe o número de linhas que um usuário pode chamar de uma só vez. Assim, para importar bases de dados maiores é preciso montar estratégias para particionar os dados.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importa os dados de 2010 e de 2020</span></span>
<span id="cb10-2">pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6579</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2010"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"City"</span>)</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importa todos os dados de 2010 até 2020 (erro: limite de requisição)</span></span>
<span id="cb10-5">pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6579</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2010-2020"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"City"</span>)</span></code></pre></div>
</div>
<p>Um detalhe curioso é que a função não retorna erros quando o período extrapola os valores disponíveis nos dados. Assim a função abaixo retorna apenas os valores de 2021.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importa todos os dados de 2021 até 2030</span></span>
<span id="cb11-2">pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6579</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2021-2030"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"City"</span>)</span></code></pre></div>
</div>
<p>A mesma lógica acima vale para quando os dados são mensais ou trimestrais. Considere o exemplo da taxa de desocupação, levantada pela PNADC Trimestral. Note que os períodos estão no formato <code>YYYYQQ</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">info_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4099</span>)</span></code></pre></div>
</div>
<p>Vamos importar todos as observações da taxa de desocupação em 2012. Note que agora há múltiplas variáveis na mesma tabela e que o resultado já está em formato “long”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">unemp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4099</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"201201-201204"</span>)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(unemp)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Nível Territorial (Código) Nível Territorial Unidade de Medida (Código)
2                          1            Brasil                          2
3                          1            Brasil                          2
4                          1            Brasil                          2
5                          1            Brasil                          2
6                          1            Brasil                          2
7                          1            Brasil                          2
  Unidade de Medida Valor Brasil (Código) Brasil Trimestre (Código)
2                 %   8.0               1 Brasil             201201
3                 %   0.9               1 Brasil             201201
4                 %  15.3               1 Brasil             201201
5                 %   0.7               1 Brasil             201201
6                 %  14.0               1 Brasil             201201
7                 %   0.7               1 Brasil             201201
          Trimestre Variável (Código)
2 1º trimestre 2012              4099
3 1º trimestre 2012              4103
4 1º trimestre 2012              4114
5 1º trimestre 2012              4115
6 1º trimestre 2012              4116
7 1º trimestre 2012              4117
                                                                                                                                                                           Variável
2                                                                                             Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
3                                                                   Coeficiente de variação - Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
4                           Taxa combinada de desocupação e de subocupação por insuficiência de horas trabalhadas, na semana de referência, das pessoas de 14 anos ou mais de idade
5 Coeficiente de variação - Taxa combinada de desocupação e de subocupação por insuficiência de horas trabalhadas, na semana de referência, das pessoas de 14 anos ou mais de idade
6                                                     Taxa combinada de desocupação e força de trabalho potencial, na semana de referência, das pessoas de 14 anos ou mais de idade
7                           Coeficiente de variação - Taxa combinada de desocupação e força de trabalho potencial, na semana de referência, das pessoas de 14 anos ou mais de idade</code></pre>
</div>
</div>
<p>Para refinar a busca acima temos de usar o argumento <code>variable</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">unemp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4099</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"201201-202203"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4099</span>)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(unemp)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Nível Territorial (Código) Nível Territorial Unidade de Medida (Código)
2                          1            Brasil                          2
3                          1            Brasil                          2
4                          1            Brasil                          2
5                          1            Brasil                          2
6                          1            Brasil                          2
7                          1            Brasil                          2
  Unidade de Medida Valor Brasil (Código) Brasil Trimestre (Código)
2                 %   8.0               1 Brasil             201201
3                 %   7.6               1 Brasil             201202
4                 %   7.1               1 Brasil             201203
5                 %   6.9               1 Brasil             201204
6                 %   8.1               1 Brasil             201301
7                 %   7.5               1 Brasil             201302
          Trimestre Variável (Código)
2 1º trimestre 2012              4099
3 2º trimestre 2012              4099
4 3º trimestre 2012              4099
5 4º trimestre 2012              4099
6 1º trimestre 2013              4099
7 2º trimestre 2013              4099
                                                                               Variável
2 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
3 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
4 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
5 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
6 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
7 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade</code></pre>
</div>
</div>
<p>Agora temos a série completa apenas da taxa de desocupação no Brasil. Podemos buscar também a taxa em cada uma das cidades do Brasil.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">unemp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(</span>
<span id="cb19-2">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4099</span>,</span>
<span id="cb19-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"201201-202203"</span>,</span>
<span id="cb19-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4099</span>,</span>
<span id="cb19-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"City"</span></span>
<span id="cb19-6">  )</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  Nível Territorial (Código) Nível Territorial Unidade de Medida (Código)
1                          6         Município                          2
2                          6         Município                          2
3                          6         Município                          2
4                          6         Município                          2
5                          6         Município                          2
6                          6         Município                          2
  Unidade de Medida Valor Município (Código)        Município
1                 %   9.0            1100205 Porto Velho - RO
2                 %  10.4            1200401  Rio Branco - AC
3                 %  12.9            1302603      Manaus - AM
4                 %   9.3            1400100   Boa Vista - RR
5                 %  10.5            1501402       Belém - PA
6                 %  12.6            1600303      Macapá - AP
  Trimestre (Código)         Trimestre Variável (Código)
1             201201 1º trimestre 2012              4099
2             201201 1º trimestre 2012              4099
3             201201 1º trimestre 2012              4099
4             201201 1º trimestre 2012              4099
5             201201 1º trimestre 2012              4099
6             201201 1º trimestre 2012              4099
                                                                               Variável
1 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
2 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
3 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
4 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
5 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade
6 Taxa de desocupação, na semana de referência, das pessoas de 14 anos ou mais de idade</code></pre>
</div>
</div>
<p>Note, contudo, que temos o resultado somente nas capitais. Apesar do argumento “City” ser o mesmo que usamos na pesquisa de Estimativas da População, aqui o argumento “City” retorna apenas as capitais. Isto acontece porque a PNADC é uma pesquisa que é feita apenas nas capitais brasileiras e não tem uma desagregação a nível municipal para todos os municípios do Brasil. Este importante detalhe não fica evidente e depende do conhecimento prévio do usuário a respeito das pesquisas do IBGE.</p>
</section>
<section id="importando-muitos-dados" class="level2">
<h2 class="anchored" data-anchor-id="importando-muitos-dados">Importando muitos dados</h2>
<p>Como comentei acima, a API do SIDRA tem um limite de linhas nas queries. Isto significa que é preciso montar algumas estratégias para pegar as tabelas em partes menores. Na prática, isto vai depender muito da tabela e da informação que se quer.</p>
<p>O exemplo abaixo é bastante simples mas pode eventualmente ser útil em alguma outra aplicação. O código importa a tabela de estimativas populacionais ano a ano. O mesmo poderia ter sido feito num for-loop, mas prefiro usar o <code>lapply</code> por simplicidade.</p>
<p>Para acelerar o processo pode-se trocar o <code>lapply</code> por <code>parallel::mclapply</code> que roda a função em paralelo. Contudo, na minha experiência, esta estratégia acaba resultando em erros imprevistos. Não sei se isto é resultado de alguma restrição da API. Na prática, é mais seguro evitar o <code>mclapply</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define um vetor com todos os anos da pesquisa</span></span>
<span id="cb21-2">periods <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2001</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>)</span>
<span id="cb21-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Converte para character</span></span>
<span id="cb21-4">periods <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(periods)</span>
<span id="cb21-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Aplica a função get_sidra a cada elemento de periods (a cada ano)</span></span>
<span id="cb21-6">req <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(periods, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(p) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6579</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"City"</span>))</span>
<span id="cb21-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Junta o resultado numa única tabela</span></span>
<span id="cb21-8">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(req)</span></code></pre></div>
</div>
</section>
</section>
<section id="refinando-a-busca-em-casos-complexos" class="level1">
<h1>Refinando a busca em casos complexos</h1>
<section id="tabelas-do-censo" class="level2">
<h2 class="anchored" data-anchor-id="tabelas-do-censo">Tabelas do Censo</h2>
<p>Tabelas que vem do Censo costumam ter maior complexidade. Considere, por exemplo, a tabela 1378, que retorna a população residente, por situação do domicílio (urbano x rural), sexo e idade, segundo a condição no domicílio e compartilhamento da responsabilidade (responsável, cônjuge, filho, etc.)</p>
<p>O resultado da função abaixo é omitido para poupar espaço pois a saída é muito grande. Em casos como este é muito importante filtrar o resultado para conseguir uma tabela que faça sentido.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">info_sidra</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1378</span>)</span></code></pre></div>
</div>
<p>Vamos nos focar somente na população residente (var 93) de pessoas responsáveis do domicílio (cod 11941) por bairro de Porto Alegre (4314902).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">resp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_sidra</span>(</span>
<span id="cb23-2">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1378</span>,</span>
<span id="cb23-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">93</span>,</span>
<span id="cb23-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">classific =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c455"</span>),</span>
<span id="cb23-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Neighborhood"</span>,</span>
<span id="cb23-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo.filter =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"City"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4314902</span>)</span>
<span id="cb23-7">  )</span></code></pre></div>
</div>
<p>Após um pouco de limpeza no nome das colunas podemos ver o resultado abaixo.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-condensed table-hover table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">bairro</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">cond_domi</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">idade</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">situacao_domi</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">11568</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Pessoa responsável</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">4206</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Pessoa responsável - com responsabilidade compartilhada</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">1054</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Pessoa responsável - sem responsabilidade compartilhada</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">3152</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Cônjuge ou companheiro(a)</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">2101</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Cônjuge ou companheiro(a) - de sexo diferente</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">2094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Cônjuge ou companheiro(a) - de mesmo sexo</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Filho(a)</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">3429</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Filho(a) - da pessoa responsável e do cônjuge</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">1916</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Filho(a) - somente da pessoa responsável</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">1513</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Enteado(a)</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">145</td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Genro ou nora</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">170</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Pai, mãe, padastro ou madrasta</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">183</td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Sogro(a)</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">16</td>
<td style="text-align: center;">Medianeira</td>
<td style="text-align: center;">Neto(a)</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">549</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Note que temos a coluna da condição do domicílio desagregada (c455), mas todas as outras (sexo, idade, etc.) estão agregadas.</p>
</section>
<section id="api-do-sidra" class="level2">
<h2 class="anchored" data-anchor-id="api-do-sidra">API do SIDRA</h2>
<p>Então imagine, por exemplo, que queremos esta mesma informação, por grupos de idade. Esta requisição quebra o limite da query. Além disso, os grupos de idade disponíveis são caóticos e não é possível filtrar dentro deste grupo da mesma maneira como fazemos com o argumento <code>variable</code>.</p>
<p>A solução é interagir diretamente com a API do SIDRA! O código acaba sendo bastante complexo/confuso. Muito provavelmente há maneiras de melhorar o código abaixo, mas foi como fiz para conseguir esta informação. Por conveniência chamo explicitamente todos os pacotes que uso. A limpeza dos dados foi a parte mais desafiadora do processo visto que não foi possível transformar o input de JSON para um <code>data.frame</code> de maneira direta.</p>
<p>Em partes, acho que dei o azar de ter escolhido uma tabela especialmente complicada. Se <code>jsonlite::fromJSON(x, simplifyDataFrame = TRUE)</code> tivesse funcionado, o código seria muito mais simples.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bibliotecas usadas</span></span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb24-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb24-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb24-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(janitor)</span>
<span id="cb24-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyjson)</span>
<span id="cb24-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(httr)</span>
<span id="cb24-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(jsonlite)</span>
<span id="cb24-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(geobr)</span>
<span id="cb24-10"></span>
<span id="cb24-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Montar a query</span></span>
<span id="cb24-12"></span>
<span id="cb24-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Montar um vetor com o código de todos os bairros de Porto Alegre</span></span>
<span id="cb24-14"></span>
<span id="cb24-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importa o shapefile de todos os bairros IBGE (2010)</span></span>
<span id="cb24-16">bairros <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geobr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_neighborhood</span>()</span>
<span id="cb24-17"></span>
<span id="cb24-18">bairros_poa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bairros <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pega apenas os códigos dos bairros de POA</span></span>
<span id="cb24-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(code_muni <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4314902</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># O código do bairro tem alguns números sobrando no meio</span></span>
<span id="cb24-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code_nb =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb24-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(code_neighborhood, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb24-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(code_neighborhood, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb24-25">    )</span>
<span id="cb24-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extrai o vetor com os códgios dos bairros</span></span>
<span id="cb24-27">codenb_poa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bairros_poa[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code_nb"</span>]]</span>
<span id="cb24-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colapsa o vetor num único string separado por vírgulas</span></span>
<span id="cb24-29">local <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(codenb_poa, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb24-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Insere o string no formato da API</span></span>
<span id="cb24-31">local <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"localidades=N102[{local}]"</span>)</span>
<span id="cb24-32"></span>
<span id="cb24-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base do url da API</span></span>
<span id="cb24-34">base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://servicodados.ibge.gov.br/api/v3/agregados"</span></span>
<span id="cb24-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Número da tabela</span></span>
<span id="cb24-36">table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1378</span></span>
<span id="cb24-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Período da extração (ano)</span></span>
<span id="cb24-38">period <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2010</span></span>
<span id="cb24-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Código da variável (Pessoas residentes)</span></span>
<span id="cb24-40">variable <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">93</span></span>
<span id="cb24-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Códigos das classes</span></span>
<span id="cb24-42">class <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">287</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">455</span>)</span>
<span id="cb24-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filtro das classes (veja info_sidra(1378))</span></span>
<span id="cb24-44">category <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">93087</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">93100</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11941</span>))</span>
<span id="cb24-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colapsa os strings</span></span>
<span id="cb24-46">category <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(category, paste, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb24-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Coloca os strings no format da API</span></span>
<span id="cb24-48">cat_filter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{class}[{category}]"</span>)</span>
<span id="cb24-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colapsa os strings num único string separado pelo operador booleano |</span></span>
<span id="cb24-50">cat_filter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(cat_filter, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb24-51"></span>
<span id="cb24-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monta a query</span></span>
<span id="cb24-53">query <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_glue</span>(</span>
<span id="cb24-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{base}/{table}/periodos/{period}/variaveis/{variable}?{local}&amp;classificacao={cat_filter}"</span></span>
<span id="cb24-55">)</span>
<span id="cb24-56"></span>
<span id="cb24-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Importar dados</span></span>
<span id="cb24-58"></span>
<span id="cb24-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importar os dados da API</span></span>
<span id="cb24-60">req <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> httr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> query)</span>
<span id="cb24-61">json <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> httr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(req, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">as =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">encoding =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UTF-8"</span>)</span>
<span id="cb24-62">json <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> jsonlite<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(json, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">simplifyVector =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb24-63"></span>
<span id="cb24-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Limpar os dados</span></span>
<span id="cb24-65"></span>
<span id="cb24-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simplificar os dados de JSON para um tibble</span></span>
<span id="cb24-67">valores <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> json <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_all</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enter_object</span>(resultados) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gather_array</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_all</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enter_object</span>(series) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gather_array</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_all</span>()</span>
<span id="cb24-75"></span>
<span id="cb24-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extrair somente os valores da série</span></span>
<span id="cb24-77">valores <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> valores <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">serie.2010 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(serie<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.2010</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb24-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"array.index"</span>,</span>
<span id="cb24-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"localidade.id"</span>,</span>
<span id="cb24-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serie.2010"</span></span>
<span id="cb24-84">  )</span>
<span id="cb24-85"></span>
<span id="cb24-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extrair a classificação das variáveis (sexo, idade)</span></span>
<span id="cb24-87">classificacao <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> json <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_all</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enter_object</span>(resultados) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gather_array</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_all</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enter_object</span>(classificacoes) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gather_array</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-94">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_all</span>()</span>
<span id="cb24-95"></span>
<span id="cb24-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extrai somente a coluna com os grupos de idade</span></span>
<span id="cb24-97">tblage <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> classificacao <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"93"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb24-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unite</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_group"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-101">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(age_group <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>()</span>
<span id="cb24-103"></span>
<span id="cb24-104"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cria um grid com todas as classificações na ordem correta</span></span>
<span id="cb24-105">tblclass <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(</span>
<span id="cb24-106">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">situacao_domicilio =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"urban"</span>,</span>
<span id="cb24-107">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resp =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Responsável pelo Domicilio"</span>,</span>
<span id="cb24-108">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female"</span>),</span>
<span id="cb24-109">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_group =</span> tblage<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>age_group</span>
<span id="cb24-110">)</span>
<span id="cb24-111"></span>
<span id="cb24-112"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Junta as classificações com os valores </span></span>
<span id="cb24-113">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(valores, tblclass)</span>
<span id="cb24-114"></span>
<span id="cb24-115"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Converte os dados para wide</span></span>
<span id="cb24-116">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-117">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"431"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code_nb"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(code_nb, situacao_domicilio, resp, sex, age_group, value)</span>
<span id="cb24-119"></span>
<span id="cb24-120"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Converte os dados para uma tabela final</span></span>
<span id="cb24-121">respnb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb24-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code_nb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_group"</span>),</span>
<span id="cb24-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sex"</span>,</span>
<span id="cb24-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"value"</span></span>
<span id="cb24-126">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-127">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> female)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-128">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(code_nb) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_nb =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(total)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-130">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-131">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">share_nb =</span> total <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_nb <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span></code></pre></div>
</details>
</div>
<p>A tabela abaixo mostra o resultado final do código. A tabela apresenta o número total de pessoas responsáveis por domicílios em grupos de idade quinquenais por sexo e por bairro de Porto Alegre. Além disso, a coluna <code>total_nb</code> traz o número total de pessoas responsáveis por domicílio no bairro e <code>share_nb</code> computa a participação relativa de cada faixa de idade no total do bairro.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-condensed table-hover table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">code_nb</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">age_group</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">male</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">female</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">total</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">total_nb</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">share_nb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">4314902003</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">383</td>
<td style="text-align: center;">406</td>
<td style="text-align: center;">789</td>
<td style="text-align: center;">8757</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;">4314902005</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">435</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4314902007</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">214</td>
<td style="text-align: center;">245</td>
<td style="text-align: center;">459</td>
<td style="text-align: center;">9116</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">4314902069</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">62</td>
<td style="text-align: center;">104</td>
<td style="text-align: center;">2071</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4314902009</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">331</td>
<td style="text-align: center;">359</td>
<td style="text-align: center;">690</td>
<td style="text-align: center;">13137</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">4314902072</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">75</td>
<td style="text-align: center;">57</td>
<td style="text-align: center;">132</td>
<td style="text-align: center;">3706</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4314902068</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">163</td>
<td style="text-align: center;">144</td>
<td style="text-align: center;">307</td>
<td style="text-align: center;">8052</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">4314902013</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">193</td>
<td style="text-align: center;">177</td>
<td style="text-align: center;">370</td>
<td style="text-align: center;">6319</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4314902012</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">2719</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">4314902004</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">206</td>
<td style="text-align: center;">227</td>
<td style="text-align: center;">433</td>
<td style="text-align: center;">13342</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4314902032</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">261</td>
<td style="text-align: center;">285</td>
<td style="text-align: center;">546</td>
<td style="text-align: center;">12171</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">4314902022</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">117</td>
<td style="text-align: center;">105</td>
<td style="text-align: center;">222</td>
<td style="text-align: center;">6910</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4314902071</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">49</td>
<td style="text-align: center;">29</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="even">
<td style="text-align: center;">4314902045</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">126</td>
<td style="text-align: center;">4190</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4314902049</td>
<td style="text-align: center;">20 a 24 anos</td>
<td style="text-align: center;">71</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">136</td>
<td style="text-align: center;">4365</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Apesar de claramente não ser o foco do post, pareceu um desperdício de esforço não fazer algo com esta informação. O código abaixo agrupa os dados um pouco mais e monta um mapa interativo dos domicílios por grupo de idade da pessoa responsável. Não seria difícil transformar isto num aplicativo para ver esta mesma info nas outras faixas de idade, mas isto fica para outro post.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">bairros <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geobr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_neighborhood</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showProgress =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb25-2"></span>
<span id="cb25-3">bairros_poa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bairros <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pega apenas os códigos dos bairros de POA</span></span>
<span id="cb25-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(code_muni <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4314902</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># O código do bairro tem alguns números sobrando no meio</span></span>
<span id="cb25-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code_nb =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb25-8">    stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(code_neighborhood, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb25-9">    stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(code_neighborhood, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb25-10">    )</span>
<span id="cb25-11"></span>
<span id="cb25-12"></span>
<span id="cb25-13">respnb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> respnb <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(age_group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_min"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_max"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" a "</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb25-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_generation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb25-17">      age_min <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> age_min <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"25-39"</span>,</span>
<span id="cb25-18">      age_min <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> age_min <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"40-59"</span>,</span>
<span id="cb25-19">      age_min <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> age_min <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"60-79"</span>,</span>
<span id="cb25-20">      age_min <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"80+"</span>,</span>
<span id="cb25-21">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;25"</span></span>
<span id="cb25-22">    )</span>
<span id="cb25-23">  )</span>
<span id="cb25-24"></span>
<span id="cb25-25">resp_grouped_nb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> respnb <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(code_nb, age_generation) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(total, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(code_nb) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_nb =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(pop)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">share_nb =</span> pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_nb <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb25-32"></span>
<span id="cb25-33">resp_ages <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb25-34">  resp_grouped_nb,</span>
<span id="cb25-35">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code_nb"</span>,</span>
<span id="cb25-36">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_generation"</span>,</span>
<span id="cb25-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_"</span>,</span>
<span id="cb25-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"share_nb"</span></span>
<span id="cb25-39">)</span>
<span id="cb25-40"></span>
<span id="cb25-41">resp_ages <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(resp_ages)</span>
<span id="cb25-42"></span>
<span id="cb25-43">resp_bairros <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(bairros_poa, resp_ages, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code_nb"</span>)</span></code></pre></div>
</details>
</div>
<p>O mapa é gerado pelo código abaixo. O mapa mostra o share de domicílios, em cada bairro, que são chefiados por “adultos-jovens”, isto é, de 25 a 39 anos. Nota-se que os bairros que tem maiores percentuais estão mais na periferia da cidade. Alguns bairros de classe alta como Moinhos de Vento, Três Figueiras e Vila Assunção tem os menores percentuais.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tmap)</span>
<span id="cb26-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tmaptools)</span>
<span id="cb26-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tmap_mode</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"view"</span>)</span>
<span id="cb26-4"></span>
<span id="cb26-5">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_shape</span>(resp_bairros) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_fill</span>(</span>
<span id="cb26-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_25_39"</span>,</span>
<span id="cb26-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inferno"</span>,</span>
<span id="cb26-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb26-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jenks"</span>,</span>
<span id="cb26-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb26-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name_neighborhood"</span>,</span>
<span id="cb26-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percentual de domicílios&lt;br&gt;chefiados por pessoas&lt;br&gt;de 25 a 39 anos (%)."</span>,</span>
<span id="cb26-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">popup.vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb26-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Menos de 25 anos"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_25"</span>,</span>
<span id="cb26-16">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"25 a 39 anos"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_25_39"</span>,</span>
<span id="cb26-17">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"40 a 59 anos"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_40_59"</span>,</span>
<span id="cb26-18">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"60 a 79 anos"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_60_79"</span>,</span>
<span id="cb26-19">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"80 anos ou mais"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age_80"</span>),</span>
<span id="cb26-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">popup.format =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb26-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.format =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_borders</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_basemap</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">server =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CartoDB.Positron"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_view</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">set.view =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.179152</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">30.025976</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>))</span>
<span id="cb26-25"></span>
<span id="cb26-26">leaf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tmap_leaflet</span>(m)</span>
<span id="cb26-27">widgetframe<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">frameWidget</span>(leaf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100%"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-c54b2f67a90b5c0d92b4" style="width:100%;height:415.296px;" class="widgetframe html-widget "></div>
<script type="application/json" data-for="htmlwidget-c54b2f67a90b5c0d92b4">{"x":{"url":"index_files/figure-html//widgets/widget_unnamed-chunk-27.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>data-science</category>
  <category>economia</category>
  <category>tutorial-R</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/2023-08-importando-dados-sidra/index.html</guid>
  <pubDate>Thu, 10 Aug 2023 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/images/thumbnails/sidra_logo.png" medium="image" type="image/png" height="70" width="144"/>
</item>
<item>
  <title>Definindo objetos no R. = ou &lt;- ?</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/definindo-objetos/index.html</link>
  <description><![CDATA[ 




<section id="definindo-objetos-no-r" class="level1">
<h1>Definindo objetos no R</h1>
<p>Há dois operadores para definir um objeto no R: <code>=</code> e <code>&lt;-</code>. A maior parte dos usuários parece preferir o último apesar dele parecer um tanto inconveniente. Em teclados antigos, havia uma tecla específica com o símbolo <code>&lt;-</code>, mas em teclados ABNT modernos ele exige três teclas para ser escrito.</p>
<p>Para contornar este incômodo é comum criar um atalho no teclado para esse símbolo; o RStudio, por exemplo, tem um atalho usando a teclas <code>Alt</code> e <code>-</code> em conjunto. Mas ainda assim fica a questão: por que não utilizar o <code>=</code>? A resposta curta é que o símbolo <code>&lt;-</code> é a melhor e mais consistente forma de definir objetos R. Na prática, contudo, há poucas diferenças entre as expressões e elas dificilmente vão fazer alguma diferença. Podemos começar com um exemplo bastante simples para entender estas diferenças.</p>
<section id="qual-a-diferença" class="level2">
<h2 class="anchored" data-anchor-id="qual-a-diferença">Qual a diferença?</h2>
<p>O código abaixo cria duas variáveis, <code>x</code> e <code>y</code>, cujos valores são a sequência <img src="https://latex.codecogs.com/png.latex?1,%202,%203,%204,%205">. Até aí tudo igual. A função <code>all.equal</code> certifica que os objetos são iguais e a função <code>rm</code> “deleta” os objetos. Esta última vai ser conveniente para manter os exemplos organizados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb1-2">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all.equal</span>(x, y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(x, y)</span></code></pre></div>
</div>
<p>Agora considere o código abaixo. A função <code>median</code> está sendo aplicada em <code>x &lt;- 1:5</code>. O que acontece desta vez? O resultado é que é criada uma variável <code>x</code> com valor <code>1 2 3 4 5</code> e também é impresso a mediana deste vetor, i.e., <code>3</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">x</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(x)</span></code></pre></div>
</div>
<p>Poderíamos fazer o mesmo usando <code>=</code>, certo? Errado. Aí está uma das primeiras diferenças entre estes operadores. O código abaixo calcula a mediana do vetor, mas não cria um objeto chamado <code>x</code> com valor <code>1 2 3 4 5</code>. Por quê? O problema é que o operador <code>=</code> tem <em>duas finalidades distintas</em>. Ele serve tanto para definir <em>novos</em> objetos, como em <code>x = 2</code>, como também para definir o <em>valor dos argumentos de uma função</em>, como em <code>rnorm(n = 10, mean = 5, sd = 1)</code>. Coincidentemente, o nome do primeiro argumento da função <code>median</code> é x. Logo, o código abaixo é interpretado como: tire a mediana do vetor <code>1 2 3 4 5</code>. O mesmo acontece com outras funções (ex: <code>mean</code>, <code>var</code>, etc.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">x</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'x' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(x)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rm(x): object 'x' not found</code></pre>
</div>
</div>
<p>Outro exemplo em que há divergência entre os operadores é com o comando <code>lm</code>. Usando <code>&lt;-</code> podemos escrever, numa única linha, um comando que define um objeto <code>lm</code> (resultado de uma regressão) ao mesmo tempo em que pedimos ao R para imprimir os resultados desta regressão. O código abaixo faz justamente isto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Imprime os resultados da regressão e salva as info num objeto chamado 'fit'</span></span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5432 -2.3647 -0.1252  1.4096  6.8727 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***
wt           -5.3445     0.5591  -9.559 1.29e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.046 on 30 degrees of freedom
Multiple R-squared:  0.7528,    Adjusted R-squared:  0.7446 
F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Verifica que é, de fato, um objeto lm</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lm"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(fit)</span></code></pre></div>
</div>
<p>Note que isto não é possível com o operador <code>=</code>. Isto acontece, novamente, porque o <code>=</code> é interpretado de maneira diferente quando aparece dentro de uma função. É necessário quebrar o código em duas linhas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Este exemplo não funciona</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fit =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars))</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in summary.lm(fit = lm(mpg ~ wt, data = mtcars)): argument "object" is missing, with no default</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># É preciso reescrever o código em duas linhas</span></span>
<span id="cb22-2">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span>
<span id="cb22-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5432 -2.3647 -0.1252  1.4096  6.8727 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***
wt           -5.3445     0.5591  -9.559 1.29e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.046 on 30 degrees of freedom
Multiple R-squared:  0.7528,    Adjusted R-squared:  0.7446 
F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(fit)</span></code></pre></div>
</div>
<p>Há também algumas pequenas divergências pontuais. Os primeiros dois argumentos da função <code>lm</code> são <code>formula</code> e <code>data</code>. Considere o código abaixo. Sem executar o código qual deve ser o resultado?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(formula <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mtcars)</span></code></pre></div>
</div>
<p>Estamos aplicando a função <code>lm</code> em dois argumentos. O primeiro deles se chama <code>formula</code> e é definido como <code>mpg ~ wt</code>, o segundo é chamado <code>data</code> e é definido como os valores no data.frame <code>mtcars</code>. Ou seja, o resultado deve ser o mesmo do exemplo acima com <code>median(x &lt;- 1:5)</code>. A função é aplicada sobre os argumentos e os objetos <code>formula</code> e <code>data</code> são criados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(formula <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mtcars)</span>
<span id="cb26-2">fit</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula &lt;- mpg ~ wt, data = data &lt;- mtcars)

Coefficients:
(Intercept)           wt  
     37.285       -5.344  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">formula</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mpg ~ wt</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(fit, formula, data)</span></code></pre></div>
</div>
<p>Note que usei os nomes dos argumentos apenas para exemplificar o caso. Pode-se colocar um nome diferente, pois não estamos “chamando” o argumento e sim especificando qual valor/objeto a função deve utilizar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exemplo utilizando nomes diferentes</span></span>
<span id="cb33-2">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg ~ wt"</span>, b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mtcars)</span>
<span id="cb33-3">fit</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = a &lt;- "mpg ~ wt", data = b &lt;- mtcars)

Coefficients:
(Intercept)           wt  
     37.285       -5.344  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(a)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mpg ~ wt"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(b)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">list =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span>())</span></code></pre></div>
</div>
<p>O mesmo não é possível com <code>=</code>, por causa da duplicidade apontada acima.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg ~ wt"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> mtcars)</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in terms.formula(formula, data = data): argument is not a valid model</code></pre>
</div>
</div>
<p>Há ainda mais alguns exemplos estranhos, resultados da ordem que o R processa os comandos. O segundo código abaixo, por exemplo, não funciona. Isto acontece porque o <code>&lt;-</code> tem “prioridade” e é lido primeiro.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">(x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in x &lt;- y = 5: could not find function "&lt;-&lt;-"</code></pre>
</div>
</div>
<p>É difícil encontrar desvatagens em usar o <code>&lt;-</code> (além da dificuldade de escrevê-lo num teclado normal). Mas há pelo menos um caso em que ele pode levar a problemas. O código abaixo mostra como este operador pode ser sensível a espaços em branco. No caso, define-se o valor de <code>x</code> como <code>-2</code>. O primeiro teste verifica se o valor de <code>x</code> é menor que <img src="https://latex.codecogs.com/png.latex?-1">. Logo, espera-se que o código imprima <code>"ótimo"</code> pois <code>-2</code> é menor que <code>-1</code>. Já o segundo teste faz <em>quase</em> o mesmo. A única diferença é um espaço em branco, mas agora ao invés de um teste, a linha de código define o valor de x como <code>1</code> e imprime <code>"ótimo"</code>, pois o valor do teste (por padrão) é <code>TRUE</code>.</p>
<p>Assim como muitos dos exemplos acima, é difícil imaginar que isto possa ser um problema real. Eventualmente, podemos apagar espaços em branco usando o ‘localizar e substituir’ e isto talvez leve a um erro como o abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define x como -2</span></span>
<span id="cb46-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb46-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Se x for menor que -1 (menos um) então "ótimo"</span></span>
<span id="cb46-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ótimo"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"errado"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ótimo"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Verifica o valor de x</span></span>
<span id="cb48-2">x</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mesma linha com uma diferença sutil</span></span>
<span id="cb50-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ) <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ótimo"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"errado"</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ótimo"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Agora acabamos de mudar o valor de x (e não há aviso algum!)</span></span>
<span id="cb52-2">x</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="mais-um-adendo" class="level2">
<h2 class="anchored" data-anchor-id="mais-um-adendo">Mais um adendo</h2>
<p>Eu citei apenas dois operadores: <code>=</code> e <code>&lt;-</code>; mas na verdade há ainda outros: <code>&lt;&lt;-</code>, <code>-&gt;</code> e <code>-&gt;&gt;</code> (veja <code>help("assignOps")</code>). Os operadores com “flecha dupla” são comumente utilizadas dentro de funções para usos específicos. Algumas pessoas acham que o operador <code>-&gt;</code> é mais intuitivo quando usado com “pipes”. Pessoalmente, acho este tipo de código abominável.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">AirPassengers <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">window</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1955</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1958</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> sub_air_passengers</span>
<span id="cb54-4"></span>
<span id="cb54-5">sub_air_passengers</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
1955 5.488938 5.451038 5.587249 5.594711 5.598422 5.752573 5.897154 5.849325
1956 5.648974 5.624018 5.758902 5.746203 5.762051 5.924256 6.023448 6.003887
1957 5.752573 5.707110 5.874931 5.852202 5.872118 6.045005 6.142037 6.146329
1958 5.828946 5.762051 5.891644 5.852202 5.894403 6.075346 6.196444 6.224558
          Sep      Oct      Nov      Dec
1955 5.743003 5.613128 5.468060 5.627621
1956 5.872118 5.723585 5.602119 5.723585
1957 6.001415 5.849325 5.720312 5.817111
1958 6.001415 5.883322 5.736572 5.820083</code></pre>
</div>
</div>
<p>Além dos operadores base, o popular pacote <code>magrittr</code> também possui um novo tipo de operador. Muitos conhecem o <code>%&gt;%</code> que ajuda a formar “pipes” e carregar objetos progressivamente em funções distintas. Menos conhecido, mas igualmente poderoso, o <code>%&lt;&gt;%</code> faz algo parecido.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)</span>
<span id="cb56-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb56-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(x)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1">x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&lt;&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&lt;&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>()</span>
<span id="cb58-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(x)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.14112</code></pre>
</div>
</div>
<p>Note que o código acima é equivalente ao abaixo. A vantagem do operador <code>%&lt;&gt;%</code> é de evitar a repetição do <code>x &lt;- x ...</code> o que pode ser conveniente quando o nome do objeto é longo. Da mesma forma, também pode ser aplicado para transformar elementos em uma lista ou colunas num <code>data.frame</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb60-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>()</span></code></pre></div>
</div>
<p>Não recomendo o uso nem do <code>-&gt;</code> e nem do <code>%&lt;&gt;%</code>.</p>
</section>
<section id="resumo" class="level2">
<h2 class="anchored" data-anchor-id="resumo">Resumo</h2>
<p>No geral, o operador <code>&lt;-</code> é a forma mais “segura” de se definir objetos. De fato, atualmente, este operador é considerado o mais apropriado. O livro <a href="https://adv-r.hadley.nz/"><em>Advanced R</em></a>, do influente autor Hadley Wickham, por exemplo, recomenda que se use o operador <code>&lt;-</code> <em>exclusivamente</em> para definir objetos.</p>
<p>A inconveniência de escrevê-lo num teclado moderno é contornada, como comentado acima, por atalhos como o <code>Alt</code> + <code>-</code> no RStudio. Em editores de texto como o VSCode, Sublime Text ou Notepad++ também é possível criar atalhos personalizados para o <code>&lt;-</code>. Pessoalmente, eu já me acostumei a digitar <code>&lt;-</code> manualmente e não vejo grande problema nisso. Acho que o <code>=</code> tem seu valor por ser mais intutivo, especialmente para usuários que já tem algum conhecimento de programação, mas acabo usando mais o <code>&lt;-</code>. Por fim, o <code>&lt;-</code> fica bem bonito quando se usa uma fonte com ligaturas como o <a href="https://github.com/tonsky/FiraCode">Fira Code</a>.</p>
<p>É importante frisar que o <code>&lt;-</code> continua sendo o operador de predileção da comunidade dos usuários de R e novas funções/pacotes devem ser escritas com este sinal. Por sorte há opções bastante simples que trocam os <code>=</code> para <code>&lt;-</code> corretamente como o <code>formatR</code> apresentado abaixo. Veja também o addin do pacote <code>styler</code>. Ou seja, é possível escrever seu código usando <code>=</code> e trocá-los por <code>&lt;-</code> de maneira automática se for necessário.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(formatR)</span>
<span id="cb61-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_source</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x = rnorm(n = 10, mean = 2)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;- rnorm(n = 10, mean = 2)</code></pre>
</div>
</div>
<p>O ponto central deste post, na verdade, é mostrar como os operadores <code>&lt;-</code> e <code>=</code> são muito similares na prática e que a escolha entre um ou outro acaba caindo numa questão subjetiva. Há quem acredite ser mais cômodo usar o <code>=</code> não só porque ele é mais fácil de escrever, mas também porque ele é mais próximo de <em>universal</em>. Várias linguagens de programação comuns para a/o economista (Matlab, Python, Stata, etc.) usam o sinal de igualdade para definir objetos e parece estranho ter que usar o <code>&lt;-</code> somente para o R.</p>
<p>Em livros de econometria ambos os operadores são utilizados. Os livros <a href="https://www.econometrics-with-r.org/index.html">Introduction to Econometrics with R</a>, <a href="https://www.zeileis.org/teaching/AER/">Applied Econometrics with R</a>, <a href="https://link.springer.com/book/10.1057/9781137317940">Arbia. Spatial Econometrics</a>, entre outros, usam o <code>&lt;-</code>. Já os livros <a href="https://faculty.chicagobooth.edu/ruey-s-tsay/research/analysis-of-financial-time-series-3rd-edition">Tsay. Financial Time Series</a> e <a href="https://link.springer.com/book/10.1007/978-3-319-52452-8">Shumway &amp; Stoffer. Time Series Analysis</a> usam <code>=</code>.</p>
<p>No fim, use o operador que melhor</p>


</section>
</section>

 ]]></description>
  <category>tutorial-R</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/definindo-objetos/index.html</guid>
  <pubDate>Tue, 11 Jul 2023 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/codigo_generico.png" medium="image" type="image/png" height="56" width="144"/>
</item>
<item>
  <title>Pacotes Essenciais R</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/pacotes-essenciais-r/index.html</link>
  <description><![CDATA[ 




<p>R é uma das linguagens de programação mais populares para ciência de dados, estatística, economia e várias outras áreas quantitativas. O <code>R</code> já vem com alguns pacotes “imbutidos” que, em geral, são referidos como <code>base R</code>, são os pacotes que são instalados automaticamente junto com o <code>R</code> como o <code>stats</code>, <code>utils</code>, <code>graphics</code>, <code>datasets</code> entre outros.</p>
<p>Ou seja, já é possível importar dados e limpá-los, fazer análises estatísticas, gráficos e tabelas sem carregar nenhum pacote adicional.</p>
<p>Mas para o usufruir de todo o potencial que o R pode oferecer é essencial conhecer os melhores pacotes e as suas funções.</p>
<section id="a-lista-de-pacotes-essenciais" class="level1">
<h1>A lista de pacotes essenciais</h1>
<table class="table">
<colgroup>
<col style="width: 39%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th>Nome do Pacote</th>
<th>Principal Uso</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><code>data.table</code></p></td>
<td><p>Manipulação de dados extremamente veloz para bigdata</p></td>
</tr>
<tr class="even">
<td><p><code>dplyr</code> + <code>tidyr</code></p></td>
<td><p>Manipulação de dados</p></td>
</tr>
<tr class="odd">
<td><p><code>readr</code></p></td>
<td><p>Importar e exportar arquivos</p></td>
</tr>
<tr class="even">
<td><p><code>stringr</code></p></td>
<td><p>Trabalhar com strings</p></td>
</tr>
<tr class="odd">
<td><p><code>lubridate</code></p></td>
<td><p>Trabalhar com datas</p></td>
</tr>
<tr class="even">
<td><p><code>ggplot2</code></p></td>
<td><p>Visualização de dados com varias extensões</p></td>
</tr>
<tr class="odd">
<td><p><code>knitr</code> + <code>shiny</code> + <code>rmarkdown</code> + <code>quarto</code></p></td>
<td><p>Desenvolvimento de relatórios, apresentações, dashboards e Apps</p></td>
</tr>
<tr class="even">
<td><p><code>dbplyr</code></p></td>
<td><p>Interface para interagir com Bases de Dados (SQL, PostGreSQL, etc.)</p></td>
</tr>
</tbody>
</table>
<p>A verdade é que cada usuário de <code>R</code> tem demandas específicas, então é difícil dizer quais são os pacotes <strong>indisipensáveis</strong>. Por isso o foco da minha lista foi em pacotes que facilitam três partes essenciais de qualquer análise de dados: importação, manipulação e apresentação dos dados.</p>
<p>Independentemente do foco do seu projeto ou da sua pesquisa eu garanto que será necessário:</p>
<ol type="1">
<li>Importar dados no <code>R</code></li>
<li>Transformar esses dados</li>
<li>Apresentar seus resultados na forma de gráficos, tabelas, relatórios, dashboards, etc.</li>
</ol>
</section>
<section id="importar-dados" class="level1">
<h1>Importar dados</h1>
<section id="tabelas-csv" class="level3">
<h3 class="anchored" data-anchor-id="tabelas-csv">Tabelas csv</h3>
<p>Quando comecei a usar <code>R</code> uma das partes mais agoniantes era conseguir importar arquivos de dados externos corretamente. As funções <code>read.csv</code>, <code>read.csv2</code>, <code>read.delim</code> funcionam bem, mas o <code>readr</code> tornou isso tudo muito mais fácil.</p>
<p>O pacote essencialmente tem funções <code>read_*</code> (<code>read_csv</code>, <code>read_fwf</code>, etc.) que servem para importar dados e funções <code>write_</code> (<code>write_csv</code>, <code>write_excel_csv</code>, etc.) que servem para exportar dados num formato específico.</p>
<p>Além das funções <code>read_*</code> e <code>write_*</code>, vale a pena explorar as funções <code>parse_*</code> como <code>parse_number</code> e <code>parse_date</code> que são muito convenientes para garantir que seus dados estejam sendo interpretados da maneira correta.</p>
<p>Para arquivos mais pesados vale considerar duas opções: <code>vroom</code> e <code>data.table</code>. O primeiro é um pacote enxuto que permite a importação e exportação rápida de arquivos <code>csv</code> mais pesados. Já a segunda opção é um pacote completo, que será disuctido em maiores detalhes abaixo, de importação e manipulação de dados. A função <code>data.table::fread</code> é extremamente veloz.</p>
</section>
<section id="outros-formatos" class="level3">
<h3 class="anchored" data-anchor-id="outros-formatos">Outros formatos</h3>
<p>Se você utiliza dados em formatos mais específicos então outros pacotes se tornam essenciais. A lista abaixo cita alguns dos casos mais comuns:</p>
<ul>
<li><code>haven</code> - SPSS, SAS e Stata</li>
<li><code>readxl</code> - Excel</li>
<li><code>jsonlite</code> - Json</li>
<li><code>sf</code> - Shapefiles em geral</li>
</ul>
<p>Por fim, vale notar um pacote simpático chamado <code>rio</code> que tem duas funções centrais <code>import</code> e <code>export</code>. Essas funções automaticamente detectam o tipo de arquivo que você quer importar ou exportar e chamam a função do pacote apropriado para executar a tarefa.</p>
<p>A única desvantagem desta conveniência é que em casos mais complicados pode ser difícil lembrar do nome dos argumentos da função que você precisa. Por exemplo, o <code>import</code> usa o o <code>readxl</code> para importar um arquivo <code>xlsx</code>. Mas você precisa lembrar de cabeça que o argumento para selecionar uma aba específica é <code>sheet</code>.</p>
</section>
</section>
<section id="manipulação-de-dados" class="level1">
<h1>Manipulação de dados</h1>
<p>Toda análise começa com uma base de dados (ou muitas bases de dados). E se você já se aventurou o suficiente no mundo, você sabe que são raríssimas as bases de dados que já vem prontas no momento em que você baixa o <code>csv</code> ou <code>xlsx</code>. Na grande maioria dos casos, é preciso passar por diversas etapas de limpeza ou de pré-processamento para transformar os dados em algo que possa ser analisado.</p>
<p>O <code>R</code> tem várias funções no seu core para realizar essas tarefas mas há dois pacotes essenciais que melhoram (e muito) essa tarefa: <code>dplyr</code> e <code>data.table</code>.</p>
<section id="dplyr-x-data.table" class="level2">
<h2 class="anchored" data-anchor-id="dplyr-x-data.table">dplyr x data.table</h2>
<p>O <code>dplyr</code> é bastante intuitivo, poderoso e há centenas de tutoriais e livros sobre ele. Ele serve para transformar os dados: criar colunas, filtrar linhas, reordernar dados, etc. Ele integra um “ecossistema” de pacotes chamado <a href="https://www.tidyverse.org">tidyverse</a>, uma coleção de pacotes para processamento e visualização de dados, construídos em torno de uma filosofia comum.</p>
<p>O <code>data.table</code> surgiu com o intuito de fazer o <code>R</code> funcionar melhor num mundo de big data. Seu desenvolvimento foi focado em ser o mais rápido, eficiente e sucinto possível, permitindo trabalhar com bases de dados muito grandes dentro do <code>R</code> (~100GB). Em termos de velocidade, o <code>data.table</code> ganha facilmente de praticamente <a href="https://h2oai.github.io/db-benchmark/">todas as outras linguagens populares em data science</a>. Ele é centena de vezes mais rápido que base <code>R</code> e também ganha com folga do seu competidor <code>dplyr</code>.</p>
<p>Se o <code>data.table</code> é tão mais eficiente então como o <code>dplyr</code> se tornou mais popular do que ele?</p>
<p>Acontece que o <code>dplyr</code> é melhor integrado com vários outros pacotes podersos do <code>tidyverse</code>. Também há muito material de apoio ao <code>dplyr</code> na forma de tutoriais, vídeos, livros, etc. disponíveis na internet. Quase todo curso de R ensina a usar o <code>dplyr</code>. Assim, a curva de aprendizado fica mais fácil.</p>
<p>O <code>data.table</code> funciona muito bem com funções do <code>base R</code> como <code>lapply</code>, <code>colMeans()</code>, etc. e tem uma sintaxe concisa e flexível, onde o usuário acaba tendo bastante liberdade para criar as suas soluções. Já o <code>dplyr</code> vai pelo caminho de tentar facilitar ao máximo a vida do usuário criando várias funções com usos bastante específicos para otimizar pequenas tarefas do dia-a-dia do processamento de dados.</p>
<p>Outra pequena desvantagem do <code>data.table</code> é que ele <strong>não funciona de primeira no Mac</strong>. Como ele usa OpenMP é preciso baixar outros programas e modificar algumas configurações no <code>R</code> o que pode ser bem trabalhoso e chato.</p>
<p>Na comparação fica o seguinte:</p>
<table class="table">
<colgroup>
<col style="width: 65%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th><code>dplyr</code></th>
<th><code>data.table</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mais funções para aprender. Em geral, o código fica mais comprido</td>
<td>Sintaxe sucinta</td>
</tr>
<tr class="even">
<td>Funções melhor integradas com o <code>tidyverse</code></td>
<td>Funções melhor integradas com base <code>R</code></td>
</tr>
<tr class="odd">
<td>Muito mais veloz que o base <code>R</code></td>
<td>Opção mais veloz possível</td>
</tr>
<tr class="even">
<td>Sintaxe mais intuitiva, mais material de apoio na internet, mais popular.</td>
<td>Menos material de apoio disponível</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="tidyverse">tidyverse</h2>
<p>Indepedentemente da sua escolha entre <code>dplyr</code> e/ou <code>data.table</code> (recomendo usar os dois!) vale a pena explorar os demais pacotes do <code>tidyverse</code>.</p>
<section id="tidyr" class="level3">
<h3 class="anchored" data-anchor-id="tidyr">tidyr</h3>
<p>O <code>tidyr</code> acrescenta algumas importantes funcionalidades que faltam no <code>dplyr</code>. Talvez as duas funções mais importantes do pacote sejam <code>pivot_longer</code> e <code>pivot_wider</code> que servem para converter seus dados de transversais (wide) para longitudinais (long) e vice-versa. O <code>tidyr</code> também traz um novo tipo de objeto o <code>tibble</code>, uma versão moderna do <code>data.frame</code>.</p>
<p>Vale também explorar algumas funções muito úteis como <code>separate</code>, <code>fill</code>, <code>complete</code>, <code>replace_na</code> entre outras.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exemplo de tibble</span></span>
<span id="cb1-4">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(USPersonalExpenditure)</span>
<span id="cb1-5">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variable =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(USPersonalExpenditure))</span>
<span id="cb1-6">data</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  `1940` `1945` `1950` `1955` `1960` variable           
   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;              
1 22.2   44.5    59.6    73.2  86.8  Food and Tobacco   
2 10.5   15.5    29      36.5  46.2  Household Operation
3  3.53   5.76    9.71   14    21.1  Medical and Health 
4  1.04   1.98    2.45    3.4   5.4  Personal Care      
5  0.341  0.974   1.8     2.6   3.64 Private Education  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exemplo de dado longitudinal</span></span>
<span id="cb3-2">long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>variable, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>)</span>
<span id="cb3-3">long</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 3
   variable            year  value
   &lt;chr&gt;               &lt;chr&gt; &lt;dbl&gt;
 1 Food and Tobacco    1940   22.2
 2 Food and Tobacco    1945   44.5
 3 Food and Tobacco    1950   59.6
 4 Food and Tobacco    1955   73.2
 5 Food and Tobacco    1960   86.8
 6 Household Operation 1940   10.5
 7 Household Operation 1945   15.5
 8 Household Operation 1950   29  
 9 Household Operation 1955   36.5
10 Household Operation 1960   46.2
# ℹ 15 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcula a variação e apresenta de maneira transversal</span></span>
<span id="cb5-2">long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(variable) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variacao =</span> (value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb5-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"variable"</span>,</span>
<span id="cb5-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>,</span>
<span id="cb5-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"variacao"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
# Groups:   variable [5]
  variable            `1945` `1950` `1955` `1960`
  &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Food and Tobacco     100.    33.9   22.8   18.6
2 Household Operation   47.6   87.1   25.9   26.6
3 Medical and Health    63.2   68.6   44.2   50.7
4 Personal Care         90.4   23.7   38.8   58.8
5 Private Education    186.    84.8   44.4   40  </code></pre>
</div>
</div>
</section>
<section id="stringr" class="level3">
<h3 class="anchored" data-anchor-id="stringr">stringr</h3>
<p>O <code>stringr</code> é um pacote voltado para facilitar a manipulação de vetores de texto (<code>character</code>). Todas as funções do pacote são convenientemente precedidas pelo prefixo <code>str_</code> e a lista dos argumentos segue um padrão uniforme. O nome das funções também é bastante intuitivo.</p>
<p>Novamente, há funções base como <code>gsub</code>, <code>grep</code>, <code>strsplit</code>, <code>sub</code>, entre outras, que servem para manipular vetores de string, mas essas funções carecem de “coesão interna” e em alguns casos elas podem retornar valores inesperados ou “erros silenciosos”.</p>
<p>Uma função muito divertida do pacote é a <code>str_glue</code> que facilita na hora de concatenar strings. Note como é simples incluir variáveis como parte do texto e inclusive fazer transformações nas variáveis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb7-2"></span>
<span id="cb7-3">nome <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vinicius Oike"</span></span>
<span id="cb7-4">idade <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span></span>
<span id="cb7-5">nfav <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Olá, meu nome é {nome}, tenho {idade} anos. Ano que vem, terei {idade + 1} anos. Meu número favorito é {round(nfav)}."</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Olá, meu nome é Vinicius Oike, tenho 29 anos. Ano que vem, terei 30 anos. Meu número favorito é 3.</code></pre>
</div>
</div>
</section>
<section id="lubridate" class="level3">
<h3 class="anchored" data-anchor-id="lubridate">lubridate</h3>
<p>O <code>lubridate</code> é um pacote exclusivamente focado em manipulação de vetores de datas e tudo relacionado ao tempo como variável. Variáveis de datas podem ser uma dor de cabeça tremenda no processo de limpeza de dados, pois há inúmeros formatos diferentes, que variam para cada país, fora os problemas potenciais de ano bissextos, fusos-horários diferentes, etc.</p>
<p>Especialmente para quem precisa trabalhar com séries de tempo ou dados em painel, o <code>lubridate</code> é um pacote é essencial.</p>
<p>O pacote também facilita “operações aritméticas” com datas como no exemplo abaixo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb9-2"></span>
<span id="cb9-3">start <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymd</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-01-15"</span>)</span>
<span id="cb9-4">start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">years</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">months</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021-04-15"</code></pre>
</div>
</div>
<p>Ele também permite a extração de qualquer informação específica de uma data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">agora <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymd_hms</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2022-06-10 20:36:15"</span>)</span></code></pre></div>
</div>
<p>Como o dia da semana:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wday</span>(agora)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>O trimestre:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quarter</span>(agora)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Ou o mês (com a opção de ter a abreviação do mês já no padrão desejado!):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">month</span>(agora, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt_BR"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Jun
12 Levels: Jan &lt; Fev &lt; Mar &lt; Abr &lt; Mai &lt; Jun &lt; Jul &lt; Ago &lt; Set &lt; ... &lt; Dez</code></pre>
</div>
</div>
</section>
<section id="dbplyr" class="level3">
<h3 class="anchored" data-anchor-id="dbplyr">dbplyr</h3>
<p>O <code>dbplyr</code> é um pacote muito interessante que transforma o <code>R</code> numa “interface” para o SQL. O pacote traduz código escrito em <code>dplyr</code> para código em SQL. Assim, é possível acessar, transformar e baixar dados de uma Base de Dados em SQL, PostGreSQL, etc. diretamente no <code>R</code>.</p>
<p>O código abaixo é um exemplo (bem artficial) que demonstra o funcionamento da pacote. A função <code>show_query()</code> não costuma ser usada na prática, mas ela serve para mostrar o que o pacote está fazendo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dbplyr)</span>
<span id="cb18-3"></span>
<span id="cb18-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Abre um servidor SQL para servir de exemplo</span></span>
<span id="cb18-5">con <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> DBI<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbConnect</span>(RSQLite<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">SQLite</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dbname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":memory:"</span>)</span>
<span id="cb18-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Faz o update da tabela mtcars para esse servidor</span></span>
<span id="cb18-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">copy_to</span>(con, mtcars)</span>
<span id="cb18-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acessa a tabela do servidor usando tbl</span></span>
<span id="cb18-9">db <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl</span>(con, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mtcars"</span>)</span>
<span id="cb18-10"></span>
<span id="cb18-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Trabalha normalmente usando comandos do dplyr</span></span>
<span id="cb18-12">db <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(cyl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">disp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(disp))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(cyl) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(disp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(a1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># No lugar de show_query() use collect() para baixar os dados</span></span>
<span id="cb18-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">show_query</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt;
SELECT `cyl`, AVG(`disp`) AS `a1`, MEDIAN(`wt`) AS `a2`
FROM (
  SELECT
    `mpg`,
    `cyl`,
    LOG(ROUND(`disp`, 0)) AS `disp`,
    `hp`,
    `drat`,
    `wt`,
    `qsec`,
    `vs`,
    `am`,
    `gear`,
    `carb`
  FROM `mtcars`
  WHERE (`cyl` IN (4.0, 6.0))
)
GROUP BY `cyl`
ORDER BY `a1` DESC</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="visualização-de-dados" class="level1">
<h1>Visualização de dados</h1>
<p>Aqui a lista fica simples pois o <code>ggplot2</code> é simplesmente indispensável. O <code>ggplot2</code> foi lançado em 2005 e até hoje ainda é o pacote mais baixado de <code>R</code> na <a href="https://www.r-pkg.org/downloaded">lista oficial do CRAN</a>. É um pacote sinônimo de <code>R</code> e dá um baile em qualquer outro pacote de visualização.</p>
<p>O <code>ggplot2</code> tem uma sintaxe bastante intuitiva em que o usário vai adicionando camadas e elementos sobre o gráfico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mpg)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ef476f"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(cyl))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#073b4c"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#06d6a0"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffd166"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/pacotes-essenciais-r/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>O pacote por si só já é muito poderoso, mas há ainda inúmeras <a href="https://exts.ggplot2.tidyverse.org/gallery/">extensões desnenvolvidas por outros usuários</a>.</p>
<p>Para ter uma ideia do potencial do pacote vale olhar, por exemplo, a <a href="https://www.cedricscherer.com/top/dataviz/#&amp;gid=1&amp;pid=50">galeria de visualizações do Cédric Scherer</a>.</p>
</section>
<section id="relatórios-e-apps" class="level1">
<h1>Relatórios e Apps</h1>
<section id="rmarkdown" class="level2">
<h2 class="anchored" data-anchor-id="rmarkdown">RMarkdown</h2>
<p>Uma análise de dados, em geral, vira um de dois produtos: um relatório/artigo ou um aplicativo interativo. Novamente o <code>R</code> tem funcionalidades incríveis para ambos os objetivos. Existe um tipo de arquivo chamado <code>RMarkdown</code> que junto com o pacote <code>knitr</code> permite compilar um arquivo misto de <code>Markdown</code> e <code>R</code> em formato <code>pdf</code>, <code>html</code>, <code>doc</code> ou <code>ppt</code>.</p>
<p>Essa extensão é tão poderosa que não só é possível escrever um artigo científico com ela, mas também, um <a href="https://pkgs.rstudio.com/flexdashboard/">dashboard interativo</a>, um <a href="https://bookdown.org">livro inteiro</a>, ou até um <a href="https://bookdown.org/yihui/blogdown/">blog/site</a> (este blog é escrito em <code>RMarkdown</code>).</p>
<p>Atualmente o formato do código é ainda mais flexível, permitindo misturar linguagens como <code>R</code>, <code>Python</code>, <code>SQL</code> e outras num mesmo arquivo. <a href="https://rmarkdown.rstudio.com">Um resumo das funcionalidades pode ser visto aqui</a>.</p>
</section>
<section id="shiny" class="level2">
<h2 class="anchored" data-anchor-id="shiny">Shiny</h2>
<p>O pacote <code>shiny</code> tem se tornado cada vez mais potente nos últimos anos. Inicialmente, ele servia para montar dashboards relativamente simples, que permitiam ao usuário mais liberdade para explorar e montar suas próprias análises. Atualmente, tanto o pacote como as suas extensões melhoraram muito o seu potencial.</p>
<p>A <a href="https://shiny.rstudio.com/gallery/">galeria de apps do RStudio</a> já está um pouco desatualizada, mas dá um sabor do que é possível fazer com <code>shiny</code>.</p>
<p>Alguns exemplos:</p>
<ul>
<li><a href="https://vnijs.shinyapps.io/radiant/?SSUID=102af87a3a">Radiant</a> - Esta é, sem dúvida, uma das aplicações mais completas e impressionantes de Shiny, vale um post inteiro por si só.</li>
<li><a href="https://vac-lshtm.shinyapps.io/ncov_tracker/?_ga=2.208589338.945012269.1654951879-1352143415.1654951879#">Monitor de Covid</a></li>
<li><a href="https://voronoys.shinyapps.io/voronoys/?_ga=2.21641907.945012269.1654951879-1352143415.1654951879">Anaálise do Perfil de Eleitor no Brasil</a></li>
</ul>
</section>
<section id="quarto" class="level2">
<h2 class="anchored" data-anchor-id="quarto">Quarto</h2>
<p>Recentemente lançado, o <code>quarto</code> não é um pacote de <code>R</code> propriamente dito. O Quarto é como um <code>RMarkdown</code> turbinado, é um meio de publicar análises de dados com textos. De maneira geral o Quarto te permite:</p>
<ul>
<li>Escrever e rodar análises de dados em <code>R</code>, python e julia</li>
<li>Publicar relatórios, dashboards, livros, sites, etc.</li>
<li>Publicar artigos científicos utilizando equações, citações, etc.</li>
</ul>
<p>Para conhecer mais sobre o Quarto vale a pena checar o <a href="https://quarto.org/">site</a>. Como o Quarto foi desenvolvido pela Posit, que desenvolvou o <code>RStudio</code> a IDE mais popular de <code>R</code>, o Quarto e o <code>R</code> funcionam muito bem no <code>RStudio</code>.</p>
</section>
</section>
<section id="quero-baixar-tudo" class="level1">
<h1>Quero baixar tudo</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># O tidyverse inclui a instalação do dplyr, tidyr, readr, stringr e outros</span></span>
<span id="cb21-2">packs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb21-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.table"</span>,</span>
<span id="cb21-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vroom"</span>,</span>
<span id="cb21-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>,</span>
<span id="cb21-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"readxl"</span>,</span>
<span id="cb21-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"haven"</span>,</span>
<span id="cb21-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jsonlite"</span>,</span>
<span id="cb21-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>,</span>
<span id="cb21-10">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rio"</span>,</span>
<span id="cb21-11">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lubridate"</span>,</span>
<span id="cb21-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dbplyr"</span>,</span>
<span id="cb21-13">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"odbc"</span>,</span>
<span id="cb21-14">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DBI"</span>,</span>
<span id="cb21-15">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knitr"</span>,</span>
<span id="cb21-16">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shiny"</span>,</span>
<span id="cb21-17">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quarto"</span></span>
<span id="cb21-18">  )</span>
<span id="cb21-19"></span>
<span id="cb21-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(packs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repos =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://vps.fmvz.usp.br/CRAN/"</span>)</span></code></pre></div>
</div>


</section>

 ]]></description>
  <category>data-science</category>
  <category>econometria</category>
  <category>tutorial-R</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/pacotes-essenciais-r/index.html</guid>
  <pubDate>Fri, 30 Jun 2023 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/installing_packages.png" medium="image" type="image/png" height="46" width="144"/>
</item>
<item>
  <title>Visualizando uma única variável</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index.html</link>
  <description><![CDATA[ 




<p>Há algum tempo atrás tive o seguinte problema: como visualizar várias observações de uma única variável numérica num gráfico? Tentei algumas soluções óbvias, mas nenhuma pareceu funcionar muito bem. Neste post junto algumas das minhas tentativas.</p>
<p>Os dados provêm do <a href="https://www.nossasaopaulo.org.br/2019/11/05/mapa-da-desigualdade-2019-e-lancado-em-sao-paulo/">Mapa da Desigualdade 2019</a>. Neste site pode-se baixar todos os dados além de baixar o relatório completo que apresenta informações socioeconômicas atualizadas para todos os distritos de São Paulo, compilando e sistematizando dados de diversas fontes públicas.</p>
<section id="pacotes-tema-e-dados." class="level1">
<h1>Pacotes, tema e dados.</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(forcats)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(janitor)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(classInt)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(showtext)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importa a fonte Roboto Light</span></span>
<span id="cb2-2">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Light"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular.wt =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb2-3">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Um tema básico para os gráficos</span></span>
<span id="cb2-6">theme_vini <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Light"</span>),</span>
<span id="cb2-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Light"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb2-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb2-12">  )</span></code></pre></div>
</div>
<p>O código abaixo mostra como importei e limpei os dados.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importa os dados do arquivo xlsx</span></span>
<span id="cb3-2">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readxl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(</span>
<span id="cb3-3">  here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"general-posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"repost-mapa-desigualdade"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tabela.xlsx"</span>),</span>
<span id="cb3-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sheet =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb3-5">)</span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Arruma o nome das colunas</span></span>
<span id="cb3-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(df)</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Alguns bairros para destacar nos graficos</span></span>
<span id="cb3-10">sel_bairro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grajaú"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Penha"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sapopemba"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bela Vista"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moema"</span>)</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Função para converter os numeros</span></span>
<span id="cb3-13">as_numeric_string <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb3-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stopifnot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(x))</span>
<span id="cb3-15">  x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">."</span>)</span>
<span id="cb3-16">  x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>)</span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(x))</span>
<span id="cb3-18">  </span>
<span id="cb3-19">}</span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Função para abreviar o nome dos distritos</span></span>
<span id="cb3-22">pat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vila"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jardim"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cidade"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Santo"</span>)</span>
<span id="cb3-23">pat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(pat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-24"></span>
<span id="cb3-25">str_shorten <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb3-26">  </span>
<span id="cb3-27">  vl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb3-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vila"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vl."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jardim"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jd."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cidade"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cd."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Santo"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"St."</span>,</span>
<span id="cb3-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Santa"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"St."</span></span>
<span id="cb3-30">    )</span>
<span id="cb3-31">  </span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unname</span>(vl[x]))</span>
<span id="cb3-33"></span>
<span id="cb3-34">}</span>
<span id="cb3-35"></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Limpa os dados</span></span>
<span id="cb3-37">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-38">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Renomeia a coluna de idade_media_ao_morrer</span></span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expec_vida =</span> idade_media_ao_morrer) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Seleciona apenas as colunas de interesse</span></span>
<span id="cb3-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id_regiao, distrito, expec_vida, populacao_total) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-43">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encurta o nome dos distritos</span></span>
<span id="cb3-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_distrito =</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(distrito, pat, str_shorten),</span>
<span id="cb3-45">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Converte as colunas numéricas</span></span>
<span id="cb3-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expec_vida =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_numeric_string</span>(expec_vida),</span>
<span id="cb3-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">populacao_total =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_numeric_string</span>(populacao_total),</span>
<span id="cb3-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Variável dummy para indicar os bairros destacados</span></span>
<span id="cb3-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(distrito <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> sel_bairro, 1L, 0L))</span>
<span id="cb3-50">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>()</span>
<span id="cb3-52"></span>
<span id="cb3-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabela auxiliar somente com os valores médios do municíoio</span></span>
<span id="cb3-54">df_media <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(df, distrito <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Município SP"</span>)</span>
<span id="cb3-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabela auxiliar somente com os municipios destacados</span></span>
<span id="cb3-56">df_aux_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(df, highlight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-57"></span>
<span id="cb3-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove a média da tabela</span></span>
<span id="cb3-59">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(df, distrito <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Município SP"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="expectativa-de-vida-por-distrito-de-são-paulo" class="level1">
<h1>Expectativa de vida por distrito de São Paulo</h1>
<p>Há mais de 90 distritos em São Paulo e temos estimativas da expectativa de vida média em cada um deles. O expec_vida mais alto foi de 80,57 anos, registrado no distrito de Moema, cifra próxima a de países como Dinamarca e Liechtenstein. Como referência, a expectativa de vida média em São Paulo é de 68,7.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-hover table-striped table-sm small" data-quarto-postprocess="true">
<caption>Distritos com expectativa de vida mais elevada</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Distrito</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Expectativa de Vida</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Jardim Paulista</td>
<td style="text-align: center;">80.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">Moema</td>
<td style="text-align: center;">79.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Itaim Bibi</td>
<td style="text-align: center;">79.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">Alto de Pinheiros</td>
<td style="text-align: center;">79.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Pinheiros</td>
<td style="text-align: center;">78.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">Vila Mariana</td>
<td style="text-align: center;">78.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Santo Amaro</td>
<td style="text-align: center;">78.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">Consolação</td>
<td style="text-align: center;">78.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Perdizes</td>
<td style="text-align: center;">77.9</td>
</tr>
<tr class="even">
<td style="text-align: center;">Campo Belo</td>
<td style="text-align: center;">77.9</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Do outro lado temos expec_vidaes significativamente mais baixos, registrados em alguns dos distritos de menor renda de São Paulo como Cidade Tiradentes e Marsilac. A diferença na expectativa de vida entre os distritos chega a mais de 20 anos.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-hover table-striped table-sm small" data-quarto-postprocess="true">
<caption>Distritos com expectativa de vida mais baixa</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Distrito</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Expectativa de Vida</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Iguatemi</td>
<td style="text-align: center;">59.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">Cidade Tiradentes</td>
<td style="text-align: center;">59.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Jardim Ângela</td>
<td style="text-align: center;">59.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">São Rafael</td>
<td style="text-align: center;">59.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Grajaú</td>
<td style="text-align: center;">60.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">Guaianases</td>
<td style="text-align: center;">61.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Lajeado</td>
<td style="text-align: center;">61.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">Anhanguera</td>
<td style="text-align: center;">61.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Marsilac</td>
<td style="text-align: center;">61.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">Brás</td>
<td style="text-align: center;">61.7</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>O objetivo aqui é de enxergar mais claramente estas diferenças. Como é a expectativa de vida nos diferentes distritos de São Paulo?</p>
<section id="histograma" class="level2">
<h2 class="anchored" data-anchor-id="histograma">Histograma</h2>
<p>Uma solução bastante clássica seria de fazer um histograma. Neste tipo de gráfico a dispersão fica clara, mas pode ser difícil de dar destaque para distritos específicos. O histograma conta a frequência de observações dentro de janelas de tamanho fixo. A princípio, a única dificuldade em usar o histograma está em definir a amplitude de cada um destes intervalos, mas, na prática, este problema não costuma ser muito complexo.</p>
<p>Ainda que o gráfico seja comumente usado, ele não é tão popular, sendo raramente visto em publicações de jornal, por exemplo.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> expec_vida)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#08519c"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux_label,</span>
<span id="cb4-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> expec_vida,</span>
<span id="cb4-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb4-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(label_distrito, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)),</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray25"</span>,</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Light"</span>,</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb4-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux_label,</span>
<span id="cb4-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> expec_vida,</span>
<span id="cb4-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> expec_vida,</span>
<span id="cb4-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span></span>
<span id="cb4-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de Vida"</span>,</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Anos de idade"</span>,</span>
<span id="cb4-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: SMS (Secretaria Municipal de Saúde)"</span>,</span>
<span id="cb4-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Idade média ao morrer em 2022."</span></span>
<span id="cb4-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-30">  theme_vini <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-colunas" class="level2">
<h2 class="anchored" data-anchor-id="gráfico-de-colunas">Gráfico de colunas</h2>
<p>Um simples gráfico de colunas também poderia ser uma alternativa. Neste caso, como há muitas observações (distritos) diferentes, o gráfico acaba sobrecarregado e confuso.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">ordered_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_distrito =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(label_distrito),</span>
<span id="cb5-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_distrito =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(label_distrito, expec_vida)</span>
<span id="cb5-5">  )</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ordered_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> label_distrito, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> expec_vida)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#08519c"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de Vida"</span>,</span>
<span id="cb5-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Anos de idade"</span>,</span>
<span id="cb5-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb5-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: SMS (Secretaria Municipal de Saúde)"</span>,</span>
<span id="cb5-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Idade média ao morrer em 2022."</span></span>
<span id="cb5-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-18">  theme_vini <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb5-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-23">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index_files/figure-html/unnamed-chunk-8-1.png" style="width:100.0%" height="805" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Outra saída seria dividir os dados em grupos menores (e.g.&nbsp;alta, média-alta, média-baixa, baixa) e usar a função <code>facet_wrap</code>. O lado negativo disto, além de tornar o código mais complexo, é de acrescentar divisões nos dados que eventualmente são muito artificiais.</p>
<p>Aqui eu faço um divisão por quintil e crio uma denominação um tanto arbitrária para permitir a leitura dos dados.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">xl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Baixo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Médio-Baixo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Médio"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Médio-Alto"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alto"</span>)</span>
<span id="cb6-2"></span>
<span id="cb6-3">quintile_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ordered_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb6-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">life_group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ntile</span>(expec_vida, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb6-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">life_group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(life_group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> xl)</span>
<span id="cb6-7">    )</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(quintile_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> label_distrito, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> expec_vida)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#08519c"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(life_group), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de Vida"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-14">  theme_vini <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb6-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>),</span>
<span id="cb6-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb6-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb6-19">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lolipop" class="level2">
<h2 class="anchored" data-anchor-id="lolipop">Lolipop</h2>
<p>Este tipo de gráfico vem ganhando espaço mesmo em veículos de mídia populares por ser bastante simples. Ele é mais comumente usado para mostrar a evolução de uma variável em dois momentos do tempo, mas também pode-se usá-lo analogamente a um gráfico de colunas.</p>
<p>Infelizmente, neste exemplo, ele vai sofrer do mesmo problema que o gráfico de colunas. A título de exemplo faço um gráfico deste estilo apenas para os distritos com as maiores e menores expectativas de vida.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ordena a base de dados pela expectativa de vida</span></span>
<span id="cb7-2">ordered_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(ordered_df, expec_vida)</span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cria uma tabela com as primeiras 5 e últimas 5 linhas</span></span>
<span id="cb7-4">top_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ordered_df, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span>(ordered_df, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(top_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> label_distrito, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> expec_vida)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> label_distrito, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#08519c"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Anos de vida"</span>,</span>
<span id="cb7-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de vida"</span>,</span>
<span id="cb7-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Idade média ao morrer em 2022. Dados apenas dos distritos</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">com maiores e menores expectativas de vida."</span>,</span>
<span id="cb7-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: SMS (Secretaria Municipal de Saúde)"</span></span>
<span id="cb7-16">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-17">  theme_vini <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-dispersão" class="level2">
<h2 class="anchored" data-anchor-id="gráfico-de-dispersão">Gráfico de dispersão</h2>
<p>Gráficos de dispersão apresentam a relação entre duas variáveis. Neste caso, podemos fazer alguns truques para inventar uma variável falsa que serve somente para que o <code>R</code> faça o gráfico.</p>
<p>Uma alternativa seria impor um expec_vida constante e arbitrário para uma das variáveis. Neste caso escolho <code>x = 1</code> e escondo o eixo. No gráfico abaixo, cada distrito é um ponto sobre uma mesma linha. Para amenizar a sobreposição de observações uso <code>alpha = 0.5</code> que acrescenta um pouco de transparência nas observações.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">df_aux <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb8-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.025</span>,</span>
<span id="cb8-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_media<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida,</span>
<span id="cb8-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Média = "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb8-5">)</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> expec_vida)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb8-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> highlight, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> highlight, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> populacao_total),</span>
<span id="cb8-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb8-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#08519c"</span>,</span>
<span id="cb8-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb8-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux_label,</span>
<span id="cb8-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> expec_vida, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label_distrito),</span>
<span id="cb8-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Light"</span>,</span>
<span id="cb8-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb8-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb8-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux_label,</span>
<span id="cb8-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray25"</span>,</span>
<span id="cb8-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb8-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.955</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.955</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.045</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.045</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.045</span>),</span>
<span id="cb8-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> expec_vida, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> expec_vida</span>
<span id="cb8-26">    )</span>
<span id="cb8-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb8-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.02</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_media<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> y),</span>
<span id="cb8-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> yend),</span>
<span id="cb8-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray25"</span>,</span>
<span id="cb8-32">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb8-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux,</span>
<span id="cb8-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb8-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Light"</span>,</span>
<span id="cb8-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb8-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.94</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.06</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_alpha_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_size_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#08519c"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de Vida"</span>,</span>
<span id="cb8-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb8-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Anos de idade"</span>,</span>
<span id="cb8-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: SMS (Secretaria Municipal de Saúde)"</span>,</span>
<span id="cb8-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Idade média ao morrer em 2022. Cada ponto representa um distrito de São Paulo."</span></span>
<span id="cb8-51">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-52">  theme_vini <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb8-57">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Uma solucão alternativa seria criar uma variável aleatória qualquer para servir como a variável “falsa”. Estranhamente, cria-se uma sensação melhor de dispersão e não há mais o problema de sobreposição. Contudo, o gráfico pode ser bastante confuso, pois dá a entender que estamos vendo a relação entre duas variáveis distintas, quando uma delas, na verdade, não representa coisa alguma.</p>
<p>Ainda assim, ideias similares foram implementadas pelo portal Nexo <a href="https://www.nexojornal.com.br/grafico/2019/11/12/A-desigualdade-na-cidade-de-S%C3%A3o-Paulo-em-20-indicadores">nesta postagem</a>.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cria uma variável aleatória qualquer seguindo uma Gaussiana</span></span>
<span id="cb9-2">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.)))</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Para destacar o expec_vida médio</span></span>
<span id="cb9-5">df_aux <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb9-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.25</span>,</span>
<span id="cb9-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_media<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>,</span>
<span id="cb9-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Média ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb9-9">)</span>
<span id="cb9-10"></span>
<span id="cb9-11">df_aux_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_distrito =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(highlight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> 1L, label_distrito, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb9-13"></span>
<span id="cb9-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> expec_vida)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> highlight, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> populacao_total),</span>
<span id="cb9-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb9-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#08519c"</span></span>
<span id="cb9-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-19">  ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(</span>
<span id="cb9-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux_label,</span>
<span id="cb9-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label_distrito),</span>
<span id="cb9-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb9-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Light"</span>,</span>
<span id="cb9-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb9-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb9-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux,</span>
<span id="cb9-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb9-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span></span>
<span id="cb9-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(expec_vida)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_alpha_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de Vida (idade média ao morrer)"</span>,</span>
<span id="cb9-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb9-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Anos de idade"</span>,</span>
<span id="cb9-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: SMS (Secretaria Municipal de Saúde)"</span></span>
<span id="cb9-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-43">  theme_vini <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb9-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb9-47">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mapa" class="level2">
<h2 class="anchored" data-anchor-id="mapa">Mapa</h2>
<p>Deixei a visualização mais óbvia para o final. Como a variável está distribuída espacialmente, pode-se fazer um simples mapa de São Paulo separado por distritos.</p>
<p>Aqui, eu uso o shapefile de distritos da Pesquisa Origem e Destino. Apesar de não haver um identificador comum entre as bases, foi relativamente simples fazer o join compatibilizando o nome dos distritos.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importa o shapefile</span></span>
<span id="cb10-2">distritos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_read</span>(</span>
<span id="cb10-3">  here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"general-posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"repost-mapa-desigualdade"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"districts.gpkg"</span>),</span>
<span id="cb10-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb10-5">  )</span>
<span id="cb10-6"></span>
<span id="cb10-7">distritos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> distritos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filtra apenas distritos de SP (capital)</span></span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(code_district <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Renomeia a coluna para facilitar o join</span></span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distrito =</span> name_district)</span>
<span id="cb10-12"></span>
<span id="cb10-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Verifica se ha distritos com nome diferente (Mooca)</span></span>
<span id="cb10-14">anti <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(df, distrito), distritos, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"distrito"</span>)</span>
<span id="cb10-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Altera a grafia para garantir o join</span></span>
<span id="cb10-16">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb10-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distrito =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(distrito <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moóca"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mooca"</span>, distrito)</span>
<span id="cb10-19">  )</span>
<span id="cb10-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Junta os dados no sf</span></span>
<span id="cb10-21">distritos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(distritos, df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"distrito"</span>)</span></code></pre></div>
</details>
</div>
<p>O gráfico abaixo mostra a expectativa de vida em cada distrito na cidade.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(distritos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> expec_vida), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">de Vida"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de Vida por Distrito"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb11-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb11-9">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Outra maneira de apresentar este dado é agrupando-o de alguma forma. Eu sou particularmente parcial ao algoritmo de Jenks.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encontra os intervalos de cada grupo</span></span>
<span id="cb12-2">breaks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> classInt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">classIntervals</span>(distritos<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expec_vida, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jenks"</span>)</span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Classifica os valores em grupos</span></span>
<span id="cb12-4">distritos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> distritos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb12-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">jenks_group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(expec_vida, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> breaks<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>brks, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include.lowest =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb12-7">  )</span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(distritos, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> jenks_group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BrBG"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">de Vida"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de Vida por Distrito"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb12-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb12-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb12-17">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>data-visualization</category>
  <category>tutorial-R</category>
  <category>repost</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/repost-mapa-desigualdade/index.html</guid>
  <pubDate>Wed, 28 Jun 2023 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/visualizando-unica-variavel.png" medium="image" type="image/png" height="89" width="144"/>
</item>
<item>
  <title>Preços de Imóveis e Demografia</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/precos-imoveis-demografia/index.html</link>
  <description><![CDATA[ 




<p>Já vi em alguns lugares uma suposta ligação entre fatores demográficos e tendências de longo prazo no mercado imobiliário. Intuitivamente, alguns dos principais motivadores para comprar ou vender um imóvel estão ligados a fatores demográficos: nascimentos, casamentos, divórcios ou óbitos.</p>
<p>Este tipo de análise omite fatores importantes como renda, condições de financiamento e o contexto geral da economia. Ainda assim, fiquei curioso para ver se havia algum padrão entre tendências demográficas mais simples e o comportamento dos preços.</p>
<section id="dados-e-setup" class="level1">
<h1>Dados e setup</h1>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(WDI)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(showtext)</span></code></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Helvetica"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Helvetica.ttc"</span>)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-3"></span>
<span id="cb2-4">colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> MetBrewer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">met.brewer</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hokusai1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)]</span>
<span id="cb2-5"></span>
<span id="cb2-6">theme_vini <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-9">    </span>
<span id="cb2-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb2-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb2-12">    </span>
<span id="cb2-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb2-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb2-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb2-16">    </span>
<span id="cb2-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Helvetica"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray15"</span>),</span>
<span id="cb2-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb2-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>),</span>
<span id="cb2-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption  =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>),</span>
<span id="cb2-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb2-22">  )</span></code></pre></div>
</details>
</div>
<p>Para montar um painel de dados usei preços de imóveis do Bank for International Settelments (BIS), que reúne índices de preços imobiliários de diversos países do mundo. Os dados demográficos, de crescimento econômico, e share de população adulta, vem do Banco Mundial. Como os dados demográficos dependem de censos populacionais que demoram a ser divulgados, tive que restringir a amostra até 2020 para garantir que os dados fossem comparáveis no maior número possível de países.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import house price indexes from BIS #</span></span>
<span id="cb3-2">bis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"posts/general-posts/precos-imoveis-demografia/rppi_bis_data.csv"</span>))</span>
<span id="cb3-3">bis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bis <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>, unit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index, 2010 = 100"</span>)</span>
<span id="cb3-5"></span>
<span id="cb3-6">bis_real <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bis <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nominal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> reference_area, value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">index_house =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T))</span>
<span id="cb3-11"></span>
<span id="cb3-12">bis_nominal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bis <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nominal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nominal"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> reference_area, value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">index_house =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T))</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import demographic data from WBD #</span></span>
<span id="cb3-19">wdi_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(WDI_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>country)</span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#search &lt;- WDIsearch("population")</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Total population</span></span>
<span id="cb3-23">pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">WDI</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">indicator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.TOTL"</span>)</span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Population growth</span></span>
<span id="cb3-25">pop_growth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">WDI</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">indicator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.GROW"</span>)</span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adult population</span></span>
<span id="cb3-27">codes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb3-28">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.2024.MA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.2529.MA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.3034.MA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.3539.MA"</span>,</span>
<span id="cb3-29">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.4044.FE"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.2024.FE"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.2529.FE"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.3034.FE"</span>,</span>
<span id="cb3-30">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.3539.FE"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.4044.FE"</span>)</span>
<span id="cb3-31"></span>
<span id="cb3-32">adult_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">WDI</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">indicator =</span> codes)</span>
<span id="cb3-33"></span>
<span id="cb3-34">tbl_pop_adult <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adult_pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>iso2c, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>iso3c) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(year, country)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_adult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hong Kong SAR, China"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hong Kong SAR"</span>),</span>
<span id="cb3-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Korea, Rep."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Korea"</span>),</span>
<span id="cb3-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russian Federation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russia"</span>))</span>
<span id="cb3-44"></span>
<span id="cb3-45">tbl_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hong Kong SAR, China"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hong Kong SAR"</span>),</span>
<span id="cb3-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Korea, Rep."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Korea"</span>),</span>
<span id="cb3-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russian Federation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russia"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(year, country, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop =</span> SP.POP.TOTL) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(tbl_pop_adult)</span>
<span id="cb3-53"></span>
<span id="cb3-54">base_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tbl_pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2010</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(country, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_pop =</span> pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_pop_adult =</span> pop_adult)</span>
<span id="cb3-57"></span>
<span id="cb3-58">tbl_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tbl_pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(base_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">index_pop =</span> pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> base_pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb3-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">index_pop_adult =</span> pop_adult <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> base_pop_adult <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb3-63">    )</span>
<span id="cb3-64"></span>
<span id="cb3-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join information across tables</span></span>
<span id="cb3-66"></span>
<span id="cb3-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Real property prices</span></span>
<span id="cb3-68">tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bis_real <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1970</span>, year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(tbl_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(year, country, index_house, index_pop, index_pop_adult) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(year, country), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"index"</span>)</span>
<span id="cb3-73"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nominal property prices</span></span>
<span id="cb3-74">tbl_nominal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bis_nominal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1970</span>, year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(tbl_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(year, country, index_house, index_pop, index_pop_adult) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(year, country), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"index"</span>)</span>
<span id="cb3-79"></span>
<span id="cb3-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert real prices to wide and compare evolution</span></span>
<span id="cb3-81">tbl_wide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-83">    year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2010</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>),</span>
<span id="cb3-84">    index <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"index_house"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"index_pop"</span>)</span>
<span id="cb3-85">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country, index) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">diff =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diff</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> country, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> index, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> diff) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(wdi_names, country, iso3c)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)))</span>
<span id="cb3-93"></span>
<span id="cb3-94">tbl_wide_lr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tbl_nominal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-96">    year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1990</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>),</span>
<span id="cb3-97">    index <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"index_house"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"index_pop"</span>)</span>
<span id="cb3-98">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country, index) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">diff =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diff</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-101">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(diff)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> country, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> index, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> diff) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(wdi_names, country, iso3c)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)))</span>
<span id="cb3-106"></span>
<span id="cb3-107">sel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Australia"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"United States"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Japan"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Germany"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Austria"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"France"</span>)</span>
<span id="cb3-108">sel_latam <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chile"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazil"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peru"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mexico"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Colombia"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="análise" class="level1">
<h1>Análise</h1>
<p>Nos gráficos abaixo eu destaco a variação real do preços dos imóveis (isto é, descontando a inflação geral) e variação no crescimento da população. Considero tanto o nível geral da população como da população adulta (aqui definida como a população de 20 a 44 anos, que formam o grosso da demanda por nova habitação).</p>
<p>O gráfico abaixo mostra como estas variáveis evoluíram nos EUA desde 1970. Durante os anos 1970 até o começo dos anos 2000 parece haver uma ligação próxima entre o mercado imobiliário e o crescimento da população. O descolamento começa ali por volta de 2002 e culmina na Crise Imobiliária e na Crise dos anos 2008-09. Após a Crise, os preços caem até o início de 2010; de lá pra cá os preços voltaram a subir, impulsionados pela baixíssima taxa de juros da economia norte americana neste período.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(tbl, country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"United States"</span>),</span>
<span id="cb4-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> index)</span>
<span id="cb4-5">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(</span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colors,</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real House Prices"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adult Pop."</span>)</span>
<span id="cb4-11">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Over the long-run, house price seemed to follow pop. growth"</span>,</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index (2010 = 100)"</span>,</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: Real House Price Indexes (BIS), Population (UN).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Adult Pop. defined as population from 20-44 years."</span></span>
<span id="cb4-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-18">  theme_vini</span>
<span id="cb4-19"></span>
<span id="cb4-20">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prices and demographic trends in the USA."</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/precos-imoveis-demografia/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Olhando somente para este gráfico a história parece convincente, mas acho que por trás da recente valorização de imóveis está a escassez de novos imóveis no mercado. A imagem abaixo vem de um <a href="https://www.jchs.harvard.edu/blog/were-finally-building-more-small-homes-but-construction-remains-at-historically-low-levels">estudo do Joint Center for Housing Stuides (JCHS)</a> da Universidade de Harvard. Fica evidente como a construção de novos imóveis desacelerou muito na última década. Em estudos com horizontes mais longos, que voltam até a década de 1930 ou 1940, vê-se que a construção está em um de seus pontos mais baixos na história.</p>
<p>A escassez de oferta junto com uma tendência de concentração populacional em grandes metrópoles (com péssimas leis de zoneamento, como São Fransisco, por exemplo) - para mim - é uma história muito mais convincente do que imaginar que está havendo uma bolha imobiliária.</p>
<p><img src="https:://www.restateinsight.com/posts/general-posts/precos-imoveis-demografia/jchs_house_starts.png" class="img-fluid"></p>
<section id="preços-e-população-andam-juntos" class="level3">
<h3 class="anchored" data-anchor-id="preços-e-população-andam-juntos">Preços e população andam juntos</h3>
<p>No agregado dos dados encontrei mais alguns países em que os preços parecem seguir as tendências demográficas. É o caso, por exemplo, de Cingapura, Japão e Itália. Vale notar que estes são países, atualmente, têm baixo crescimento populacional e vivem o envelhecimento de suas populações.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">sel_conforme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Singapore"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Belgium"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"France"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Japan"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Korea"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Italy"</span>)</span>
<span id="cb5-2">sel_acima <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Switzerland"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hong Kong SAR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chile"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malaysia"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estonia"</span>)</span>
<span id="cb5-3"></span>
<span id="cb5-4">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb5-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(tbl, country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> sel_conforme, year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>),</span>
<span id="cb5-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> index)</span>
<span id="cb5-8">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(</span>
<span id="cb5-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colors,</span>
<span id="cb5-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb5-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real House Prices"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adult Pop."</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"House prices follow population growth"</span>,</span>
<span id="cb5-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index (2010 = 100)"</span>,</span>
<span id="cb5-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: Real House Price Indexes (BIS), Population (UN).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Adult Pop. defined as population from 20-44 years."</span></span>
<span id="cb5-22">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-23">  theme_vini</span>
<span id="cb5-24"></span>
<span id="cb5-25">p2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/precos-imoveis-demografia/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="preços-e-população-divergem" class="level3">
<h3 class="anchored" data-anchor-id="preços-e-população-divergem">Preços e população divergem</h3>
<p>Mas há tabmém vários outros em que população e preços divergem. Vale lembrar que estamos comparando índices de preços imobiliárias reais, isto é, já descontando o efeito da inflação: no Chile, por exemplo, o preço médio dos imóveis cresceu cerca de 100% acima do nível da inflação (dobrou nos últimos dez anos). Chile e Hong Kong, em particular, são dois países onde o aumento do preço dos imóveis causou bastante revolta popular em anos recentes<sup>1</sup>.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">p3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb6-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(tbl, country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> sel_acima, year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>),</span>
<span id="cb6-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> index)</span>
<span id="cb6-5">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(</span>
<span id="cb6-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colors,</span>
<span id="cb6-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb6-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real House Prices"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adult Pop."</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"In some markets, hose prices have detached from pop. growth"</span>,</span>
<span id="cb6-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index (2010 = 100)"</span>,</span>
<span id="cb6-17">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: Real House Price Indexes (BIS), Population (UN).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Adult Pop. defined as population from 20-44 years."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-18">  theme_vini</span>
<span id="cb6-19"></span>
<span id="cb6-20">p3</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/precos-imoveis-demografia/index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="américa-latina" class="level3">
<h3 class="anchored" data-anchor-id="américa-latina">América Latina</h3>
<p>Por curiosidade, resolvi olhar os países da América Latina.</p>
<p>No caso do Brasil, vemos que os preços entraram em queda seguindo a recessão de 2014 e, a despeito de uma recuperação recente, ainda estão em níveis mais baixos do que os observados em 2010. De maneira geral, os preços parecem ter ligação nenhuma com o crescimento da população. Vale lembrar que o mercado imobiliário no Brasil é fortemente subsididado e pouco alavancado de maneira geral.</p>
<p>Chile e Colômbia parecem exibir uma tendência similar de crescimento, mas a alta pós-2010 no Chile é assustadora. Em termos reais, os preços dos imóveis quase dobraram em dez anos.</p>
<p>Outro ponto interessante é que os mercado não parecem exibir muito sincronismo (no olho, não parecem séries cointegradas) ao contrário do que se observa em <a href="https://journals.sagepub.com/doi/full/10.1177/0042098014555629?casa_token=GZDm7jR8f0UAAAAA%3AbbnqbFMywKOF1U1Jug1oU2mrE1PASlgW0ZBGL405xMkI2_TAPA62V1iURTfD7uJBics4gMT9dDgI">mercados mais integrados como a Zona do Euro</a>.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">p4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb7-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(tbl, country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> sel_latam, year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>),</span>
<span id="cb7-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> index)</span>
<span id="cb7-5">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(</span>
<span id="cb7-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colors,</span>
<span id="cb7-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb7-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real House Prices"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adult Pop."</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LATAM markets are not synched"</span>,</span>
<span id="cb7-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index (2010 = 100)"</span>,</span>
<span id="cb7-17">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: Real House Price Indexes (BIS), Population (UN).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Adult Pop. defined as population from 20-44 years."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-18">  theme_vini</span>
<span id="cb7-19"></span>
<span id="cb7-20">p4</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/precos-imoveis-demografia/index_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="todos-os-países" class="level2">
<h2 class="anchored" data-anchor-id="todos-os-países">Todos os países</h2>
<p>Esta análise é ainda bastante preliminar. Ainda que a demografia seja um motor para a demanda imobiliária, outros fatores como oferta de moradia e condições de crédito são importantes demais parecem serem omitidos.</p>
<p>O gráfico abaixo compara a população em 2010/2020 com os preços em 2010/2020. Os países ao lado direito do gráfico, são os países onde houve crescimento populacional. Os países na parte de cima do gráfico são os países onde houve crescimento real do preço dos imóveis. Na média da amostra, destacada como WLD, houve crescimento de ambos.</p>
<p>Países que estão muito para cima como Chile (CHL), Índia (IND) e Estônia (EDT) estão com imóveis muito “caros”. Já em países com França e Finlândia tanto a população como o nível de preço dos imóveis cresceram muito pouco. No caso da Grécia, tanto a população como o preço dos imóveis diminuiu nos últimos dez anos.</p>
<p>O gráfico não me surpreendeu muito, mas esperava que os EUA estivessem mais para cima no gráfico e que o Brasil estivesse ao menos do lado positivo do eixo-x. Isso me sugere que a impressão de que os imóveis no Brasil são ou estão caros tem muito mais a ver com a baixa renda da população.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">p5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb8-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(tbl_wide),</span>
<span id="cb8-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> index_pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> index_house)</span>
<span id="cb8-5">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> colors[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> highlight)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> iso3c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> highlight)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, colors[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real House Prices x Population (2010/20)"</span>,</span>
<span id="cb8-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population (2010/2020)"</span>,</span>
<span id="cb8-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RPPI (2010/2020)"</span>,</span>
<span id="cb8-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: Real House Price Indexes (BIS), Population (UN)."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-20">  theme_vini</span>
<span id="cb8-21"></span>
<span id="cb8-22">p5</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/precos-imoveis-demografia/index_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Hong Kong: https://exame.com/economia/as-raizes-economicas-dos-protestos-de-hong-kong/↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>real-estate</category>
  <category>economia</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/precos-imoveis-demografia/index.html</guid>
  <pubDate>Tue, 20 Jun 2023 03:00:00 GMT</pubDate>
</item>
<item>
  <title>Séries de Tempo no R</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/arima-no-r/index.html</link>
  <description><![CDATA[ 




<section id="séries-de-tempo-no-r" class="level1">
<h1>Séries de tempo no R</h1>
<p>Neste post vou explorar um pouco das funções base do R para montar um modelo SARIMA. O <code>R</code> vem “pré-equipado” com um robusto conjunto de funções para lidar com séries de tempo. Inclusive, como se verá, existe uma class específica de objeto para trabalhar com séries de tempo.</p>
</section>
<section id="os-dados" class="level1">
<h1>Os dados</h1>
<p>Como exemplo, vamos usar a série <code>AirPassengers</code>, uma série bastante famosa usada no livro <em>Time Series Analysis</em> de Box &amp; Jenkins (1976). A série apresenta o volume mensal de passagens aéreas internacionais (em milhares) no período 1949-1960.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(AirPassengers, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#023047"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/arima-no-r/index_files/figure-html/unnamed-chunk-2-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Uma maneira comum de avaliar a performance preditiva de modelo é usando uma divisão train/test. Essencialmente, removemos uma parte das observações da nossa amostra para que possamos testar a taxa de acerto das previsões do nosso modelo.</p>
<p>Como estamos no contexto de séries de tempo, é natural remover um percetual das observações finais da série. No caso, uso a função <code>window</code> para remover os últimos dois anos da amostra.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(AirPassengers)</span>
<span id="cb2-2"></span>
<span id="cb2-3">train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">window</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1958</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb2-4">test  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">window</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1959</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/arima-no-r/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>A rigor, seria mais correto experimentar com várias janelas diferentes e talvez fosse interessante também remover um percentual maior de observações. Até onde sei, não é tão fácil implementar esse tipo de <em>cross-validation</em> apenas usando funções base do R, mas um maneira de fazer isso está exposta no livro <a href="https://otexts.com/fpp3/tscv.html">Forecasting: Principles and Practice</a>.</p>
<section id="modelagem-sarima" class="level2">
<h2 class="anchored" data-anchor-id="modelagem-sarima">Modelagem SARIMA</h2>
<p>Aqui a ideia é experimentar com alguns modelos simples. Em especial, o modelo que Box &amp; Jenkins sugerem para a série é de um SARIMA (0, 1, 1)(0, 1, 1)[12] da forma</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(1%20-%20%5CDelta)(1%20-%20%5CDelta%5E%7B12%7D)y_%7Bt%7D%20=%20%5Cvarepsilon_%7Bt%7D%20+%20%5Ctheta_%7B1%7D%5Cvarepsilon_%7Bt_1%7D%20+%20%5CTheta_%7B1%7D%5Cvarepsilon_%7Bt-12%7D%0A"></p>
<p>A metodologia correta para a análise seria primeiro fazer testes de raiz unitária para avaliar a estacionaridade da série. Mas só de olhar para as funções de autocorrelação e autocorrelação parcial, fica claro que há algum componente sazonal e que a série não é estacionária.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/arima-no-r/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<section id="teste-de-raiz-unitária" class="level3">
<h3 class="anchored" data-anchor-id="teste-de-raiz-unitária">Teste de raiz unitária</h3>
<p>Apenas a título de exemplo, faço um teste Dickey-Fuller (ADF), bastante geral, com constante e tendência temporal linear. Para uma boa revisão metodológica de como aplicar testes de raiz unitária, em partiular o teste ADF, consulte o capítulo de séries não-estacionárias do livro <a href="https://www.wiley.com/en-br/Applied+Econometric+Time+Series,+4th+Edition-p-9781118808566">Applied Econometric Time Series do Enders</a></p>
<p>Aqui, a escolha ótima do lag é feita usando o critério BIC (também conhecido como Critério de Schwarz). Não existe uma função que aplica o teste ADF no pacote base o <code>R</code>. A implementação é feita na função <code>ur.df</code> do pacote <code>urca</code>.</p>
<p>A estatísitica de teste mais relevante é a <code>tau3</code> e vê-se, surpreendentemente, que se rejeita a hipótese nula de raiz unitária. As estatísticas <code>phi2</code> e <code>phi3</code> são testes-F da significânica conjunta dos termos de constante e de tendência temporal. As estatísticas de teste são convencionais e seguem a notação do livro do Enders citado acima e também do clássico livro do <a href="http://www.ru.ac.bd/stat/wp-content/uploads/sites/25/2019/03/504_02_Hamilton_Time-Series-Analysis.pdf">Hamilton</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(urca)</span>
<span id="cb3-2">adf_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ur.df</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trend"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectlags =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BIC"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lags =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(adf_test)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
############################################### 
# Augmented Dickey-Fuller Test Unit Root Test # 
############################################### 

Test regression trend 


Call:
lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.090139 -0.022382 -0.002417  0.021008  0.110003 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.8968049  0.3999031   2.243 0.026859 *  
z.lag.1      -0.1809364  0.0842729  -2.147 0.033909 *  
tt            0.0016886  0.0008609   1.961 0.052263 .  
z.diff.lag1  -0.2588927  0.1134142  -2.283 0.024301 *  
z.diff.lag2  -0.0986455  0.1070332  -0.922 0.358665    
z.diff.lag3  -0.0379799  0.1045583  -0.363 0.717097    
z.diff.lag4  -0.1392651  0.0981271  -1.419 0.158560    
z.diff.lag5  -0.0283998  0.0963368  -0.295 0.768686    
z.diff.lag6  -0.1326313  0.0889223  -1.492 0.138581    
z.diff.lag7  -0.1096365  0.0865862  -1.266 0.208019    
z.diff.lag8  -0.2348880  0.0829892  -2.830 0.005497 ** 
z.diff.lag9  -0.0926604  0.0843594  -1.098 0.274344    
z.diff.lag10 -0.2053937  0.0789245  -2.602 0.010487 *  
z.diff.lag11 -0.1081091  0.0786801  -1.374 0.172127    
z.diff.lag12  0.6633101  0.0752086   8.820 1.54e-14 ***
z.diff.lag13  0.3197783  0.0883636   3.619 0.000443 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.04011 on 114 degrees of freedom
Multiple R-squared:  0.8781,    Adjusted R-squared:  0.8621 
F-statistic: 54.75 on 15 and 114 DF,  p-value: &lt; 2.2e-16


Value of test-statistic is: -2.147 4.9781 3.4342 

Critical values for test statistics: 
      1pct  5pct 10pct
tau3 -3.99 -3.43 -3.13
phi2  6.22  4.75  4.07
phi3  8.43  6.49  5.47</code></pre>
</div>
</div>
<p>Pela análise do correlograma do resíduo da regressão, fica claro que ainda há autocorrelação. Novamente, o mais correto seria aplicar o teste Ljung-Box sobre os resíduos para verificar a presença de autocorrelação conjunta nas primeiras <em>k</em> defasagens, mas este não é o foco deste post. Esta pequena digressão exemplifica como a aplicação destes testes em séries de tempo pode não ser tão direto/simples.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/arima-no-r/index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Os gráficos abaixo mostram o correlograma da série após tirarmos a primeira diferença e a primeira diferença sazonal. A partir da análise destes correlogramas poderíamos inferir algumas especificações alternativas para modelos SARIMA e aí, poderíamos escolher o melhor modelo usando algum critério de informação.</p>
<p>A metodologia Box &amp; Jenkins de análise de séries de tempo tem, certamente, um pouco de <em>arte</em> e <em>feeling</em>. Não é tão imediato entender como devemos proceder e, na prática, faz sentido experimentar com vários modelos alternativos de ordem baixa como SARIMA(1, 1, 1)(0, 1, 1), SARIMA(2, 1, 0)(0, 1, 1), etc.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/arima-no-r/index_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="os-modelos" class="level3">
<h3 class="anchored" data-anchor-id="os-modelos">Os modelos</h3>
<p>Para não perder muito tempo experimentando com vários modelos vou me ater a três modelos diferentes. Uma função bastante útil é a <code>auto.arima</code> do pacote <code>forecast</code> que faz a seleção automática do melhor modelo da classe SARIMA/ARIMA/ARMA.</p>
<p>Eu sei que o Schumway/Stoffer, autores do ótimo <a href="https://github.com/nickpoison/tsa4">Time Series Analysis and Its Applications</a>, tem um <a href="https://www.stat.pitt.edu/stoffer/tsa4/Rissues.htm">post crítico ao uso</a> do <code>auto.arima</code>. Ainda assim, acho que a função tem seu mérito e costuma ser um bom ponto de partida para a sua análise. Quando temos poucas séries de tempo para analisar, podemos nos dar ao luxo de fazer a modelagem manualmente, mas quando há centenas de séries, é muito conveniente poder contar com o <code>auto.arima</code>.</p>
<p>Como o <code>auto.arima</code> escolhe o mesmo modelo do Box &amp; Jenkins eu experimento com uma especificação diferente. Novamente, a título de exemplo eu comparo ambos os modelos SARIMA com uma regressão linear simples que considera uma tendência temporal linear e uma série de dummies sazonais. O modelo é algo da forma</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ay_%7Bt%7D%20=%20%5Calpha_%7B0%7D%20+%20%5Calpha_%7B1%7Dt%20+%20%5Csum_%7Bi%20=%201%7D%5E%7B11%7D%5Cbeta_%7Bi%7Ds_%7Bi%7D%20+%20%5Cvarepsilon_%7Bt%7D%0A"></p>
<p>Onde <img src="https://latex.codecogs.com/png.latex?s_%7Bi%7D"> é uma variável indicadora igual a 1 se <img src="https://latex.codecogs.com/png.latex?t"> corresponder ao mês <img src="https://latex.codecogs.com/png.latex?i"> e igual a 0 caso contrário. Vale notar que não podemos ter uma dummy para todos os meses se não teríamos uma matriz de regressores com colinearidade perfeita!</p>
<p>Aqui vou contradizer um pouco o espírito do post novamente para usar o <code>forecast</code>. O ganho de conveniência vem na hora de fazer as previsões. Ainda assim, indico como estimar os mesmos modelos usando apenas funções base do <code>R</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Usando o forecast</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(forecast)</span>
<span id="cb5-3">model1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto.arima</span>(train)</span>
<span id="cb5-4">model2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Arima</span>(train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonal =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb5-5">model3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tslm</span>(train <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> trend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> season)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Usando apenas funções base</span></span>
<span id="cb6-2">model2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arima</span>(</span>
<span id="cb6-3">  trains,</span>
<span id="cb6-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb6-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonal =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb6-6">)</span>
<span id="cb6-7"></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extrai uma tendência temporal linear </span></span>
<span id="cb6-9">trend <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">time</span>(train)</span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cria variáveis dummies mensais</span></span>
<span id="cb6-11">season <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cycle</span>(train)</span>
<span id="cb6-12">model3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(train <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> trend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> season)</span></code></pre></div>
</div>
<p>A saída dos modelos segue abaixo. As saídas dos modelos SARIMA não são muito interessantes. Em geral, não é muito comum avaliar nem a significância e nem o sinal dos coeficientes, já que eles não têm muito valor interpretativo. Uma coisa que fica evidente dos dois modelos abaixo é que o primeiro parece melhor ajustado aos dados pois tem valores menores em todos os critérios de informação considerados.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">model1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: train 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
          ma1     sma1
      -0.3424  -0.5405
s.e.   0.1009   0.0877

sigma^2 = 0.001432:  log likelihood = 197.51
AIC=-389.02   AICc=-388.78   BIC=-381</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">model2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: train 
ARIMA(1,1,1)(1,1,0)[12] 

Coefficients:
         ar1      ma1     sar1
      0.0668  -0.4518  -0.4426
s.e.  0.3046   0.2825   0.0875

sigma^2 = 0.001532:  log likelihood = 195.14
AIC=-382.28   AICc=-381.89   BIC=-371.59</code></pre>
</div>
</div>
<p>Já o modelo de regressão linear tem uma saída mais interessante. Note que, por padrão, o primeiro mês foi omitido e seu efeito aparece no termo constante. Na tabela abaixo, vemos que há um efeito positivo e significativo, por exemplo, nos meses 6-8 (junho a agosto), que coincidem com o período de férias de verão no hemisfério norte. Já, em novembro (mês 11) parece haver uma queda na demanda por passagens aéreas.</p>
<p>Note que o R quadrado da regressão é extremamente elevado e isso é um indício de que algo está errado. Isto, muito provavelmente é resultado da não-estacionaridade da série.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">broom<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(model3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 5
   term        estimate std.error statistic   p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)  4.71     0.0191    247.     2.81e-149
 2 trend        0.0106   0.000145   73.2    3.09e- 93
 3 season2     -0.0134   0.0245     -0.549  5.84e-  1
 4 season3      0.120    0.0245      4.91   3.32e-  6
 5 season4      0.0771   0.0245      3.15   2.14e-  3
 6 season5      0.0675   0.0245      2.75   6.93e-  3
 7 season6      0.191    0.0245      7.81   4.23e- 12
 8 season7      0.288    0.0245     11.7    6.32e- 21
 9 season8      0.278    0.0245     11.4    4.36e- 20
10 season9      0.143    0.0245      5.82   6.13e-  8
11 season10     0.00108  0.0245      0.0441 9.65e-  1
12 season11    -0.141    0.0245     -5.77   7.97e-  8
13 season12    -0.0248   0.0245     -1.01   3.14e-  1</code></pre>
</div>
</div>
<p>De fato, olhando para a função de autocorrelação do resíduo do modelo de regressão linear, fica evidente que há autocorrelação. Uma forma de contornar isso seria de incluir um termo ARMA no termo de erro. Novamente, este não é o foco do post e vamos seguir normalmente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resid</span>(model3))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/arima-no-r/index_files/figure-html/unnamed-chunk-14-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="comparando-as-previsões" class="level2">
<h2 class="anchored" data-anchor-id="comparando-as-previsões">Comparando as previsões</h2>
<p>A maneira mais prática de trabalhar com vários modelos ao mesmo tempo é agregando eles em listas e aplicando funções nessas listas.</p>
<p>Abaixo eu aplico a função <code>forecast</code> para gerar as previsões 24 períodos a frente nos três modelos. Depois, eu extraio somente a estimativa pontual de cada previsão.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">models <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(model1, model2, model3)</span>
<span id="cb14-2">yhat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(models, forecast, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>)</span>
<span id="cb14-3">yhat_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(yhat, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean)</span></code></pre></div>
</div>
<p>Comparamos a performance de modelos de duas formas: (1) olhando para medidas de erro (o quão bem o modelo prevê os dados do <em>test</em>) e (2) olhando para critérios de informação (o quão bem o modelo se ajusta aos dados do <em>train</em>).</p>
<p>Os critérios de informação têm todos uma interpretação bastante simples: quanto menor, melhor. Tipicamente, o AIC tende a escolher modelos sobreparametrizados enquanto o BIC tende a escolher modelos mais parcimoniosos.</p>
<p>Já a comparação de medidas de erro não é tão simples. Pois ainda que um modelo tenha, por exemplo, um erro médio quadrático menor do que outro, não é claro se esta diferença é significante. Uma maneira de testar isso é via o teste Diebold-Mariano, que compara os erros de previsão de dois modelos. Implicitamente, contudo, ele assume que a diferença entre os erros de previsão é covariância-estacionária (também conhecido como estacionário de segunda ordem ou fracamente estacionário). Dependendo do contexto, esta pode ser uma hipótese mais ou menos razoável.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">compute_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(model, test) {</span>
<span id="cb15-2">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> test</span>
<span id="cb15-3">    yhat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean</span>
<span id="cb15-4">    train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x</span>
<span id="cb15-5"></span>
<span id="cb15-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcula o erro de previsao</span></span>
<span id="cb15-7">    y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> yhat</span>
<span id="cb15-8">}</span>
<span id="cb15-9"></span>
<span id="cb15-10">compute_error_metrics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(model, test) {</span>
<span id="cb15-11"></span>
<span id="cb15-12">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> test</span>
<span id="cb15-13">    yhat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean</span>
<span id="cb15-14">    train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x</span>
<span id="cb15-15"></span>
<span id="cb15-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcula o erro de previsao</span></span>
<span id="cb15-17">    error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> yhat</span>
<span id="cb15-18">    </span>
<span id="cb15-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Raiz do erro quadrado medio</span></span>
<span id="cb15-20">    rmse <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(error<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb15-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Erro medio absoluto</span></span>
<span id="cb15-22">    mae <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(error))</span>
<span id="cb15-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Erro medio percentual</span></span>
<span id="cb15-24">    mape <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> error <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> y))</span>
<span id="cb15-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Root mean squared scaled error</span></span>
<span id="cb15-26">    rmsse <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(error<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">snaive</span>(train)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean))</span>
<span id="cb15-27"></span>
<span id="cb15-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Devolve os resultados num list</span></span>
<span id="cb15-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rmse =</span> rmse, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mae =</span> mae, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mape =</span> mape, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rmsse =</span> rmsse)</span>
<span id="cb15-30">    </span>
<span id="cb15-31"></span>
<span id="cb15-32">}</span>
<span id="cb15-33"></span>
<span id="cb15-34">compute_ics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(model) {</span>
<span id="cb15-35"></span>
<span id="cb15-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extrai criterios de informacao</span></span>
<span id="cb15-37">    aic  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">AIC</span>(model)</span>
<span id="cb15-38">    bic  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">BIC</span>(model)</span>
<span id="cb15-39"></span>
<span id="cb15-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Devolve os resultados num list</span></span>
<span id="cb15-41">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aic =</span> aic, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bic =</span> bic)</span>
<span id="cb15-42"></span>
<span id="cb15-43">} </span>
<span id="cb15-44"></span>
<span id="cb15-45">fcomparison <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(yhat, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(yhat) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_error_metrics</span>(yhat, test))</span>
<span id="cb15-46">icc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(models, compute_ics)</span>
<span id="cb15-47"></span>
<span id="cb15-48">comp_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind.data.frame, fcomparison)</span>
<span id="cb15-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(comp_error) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AutoArima"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual SARIMA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLS"</span>)</span>
<span id="cb15-50">comp_ics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind.data.frame, icc)</span>
<span id="cb15-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(comp_ics) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AutoArima"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual SARIMA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLS"</span>)</span></code></pre></div>
</div>
<p>A tabela abaixo mostra os critérios AIC e BIC para os três modelos. Em ambos os casos, o SARIMA(0, 1, 1)(0, 1, 1)[12] parece ser o escolhido. Este tipo de feliz coincidência não costuma acontecer frequentemente na prática, mas neste caso ambos os critérios apontam para o mesmo modelo.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">comp_ics</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    aic       bic
AutoArima     -389.0155 -380.9970
Manual SARIMA -382.2807 -371.5894
OLS           -342.2930 -303.2681</code></pre>
</div>
</div>
<p>Na comparação de medidas de erro, o SARIMA(0, 1, 1)(0, 1, 1)[12] realmente tem uma melhor performance, seguido pelo OLS e pelo SARIMA(1, 1, 1)(1, 1, 0)[12].</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">comp_error</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    rmse        mae     mape      rmsse
AutoArima     0.09593236 0.08959921 1.463477 0.03939512
Manual SARIMA 0.11688549 0.10780460 1.762201 0.04806577
OLS           0.10333715 0.09384411 1.549261 0.04266214</code></pre>
</div>
</div>
<p>Será que esta diferença é significante? Vamos comparar os modelos SARIMA. Pelo teste DM ela é sim. Lembre-se que o teste DM é, essencialmente, um teste Z de que <img src="https://latex.codecogs.com/png.latex?e_%7B1%7D%20-%20e_%7B2%7D%20=%200"> ou <img src="https://latex.codecogs.com/png.latex?e_%7B1%7D%20=%20e_%7B2%7D">, onde os valores são a média dos erros de previsão dos modelos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">errors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(yhat, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(yhat) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_error</span>(yhat, test))</span>
<span id="cb20-2">e1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> errors[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb20-3">e2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> errors[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]</span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dm.test</span>(e1, e2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">power =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Diebold-Mariano Test

data:  e1e2
DM = -4.4826, Forecast horizon = 1, Loss function power = 2, p-value =
0.0001691
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Vale notar que o teste DM serve para comparar os erros de previsão de quaisquer modelos. Como o teste não faz qualquer hipótese sobre “de onde vem” os erros de previsão, ele pode ser utilizado livremente. Vale lembrar também que este teste não deve ser utilizado para escolher o melhor modelo, já que ele compara apenas a capacidade preditiva de dois modelos alternativos.</p>
<p>Outro ponto, também complicado, é de qual a medida de erro que se deve escolher. O teste DM implicitamente usa o erro médio quadrático, mas há várias outras alternativas. <a href="https://otexts.com/fpp3/accuracy.html">Uma breve discussão pode ser vista aqui</a>.</p>
<p>Por fim, o gráfico abaixo mostra as previsões dos modelos alternativos contra a série real.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(test, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#8ecae6"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"o"</span>)</span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(yhat_mean[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>)</span>
<span id="cb22-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(yhat_mean[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#fb8500"</span>)</span>
<span id="cb22-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(yhat_mean[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#B86200"</span>)</span>
<span id="cb22-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid</span>()</span>
<span id="cb22-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topleft"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb22-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AutoArima"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arima"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLS"</span>),</span>
<span id="cb22-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#8ecae6"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#fb8500"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#B86200"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/arima-no-r/index_files/figure-html/unnamed-chunk-20-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resumo-geral" class="level1">
<h1>Resumo geral</h1>
<p>Algumas conclusões gerais para amarrar este post:</p>
<ol type="1">
<li><p>A metodologia Box-Jenkins não é tão direta. A interpretação do correlograma é muitas vezes incerta e a melhor opção costuma ser testar vários modelos.</p></li>
<li><p>Escolher o melhor modelo não é tão trivial. Uma saída simples é escolher o modelo com menor AIC ou BIC. Ainda assim, é importante levar em conta a capacidade preditiva do modelo.</p></li>
<li><p>Mesmo usando apenas funções base do <code>R</code> já é possível fazer boas análises com séries de tempo.</p></li>
</ol>


</section>

 ]]></description>
  <category>time-series</category>
  <category>tutorial-R</category>
  <category>econometria</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/arima-no-r/index.html</guid>
  <pubDate>Thu, 01 Jun 2023 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/series-tempo-r.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Usando fontes com showtext no R</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/index.html</link>
  <description><![CDATA[ 




<p>Criar boas visualizações é parte importante de qualquer análise de dados.</p>
<p>A tipografia de um texto deve complementar a mensagem e o tom que se quer comunicar e o mesmo vale para visualizações com dados. A fonte do texto ajuda a transmitir informação e pode comunicar, por exemplo, maior sobriedade, profissionalismo, etc.</p>
<p>O pacote <code>showtext</code>, desenvolvido por <a href="https://github.com/yixuan/showtext">yixuan</a>, facilita a importação e o uso de fontes em gráficos no <code>R</code>. O pacote funciona com uma variedade de extensões de fontes, não sendo limitado como o <code>extrafont</code>, por exemplo, a arquivos <code>.ttf</code>.</p>
<section id="r" class="level1">
<h1>R</h1>
<p>O primeiro passo necessário é instalar o pacote do CRAN usando <code>install.packages()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Instale o pacote se necessário</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extrafont"</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Opcionalmente instale a versão em desenvolvimento</span></span>
<span id="cb1-5">remotes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install_github</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yixuan/showtext"</span>)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(showtext)</span></code></pre></div>
</div>
<p>Importar fontes é bastante simples. Como exemplo vamos importar algumas <a href="https://fonts.google.com">fontes do Google</a> usando a função <code>font_add_google()</code>. Esta função, em geral, leva apenas dois arugmentos. O primeiro argumento deve ser o nome “oficial” da fonte; o segundo argumento é como será o nome desta fonte dentro do R.</p>
<p>No exemplo abaixo vamos importar três fontes: Montserrat, Roboto Condensed e Alice. No primeiro caso vamos manter o mesmo nome da fonte; já nos outros dois vamos usar nomes diferentes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Montserrat"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Montserrat"</span>)</span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># É possível simplificar o nome da fonte</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RobCond"</span>)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alice"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alice"</span>)</span></code></pre></div>
</div>
<p>Também é possível importar fontes que já estão instaladas no seu computador usando a função <code>font_add</code>. Agora a ordem dos arugmentos é invertida: o primeiro argumento define o nome da fonte dentro do <code>R</code> enquanto o segundo argumento é o nome do arquivo que pode ser <code>.ttf</code>, <code>.ttc</code> ou outros.</p>
<p>Em geral, o <code>showtext</code> consegue encontrar corretamente as pastas onde estes arquivos estão armazenados. Caso você tenha problema com isso vai ter de especificar este caminho manualmente com a função <code>font_paths()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importar a fonte Helvetica</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HelveticaNeue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HelveticaNeue.ttc"</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importar a fonte Arial (junto com a versão em negrito, itálico, etc.)</span></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb3-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arial"</span>,</span>
<span id="cb3-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arial.ttf"</span>,</span>
<span id="cb3-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arial Bold.ttf"</span>,</span>
<span id="cb3-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">italic =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arial Italic.ttf"</span>,</span>
<span id="cb3-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bolditalic =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arial Bold Italic.ttf"</span>)</span></code></pre></div>
</div>
<p>Para informar ao R que o <code>showtext</code> deve ser utilizado para desenhar o texto dos gráficos é preciso usar a função <code>showtext_auto()</code>. Só é preciso fazer isto uma única vez por sessão. Se você <em>sempre</em> utiliza o <code>showtext</code> você pode considerar incluir esta função no seu <code>.Rprofile</code>, assim o pacote será carregado automaticamente sempre que você abrir uma nova sessão no <code>R</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Indica que o showtext deve ser utilizado para criar as imagens</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Só precisa ser chamado uma única vez por sessão</span></span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span></code></pre></div>
</div>
<section id="base-r" class="level2">
<h2 class="anchored" data-anchor-id="base-r">Base R</h2>
<p>Para modificar a fonte dos elementos textuais dos gráficos feitos com o <code>plot()</code> é preciso ajustar o argumento <code>family</code>. Usando as funções base do R, este argumento aparece dentro da função <code>par</code> (que configura vários parâmetros dos gráficos).</p>
<p>O código abaixo mostra como trocar a fonte do gráfico.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define a fonte padrão do gráfico</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alice"</span>)</span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monta um scatter plot de exemplo</span></span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Milhas por galão"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peso (ton.)"</span>)</span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peso x eficiência de carros"</span>)</span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exemplo de texto"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb5-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exemplo de legenda"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note que <em>todos</em> os objetos textuais (título, legenda, etc.) são convertidos para a mesma fonte. Caso se queira fontes diferentes para estes elementos é preciso especificá-los adequadamente. Por exemplo, para trocar somente a fonte do título</p>
<p><code>title("nome_do_titulo", family = "nome_fonte")</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Milhas por galão"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peso (ton.)"</span>)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peso x eficiência de carros"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RobCond"</span>)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exemplo de texto"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Montserrat"</span>)</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exemplo de legenda"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Vale notar que, uma vez definida a fonte usando a função <code>par</code>, todos os gráficos subsequentes vão usar esta fonte. Para trocar a fonte é preciso usar a função <code>par</code> novamente. Além da fonte também é possível trocar a ênfase (e.g.&nbsp;<code>face = c("bold", "italic")</code>) e também o tamanho da letra (e.g.&nbsp;<code>cex.axis = 1.5</code>, <code>cex.main = 2</code>).</p>
</section>
<section id="ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2">ggplot2</h2>
<p>Também é possível trocar a fonte de gráficos feitos com outros pacotes, como o <code>ggplot2</code>. O exemplo abaixo monta um gráfico similar ao que foi feito acima. Modifica-se a fonte dentro da função <code>theme</code>. Esta função é um tanto particular, então vale a pena discorrer um pouco sobre ela. Ela é basicamente usada para modificar elementos do gráfico. Há quatro elementos principais, dos quais só nos interessa um: o <code>element_text</code>. São seis os principais elementos textuais que pode-se modificar:</p>
<ul>
<li><code>axis.text</code> - texto dos eixos (em geral, os números do eixo);</li>
<li><code>axis.title</code> - nome do eixo (e.g.&nbsp;“Milhas por galão” no exemplo acima);</li>
<li><code>legend.text</code> - texto da legenda;</li>
<li><code>legend.title</code> - título da legenda;</li>
<li><code>plot.title</code> - título do gráfico;</li>
<li><code>text</code> - <em>todos</em> os acima.</li>
</ul>
<p>Pode-se ser mais específico com o texto dos eixos usando <code>axis.text.x</code> e <code>axis.text.y</code>, por exemplo. O último dos elementos listados acima funciona como um “coringa”, ele serve para modificar de uma vez só todos os elementos textuais de um gráfico. No exemplo abaixo modifico somente o <code>text</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb7-2"></span>
<span id="cb7-3">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mpg)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poly</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peso (ton.)"</span>,</span>
<span id="cb7-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Milhas por galão"</span>,</span>
<span id="cb7-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Eficiência e peso de carros"</span>,</span>
<span id="cb7-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Regressão entre o peso de diferentes carros e sua eficiência energética"</span>,</span>
<span id="cb7-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: Motor Trend US Magazine 1974"</span></span>
<span id="cb7-12">    )</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Montserrat"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/index_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>O próximo exemplo mostra como modificar alguns dos diferentes elementos do gráfico. Aproveito a variável <code>cyl</code> (cilindradas) para diferenciar os carros em três grupos para que o gráfico agora tenha uma legenda.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(cyl))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cilindros"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica o texto (números) dos eixos x e y</span></span>
<span id="cb9-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alice"</span>),</span>
<span id="cb9-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica o título do eixo (i.e. Milhas por galão)</span></span>
<span id="cb9-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Montserrat"</span>),</span>
<span id="cb9-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica o título da legenda (Cilindros)</span></span>
<span id="cb9-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HelveticaNeue"</span>),</span>
<span id="cb9-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica o texto da legenda (i.e. 4, 6, 8)</span></span>
<span id="cb9-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HelveticaNeue"</span>),</span>
<span id="cb9-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica o título do gráfico</span></span>
<span id="cb9-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RobCond"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb9-15">    )</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/index_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Talvez o jeito mais sensato de usar fontes com o <code>ggplot2</code> seja primeiro especificar uma fonte padrão para o gráfico usando <code>text</code> e depois calibrar as exceções. Os elementos textuais como <code>axis.title</code> e <code>legend.text</code> copiam as propriedades definidas em <code>text</code>.</p>
<p>No exemplo abaixo defino que todos os elementos textuais ser escritos em Arial simples em tamanho 12 na cor <code>"gray20"</code>. Depois disso defino que o título deve ter mais destaque com Arial em negrito (bold) num tamanho maior e numa cor mais escura. Por fim, defino que o rodapé do gráfico seja escrito em fonte menor e em itálico.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb10-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica todos os elementos textuais do gráfico</span></span>
<span id="cb10-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arial"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray20"</span>),</span>
<span id="cb10-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica apenas o título</span></span>
<span id="cb10-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray10"</span>),</span>
<span id="cb10-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica apenas a nota no rodapé</span></span>
<span id="cb10-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb10-9">  )</span>
<span id="cb10-10"></span>
<span id="cb10-11">p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(cyl))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cilindros"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-14">  theme_custom</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/index_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Por último, também pode ser interessante usar fontes diferentes para representar dados diferentes. Isto é possível usando o argumento <code>family</code> dentro do <code>aes</code>. Da mesma forma, seria possível também representar grupos de dados diferentes com tamanhos de fontes diferentes ou mesmo destacar algum grupo específico com itálico.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">nomes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row.names</span>(mtcars)</span>
<span id="cb11-2">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cyl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cyl)</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mpg)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> nomes, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arial"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alice"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Montserrat"</span>)[cyl]))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/index_files/figure-html/unnamed-chunk-12-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anexo-problemas-com-dpi-e-rmarkdown" class="level2">
<h2 class="anchored" data-anchor-id="anexo-problemas-com-dpi-e-rmarkdown">Anexo: problemas com DPI e RMarkdown</h2>
<p>Apesar de muito conveniente, o <code>showtext</code> não é inteiramente desprovido de problemas. Dois problemas que enfrento com alguma recorrência são diferenças de DPI na hora de exportar gráficos e problemas com RMarkdown.</p>
<p>O problema com o RMarkdown é mais simples. Em versões antigas do RMarkdown e do showtext era necessário adicionar um argumento <code>fig.showtext = TRUE</code> em todos os chunks em que um gráfico usando showtext fosse renderizado. Alternativamente, podia-se modificar esta opção globalmente inserido o seguinte código no início do documento RMarkdown.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb12-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.showtext =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb12-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.retina =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-4">  )</span></code></pre></div>
</div>
<p>Acredito, mas não tenho certeza, de que este problema sumiu em versões mais recentes dos pacotes, pois com frequência eu esqueço de adicionar estes argumentos mas não encontro problemas na prática.</p>
<p>O problema com o DPI na hora de exportar gráficos é mais complicado. Por problemas de DPI quero dizer quando o showtext “desenha” o texto num DPI diferente do ggplot2. O resultado é que o texto fica ou grande ou pequeno demais. Por padrão o <code>showtext</code> utiliza o DPI em 96.</p>
<p>Vamos montar um gráfico para ilustrar o problema.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">grafico <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(cyl))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cilindros"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-4">  theme_custom</span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exportar o gráfico em alta resolução</span></span>
<span id="cb13-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meu_grafico.jpeg"</span>, grafico, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span></code></pre></div>
</div>
<p>Quando vamos abrir o arquivo que foi exportado temos o resultado abaixo.</p>
<p><img src="https:://www.restateinsight.com/posts/tutorial-showtext/meu_grafico.jpeg" class="image_figure image_featured image_internal image_unprocessed img-fluid" loading="lazy" decoding="async" alt=""></p>
<p>Como a imagem foi salva com DPI mais elevado o texto fica menor do que deveria; em casos mais extremos o texto fica minúsculo a ponto de ser ilegível. Há duas formas de tentar contornar este problema: (1) reduzir o DPI dentro de <code>ggsave</code>; ou (2) modificar o DPI do <code>showtext</code>.</p>
<p>Vamos tentar a primeira solução: modificar o <code>ggsave</code> para o DPI padrão do <code>showtext</code>. Agora o texto está maior mas a proporção dos elementos está péssima! O resultado é pior do que o problema inicial.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exportar a imagem num dpi menor</span></span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meu_grafico_96.jpeg"</span>, grafico, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>)</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/meu_grafico_96.jpeg" class="img-fluid figure-img"></p>
</figure>
</div>
<p>A segunda solução é modificar as opções internas do <code>showtext</code>. Isto é bastante simples e pode ser feito com o <code>showtext_opts(dpi = 300)</code> e chamando novamente a função <code>showtext_auto()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ajusta o DPI do showtext</span></span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_opts</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "Ativa" o showtext novamente</span></span>
<span id="cb15-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Refaz o gráfico (isto é importante!)</span></span>
<span id="cb15-7">grafico <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(cyl))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cilindros"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-10">  theme_custom</span>
<span id="cb15-11"></span>
<span id="cb15-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exporta um novo gráfico</span></span>
<span id="cb15-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meu_grafico_300.jpeg"</span>, grafico, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span></code></pre></div>
</div>
<p>Agora o tamanho do texto está correto e a imagem como um todo está em alta resolução. Um problema é que a imagem ficou bastante grande, mas isto pode ser ajustado variando os argumentos <code>width</code> e <code>height</code> da função <code>ggsave</code>.</p>
<p><img src="https:://www.restateinsight.com/posts/tutorial-showtext/meu_grafico_300.jpeg" class="image_figure image_featured image_internal image_unprocessed img-fluid" loading="lazy" decoding="async" alt=""></p>
<p>Vale notar que, a depender do seu sistema operacional, modificar o DPI padrão do showtext pode distorcer os gráficos dentro do R ou RStudio. Na prática o melhor <em>workflow</em> pode ser de modificar o DPI do showtext apenas no momento de exportar os gráficos.</p>


</section>
</section>

 ]]></description>
  <category>tutorial-R</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/tutorial-showtext/index.html</guid>
  <pubDate>Wed, 10 May 2023 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/tipografia_r.png" medium="image" type="image/png" height="57" width="144"/>
</item>
<item>
  <title>Visualizando o IPCA</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index.html</link>
  <description><![CDATA[ 




<section id="inflação-no-brasil" class="level1">
<h1>Inflação no Brasil</h1>
<p>A inflação voltou a ser uma pauta, não só no Brasil, mas no mundo todo, nos últimos meses. No Brasil, a combinação de câmbio desvalorizado, desajustes logísticos, crise hídrica e choques de preços externos, culminaram no maior nível de inflação desde 2002.</p>
<p>Mesmo em países avançados, os níveis de inflação estão em altas históricas. Nos Estados Unidos, por exemplo, o nível do CPI está no valor mais alto desde o final dos anos 1970.</p>
<p>Visualizar a magnitude da inflação no Brasil pode ser um pouco desafiador. A série do IPCA é calculada desde 1979. O número de cidades avaliadas pelo índice cresceu no tempo: nos primeiros anos o índice contemplava Rio de Janeiro, Porto Alegre, Belo Horizonte, Recife, São Paulo, Brasília, Belém, Fortaleza, Salvador e Curitiba. Em 1991, Goiânia entra no índice e, mais recentemente, em 2014, Vitória e Campo Grande também entraram no cômputo do índice.</p>
<p>Mais importante do que a variação no número das cidades, é o período hiperinflacionário da década de 1980. Os números da inflação são incomparavelmente mais altos do que os atuais. Como regra, os cortes temporais mais relevantes para enxergar a inflação são Jul/94 (Plano Real), Jul/99 (Regime de Metas de Inflação), Mai/00 (Lei de Responsabilidade Fiscal) e Mai/03 (pós choque de 2002).</p>
<p>Neste post vou mostrar o comportamento da inflação desde 1999.</p>
<section id="pacotes" class="level2">
<h2 class="anchored" data-anchor-id="pacotes">Pacotes</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Os pacotes utilizados</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdist)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spiralize)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(showtext)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(GetBCBData)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(forecast)</span></code></pre></div>
</div>
</section>
<section id="importando-os-dados" class="level2">
<h2 class="anchored" data-anchor-id="importando-os-dados">Importando os dados</h2>
<p>Importo os dados diretamente da API do Banco Central usando o pacote <code>GetBCBData</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importar os dados</span></span>
<span id="cb2-2">ipca <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gbcbd_get_series</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">433</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">first.date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1998-01-01"</span>))</span></code></pre></div>
</div>
<p>O código abaixo cria alguns elementos que serão necessários para as visualizações.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb3-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ref.date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1998-01-01"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2022-12-01"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 month"</span>))</span>
<span id="cb3-3"></span>
<span id="cb3-4">ipca_meta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1999</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2022</span>,</span>
<span id="cb3-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>),</span>
<span id="cb3-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">banda =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)),</span>
<span id="cb3-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">banda_superior =</span> meta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> banda,</span>
<span id="cb3-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">banda_inferior =</span> meta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> banda)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">ipca <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ipca <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(grid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fill</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">month =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">month</span>(ref.date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">abbr =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt_BR"</span>),</span>
<span id="cb4-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(ref.date),</span>
<span id="cb4-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb4-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">acum12m =</span> RcppRoll<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">roll_prodr</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">acum12m =</span> acum12m <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(ipca_meta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">deviation =</span> acum12m <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> meta)</span></code></pre></div>
</div>
</section>
<section id="inflação" class="level2">
<h2 class="anchored" data-anchor-id="inflação">Inflação</h2>
<p>O cálculo do IPCA avalia a variação de preços de uma cesta fixa de bens. A composição desta cesta vem da Pesquisa de Orçamentos Familiares (POF), também feita pelo IBGE, que tem como objetivo representar a “cesta de consumo média” dos brasileiros.</p>
<p>Formalmente, o IPCA é um índice de Laspeyeres que compara o preço de mercado de uma cesta de bens <img src="https://latex.codecogs.com/png.latex?W%20=%20(w_%7B1%7D,%20w_%7B2%7D,%20%5Cdots,%20w_%7Bn%7D)"> no período <img src="https://latex.codecogs.com/png.latex?t"> e compara o preço de mercado desta mesma cesta de bens no período anterior <img src="https://latex.codecogs.com/png.latex?t-1">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AI_%7Bt%7D%20=%20%5Cfrac%7B%5Csum_%7Bi%7Dw_%7Bi%7DP_%7Bi,%20t%7D%7D%7B%5Csum_%7Bi%7Dw_%7Bi%7DP_%7Bi,%20t-1%7D%7D%0A"></p>
<p>Na prática, esta cesta de bens agrega um misto de gastos com habitação, alimentos, vestuário, combustíveis, serivços, etc. Como existe uma clara sazonalidade tanto na oferta como na demanda por estes bens, o IPCA também apresenta sazonalidade.</p>
<p>Isso fica claro, quando se visualiza a variação do IPCA mês a mês como no gráfico abaixo. Tipicamente, os meses de nov-dez-jan-fev apresentam valores mais altos do que os meses de mai-jun-jul-ago.</p>
<p>O ponto fora da curva em novembro é referente ao ano de 2002. Ele é resultado, em parte, da incerteza econômica e da enorme desvalorização cambial que se seguiu à primeira eleição do ex-presidente Lula.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts</span>(ipca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1998</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frequency =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggseasonplot</span>(y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sazonalidade do IPCA"</span>,</span>
<span id="cb5-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="no-longo-prazo" class="level2">
<h2 class="anchored" data-anchor-id="no-longo-prazo">No longo prazo</h2>
<p>Uma das maneiras de contornar o problema da sazonalidade é acumulando o índice anualmente, pois aí temos o efeito sazonal de todos os meses. O problema é que aí teríamos de sempre comparar anos completos, impossibilitando um diagnóstico da inflação em maio do ano corrente.</p>
<p>A solução é acumular o índice em doze meses, criando um “ano artificial”. A lógica é que, independentemente do momento do tempo em que estamos, contamos o efeito de todos os meses individualmente. Chamando de <img src="https://latex.codecogs.com/png.latex?z_%7Bt%7D"> o índice acumulado e <img src="https://latex.codecogs.com/png.latex?y_%7Bt%7D"> o valor do IPCA no período <img src="https://latex.codecogs.com/png.latex?t"> temos que:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az_%7Bt%7D%20=%20%5B(1%20+%20y_%7Bt-12%7D)(1%20+%20y_%7Bt-11%7D)%5Cdots(1%20+%20y_%7Bt-1%7D)%5D%20-%201%0A"></p>
<p>Assim, para o mês de maio de 2022 teríamos</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az_%7B%5Ctext%7Bmaio/22%7D%7D%20=%20%5B(1%20+%20y_%7B%5Ctext%7Babril/22%7D%7D)(1%20+%20y_%7B%5Ctext%7Bmar/22%7D%7D)%5Cdots(1%20+%20y_%7B%5Ctext%7Bjun/21%7D%7D)%5D%20-%201%0A"></p>
<section id="acumulado-12-meses" class="level3">
<h3 class="anchored" data-anchor-id="acumulado-12-meses">Acumulado 12 meses</h3>
<p>O código abaixo apresenta o histórico do IPCA acumulado em 12 meses junto com a sua média histórica.</p>
<p>Vemos como o período de 2002 é muito fora da curva. Também se nota como o Brasil quase sempre tem uma inflação relativamente alta, próxima de 5-6%. O único período de inflação baixa na série é no período 2017-19.</p>
<p>Vale notar que só faz sentido em falar na “média histórica” de uma série se ela for estacionária.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">avgipca <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ipca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>acum12m, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-2">label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Média: "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(avgipca, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb6-3">dftext <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2019-01-01"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(ipca), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ref.date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> acum12m)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> avgipca,</span>
<span id="cb6-9">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dftext,</span>
<span id="cb6-11">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2019-01-01"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb6-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Helvetica"</span>,</span>
<span id="cb6-13">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_date</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_breaks =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 year"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Inflação Acumulada em 12 Meses"</span>,</span>
<span id="cb6-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-17">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>,</span>
<span id="cb6-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: BCB"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb6-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Helvetica"</span>),</span>
<span id="cb6-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>A comparação com a média histórica é interessante, mas é mais relevante olhar para a meta de inflação. Desde 1999, o Conselho Monetário Nacional (CMN) define, em geral com 2 anos de antecedência, a meta de inflação que o Banco Central deve perseguir. Este tipo de estrutura institucional é bastante popular mundo afora e há uma sólida básica empírica e teórica que a sustenta.</p>
<p>Basicamente, ao estabelecer antecipadamente uma meta de inflação, o CMN tenta ancorar as expectativas das pessoas na economia. Se a meta for crível, as pessoas tendem a montar planos de negócios, firmar contratos e tomar escolhas tomando a inflação futura como a meta de inflação.</p>
<p>A meta de inflação também incentiva o Banco Central a priorizar o controle dos preços acima de outras prioridades concorrentes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">historico_meta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ipca <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(ref.date, acum12m, meta, banda_inferior, banda_superior) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ref.date) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>()</span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(historico_meta, name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acum12m"</span>),</span>
<span id="cb7-8">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ref.date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value),</span>
<span id="cb7-9">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(historico_meta, name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acum12m"</span>),</span>
<span id="cb7-11">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ref.date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_date</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_breaks =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 year"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb7-15">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#264653"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#264653"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#2a9d8f"</span>),</span>
<span id="cb7-16">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Banda Inf."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Banda Sup."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Meta"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histórico de Metas de Inflação"</span>,</span>
<span id="cb7-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% (acum. 12 meses)"</span>,</span>
<span id="cb7-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: BCB"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-21">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>No Brasil, o CMN define a meta e também a sua banda superior e inferior. No gráfico acima, vemos que a inflação esteve relativamente dentro da meta no período 2003-2014, ainda que depois de 2008 o índice tenha ficado sempre acima do centro da meta.</p>
<p>Após a alta de 2016 o índice cai para níveis bastante baixos e o CMN inclusive começa a progressivamente reduzir a meta de inflação. Este é o único período desde 1999 em que a inflação fica, em alguns momentos, abaixo da meta.</p>
<p>Evidentemente, a inflação dispara no período recente. O enorme descolamento com a meta põe o sistema em cheque, à medida em que as pessoas acreditam cada vez menos na habilidade do Banco Central em honrar seu compromisso.</p>
</section>
</section>
<section id="enxergando-a-distribuição" class="level2">
<h2 class="anchored" data-anchor-id="enxergando-a-distribuição">Enxergando a distribuição</h2>
<p>Outra maneira de enxergar o IPCA é olhar para a distribuição dos seus valores. O gráfico abaixo é um histograma com um</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ipca, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ..density..), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">38</span>,</span>
<span id="cb8-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#264653"</span>,</span>
<span id="cb8-4">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribuição do IPCA mensal"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Densidade"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-9">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Um tipo de visualização interessante é montar um “grid” como o abaixo. Um problema é que a escala de cores acaba um pouco deturpada por causa do período 2002-3.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ipca, ref.date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1999-01-01"</span>)),</span>
<span id="cb9-2">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> month, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> acum12m)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray90"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1999</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2022</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"magma"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-7">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Algum nível de arbitrariedade é necessário para resolver isso. Uma opção é agrupar os dados em grupos. Como a meta mais longa que tivemos foi a de 4.5 com intervalo de 2, monto os grupos baseado nisso. A aceleração recente da inflação, a meu ver, fica mais evidente desta forma. Inclusive, conseguimos enxergar melhor como a inflação recente é mais intensa do que a de 2015-17.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">grupos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ipca <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ref.date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1999-01-01"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ipca_group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">findInterval</span>(acum12m, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)),</span>
<span id="cb10-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ipca_group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(ipca_group))</span>
<span id="cb10-5">labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt; 2.5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.5-4.5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.5-6.5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6.5-10"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10-15"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt; 15"</span>)</span>
<span id="cb10-6"></span>
<span id="cb10-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(grupos,</span>
<span id="cb10-8">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> month, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> ipca_group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray90"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1999</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2022</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"magma"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> labels) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-13">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Também podemos plotar a distribuição dos dados a cada ano. Note que a visualização abaixo não é nada convencional do ponto de vista estatístico.</p>
<p>Ainda assim, é interessante ver a dispersão enorme dos valores em 2002-3 e também como a inflação ficou relativamente bem-comportada nos anos seguintes até se tornar mais volátil e enviesada para a direita em 2016.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ipca, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(year), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(year))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_halfeye</span>(</span>
<span id="cb11-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">justification =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb11-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb11-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">  </span>
<span id="cb11-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"magma"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb11-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Por fim, uma visualização que eu acho muito interessante, mas que é ainda menos convencional é de espiral. Eu sinceramente não sei se é possível enxergar muita coisa de interessante desta forma e eu, infelizmente, não entendo o pacote <code>spiralize</code> o suficiente para entender de que forma é possível ajustar a escala das cores.</p>
<p>Fica uma visualização bacana, mas não acho que seja a mais apropriada.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">ipca <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(ipca)</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spiral_initialize_by_time</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(ipca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ref.date),</span>
<span id="cb12-4">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit_on_axis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"months"</span>,</span>
<span id="cb12-5">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>,</span>
<span id="cb12-6">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">period_per_loop =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb12-7">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>))</span>
<span id="cb12-8">                          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#vp_param = list(x = unit(0, "npc"), just = "left"))</span></span>
<span id="cb12-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spiral_track</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb12-10">lt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spiral_horizon</span>(ipca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ref.date, ipca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>acum12m, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_bar =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb12-11"></span>
<span id="cb12-12">s <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">current_spiral</span>()</span>
<span id="cb12-13">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span></span>
<span id="cb12-14">month_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(lubridate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">month</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">abbr =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt_BR"</span>))</span>
<span id="cb12-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(d)) {</span>
<span id="cb12-16">  foo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">polar_to_cartesian</span>(d[i]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>pi, (s<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max_radius <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>)</span>
<span id="cb12-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid.text</span>(month_name[i], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> foo[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> foo[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb12-18">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(d[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> d[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, d[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, d[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontsize =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb12-19">}</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>data-visualization</category>
  <category>brasil</category>
  <category>economia</category>
  <category>tutorial-R</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/ipca-visualizacao/index.html</guid>
  <pubDate>Thu, 01 Dec 2022 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/visualizando-ipca.png" medium="image" type="image/png" height="99" width="144"/>
</item>
<item>
  <title>ARMA: um exemplo simples</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index.html</link>
  <description><![CDATA[ 




<section id="introdução" class="level1">
<h1>Introdução</h1>
<p>Neste post apresento como estimar e diagnosticar um modelo ARMA simples no R. O modelo ARMA decompõe uma série em função de suas observações passadas e de “passados” (às vezes chamados de inovações). O ARMA(1, 1) com constante tem a seguinte forma.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ay_%7Bt%7D%20=%20%5Cphi_%7B0%7D%20+%5Cphi_%7B1%7Dy_%7Bt-1%7D%20+%20%5Cvarepsilon_%7Bt%7D%20+%20%5Ctheta_%7B1%7D%5Cvarepsilon_%7Bt%20-%201%7D%0A"></p>
<p>onde ambas as condições de estacionaridade como de invertibilidade devem ser atendidas. Assume-se que o termo <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_%7Bt%7D"> é um ruído branco. De maneira mais geral, um modelo ARMA(p, q) tem a forma:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ay_%7Bt%7D%20=%20%5Cphi_%7B0%7D%20+%5Cphi_%7B1%7Dy_%7Bt-1%7D%20+%20%5Cdots%20+%20%5Cphi_%7Bp%7Dy_%7Bt-p%7D%20+%20%5Cvarepsilon_%7Bt%7D%20+%20%5Ctheta_%7B1%7D%5Cvarepsilon_%7Bt%20-%201%7D%20+%20%5Cdots%20+%20%5Ctheta_%7Bq%7D%5Cvarepsilon_%7Bt-%20q%7D%0A"></p>
</section>
<section id="crescimento-do-pnb" class="level1">
<h1>Crescimento do PNB</h1>
<p>Vamos usar a série do PNB disponbilizada pelo pacote <code>astsa</code>. Este pacote foi montado pelos autores do livro <a href="https://www.stat.pitt.edu/stoffer/tsa4/">Time Series Analysis</a>. Para visualizar a série usamos a função <code>plot.ts</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(astsa)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(forecast)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gnp"</span>)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot.ts</span>(gnp,</span>
<span id="cb2-2">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Produto Nacional Bruto EUA (trimestre)"</span>,</span>
<span id="cb2-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb2-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"US$ (bilhões)"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Precisamos transformar a série primeiro. Para encontrar a variação percentual de uma variável <img src="https://latex.codecogs.com/png.latex?y_%7Bt%7D"> qualquer fazemos</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5CDelta%20y_%7Bt%7D%20=%20%5Cfrac%7By_%7Bt%7D%20-%20y_%7Bt-1%7D%7D%7By_%7Bt-1%7D%7D%0A"></p>
<p>Uma aproximação comumumente usada no lugar da equação acima é a diferença em log. Na literatura de finanças a equação acima também é conhecida como <em>retorno</em> e a diferença em log como <em>log-retorno</em>. Na prática, além da aproximação ser boa para valores pequenos (em torno de zero) costuma ser mais cômodo trabalhar com log-retornos.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5CDelta%20y_%7Bt%7D%20=%20%5Cfrac%7By_%7Bt%7D%20-%20y_%7Bt-1%7D%7D%7By_%7Bt-1%7D%7D%20%5Capprox%20%5Ctext%7Bln%7D(1%20+%20%5CDelta%20y_%7Bt%7D)%20=%20%5Ctext%7Bln%7D(y_%7Bt%7D/y_%7Bt-1%7D)%20=%20%5Ctext%7Bln%7D(y_%7Bt%7D)%20-%20%5Ctext%7Bln%7D(y_%7Bt-1%7D)%0A"></p>
<p>No R podemos combinar duas funções para facilitar o cômputo da diferença dos logs: usamos <code>diff()</code> que computa <img src="https://latex.codecogs.com/png.latex?y_%7Bt%7D%20-%20y_%7Bt%20-%201%7D"> junto com a função <code>log()</code> que computa o logaritmo. Note que a função <code>log()</code> usa o número <img src="https://latex.codecogs.com/png.latex?e"> como base; é possível trocar a base usando o argumento <code>base = 10</code>, por exemplo, ou usar simplesmente uma outra função <code>log10()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Computa log(y[t]) - log(y[t-1])</span></span>
<span id="cb3-2">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diff</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(gnp))</span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gráfico da série transformada</span></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot.ts</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variação percentual do PIB"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(%)"</span>)</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para avaliar a qualidade do modelo vamos reservar a parte final dos dados: a ideia é gerar previsões usando apenas a informação da primeira parte da amostra e então comparar estas previsões com as observações. Esta metodologia às vezes é denominada de <em>train</em> (treino) e <em>test</em> (teste).</p>
<p>Treinamos o modelo com as primeiras observações e depois testamos as suas previsões contra as observações finais (que ficaram fora do modelo). Aqui também cabe uma breve observação sobre dados em série de tempo. Se tivéssemos dados em cross-section o correto seria formar as bases <em>train</em> e <em>test</em> usando algum tipo de amostragem aleatória. Como os dados de série de tempo são encadeados não podemos fazer isto: por isto “cortamos” as observações num determinado instante do tempo.</p>
<p>Abaixo escolho um tanto arbitrariamente cortar os dados em janeiro de 1992. Em azul destaco os dados que serão utilizados para alimentar o modelo. As previsões serão testasdas contra as observações em vermelho.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cria a janela temporal</span></span>
<span id="cb4-2">train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">window</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1991</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb4-3">teste <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">window</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1992</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plota o gráfico destacando as observações finais que foram removidas.</span></span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot.ts</span>(y)</span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)</span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(teste, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="identificação" class="level1">
<h1>Identificação</h1>
<p>O primeiro trabalho que temos é o de identificar a ordem do modelo, isto é, encontrar os valores verdadeiros de <img src="https://latex.codecogs.com/png.latex?p"> e <img src="https://latex.codecogs.com/png.latex?q">. A maneira mais comum de começar é tentar comparar os gráficos das funções de autocorrelação (FAC) e autocorrelação parcial (FACP) com suas contrapartidas teóricas. O R tem as funções <code>acf()</code> e <code>pacf()</code> que calculam estes valores junto com intervalos de confiança assintóticos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica parâmetros para apresentar dois gráficos numa mesma figura</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acf</span>(train,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Função de autocorrelação"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Defasagem"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ACF"</span>)</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pacf</span>(train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Função de autocorrelação parcial"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Defasagem"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PACF"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note que a escala das defasagens é agrupada pela frequência dos dados, isto é, são contadas de quatro em quatro. Há alguns problemas com a visualização acima. Primeiro, a função de autocorrelãção começa no lag zero, isto é, <img src="https://latex.codecogs.com/png.latex?%5Crho(0)">. Sabemos que este valor sempre será igual a um pois, por definição: <img src="https://latex.codecogs.com/png.latex?%5Crho(0)%20=%20%5Cfrac%7B%5Cgamma(0)%7D%7B%5Cgamma(0)%7D%20=%201">. Logo, seria melhor que esta defasagem fosse suprimida. Além disso, é um tanto inconveniente ter que modificar os parâmetros gráficos usando <code>par(mfrow = c(2, 1))</code>. Uma saída é usar a função <code>acf2()</code> do pacote <code>astsa</code>. Esta função também imprime uma lista com os valores estimados da FAC e da FACP.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acf2</span>(train)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<pre><code>#&gt;      [,1] [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8] [,9] [,10] [,11] [,12] [,13]
#&gt; ACF  0.36 0.19 -0.01 -0.13 -0.17 -0.11 -0.09 -0.05 0.04  0.05  0.03 -0.12 -0.13
#&gt; PACF 0.36 0.07 -0.12 -0.12 -0.08  0.00 -0.03 -0.02 0.05  0.01 -0.03 -0.18 -0.05
#&gt;      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
#&gt; ACF  -0.10 -0.11  0.05  0.08  0.11  0.06  0.07 -0.08 -0.05 -0.10 -0.06
#&gt; PACF  0.02 -0.07  0.10  0.02  0.02 -0.04  0.02 -0.11  0.03 -0.03 -0.01</code></pre>
</div>
<p>Agora está mais claro que as duas primeiras defasagens da FAC são significantes e que a primeira defasagem da FACP é significante. Note também que a 5ª defasagem na FAC é um pouco significante e há uma defasagem de ordem elevada (lag 12) que é um pouco significante na FACP. Em geral, podemos desprezar estas autocorrelações de ordens muito elevadas até porque vamos querer modelos mais parcimoniosos (i.e.&nbsp;com poucos parâmetros).</p>
<p>Apenas olhando para os gráficos acima poderíamos chutar um modelo ARMA(1,1), ARMA(1,2) ou mesmo um AR(1). Depois disto teríamos que checar os resíduos para ver se o modelo está bem ajustado. Por fim, poderíamos escolher o melhor modelo segundo algum critério de informação como o Critério de Akaike (AIC). Alternativamente, poderíamos identificar a ordem do modelo usando algum algoritmo. A função <code>auto.arima()</code> do pacote <code>forecast()</code> verifica vários modelos e compara eles via uma série de critérios.</p>
</section>
<section id="estimação-e-diagnóstico" class="level1">
<h1>Estimação e diagnóstico</h1>
<section id="modelo-1" class="level2">
<h2 class="anchored" data-anchor-id="modelo-1">Modelo 1</h2>
<p>Vou primeiro estimar o ARMA(1, 2) usando a função <code>arima()</code> do R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">(m1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arima</span>(train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)))</span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Call:</span></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; arima(x = train, order = c(1, 0, 2))</span></span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb8-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Coefficients:</span></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;          ar1     ma1     ma2  intercept</span></span>
<span id="cb8-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;       0.2324  0.0971  0.1623     0.0084</span></span>
<span id="cb8-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; s.e.  0.2294  0.2247  0.0958     0.0012</span></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb8-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; sigma^2 estimated as 0.0001038:  log likelihood = 566.91,  aic = -1123.82</span></span></code></pre></div>
</div>
<p>A estimativa tem a forma: <img src="https://latex.codecogs.com/png.latex?%0A%20%20y_%7Bt%7D%20=%20%5Cunderset%7B(0.0012)%7D%7B0.0084%7D%20+%20%5Cunderset%7B(0.2324)%7D%7B0.2294%7Dy_%7Bt%20-%201%7D%20+%20%5Cunderset%7B(0.2247)%7D%7B0.0971%7D%5Cepsilon_%7Bt-1%7D%20+%20%5Cunderset%7B(0.0958)%7D%7B0.1623%7D%5Cepsilon_%7Bt-2%7D%0A"> Note que os erros-padrão de <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cphi_%7B1%7D%7D"> e <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Ctheta_%7B1%7D%7D"> são bastante elevados. De fato, um teste-t revela que estes coeficientes não são significantes.</p>
<section id="diagnóstico-de-resíduos" class="level3">
<h3 class="anchored" data-anchor-id="diagnóstico-de-resíduos">Diagnóstico de resíduos</h3>
<p>Pode-se verificar os resíduos do modelo de muitas formas. Idealmente, quer-se que os resíduos não apresentem autocorrelação alguma. Uma forma gráfica de ver isto é usando a função <code>lag1.plot</code> que apresenta gráficos de dispersão entre o resíduo <img src="https://latex.codecogs.com/png.latex?u_%7Bt%7D"> contra suas defasagens <img src="https://latex.codecogs.com/png.latex?u_%7Bt-1%7D,%20u_%7Bt-2%7D,%20%5Cdots">. Abaixo faço isto para as primieras quatro defasagens.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">residuos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resid</span>(m1)</span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag1.plot</span>(residuos, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.lag =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Na prática, é mais conveniente analisar diretamente os gráficos da FAC e da FACP dos resíduos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acf2</span>(residuos)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<pre><code>#&gt;      [,1]  [,2] [,3]  [,4]  [,5]  [,6]  [,7]  [,8] [,9] [,10] [,11] [,12] [,13]
#&gt; ACF  0.01 -0.01    0 -0.09 -0.12 -0.03 -0.04 -0.05 0.04  0.06  0.07 -0.12 -0.07
#&gt; PACF 0.01 -0.01    0 -0.09 -0.12 -0.03 -0.05 -0.06 0.02  0.04  0.06 -0.15 -0.09
#&gt;      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
#&gt; ACF  -0.03 -0.12  0.07  0.06  0.06  0.02  0.09  -0.1  0.00 -0.07 -0.04
#&gt; PACF -0.02 -0.11  0.06  0.02  0.04 -0.02  0.05  -0.1  0.01 -0.05 -0.01</code></pre>
</div>
<p>Um teste basatante usual para verificar a presença de autocorrelação nos resíduos é o Ljung-Box. Para computá-lo uso a função <code>Box.test()</code> do pacote <code>tseries</code>. Note que é preciso suplementar o argumento <code>fitdf</code> com o número de parâmetros estimados do modelo. Isto serve para corrigir a estatística do teste. A escolha da ordem do teste é um tanto arbitrária e, na prática, seria recomendado fazer o teste para várias ordens diferentes. O código abaixo computa a estatística do teste para uma defasagem igual a 8.</p>
<p>Note o uso do argumento <code>fitdf</code> que leva em conta o número de parâmetros estimados no modelo. Segundo o p-valor, não temos evidência para rejeitar a hipótese nula de que os resíduos <em>não</em> são conjuntamente autocorrelacionados. Isto é, temos evidência de que o modelo está bem ajustado pois os resíduos parecem se comportar como ruído branco.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tseries)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Box.test</span>(residuos, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ljung-Box"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lag =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fitdf =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  Box-Ljung test</span></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb12-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; data:  residuos</span></span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; X-squared = 4.9486, df = 4, p-value = 0.2926</span></span></code></pre></div>
</div>
<p>Na prática, é bom repetir o teste para várias defasagens diferentes. A tabela abaixo resume os valores do teste para várias ordens de defasagem. Vale lembrar que o teste Ljung-Box tende a não-rejeitar H0 para defasagens muito elevadas.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-bordered table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Defasagem</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Estatística de teste</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">P-valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">4.9486</td>
<td style="text-align: center;">0.2926</td>
</tr>
<tr class="even">
<td style="text-align: center;">9</td>
<td style="text-align: center;">5.2251</td>
<td style="text-align: center;">0.3890</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">5.8669</td>
<td style="text-align: center;">0.4383</td>
</tr>
<tr class="even">
<td style="text-align: center;">11</td>
<td style="text-align: center;">6.7991</td>
<td style="text-align: center;">0.4501</td>
</tr>
<tr class="odd">
<td style="text-align: center;">12</td>
<td style="text-align: center;">9.7788</td>
<td style="text-align: center;">0.2809</td>
</tr>
<tr class="even">
<td style="text-align: center;">13</td>
<td style="text-align: center;">10.8054</td>
<td style="text-align: center;">0.2893</td>
</tr>
<tr class="odd">
<td style="text-align: center;">14</td>
<td style="text-align: center;">10.9313</td>
<td style="text-align: center;">0.3629</td>
</tr>
<tr class="even">
<td style="text-align: center;">15</td>
<td style="text-align: center;">13.6377</td>
<td style="text-align: center;">0.2537</td>
</tr>
<tr class="odd">
<td style="text-align: center;">16</td>
<td style="text-align: center;">14.5903</td>
<td style="text-align: center;">0.2646</td>
</tr>
<tr class="even">
<td style="text-align: center;">17</td>
<td style="text-align: center;">15.2158</td>
<td style="text-align: center;">0.2941</td>
</tr>
<tr class="odd">
<td style="text-align: center;">18</td>
<td style="text-align: center;">15.8735</td>
<td style="text-align: center;">0.3212</td>
</tr>
<tr class="even">
<td style="text-align: center;">19</td>
<td style="text-align: center;">15.9294</td>
<td style="text-align: center;">0.3868</td>
</tr>
<tr class="odd">
<td style="text-align: center;">20</td>
<td style="text-align: center;">17.4548</td>
<td style="text-align: center;">0.3568</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="usando-o-pacote-astsa" class="level3">
<h3 class="anchored" data-anchor-id="usando-o-pacote-astsa">Usando o pacote <code>astsa</code></h3>
<p>Uma forma bastante conveniente de trabalhar com modelos ARMA é com a função <code>sarima</code> do pacote <code>astsa</code>. Esta função apresenta automaticamente algumas valiosas informações para o diagnóstico dos resíduos: o gráfico do ACF, o gráfico qq-plot (para verificar a normalidade dos resíduos) e os p-valores do teste Ljung-Box para várias ordens de defasagem.</p>
<p>A saída abaixo reúne quatro gráficos. O primeiro deles apresenta o resíduo normalizado (ou escalado). Este gráfico não deve apresentar um padrão claro. O segundo gráfico é a FAC do resíduo: idealmente, nenhuma defasagem deve ser significativa neste gráfico. Ao lado da FAC temos o QQ-plot: se todos os pontos caem sobre a linha azul temos evidência de que os resíduos são normalmente distribuídos.</p>
<p>Por fim, o último gráfico mostra o p-valor do teste Ljung-Box (já ajustado pelo número de parâmetros do modelo estimado) para diferentes defasagens. A linha tracejada em azul indica o valor 0.05. Idealmente, todos os pontos devem estar acima desta linha.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sarima</span>(train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">q =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; initial  value -4.507231 </span></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   2 value -4.512000</span></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   3 value -4.582718</span></span>
<span id="cb13-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   4 value -4.583615</span></span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   5 value -4.583727</span></span>
<span id="cb13-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   6 value -4.583754</span></span>
<span id="cb13-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   7 value -4.583896</span></span>
<span id="cb13-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   8 value -4.583941</span></span>
<span id="cb13-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   9 value -4.583957</span></span>
<span id="cb13-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter  10 value -4.583958</span></span>
<span id="cb13-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter  10 value -4.583958</span></span>
<span id="cb13-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; final  value -4.583958 </span></span>
<span id="cb13-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; converged</span></span>
<span id="cb13-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; initial  value -4.586016 </span></span>
<span id="cb13-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   2 value -4.586020</span></span>
<span id="cb13-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   3 value -4.586022</span></span>
<span id="cb13-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   4 value -4.586023</span></span>
<span id="cb13-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   5 value -4.586025</span></span>
<span id="cb13-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   6 value -4.586026</span></span>
<span id="cb13-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   7 value -4.586027</span></span>
<span id="cb13-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   8 value -4.586027</span></span>
<span id="cb13-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   9 value -4.586028</span></span>
<span id="cb13-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   9 value -4.586028</span></span>
<span id="cb13-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; iter   9 value -4.586028</span></span>
<span id="cb13-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; final  value -4.586028 </span></span>
<span id="cb13-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; converged</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<pre><code>#&gt; $fit
#&gt; 
#&gt; Call:
#&gt; arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
#&gt;     xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, 
#&gt;     optim.control = list(trace = trc, REPORT = 1, reltol = tol))
#&gt; 
#&gt; Coefficients:
#&gt;          ar1     ma1     ma2   xmean
#&gt;       0.2324  0.0971  0.1623  0.0084
#&gt; s.e.  0.2294  0.2247  0.0958  0.0012
#&gt; 
#&gt; sigma^2 estimated as 0.0001038:  log likelihood = 566.91,  aic = -1123.82
#&gt; 
#&gt; $degrees_of_freedom
#&gt; [1] 175
#&gt; 
#&gt; $ttable
#&gt;       Estimate     SE t.value p.value
#&gt; ar1     0.2324 0.2294  1.0130  0.3125
#&gt; ma1     0.0971 0.2247  0.4319  0.6664
#&gt; ma2     0.1623 0.0958  1.6946  0.0919
#&gt; xmean   0.0084 0.0012  6.7491  0.0000
#&gt; 
#&gt; $AIC
#&gt; [1] -6.278312
#&gt; 
#&gt; $AICc
#&gt; [1] -6.277028
#&gt; 
#&gt; $BIC
#&gt; [1] -6.189279</code></pre>
</div>
</section>
</section>
<section id="modelo-2" class="level2">
<h2 class="anchored" data-anchor-id="modelo-2">Modelo 2</h2>
<p>Estimo também o modelo ARMA(1, 1). A análise de resíduos é análoga à apresentada acima.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">m2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arima</span>(train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
</div>
</section>
<section id="modelo-3" class="level2">
<h2 class="anchored" data-anchor-id="modelo-3">Modelo 3</h2>
<p>Para o terceiro modelo uso o método automático do <code>auto.arima()</code>. A função escolhe o AR(1) com constante como melhor modelo para representar os dados. Note que a na inspeação visual também tínhamos verificado que o AR(1) seria um possível candidato.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">(m3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto.arima</span>(train))</span>
<span id="cb16-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Series: train </span></span>
<span id="cb16-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; ARIMA(1,0,0) with non-zero mean </span></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb16-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Coefficients:</span></span>
<span id="cb16-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;          ar1    mean</span></span>
<span id="cb16-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;       0.3568  0.0084</span></span>
<span id="cb16-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; s.e.  0.0695  0.0012</span></span>
<span id="cb16-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; </span></span>
<span id="cb16-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; sigma^2 = 0.0001066:  log likelihood = 565.52</span></span>
<span id="cb16-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; AIC=-1125.04   AICc=-1124.91   BIC=-1115.48</span></span></code></pre></div>
</div>
<section id="seleção" class="level3">
<h3 class="anchored" data-anchor-id="seleção">Seleção</h3>
<p>Para escolher o melhor modelo pode-se usar algum critério de informação. Abaixo comparo os modelos segundo os critérios AIC, AICc (AIC corrigido) e BIC (Bayesian Information Criterion). Na prática, não é comum que os três critérios escolham o mesmo modelo; em particular, o BIC penaliza o número de parâmetros mais fortemente que o AIC. Neste caso específico, os três critérios escolhem o AR(1).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-bordered table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AICc</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ARMA(1, 2)</td>
<td style="text-align: center;">-1123.818</td>
<td style="text-align: center;">-1124.908</td>
<td style="text-align: center;">-1115.483</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARMA(1, 1)</td>
<td style="text-align: center;">-1123.563</td>
<td style="text-align: center;">-1124.908</td>
<td style="text-align: center;">-1115.483</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AR(1)</td>
<td style="text-align: center;">-1125.045</td>
<td style="text-align: center;">-1124.908</td>
<td style="text-align: center;">-1115.483</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="previsão" class="level3">
<h3 class="anchored" data-anchor-id="previsão">Previsão</h3>
<p>Para gerar previsões usamos a função <code>forecast()</code> (outra opção é usar a função base <code>predict()</code>). Abaixo computo previsões para os três modelos acima mais um modelo ingênuo que será usado como bench-mark. O modelo ingênuo é simplesmente um random-walk que prevê sempre o valor anterior, isto é, <img src="https://latex.codecogs.com/png.latex?%5Chat%7By_%7BT+1%7D%7D%20=%20y_%7BT%7D">.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">prev1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">forecast</span>(m1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(teste))</span>
<span id="cb17-2">prev2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">forecast</span>(m2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(teste))</span>
<span id="cb17-3">prev3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">forecast</span>(m3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(teste))</span>
<span id="cb17-4">prev4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">forecast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">naive</span>(train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(teste)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(teste))</span>
<span id="cb17-5"></span>
<span id="cb17-6">erros <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(teste <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> prev1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean,</span>
<span id="cb17-7">                    teste <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> prev2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean,</span>
<span id="cb17-8">                    teste <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> prev3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean,</span>
<span id="cb17-9">                    teste <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> prev4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean),</span>
<span id="cb17-10">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb17-11">erros <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(erros)</span>
<span id="cb17-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(erros) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">time</span>(teste)))</span>
<span id="cb17-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row.names</span>(erros) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ARMA(1, 2)"</span>,</span>
<span id="cb17-14">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ARMA(1, 1)"</span>,</span>
<span id="cb17-15">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AR(1)"</span>,</span>
<span id="cb17-16">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y[t+1] = Y[t]"</span>)</span></code></pre></div>
</div>
<p>Os erros de previsão são apresentados na tabela abaixo.</p>
<div class="cell" data-layout-align="center" data-asis="true">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-bordered table-hover table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1992</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1992.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1992.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1992.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1993</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1993.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1993.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1993.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1994</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1994.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1994.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1994.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1995</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1995.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1995.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1995.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1996</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1996.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1996.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1996.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1997</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1997.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1997.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1997.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1998</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1998.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1998.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1998.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1999</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1999.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1999.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 1999.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2000</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2000.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2000.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2000.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2001</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2001.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2001.5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2001.75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2002</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2002.25</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t = 2002.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ARMA(1, 2)</td>
<td style="text-align: center;">0.0017385</td>
<td style="text-align: center;">0.0009996</td>
<td style="text-align: center;">-0.0011832</td>
<td style="text-align: center;">0.0047685</td>
<td style="text-align: center;">-0.0075880</td>
<td style="text-align: center;">-0.0034300</td>
<td style="text-align: center;">-0.0032720</td>
<td style="text-align: center;">0.0041505</td>
<td style="text-align: center;">0.0009645</td>
<td style="text-align: center;">0.0048053</td>
<td style="text-align: center;">-0.0031499</td>
<td style="text-align: center;">0.0038158</td>
<td style="text-align: center;">-0.0038534</td>
<td style="text-align: center;">-0.0059706</td>
<td style="text-align: center;">-0.0026298</td>
<td style="text-align: center;">0.0011636</td>
<td style="text-align: center;">-0.0008728</td>
<td style="text-align: center;">0.0066953</td>
<td style="text-align: center;">-0.0041940</td>
<td style="text-align: center;">0.0035309</td>
<td style="text-align: center;">0.0012488</td>
<td style="text-align: center;">0.0064862</td>
<td style="text-align: center;">0.0012950</td>
<td style="text-align: center;">-0.0021395</td>
<td style="text-align: center;">0.0069883</td>
<td style="text-align: center;">-0.0032794</td>
<td style="text-align: center;">-0.0002956</td>
<td style="text-align: center;">0.0083934</td>
<td style="text-align: center;">0.0023188</td>
<td style="text-align: center;">-0.0031434</td>
<td style="text-align: center;">0.0033963</td>
<td style="text-align: center;">0.0099058</td>
<td style="text-align: center;">-0.0030742</td>
<td style="text-align: center;">0.0039295</td>
<td style="text-align: center;">-0.0078546</td>
<td style="text-align: center;">-0.0045499</td>
<td style="text-align: center;">-0.0119065</td>
<td style="text-align: center;">-0.0103021</td>
<td style="text-align: center;">-0.0110772</td>
<td style="text-align: center;">0.0006393</td>
<td style="text-align: center;">0.0005900</td>
<td style="text-align: center;">-0.0074360</td>
<td style="text-align: center;">0.0023173</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARMA(1, 1)</td>
<td style="text-align: center;">0.0015678</td>
<td style="text-align: center;">0.0011472</td>
<td style="text-align: center;">-0.0010609</td>
<td style="text-align: center;">0.0048359</td>
<td style="text-align: center;">-0.0075556</td>
<td style="text-align: center;">-0.0034158</td>
<td style="text-align: center;">-0.0032667</td>
<td style="text-align: center;">0.0041516</td>
<td style="text-align: center;">0.0009637</td>
<td style="text-align: center;">0.0048036</td>
<td style="text-align: center;">-0.0031520</td>
<td style="text-align: center;">0.0038136</td>
<td style="text-align: center;">-0.0038557</td>
<td style="text-align: center;">-0.0059730</td>
<td style="text-align: center;">-0.0026323</td>
<td style="text-align: center;">0.0011611</td>
<td style="text-align: center;">-0.0008752</td>
<td style="text-align: center;">0.0066928</td>
<td style="text-align: center;">-0.0041964</td>
<td style="text-align: center;">0.0035284</td>
<td style="text-align: center;">0.0012464</td>
<td style="text-align: center;">0.0064838</td>
<td style="text-align: center;">0.0012925</td>
<td style="text-align: center;">-0.0021420</td>
<td style="text-align: center;">0.0069858</td>
<td style="text-align: center;">-0.0032818</td>
<td style="text-align: center;">-0.0002980</td>
<td style="text-align: center;">0.0083910</td>
<td style="text-align: center;">0.0023164</td>
<td style="text-align: center;">-0.0031458</td>
<td style="text-align: center;">0.0033939</td>
<td style="text-align: center;">0.0099034</td>
<td style="text-align: center;">-0.0030766</td>
<td style="text-align: center;">0.0039271</td>
<td style="text-align: center;">-0.0078570</td>
<td style="text-align: center;">-0.0045523</td>
<td style="text-align: center;">-0.0119090</td>
<td style="text-align: center;">-0.0103046</td>
<td style="text-align: center;">-0.0110796</td>
<td style="text-align: center;">0.0006369</td>
<td style="text-align: center;">0.0005876</td>
<td style="text-align: center;">-0.0074384</td>
<td style="text-align: center;">0.0023149</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AR(1)</td>
<td style="text-align: center;">0.0013079</td>
<td style="text-align: center;">0.0009620</td>
<td style="text-align: center;">-0.0011721</td>
<td style="text-align: center;">0.0047728</td>
<td style="text-align: center;">-0.0075918</td>
<td style="text-align: center;">-0.0034379</td>
<td style="text-align: center;">-0.0032817</td>
<td style="text-align: center;">0.0041400</td>
<td style="text-align: center;">0.0009537</td>
<td style="text-align: center;">0.0047944</td>
<td style="text-align: center;">-0.0031608</td>
<td style="text-align: center;">0.0038049</td>
<td style="text-align: center;">-0.0038643</td>
<td style="text-align: center;">-0.0059815</td>
<td style="text-align: center;">-0.0026408</td>
<td style="text-align: center;">0.0011526</td>
<td style="text-align: center;">-0.0008837</td>
<td style="text-align: center;">0.0066843</td>
<td style="text-align: center;">-0.0042049</td>
<td style="text-align: center;">0.0035199</td>
<td style="text-align: center;">0.0012379</td>
<td style="text-align: center;">0.0064753</td>
<td style="text-align: center;">0.0012840</td>
<td style="text-align: center;">-0.0021505</td>
<td style="text-align: center;">0.0069773</td>
<td style="text-align: center;">-0.0032903</td>
<td style="text-align: center;">-0.0003065</td>
<td style="text-align: center;">0.0083825</td>
<td style="text-align: center;">0.0023079</td>
<td style="text-align: center;">-0.0031543</td>
<td style="text-align: center;">0.0033854</td>
<td style="text-align: center;">0.0098949</td>
<td style="text-align: center;">-0.0030851</td>
<td style="text-align: center;">0.0039186</td>
<td style="text-align: center;">-0.0078655</td>
<td style="text-align: center;">-0.0045608</td>
<td style="text-align: center;">-0.0119175</td>
<td style="text-align: center;">-0.0103131</td>
<td style="text-align: center;">-0.0110881</td>
<td style="text-align: center;">0.0006284</td>
<td style="text-align: center;">0.0005791</td>
<td style="text-align: center;">-0.0074469</td>
<td style="text-align: center;">0.0023064</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y[t+1] = Y[t]</td>
<td style="text-align: center;">0.0024552</td>
<td style="text-align: center;">0.0025186</td>
<td style="text-align: center;">0.0005306</td>
<td style="text-align: center;">0.0065276</td>
<td style="text-align: center;">-0.0058184</td>
<td style="text-align: center;">-0.0016579</td>
<td style="text-align: center;">-0.0014994</td>
<td style="text-align: center;">0.0059232</td>
<td style="text-align: center;">0.0027372</td>
<td style="text-align: center;">0.0065781</td>
<td style="text-align: center;">-0.0013772</td>
<td style="text-align: center;">0.0055886</td>
<td style="text-align: center;">-0.0020806</td>
<td style="text-align: center;">-0.0041978</td>
<td style="text-align: center;">-0.0008571</td>
<td style="text-align: center;">0.0029363</td>
<td style="text-align: center;">0.0009000</td>
<td style="text-align: center;">0.0084680</td>
<td style="text-align: center;">-0.0024213</td>
<td style="text-align: center;">0.0053036</td>
<td style="text-align: center;">0.0030215</td>
<td style="text-align: center;">0.0082589</td>
<td style="text-align: center;">0.0030677</td>
<td style="text-align: center;">-0.0003668</td>
<td style="text-align: center;">0.0087610</td>
<td style="text-align: center;">-0.0015066</td>
<td style="text-align: center;">0.0014772</td>
<td style="text-align: center;">0.0101662</td>
<td style="text-align: center;">0.0040916</td>
<td style="text-align: center;">-0.0013707</td>
<td style="text-align: center;">0.0051690</td>
<td style="text-align: center;">0.0116786</td>
<td style="text-align: center;">-0.0013015</td>
<td style="text-align: center;">0.0057023</td>
<td style="text-align: center;">-0.0060818</td>
<td style="text-align: center;">-0.0027771</td>
<td style="text-align: center;">-0.0101338</td>
<td style="text-align: center;">-0.0085294</td>
<td style="text-align: center;">-0.0093044</td>
<td style="text-align: center;">0.0024120</td>
<td style="text-align: center;">0.0023628</td>
<td style="text-align: center;">-0.0056632</td>
<td style="text-align: center;">0.0040900</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>Pode-se melhor comparar a performance das previsões usando alguma medida agregada de erro. Duas medidas bastante comuns são o Erro Absoluto Médio (EAM) e o Erro Quadrático Médio. A primeira toma o módulo da diferença entre o previsto (<img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D">) e o observado (<img src="https://latex.codecogs.com/png.latex?y">) e tira uma média, enquanto a última toma a diferença quadrática. Formalmente, para um horizonte de previsão <img src="https://latex.codecogs.com/png.latex?h"> começando na última observação <img src="https://latex.codecogs.com/png.latex?T">:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%5Ctext%7BEAM%7D%20&amp;%20=%20%5Cfrac%7B1%7D%7Bh%7D%5Csum_%7Bi%20=%20T%20+%201%7D%5E%7BT%20+%20h%7D%20%7Cy_%7Bi%7D%20-%20%5Chat%7By%7D_%7Bi%7D%7C%20%5C%5C%0A%5Ctext%7BEQM%7D%20&amp;%20=%20%5Cfrac%7B1%7D%7Bh%7D%5Csum_%7Bi%20=%20T%20+%201%7D%5E%7BT%20+%20h%7D%20(y_%7Bi%7D%20-%20%5Chat%7By%7D_%7Bi%7D)%5E2%0A%5Cend%7Balign%7D">
<p>A tabela abaixo compara os modelos segundo estas medidas de erro.</p>
<div class="cell" data-layout-align="center" data-asis="true">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-bordered table-hover table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">EAM</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">EQM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ARMA(1, 2)</td>
<td style="text-align: center;">0.0042173</td>
<td style="text-align: center;">0.0042062</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARMA(1, 1)</td>
<td style="text-align: center;">0.0000268</td>
<td style="text-align: center;">0.0000268</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AR(1)</td>
<td style="text-align: center;">0.0042143</td>
<td style="text-align: center;">0.0043644</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y[t+1] = Y[t]</td>
<td style="text-align: center;">0.0000268</td>
<td style="text-align: center;">0.0000280</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>Nem sempre é fácil comparar estas medidas, i.e., verificar se elas são estatisticamente significantes. Pode-se usar o teste Diebold-Mariano para comparar estas medidas de erro, mas é importante frisar que ele contém uma série de hipóteses sobre a distribuição dos erros. A função <code>dm.test</code> do pacote <code>forecast</code> faz este teste e mais informações sobre ele podem ser encontradas usando <code>?dm.test</code>.</p>
<p>Pode-se visualizar as previsões usando as funções <code>autoplot()</code> e <code>autolayer()</code> do pacote <code>forecast</code>. Abaixo mostro os resultados para o modelo AR(1) e também para o modelo ingênuo. note como o erros-padrão deste último cresce muito rapidamente (pois a variância de um processo random-walk cresce sem limite).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(prev2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autolayer</span>(teste) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-21-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"></span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(prev3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autolayer</span>(teste) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb19-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-21-2.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(prev4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autolayer</span>(teste) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index_files/figure-html/unnamed-chunk-21-3.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="conclusão" class="level1">
<h1>Conclusão</h1>
<p>Os modelos da classe ARMA são bastante populares em séries de tempo pois geram boas previsões de curto prazo. Além disso, estes modelos são estimados facilmente e usam apenas a informação da própria série. No post acima, vimos como estimar um modelo ARMA e algumas das facilidades que tanto o pacote <code>astsa</code> como o <code>forecast</code> nos oferecem.</p>


</section>

 ]]></description>
  <category>econometria</category>
  <category>time-series</category>
  <category>repost</category>
  <category>tutorial-R</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/repost-arma-exemplo-simples/index.html</guid>
  <pubDate>Mon, 01 Mar 2021 03:00:00 GMT</pubDate>
</item>
<item>
  <title>EMV no R</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/emv-no-r/index.html</link>
  <description><![CDATA[ 




<section id="estimadores-de-máxima-verossimilhança" class="level1">
<h1>Estimadores de Máxima Verossimilhança</h1>
<p>A estimação por máxima verossimilhança possui várias boas propriedades. O estimador de máxima verossimilhança (EMV) é <strong>consistente</strong> (converge para o valor verdadeiro), <strong>normalmente assintótico</strong> (distribuição assintórica segue uma normal padrão) e <strong>eficiente</strong> (é o estimador de menor variância possível). Por isso, e outros motivos, ele é um estimador muito comumemente utilizado em estatística e econometria.</p>
<p>A intuição do EMV é a seguinte: temos uma amostra e estimamos os parâmetros que maximizam a probabilidade de que esta amostra tenha sido gerada por uma certa distribuição de probabilidade. Em termos práticos, eu primeiro suponho a forma da distribuição dos meus dados (e.g.&nbsp;normal), depois eu estimo os parâmetros <img src="https://latex.codecogs.com/png.latex?%5Cmu"> e <img src="https://latex.codecogs.com/png.latex?%5Csigma"> de maneira que eles maximizem a probabilidade de que a minha amostra siga uma distribuição normal (tenha sido “gerada” por uma normal).</p>
<p>Há vários pacotes que ajudam a implementar a estimação por máxima verossimilhança no <code>R</code>. Neste post vou me ater apenas a dois pacotes: o <code>optimx</code> e o <code>maxLik</code>. O primeiro deles agrega funções de otimização de diversos outros pacotes numa sintaxe unificada centrada em algumas poucas funções. O último é feito especificamente para estimação de máxima verossimilhança então traz algumas comodidades como a estimação automática de erros-padrão.</p>
<p>Vale lembrar que o problema de MV é, essencialmente, um problema de otimização, então é possível resolvê-lo simplesmente com a função <code>optim</code> do <code>R</code>. Os dois pacotes simplesmente trazem algumas comodidades.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(maxLik)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(optimx)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Para reproduzir os resultados</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>)</span></code></pre></div>
</div>
</section>
<section id="exemplo-com-distribuição-poisson" class="level1">
<h1>Exemplo com distribuição Poisson</h1>
<p>A ideia da estimação por máxima verossimilhança é de encontrar os parâmetros que maximizam a probabilidade de que um certo conjunto de dados sejam gerados por algum processo específico. Agora, em português: imagine que temos uma amostra aleatória; não sabemos qual distribuição os dados seguem, mas vamos <em>supor</em> que eles seguem alguma distribuição específica, por exemplo, uma Poisson. O formato da Poisson depende do parâmetro <img src="https://latex.codecogs.com/png.latex?%5Clambda"> e a ideia então é de encontrar o valor de <img src="https://latex.codecogs.com/png.latex?%5Clambda"> que melhor aproxima a distribuição empírica/observada dos dados. Isto é, dado uma amostra aleatória <img src="https://latex.codecogs.com/png.latex?x_%7B1%7D,%20x_%7B2%7D,%20%5Cdots%20,%20x_%7Bn%7D"> buscamos o valor de <img src="https://latex.codecogs.com/png.latex?%5Clambda"> que maximiza a probabilidade de que os dados tenham sido gerados por uma distribuição de Poisson.</p>
<p>A Poisson é uma distribuição discreta parametrizada por um valor <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%3E%200">. O formato da distribuição varia com o valor de <img src="https://latex.codecogs.com/png.latex?%5Clambda">. Lembrando que a função de distribuição da Poisson é dada pela expressão:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20f(k,%20%5Clambda)%20=%20%5Ctext%7BPr%7D(X%20=%20k)%20=%20%5Cfrac%7B%5Clambda%5E%7Bk%7De%5E%7B-%5Clambda%7D%7D%7Bk!%7D,%20%5Cquad%20k%20=%200,%201,%202,%20%5Cdots%0A"></p>
<p>O código abaixo faz o gráfico da função acima para diferentes valores de <img src="https://latex.codecogs.com/png.latex?%5Clambda">.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/emv-no-r/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para montar a função de log-verossimilhança começamos com a função de verossimilhança de uma observação <img src="https://latex.codecogs.com/png.latex?i"> qualquer e depois montamos a distribuição conjunta dos dados. Lembrando que a função de verossimilhança da Poisson para uma observação <img src="https://latex.codecogs.com/png.latex?i"> é dada por:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20f(x_%7Bi%7D,%20%5Clambda)%20=%20%5Cfrac%7B%5Clambda%5E%7Bx_%7Bi%7D%7De%5E%7B-%5Clambda%7D%7D%7Bx_%7Bi%7D!%7D%0A"></p>
<p>Supondo que a amostra é de fato aleatória, a distribuição conjunta dos dados é simplesmente o produtório das distribuições individuais, isto é:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%20%20%5Cprod_%7Bk%20=%201%7D%5E%7Bn%7D%20f(x_%7Bk%7D,%20%5Clambda)%20&amp;%20=%20%5Cprod_%7Bk%20=%201%7D%5E%7Bn%7D%20%5Cleft(%20%5Cfrac%7B%5Clambda%5E%7Bx_%7Bk%7D%7De%5E%7B-%5Clambda%7D%7D%7Bx_%7Bk%7D!%7D%20%5Cright)%20%5C%5C%0A%20%20&amp;%20=%20%5Cfrac%7B%5Clambda%5E%7B%5Csum%20x_%7Bk%7D%7D%20e%5E%7B-n%5Clambda%7D%7D%7B%5Cprod_%7Bk%20=%201%7D%5E%7Bn%7D(x_%7Bk%7D!)%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>Aplicando log chegamos na função de log-verossimilhança:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%20%20%5Cmathcal%7BL%7D(%5Clambda%20;%20x_%7B1%7D,%20%5Cdots%20,%20x_%7Bn%7D)%20&amp;%20=%20%5Ctext%7Bln%7D(%5Cprod_%7Bk%20=%201%7D%5E%7Bn%7D%20f(x_%7Bk%7D,%20%5Clambda))%20%5C%5C%0A%20%20&amp;%20=%20%5Ctext%7Bln%7D(%5Clambda%5E%7B%5Csum%20x_%7Bk%7D%7D)%20+%20%5Ctext%7Bln%7D(e%5E%7B-n%5Clambda%7D)%20-%20%5Ctext%7Bln%7D(%5Cprod_%7Bk%20=%201%7D%5E%7Bn%7D(x_%7Bk%7D!))%20%5C%5C%0A%20%20&amp;%20=%20%5Ctext%7Bln%7D(%5Clambda)%5Csum_%7Bk%20=%201%7D%5E%7Bn%7Dx_%7Bk%7D%20-%20n%5Clambda%20-%20%5Csum_%7Bk%20=%201%7D%5E%7Bn%7D%20%5Ctext%7Bln%7D(x_%7Bk%7D!)%0A%5Cend%7Balign%7D%0A"></p>
<p>Dada uma amostra aleatória <img src="https://latex.codecogs.com/png.latex?x_%7B1%7D,%20x_%7B2%7D,%20%5Cdots%20,%20x_%7Bn%7D"> buscamos o valor de <img src="https://latex.codecogs.com/png.latex?%5Clambda"> que maximiza a função acima. Isto é, temos o seguinte problema de otimização:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Cunderset%7B%5Clambda%20%3E%200%7D%7B%5Ctext%7BMax%7D%7D%20%5Cquad%20%5Ctext%7Bln%7D(%5Clambda)%5Csum_%7Bk%20=%201%7D%5E%7Bn%7Dx_%7Bk%7D%20-%20n%5Clambda%20-%20%5Csum_%7Bk%20=%201%7D%5E%7Bn%7D%20%5Ctext%7Bln%7D(x_%7Bk%7D!)%0A"></p>
<p>onde os valores de <img src="https://latex.codecogs.com/png.latex?x_%7Bk%7D"> são os nossos dados observados. Para implementar este procedimento no R primeiro montamos a função log-verossimilhança no código abaixo. Em seguida vamos usar a função base <code>optim</code> que resolve problemas de minimização. Como a função <code>optim</code> serve para <em>minimizar</em> funções precisamos implementar o negativo da função de log-verossimilhança (lembrando que maximizar <img src="https://latex.codecogs.com/png.latex?f(x)"> é equivalente à minimizar <img src="https://latex.codecogs.com/png.latex?-f(x)">).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">ll_pois <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, theta) {</span>
<span id="cb2-2">    n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)</span>
<span id="cb2-3">    ll <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> theta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factorial</span>(x)))</span>
<span id="cb2-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ll)</span>
<span id="cb2-5">}</span></code></pre></div>
</div>
<p>Vamos simular 1000 observações <img src="https://latex.codecogs.com/png.latex?x_%7Bi%7D%20%5Csim%20%5Ctext%7BPoisson%7D(%5Clambda%20=%205)">.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">amostra <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpois</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
</div>
<p>Podemos tornar mais claro o procedimento de estimação olhando para o gráfico da função. O código abaixo plota o gráfico da função de log-verossimilhança para valores de <img src="https://latex.codecogs.com/png.latex?%5Clambda"> no intervalo <img src="https://latex.codecogs.com/png.latex?%5B0,%2020%5D">. Note que a função parece atingir um máximo em torno de <img src="https://latex.codecogs.com/png.latex?5">, o valor verdadeiro do parâmetro.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">eixo_lambda <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">001</span>)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(eixo_lambda, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ll_pois</span>(amostra, eixo_lambda), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l"</span>,</span>
<span id="cb4-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(lambda),</span>
<span id="cb4-4">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L("</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>lambda<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", ... ,"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>x[n]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>),</span>
<span id="cb4-5">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Função log-verossimilhança da Poisson"</span>)</span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"indianred"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/emv-no-r/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para estimar <img src="https://latex.codecogs.com/png.latex?%5Clambda"> usamos a função <code>optim</code>. É preciso definir algum valor inicial para que o otimizador numérico comece a procurar pelo máximo global. Em casos mais simples, de funções globalmente côncavas, esta escolha não apresenta grandes consequências. Em casos mais complicados, o resultado da estimação pode ser bastante sensível à escolha de valor inicial porque o otimizador pode cair em máximos/mínimos locais. No final do post discuto brevemente algumas soluções. Neste exemplo escolho arbitrariamente começar no valor <img src="https://latex.codecogs.com/png.latex?1">.</p>
<p>Neste caso também poderíamos usar o fato de que a esperança da Poisson é igual a <img src="https://latex.codecogs.com/png.latex?%5Clambda">, logo, pela Lei dos Grandes Números, a média amostral já deve estar próxima do verdadeiro valor de <img src="https://latex.codecogs.com/png.latex?%5Clambda">. Assim, poderíamos também ter escolhido <code>mean(amostra)</code> como valor inicial.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optim</span>(</span>
<span id="cb5-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_pois,</span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> amostra,</span>
<span id="cb5-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BFGS"</span>,</span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hessian =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb5-7">  )</span>
<span id="cb5-8"></span>
<span id="cb5-9">fit</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 4.938

$value
[1] 2202.837

$counts
function gradient 
      34        9 

$convergence
[1] 0

$message
NULL

$hessian
         [,1]
[1,] 202.5112</code></pre>
</div>
</div>
<p>A saída da função traz várias informações técnicas sobre a otimização numérica. A estimativa pontual computada foi de <img src="https://latex.codecogs.com/png.latex?4.938"> - bastante próxima do verdadeiro valor do parâmetro. Usando a função <code>str</code> podemos observar a estrutura do objeto <code>fit</code> criado acima. As principais informações que podemos extrair são as estimativas dos parâmetros <code>fit$par</code> e a hessiana calculada nestes parâmetros <code>fit$hessian</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 6
 $ par        : num 4.94
 $ value      : num 2203
 $ counts     : Named int [1:2] 34 9
  ..- attr(*, "names")= chr [1:2] "function" "gradient"
 $ convergence: int 0
 $ message    : NULL
 $ hessian    : num [1, 1] 203</code></pre>
</div>
</div>
<p>Usando a estimativa da hessiana podemos computar o erro-padrão da estimativa. Lembre que a variância assintótica do estimador de máxima verossimilhança é o inverso da matriz de informação de Fisher que pode ser expressa como o negativo do valor esperado da hessiana. Isto é, podemos encontrar a variância assintótica calculando o inverso da hessiana (como fizemos a minimização do negativo da função log-verossimilhança não precisamos calcular o negativo da hessiana).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">(ep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hess))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.0702709</code></pre>
</div>
</div>
<p>Com o erro-padrão podemos calcular intervalos de confiança e estatística t.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">(ic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>par <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ep, fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>par <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.96</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ep))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.800269 5.075731</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">(est_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>par <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> ep)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] -0.8823045</code></pre>
</div>
</div>
<section id="usando-o-pacote-optimx" class="level2">
<h2 class="anchored" data-anchor-id="usando-o-pacote-optimx">Usando o pacote <code>optimx</code></h2>
<p>A função <code>optim</code> já é bastante antiga e um novo pacote, chamado <code>optimx</code>, foi criado. A ideia do pacote é de agregar várias funções de otimização que estavam espalhadas em diversos pacotes diferentes. As principais funções do pacote são <code>optimx</code> e <code>optimr</code>. Mais informações sobre o pacote podem ser encontradas <a href="https://rdrr.io/cran/optimx/">aqui</a>.</p>
<p>A sintaxe das funções é muito similar à sintaxe original do <code>optim</code>. O código abaixo faz o mesmo procedimento de estimação que o acima. Por padrão a função executa dois otimizadores: o BFGS e Nelder-Mead</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optimx</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_pois, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> amostra))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                p1    value fevals gevals niter convcode kkt1 kkt2 xtime
Nelder-Mead 4.9375 2202.837     32     NA    NA        0   NA   NA 0.001
BFGS        4.9380 2202.837     34      9    NA        0   NA   NA 0.003</code></pre>
</div>
</div>
<p>Uma das principais vantagens do <code>optimx</code> é a possibilidade de usar vários métodos de otimização numérica numa mesma função.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optimx</span>(</span>
<span id="cb17-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb17-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_pois,</span>
<span id="cb17-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> amostra,</span>
<span id="cb17-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nlm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BFGS"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rcgmin"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nlminb"</span>)</span>
<span id="cb17-6">  )</span>
<span id="cb17-7"></span>
<span id="cb17-8">fit</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             p1    value fevals gevals niter convcode kkt1 kkt2 xtime
nlm    4.937998 2202.837     NA     NA     8        0   NA   NA 0.001
BFGS   4.938000 2202.837     34      9    NA        0   NA   NA 0.002
Rcgmin 4.938000 2202.837     15     10    NA        0   NA   NA 0.002
nlminb 4.938000 2202.837     10     12     9        0   NA   NA 0.002</code></pre>
</div>
</div>
<p>Como este exemplo é bastante simples os diferentes métodos parecem convergir para valores muito parecidos.</p>
</section>
<section id="usando-o-pacote-maxlik" class="level2">
<h2 class="anchored" data-anchor-id="usando-o-pacote-maxlik">Usando o pacote maxLik</h2>
<p>A função maxLik (do pacote homônimo) traz algumas comodidades: primeiro, ela maximiza as funções de log-verossimilhança, ou seja, <em>não é preciso montar a função com sinal de menos</em> como fizemos acima; segundo, ela já <em>calcula erros-padrão e estatísticas-t dos coeficientes estimados</em>. Além disso, ela também facilita a implementação de gradientes e hessianas analíticos e conta com métodos de otimização bastante populares como o BHHH. Mais detalhes sobre a função e o pacote podem ser encontradas <a href="https://www.researchgate.net/publication/227354660_MaxLik_A_package_for_maximum_likelihood_estimation_in_R">aqui</a>.</p>
<p>Para usar a função precisamos primeiro reescrever a função log-verossimilhança, pois agora não precisamos mais buscar o negativo da função. Como o R já vem com as funções de densidade de várias distribuições podemos tornar o código mais enxuto usando o <code>dpois</code> que implementa a função densidade da Poisson. O argumento <code>log = TRUE</code> retorna as probabilidades <img src="https://latex.codecogs.com/png.latex?p"> como <img src="https://latex.codecogs.com/png.latex?log(p)">.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">ll_pois <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, theta) {</span>
<span id="cb19-2">    ll <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dpois</span>(x, theta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb19-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(ll))</span>
<span id="cb19-4">}</span></code></pre></div>
</div>
<p>O comando abaixo executa a estimação. Note que a saída agora traz várias informações relevantes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">maxLik</span>(ll_pois, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> amostra))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
Maximum Likelihood estimation
Newton-Raphson maximisation, 8 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-Likelihood: -2202.837 
1  free parameters
Estimates:
     Estimate Std. error t value Pr(&gt; t)    
[1,]  4.93800    0.07617   64.83  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------</code></pre>
</div>
</div>
<p>Podemos implementar manualmente o gradiente e a hessiana da função. Neste caso, a estimativa do parâmetro continua a mesma mas o erro-padrão diminui um pouco. Note que também podemos fornecer estas informações para a função <code>optimx</code>. Derivando a função de log-verossimilhança:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%20%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D(%5Clambda%20;%20x)%7D%7B%5Cpartial%5Clambda%7D%20&amp;%20=%20%5Cfrac%7B1%7D%7B%5Clambda%7D%5Csum_%7Bk%20=%201%7D%5E%7Bn%7Dx_%7Bk%7D%20-%20n%20%5C%5C%0A%20%20%5Cfrac%7B%5Cpartial%5E2%20%5Cmathcal%7BL%7D(%5Clambda%20;%20x)%7D%7B%5Cpartial%5Clambda%5E2%7D%20&amp;%20=%20-%5Cfrac%7B1%7D%7B%5Clambda%5E2%7D%5Csum_%7Bk%20=%201%7D%5E%7Bn%7Dx_%7Bk%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>O código abaixo implementa o gradiente e a hessiana e faz a estimação. O valor estimado continua praticamente o mesmo, mas o erro-padrão fica menor.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">grad_pois <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, theta) {</span>
<span id="cb22-2">  (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)</span>
<span id="cb22-3">  }</span>
<span id="cb22-4"></span>
<span id="cb22-5">hess_pois <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, theta) {</span>
<span id="cb22-6">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> theta<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(x)</span>
<span id="cb22-7">}</span>
<span id="cb22-8"></span>
<span id="cb22-9">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">maxLik</span>(</span>
<span id="cb22-10">  ll_pois,</span>
<span id="cb22-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grad =</span> grad_pois,</span>
<span id="cb22-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hess =</span> hess_pois,</span>
<span id="cb22-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb22-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> amostra</span>
<span id="cb22-15">  )</span>
<span id="cb22-16"></span>
<span id="cb22-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
Maximum Likelihood estimation
Newton-Raphson maximisation, 7 iterations
Return code 1: gradient close to zero (gradtol)
Log-Likelihood: -2202.837 
1  free parameters
Estimates:
     Estimate Std. error t value Pr(&gt; t)    
[1,]  4.93800    0.07027   70.27  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="exemplo-com-a-distribuição-normal" class="level1">
<h1>Exemplo com a distribuição normal</h1>
<p>A distribuição normal tem dois parâmetros: <img src="https://latex.codecogs.com/png.latex?%5Cmu"> e <img src="https://latex.codecogs.com/png.latex?%5Csigma">. Lembrando que o primeiro indica a média e o segundo a desvio-padrão. A função de densidade de probabilidade é dada por:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20f(x,%20%5Ctheta)%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E%7B2%7D%7D%7D%5Ctext%7Bexp%7D%5Cleft(%5Cfrac%7B-(x%20-%20%5Cmu)%5E2%7D%7B2%5Csigma%5E%7B2%7D%7D%5Cright)%0A"></p>
<p>onde <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20=%20(%5Cmu,%20%5Csigma)">. O gráfico abaixo mostra como o formato da função varia conforme o valor destes parâmetros. Basicamente, quando a média aumenta, estamos “deslocando para a direita” e quando aumentamos o desvio-padrão estamos “achatando” a distribuição.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/emv-no-r/index_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Lembrando que a função de distribuição de probabilidade da normal para uma observação <img src="https://latex.codecogs.com/png.latex?i"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20f(x_%7Bi%7D,%20%5Ctheta)%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E%7B2%7D%7D%7De%5E%7B%5Cfrac%7B-(x_%7Bi%7D%20-%20%5Cmu)%5E2%7D%7B2%5Csigma%5E%7B2%7D%7D%7D%0A"></p>
<p>Fazendo o produtório da expressão acima para cada <img src="https://latex.codecogs.com/png.latex?i"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Cprod_%7Bi%20=%201%7D%5E%7BN%7Df(x_%7Bi%7D,%20%5Ctheta)%20=%20(2%5Cpi%5Csigma%5E%7B2%7D)%5E%7B-%5Cfrac%7BN%7D%7B2%7D%7D%5Ctext%7Bexp%7D%5Cleft(%20-%5Cfrac%7B1%7D%7B2%5Csigma%5E%7B2%7D%7D%5Cprod_%7Bi%20=%201%7D%5E%7BN%7D(x_%7Bi%7D%20-%20%5Cmu)%5E2%5Cright)%0A"></p>
<p>e agora passando log, temos:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20L(x_%7Bi%7D,%20%5Ctheta)%20=%20-%5Cfrac%7BN%7D%7B2%7D%5Ctext%7Bln%7D(2%5Cpi)%20-N%5Ctext%7Bln%7D(%5Csigma)%20-%5Cfrac%7B1%7D%7B2%5Csigma%5E%7B2%7D%7D%5Csum_%7Bi%20=%201%7D%5E%7BN%7D(x_%7Bi%7D%20-%20%5Cmu)%5E%7B2%7D%0A"></p>
<p>Montamos a função log-verossimilhança usando a função <code>dnorm</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">ll_norm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(theta) {</span>
<span id="cb24-2">    ll <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(x, theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb24-3">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(ll)</span>
<span id="cb24-4">}</span></code></pre></div>
</div>
<p>Vamos simular uma amostra aleatória <img src="https://latex.codecogs.com/png.latex?x_%7B1%7D,%20x_%7B2%7D,%20%5Cdots,%20x_%7B1000%7D"> onde cada <img src="https://latex.codecogs.com/png.latex?x_%7Bi%7D"> segue uma distribuição normal com média <img src="https://latex.codecogs.com/png.latex?2"> e desvio-padrão <img src="https://latex.codecogs.com/png.latex?3"> (i.e., variância <img src="https://latex.codecogs.com/png.latex?9">).</p>
<p>Primeiro vamos usar a função <code>optimx</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># warnings por causa dos valores negativos no log</span></span>
<span id="cb25-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb25-3">(fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optimx</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_norm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BFGS"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           p1       p2    value fevals gevals niter convcode kkt1 kkt2 xtime
BFGS 2.138082 3.058111 2536.736     47     20    NA        0 TRUE TRUE 0.003</code></pre>
</div>
</div>
<p>Note que a função retorna mensagens de erro indicando que a função retornou <em>NaNs</em>. Isto acontece porque o otimizador experimenta valores não-positivos para <img src="https://latex.codecogs.com/png.latex?%5Csigma"> e isto não é admissível pois <img src="https://latex.codecogs.com/png.latex?%5Ctext%7Bln%7D(%5Csigma)">, que aparece no segundo termo da equação acima, não é definido para <img src="https://latex.codecogs.com/png.latex?%5Csigma%20%3C%200">. Além disso, <img src="https://latex.codecogs.com/png.latex?%5Csigma"> não pode ser igual a zero pois ele aparece no denominador do último termo à direita da expressão da log-verossimilhança.</p>
<p>Intuitivamente isto é bastante óbvio: <img src="https://latex.codecogs.com/png.latex?%5Csigma"> representa o desvio-padrão da distribuição e <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E%7B2%7D"> a sua variância: não podemos ter valores negativos ou nulos para estas expressões.</p>
<p>Podemos restringir os valores dos parâmetros usando os argumentos <code>upper</code> e <code>lower</code> para evitar as mensagens de <code>warning</code>, mas, na prática, isto não costuma fazer diferença no resultado final da estimação. Note que podemos deixar a restrição livre usando <code>Inf</code> e <code>-Inf</code> que correspondem a <img src="https://latex.codecogs.com/png.latex?%5Cinfty"> e <img src="https://latex.codecogs.com/png.latex?-%5Cinfty">.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optimx</span>(</span>
<span id="cb27-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb27-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_norm,</span>
<span id="cb27-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L-BFGS-B"</span>,</span>
<span id="cb27-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">upper =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb27-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb27-7">  )</span>
<span id="cb27-8"></span>
<span id="cb27-9">fit</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               p1       p2    value fevals gevals niter convcode kkt1 kkt2
L-BFGS-B 2.138093 3.058112 2536.736     11     11    NA        0 TRUE TRUE
         xtime
L-BFGS-B 0.001</code></pre>
</div>
</div>
</section>
<section id="propriedades-dos-estimadores-de-mv" class="level1">
<h1>Propriedades dos estimadores de MV</h1>
<p>A teoria dos estimadores de máxima verossimilhança nos garante que eles são <em>consistentes</em> (i.e.&nbsp;que eles aproximam o valor verdadeiro dos parâmetros) e <em>normalmente assintóticos</em> (a distribuição assintótica segue uma distribuição normal) desde que algumas condições de regularidade sejam atentdidas.</p>
<p>Podemos demonstrar ambas as propriedades fazendo algumas simulações no <code>R</code>.</p>
<section id="consistência" class="level2">
<h2 class="anchored" data-anchor-id="consistência">Consistência</h2>
<p>Vamos montar um experimento simples: simulamos 5000 amostras aleatórias de tamanho 1000 seguindo uma distribuição <img src="https://latex.codecogs.com/png.latex?N(2,%203)">; computamos as estimativas para <img src="https://latex.codecogs.com/png.latex?%5Cmu"> e <img src="https://latex.codecogs.com/png.latex?%5Csigma"> e suas respectivas variâncias assintóticas e depois analisamos suas propriedades.</p>
<ol type="1">
<li>Simular uma amostra segundo uma distribuição.</li>
<li>Estimata os parâmetros da distribuição.</li>
<li>Calcula a variância assintótica dos estimadores.</li>
<li>Repete 5000 vezes os passos 1-3.</li>
</ol>
<p>O código abaixo implementa exatamente este experimento. Note que a matriz de informação de Fisher é aproximada pela hessiana.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span></span>
<span id="cb29-2">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb29-3"></span>
<span id="cb29-4">estimativas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> r)</span>
<span id="cb29-5"></span>
<span id="cb29-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>r) {</span>
<span id="cb29-7">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb29-8">    </span>
<span id="cb29-9">    fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optimr</span>(</span>
<span id="cb29-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb29-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_norm,</span>
<span id="cb29-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BFGS"</span>,</span>
<span id="cb29-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hessian =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb29-14">      )</span>
<span id="cb29-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Guarda o valor estimado do parâmetro</span></span>
<span id="cb29-16">    estimativas[i, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>par</span>
<span id="cb29-17">    estimativas[i, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">solve</span>(fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hess))</span>
<span id="cb29-18">}</span></code></pre></div>
</div>
<p>A <em>consistência</em> dos estimadores <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Ctheta%7D_%7BMV%7D"> significa que eles aproximam os valores verdadeiros do parâmetros <img src="https://latex.codecogs.com/png.latex?%5Ctheta_%7B0%7D"> à medida que aumenta o tamanho da amostra. Isto é, se tivermos uma amostra grande <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BN%7D%20%5Cto%20%5Cinfty"> então podemos ter confiança de que nossos estimadores estão muito próximos dos valores verdadeiros dos parâmetros <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Ctheta%7D_%7B%5Ctext%7BMV%7D%7D%20%5Cto%20%5Ctheta_%7B0%7D"></p>
<p>O código abaixo calcula a média das estimativas para cada parâmetro - lembrando que <img src="https://latex.codecogs.com/png.latex?%5Cmu_%7B0%7D%20=%202"> e que <img src="https://latex.codecogs.com/png.latex?%5Csigma_%7B0%7D%20=%203">. Além disso, o histograma das estimativas mostra como as estimativas concentram-se em torno do valor verdadeiro do parâmetro (indicado pela linha vertical).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># | fig-width: 10</span></span>
<span id="cb30-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb30-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Consistência dos estimadores de MV</span></span>
<span id="cb30-4">mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> estimativas[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]; sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> estimativas[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb30-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mu)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.000883</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(sigma)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.997335</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(mu, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimativas para "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">~</span>mu), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>))</span>
<span id="cb34-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"indianred"</span>)</span>
<span id="cb34-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(sigma, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimativas para "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">~</span>sigma), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>))</span>
<span id="cb34-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"indianred"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/emv-no-r/index_files/figure-html/unnamed-chunk-21-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="normalmente-assintótico" class="level2">
<h2 class="anchored" data-anchor-id="normalmente-assintótico">Normalmente assintótico</h2>
<p>Dizemos que os estimadores de máxima verossimilhança são normalmente assintóticos porque a sua distribuição assintótica segue uma normal padrão. Especificamente, temos que:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az_%7B%5Ctheta%7D%20=%20%5Csqrt%7BN%7D%5Cfrac%7B%5Chat%7B%5Ctheta%7D_%7BMV%7D%20-%20%5Ctheta%7D%7B%5Csqrt%7B%5Ctext%7BV%7D_%7Bast%7D%7D%7D%20%5Cto%20%5Cmathbb%7BN%7D(0,%201)%0A"></p>
<p>onde <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BV%7D_%7Bast%7D"> é a variância assintótica do estimador. O código abaixo calcula a expressão acima para os dois parâmetros e apresenta o histograma dos dados com uma normal padrão superimposta.</p>
<p>No loop acima usamos o fato que a matriz de informação de Fisher pode ser estimada pela hessiana. O código abaixo calcula a expressão acima para os dois parâmetros e apresenta o histograma dos dados com uma normal padrão superimposta.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Normalidade assintótica</span></span>
<span id="cb35-2"></span>
<span id="cb35-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define objetos para facilitar a compreensão</span></span>
<span id="cb35-4">mu_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> estimativas[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb35-5">sigma_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> estimativas[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb35-6">var_mu_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> estimativas[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb35-7">var_sg_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> estimativas[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb35-8"></span>
<span id="cb35-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Centra a estimativa</span></span>
<span id="cb35-10">mu_centrado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mu_hat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> </span>
<span id="cb35-11">sigma_centrado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sigma_hat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb35-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Computa z_mu z_sigma</span></span>
<span id="cb35-13">mu_normalizado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> mu_centrado <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(var_mu_hat)</span>
<span id="cb35-14">sigma_normalizado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_centrado <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(var_sg_hat)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monta o gráfico para mu</span></span>
<span id="cb36-2"></span>
<span id="cb36-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Eixo x</span></span>
<span id="cb36-4">grid_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb36-5"></span>
<span id="cb36-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(</span>
<span id="cb36-7">  mu_normalizado,</span>
<span id="cb36-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma de 5000 simulações para z"</span>[mu]),</span>
<span id="cb36-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb36-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb36-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fd"</span>,</span>
<span id="cb36-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"z"</span>[mu]),</span>
<span id="cb36-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Densidade"</span></span>
<span id="cb36-14">  )</span>
<span id="cb36-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(grid_x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(grid_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>)</span>
<span id="cb36-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Normal (0, 1)"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/emv-no-r/index_files/figure-html/unnamed-chunk-23-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monta o gráfico para sigma2</span></span>
<span id="cb37-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(</span>
<span id="cb37-3">  sigma_normalizado,</span>
<span id="cb37-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma de 5000 simulações para z"</span>[sigma]),</span>
<span id="cb37-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb37-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb37-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fd"</span>,</span>
<span id="cb37-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"z"</span>[sigma]),</span>
<span id="cb37-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Densidade"</span></span>
<span id="cb37-10">  )</span>
<span id="cb37-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(grid_x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(grid_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>)</span>
<span id="cb37-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Normal (0, 1)"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/emv-no-r/index_files/figure-html/unnamed-chunk-24-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="escolha-de-valores-inicias" class="level2">
<h2 class="anchored" data-anchor-id="escolha-de-valores-inicias">Escolha de valores inicias</h2>
<p>Como comentei acima, o método de estimação por MV exige que o usuário escolha valores iniciais (chutes) para os parâmetros que se quer estimar.</p>
<p>O exemplo abaixo mostra o caso em que a escolha de valores iniciais impróprios leva a estimativas muito ruins.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sensível a escolha de valores inicias</span></span>
<span id="cb38-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb38-3">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optim</span>(</span>
<span id="cb38-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb38-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_norm,</span>
<span id="cb38-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BFGS"</span>,</span>
<span id="cb38-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hessian =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb38-8">  )</span>
<span id="cb38-9"></span>
<span id="cb38-10">fit</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 618.6792 962.0739

$value
[1] 7984.993

$counts
function gradient 
     107      100 

$convergence
[1] 1

$message
NULL

$hessian
             [,1]          [,2]
[1,]  0.001070703 -0.0013531007
[2,] -0.001353101  0.0001884928</code></pre>
</div>
</div>
<p>Note que as estimativas estão muito distantes dos valores corretos <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%2015"> e <img src="https://latex.codecogs.com/png.latex?%5Csigma%20=%204">. Uma das soluções, já mencionada acima, é de usar os momentos da distribuição como valores iniciais.</p>
<p>O código abaixo usa os momentos empíricos como valores inicias para <img src="https://latex.codecogs.com/png.latex?%5Cmu"> e <img src="https://latex.codecogs.com/png.latex?%5Csigma">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%20%20%5Cmu_%7Binicial%7D%20&amp;%20=%20%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%20=%201%7D%5E%7Bn%7Dx_%7Bi%7D%20%5C%5C%0A%20%20%5Csigma_%7Binicial%7D%20&amp;%20=%20%5Csqrt%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum_%7Bi%20=%201%7D%5E%7Bn%7D%20(x_%7Bi%7D%20-%20%5Cmu_%7Binicial%7D)%5E2%7D%0A%5Cend%7Balign%7D%0A"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">(chute_inicial <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(x))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.859702  3.930849</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">(est <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optimx</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> chute_inicial, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_norm))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  p1       p2    value fevals gevals niter convcode kkt1 kkt2
Nelder-Mead 14.85997 3.929097 2787.294     47     NA    NA        0 TRUE TRUE
BFGS        14.85970 3.928884 2787.294     15      2    NA        0 TRUE TRUE
            xtime
Nelder-Mead 0.001
BFGS        0.001</code></pre>
</div>
</div>
<p>Agora as estimativas estão muito melhores. Outra opção é experimentar com otimizadores diferentes. Aqui a função <code>optimx</code> se prova bastante conveniente pois admite uma grande variedade de métodos de otimizãção.</p>
<p>Note como os métodos BFGS e CG retornam valores muito distantes dos verdadeiros. Já o método <code>bobyqa</code> retorna um valor corretor para o parâmetro da média, mas erra no parâmetro da variânica. Já os métodos <code>nlminb</code> e <code>Nelder-Mead</code> ambos retornam os valores corretos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Usando outros métodos numéricos</span></span>
<span id="cb44-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optimx</span>(</span>
<span id="cb44-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb44-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> ll_norm,</span>
<span id="cb44-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BFGS"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nelder-Mead"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CG"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nlminb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bobyqa"</span>)</span>
<span id="cb44-6">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   p1         p2    value fevals gevals niter convcode  kkt1
BFGS        618.67917 962.073907 7984.993    107    100    NA        1  TRUE
Nelder-Mead  14.85571   3.929621 2787.294     83     NA    NA        0  TRUE
CG           46.43586 628.570987 7358.601    204    101    NA        1  TRUE
nlminb       14.85970   3.928883 2787.294     23     47    19        0  TRUE
bobyqa       15.20011   8.993240 3211.556    109     NA    NA        0 FALSE
             kkt2 xtime
BFGS        FALSE 0.006
Nelder-Mead  TRUE 0.001
CG          FALSE 0.008
nlminb       TRUE 0.001
bobyqa      FALSE 0.036</code></pre>
</div>
</div>
<p>Vale notar também alguns detalhes técnicos da saída. Em particular, <code>convcode == 0</code> significa que o otimizador conseguiu convergir com sucesso, enquanto <code>convcode == 1</code> indica que o otimizador chegou no límite máximo de iterações sem convergir. Vemos que tanto o BFGS e o CG falharam em convergir e geraram os piores resultados.</p>
<p>Já o <code>kkt1</code> e <code>kkt2</code> verificam as condições de Karush-Kuhn-Tucker (às vezes apresentadas apenas como condições de Kuhn-Tucker). Resumidamente, a primeira condição verifica a parte <em>necessária</em> do teorema enquanto a segunda condição verifica a parte <em>suficiente</em>. Note que o <code>bobyqa</code> falha em ambas as condições (pois ele não é feito para este tipo de problema).</p>
<p>Os métodos que retornam os melhores valores, o <code>Nelder-Mead</code> e <code>nlminb</code> são os únicos que convergiram com sucesso e que atenderam a ambas as condições de KKT. Logo, quando for comparar os resltados de vários otimizadores distintos, vale estar atento a estes valores.</p>
<p>Mais detalhes sobre os métodos podem ser encontrados na página de ajuda da função <code>?optimx</code>.</p>


</section>
</section>

 ]]></description>
  <category>econometria</category>
  <category>tutorial-R</category>
  <category>repost</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/emv-no-r/index.html</guid>
  <pubDate>Sat, 01 Feb 2020 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/emv-r.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Aquecimento Global</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/aquecimento-global/index.html</link>
  <description><![CDATA[ 




<p>Uma recente edição da revista inglesa <a href="https://www.economist.com/">The Economist</a> exibe uma <a href="https://pbs.twimg.com/media/EE0hWYAXUAATHvv?format=jpg&amp;name=4096x4096">série de listras coloridas em sua capa</a>. Elas formam um degradê que vai de um azul escuro até um vermelho intenso. Cada listra representa a temperatura de um ano e a linha do tempo vai desde o 1850 até o presente. A mensagem é bastante clara: o planeta esta cada ano mais quente e é nos anos recentes que estão concentradas as maiores altas de temperatura. Esta imagem é creditada a <a href="http://www.met.reading.ac.uk/~ed/home/index.php">Ed Hawkings</a>, editor do <a href="https://www.climate-lab-book.ac.uk/2018/warming-stripes/">Climate Lab Book</a>.</p>
<p><img src="https:://www.restateinsight.com/posts/general-posts/aquecimento-global/https:/bpb-eu-w2.wpmucdn.com/blogs.reading.ac.uk/dist/3/187/files/2018/05/globalcore.png" class="center" width="640px" height="480px"></p>
<p>Para ser preciso, a imagem não plota a temperatura de cada ano, mas sim o quanto cada ano se desvia da temperatura média do período 1971-2000. Isto é, anos acima dessa média têm um valor positivo, valores abaixo dessa média, valores negativos. Esta é uma forma bastante comum de representar este tipo de dado climático. De imediato, quando vi a imagem me ocorreu que seria bastante simples reproduzir uma versão aproximada dela usando o R.</p>
<section id="o-código" class="level2">
<h2 class="anchored" data-anchor-id="o-código">O código</h2>
<p>O código necessário para gerar a imagem é bastante enxuto. Vou descrever em linhas gerais o que ele faz:</p>
<p>Primeiro carrego dois pacotes (linhas 1, 2), depois a série de temperatura (linha 3), faço algumas transformações nos dados (linhas 4, 5) e, por fim, ploto os dados (linhas 6, 7, 8). O resultado inicial já é bastante satisfatório e a partir destas poucas linhas de código pode-se chegar num resultado muito próximo ao da imagem original. Vale notar que a imagem fica um pouco diferente da original porque eu uso uma <a href="http://data.giss.nasa.gov/gistemp/graphs/">base de dados diferente</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Carrega pacotes</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(astsa)</span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Carrega a base de dados 'globtemp'</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"globtemp"</span>)</span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Converte o objeto para data.frame</span></span>
<span id="cb1-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ano =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">time</span>(globtemp)),</span>
<span id="cb1-8"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">temp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(globtemp))</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monta o gráfico</span></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ano, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-12"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-13"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradient2</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#104e8b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mid =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#b9d3ee"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ff0000"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/aquecimento-global/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="os-detalhes-do-código" class="level2">
<h2 class="anchored" data-anchor-id="os-detalhes-do-código">Os detalhes do código</h2>
<p>Vou explicar cada linha de código para ser didático. O R funciona, grosso modo, como um repositório de pacotes: cada pacote contem funções e, às vezes, bases de dados. O primeiro pacote que carrego é o <code>ggplot2</code>. Ele serve para fazer visualizações de dados. O pacote <code>astsa</code> traz várias funções para fazer análise de séries de tempo, mas eu carrego ele somente para usar a base de dados <code>globtemp</code>, que traz informação sobre a temperatura anual da terra coletada pela NASA.</p>
<p>O objeto <code>globtemp</code> é uma série de tempo (um objeto da classe <code>ts</code>), que tem alguns atributos especiais. Um deles pode ser acesado pela função <code>time</code> que extrai um vetor numérico com as datas desta série de tempo. No código abaixo mostro os primeiros dez valores do <code>time(globtemp)</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(globtemp)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ts"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">time</span>(globtemp)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1880 1881 1882 1883 1884 1885 1886 1887 1888 1889</code></pre>
</div>
</div>
<p>Para extrair somente os valores da série, uso a função <code>as.numeric</code>, que converte o vetor de <code>ts</code> para <code>numeric</code> (numérico). Este tipo de função é bastante comum já que frequentemente é preciso trocar a classe de um objeto. O objetivo destes primeiros passos é de inserir as informações do <code>globtemp</code> num <code>data.frame</code> em que a data aparece na primeira coluna e os valores da série são armazenados na segunda coluna. O procedimento pode parecer um tanto trabalhoso (e acho que é mesmo), mas é o jeito. Um <code>data.frame</code> é como uma tabela com dados. Este é um objeto bastante típico em análise de dados e é necessário para usar a função <code>ggplot</code> que vai fazer o gráfico. Abaixo pode-se ver as primeiras linhas desta tabela.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ano  temp
1 1880 -0.20
2 1881 -0.11
3 1882 -0.10
4 1883 -0.20
5 1884 -0.28
6 1885 -0.31</code></pre>
</div>
</div>
<p>Agora que tenho os dados no formato apropriado posso usar o <code>ggplot</code>. O argumento que pode ser um pouco confuso é o <code>aes</code>. Nele especifica-se quais dados serão mapeados no gráfico. Depois disso adicionamos um <code>geom</code>. Há vários tipos de geom (<code>geom_line</code>, <code>geom_bar</code>, <code>geom_histogram</code>, etc.) e cada um deles produz uma imagem diferente. O <code>geom_tile</code> faz um pequeno quadrado. Para que a função consiga desenhar o quadrado é preciso informar uma variável <code>x</code> e uma variável <code>y</code>. Além disso, também especifico <code>fill = temp</code>. O <code>fill</code> se refere à cor que vai preencher (<em>fill</em>) o quadrado. Como especifico <code>fill = temp</code> a cor do quadrado vai representar a variável <code>temp</code> (temperatura).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ano, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-2"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/aquecimento-global/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O resultado é exatamente como o esperado, mas ainda é preciso mudar a escala de cores. Faço isto com o <code>scale_fill_gradient2</code>. Aqui cada termo tem um signficado: <code>scale_fill</code> pois estamos mudando a escala do <code>fill</code> (outra opção seria <code>scale_color</code> que muda a escala do <code>color</code>). <code>scale_fill_gradient</code> pois queremos um gradiente (degradê) de cores. Por fim, o <code>2</code> é adicionado no final pois queremos um escala que diferencie <em>dois</em> grupos distintos: temperaturas acima da média em vermelho, temperaturas abaixo da média em azul. A escala de cores é determinada pelos argumentos <code>low</code>, <code>mid</code> e <code>high</code>.</p>
<p>Os valores negativos serão coloridos pelo <code>low</code>, os próximos de zero pelo <code>mid</code> e os valores grandes pelo <code>high</code>. Abaixo escrevo as cores em hexa-decimal, mas elas podem ser lidas, essencialmente, como: azul-escuro, cinza-azulado-claro e vermelho-escuro.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ano, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-2"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-3"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradient2</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#104e8b"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mid =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#b9d3ee"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ff0000"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/aquecimento-global/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como comentei acima, pode-se melhorar o gráfico acima adicionando outros elementos e detalhes. A versão final que fiz do gráfico fica no código abaixo.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pacote para carregar fontes externas no R</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Necessário para utilizar 'Georgia' no gráfico</span></span>
<span id="cb10-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(extrafont)</span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data.frames auxiliares para plotar as anotações de texto</span></span>
<span id="cb10-5">df_aux_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1930</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The Climate Issue"</span>)</span>
<span id="cb10-6">df_aux_anos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb10-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1880</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1920</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>),</span>
<span id="cb10-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1890</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1925</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1995</span>)</span>
<span id="cb10-9">  )</span>
<span id="cb10-10"></span>
<span id="cb10-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ano, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb10-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux_anos,</span>
<span id="cb10-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb10-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb10-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb10-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb10-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Georgia"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb10-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_aux_title,</span>
<span id="cb10-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1950</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb10-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Georgia"</span>,</span>
<span id="cb10-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,</span>
<span id="cb10-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradientn</span>(</span>
<span id="cb10-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#213A82"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#3B60CE"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#8DA2E2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#DE2E02"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#9d0208"</span>)</span>
<span id="cb10-29">   ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb10-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb10-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb10-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb10-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb10-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb10-38">    )</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/aquecimento-global/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>data-visualization</category>
  <category>tutorial-R</category>
  <category>repost</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/aquecimento-global/index.html</guid>
  <pubDate>Fri, 10 Jan 2020 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/climate_issue.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>OLS com matrizes</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/ols-com-matrizes/index.html</link>
  <description><![CDATA[ 




<p>Uma forma instrutiva de entender o modelo de regressão linear é expressando ele em forma matricial. Os cursos introdutórios de econometria costumam omitir esta abordagem e expressam todas as derivações usando somatórios, deixando a abordagem matricial para cursos mais avançados. É bastante simples computar uma regressão usando apenas matrizes no R.</p>
<p>De fato, um dos objetos fundamentais do R é a e muitas das operações matriciais (decomposições, inversa, transposta, etc.) já estão implementadas em funções base. Uma var <img src="https://latex.codecogs.com/png.latex?k"> .</p>
<p>Neste post vou mostrar como fazer uma regressão linear usando somente matrizes no R. Além disso, vou computar algumas estatísticas típicas (t, F)</p>
<p>O modelo linear é da forma</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ay_%7Bt%7D%20=%20x%5E%5Cintercal_%7Bt%7D%20%5Cbeta%20+%20e_%7Bt%7D%0A"></p>
<p>onde <img src="https://latex.codecogs.com/png.latex?x%5E%5Cintercal"> é o vetor transposto de <img src="https://latex.codecogs.com/png.latex?x"> . É importante sempre ter em mente a dimensão destes vetores. O vetor <img src="https://latex.codecogs.com/png.latex?y_%7Bt%7D"> é <img src="https://latex.codecogs.com/png.latex?n%5Ctimes1"> onde <img src="https://latex.codecogs.com/png.latex?n"> representa o número de observações na amostra. O vetor <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> é <img src="https://latex.codecogs.com/png.latex?k%5Ctimes1"> onde <img src="https://latex.codecogs.com/png.latex?k"> é o número de regressores (ou variáveis explicativas). Como há <img src="https://latex.codecogs.com/png.latex?n"> observações para cada uma dos <img src="https://latex.codecogs.com/png.latex?k"> regressores, <img src="https://latex.codecogs.com/png.latex?x"> é <img src="https://latex.codecogs.com/png.latex?k%5Ctimes1"> ; o detalhe é que <img src="https://latex.codecogs.com/png.latex?x%20=%20(1%20%5C,%20%5C,x_%7B1%7D%20%5C,%20%5Cdots%20%5C,x_%7Bk-1%7D)"> , onde cada <img src="https://latex.codecogs.com/png.latex?x_%7Bi%7D"> é <img src="https://latex.codecogs.com/png.latex?n%5Ctimes%201"> e <img src="https://latex.codecogs.com/png.latex?1"> é um vetor de uns <img src="https://latex.codecogs.com/png.latex?n%5Ctimes1"> . Finalmente, <img src="https://latex.codecogs.com/png.latex?e_%7Bt%7D"> é <img src="https://latex.codecogs.com/png.latex?n%5Ctimes1"> . Temos então que:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bpmatrix%7D%0Ay_%7B1%7D%20%5C%5C%0Ay_%7B2%7D%5C%5C%0A%5Cvdots%5C%5C%0Ay_%7Bn%7D%0A%5Cend%7Bpmatrix%7D=%0A%5Cbegin%7Bpmatrix%7D%0A1%5C%5C%0Ax_%7B1%7D%5C%5C%0A%5Cvdots%5C%5C%0Ax_%7Bk-1%7D%0A%5Cend%7Bpmatrix%7D%5E%5Cintercal%0A%5Cbegin%7Bpmatrix%7D%0A%5Cbeta_%7B0%7D%5C%5C%0A%5Cbeta_%7B1%7D%5C%5C%0A%5Cvdots%5C%5C%0A%5Cbeta_%7Bk-1%7D%0A%5Cend%7Bpmatrix%7D+%0A%5Cbegin%7Bpmatrix%7D%0Ae_%7B1%7D%5C%5C%0Ae_%7B2%7D%5C%5C%0A%5Cvdots%5C%5C%0Ae_%7Bn%7D%0A%5Cend%7Bpmatrix%7D%0A"></p>
<p>onde:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0Ax_%7B1%7D%20&amp;%20=%20(x_%7B11%7D%20&amp;%20x_%7B12%7D%20&amp;%20x_%7B13%7D%20&amp;%20%5Cdots%20&amp;%20x_%7B1n%7D)%5C%5C%0Ax_%7B2%7D%20&amp;%20=%20(x_%7B21%7D%20&amp;%20x_%7B22%7D%20&amp;%20x_%7B23%7D%20&amp;%20%5Cdots%20&amp;%20x_%7B2n%7D)%5C%5C%0Ax_%7B3%7D%20&amp;%20=%20(x_%7B31%7D%20&amp;%20x_%7B32%7D%20&amp;%20x_%7B33%7D%20&amp;%20%5Cdots%20&amp;%20x_%7B3n%7D)%5C%5C%0A%5Cvdots%5C%5C%0Ax_%7Bk-1%7D%20&amp;%20=%20(x_%7B(k-1)1%7D%20&amp;%20x_%7B(k-1)2%7D%20&amp;%20x_%7B(k-1)3%7D%20&amp;%20%5Cdots%20&amp;%20x_%7B(k-1)n%7D)%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>Queremos encontrar o vetor <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cbeta%7D"> que minimiza o a soma do quadrado dos erros, isto é, que minimiza</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS(%5Cbeta)%20=%20%5Csum_%7Bt%20=%201%7D%5E%7BT%7D(y_%7Bt%7D%20-%20x%5E%5Cintercal_%7Bt%7D%5Cbeta)%5E%7B2%7D%0A"></p>
<p>Encontramos o ponto crítico derivando a expressão acima e igualando-a a zero. O resultado é o conhecido estimador de mínimos quadrados:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7B%5Cbeta%7D%20=%20%5Cleft%20(%20%5Csum_%7Bt%20=%201%7D%5E%7BT%7Dx_%7Bt%7Dx_%7Bt%7D%5E%7B%5E%5Cintercal%7D%20%5Cright%20)%5E%7B-1%7D%20%5Csum_%7Bt%20=%201%7D%5E%7BT%7Dx_%7Bt%7Dy_%7Bt%7D%0A"></p>
<p>Para reescrever as equações acima usando matrizes usamos os seguintes fatos:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bt%20=%201%7D%5E%7BT%7Dx_%7Bt%7Dx_%7Bt%7D%5E%7B%5E%5Cintercal%7D%20=%20X%5E%5Cintercal%20X%0A"></p>
<p>onde <img src="https://latex.codecogs.com/png.latex?X"> é uma matriz <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20k"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bt%20=%201%7D%5E%7BT%7Dx_%7Bt%7Dy_%7Bt%7D%20=%20X%5E%5Cintercal%20y%0A"></p>
<p>onde <img src="https://latex.codecogs.com/png.latex?X%5E%5Cintercal%20y"> é <img src="https://latex.codecogs.com/png.latex?k%20%5Ctimes%201"> . Lembre-se que uma hipótese do modelo linear é de que <img src="https://latex.codecogs.com/png.latex?X"> é uma matriz de posto completo, logo <img src="https://latex.codecogs.com/png.latex?X%5E%5Cintercal%20X"> possui inversa e podemos escrever:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7B%5Cbeta%7D%20=%20(X%5E%5Cintercal%20X)%5E%7B-1%7DX%5E%5Cintercal%20y%0A"></p>
<section id="exemplo-salário-wooldridge" class="level2">
<h2 class="anchored" data-anchor-id="exemplo-salário-wooldridge">Exemplo: salário (Wooldridge)</h2>
<p>Como exemplo vou usar um exemplo clássico de livro texto de econometria: uma regressão de salário (rendimento) contra algumas variáveis explicativas convencionais: anos de educação, sexo, anos de experiência, etc. As bases de dados do livro <a href="https://www.cengagebrain.com.mx/shop/isbn/9781337558860">Introductory Econometrics</a> estão disponíveis no pacote <code>wooldridge</code>. O código abaixo carrega a base de dados .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(wooldridge)</span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Carrega a base</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(wage2)</span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove os valores ausentes (NAs)</span></span>
<span id="cb1-5">sal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(wage2)</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:80%; ">
<table class="table table-hover table-bordered table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">wage</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">hours</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">IQ</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">KWW</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">educ</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">exper</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">tenure</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">married</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">black</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">south</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">urban</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sibs</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">brthord</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">meduc</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">feduc</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">lwage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: center;">769</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">93</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">6.645091</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: center;">825</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">108</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">33</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">6.715383</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: center;">650</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">6.476973</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: center;">562</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">74</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">6.331502</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: center;">600</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">6.396930</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: center;">1154</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">111</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">7.050990</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">6.907755</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: center;">930</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">132</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">6.835185</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: center;">1318</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">119</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">7.183871</td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: center;">1792</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">118</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">7.491087</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>A base traz 663 observações de 17 variáveis. A função <code>str</code> é útil para entender a estrutura dos dados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dimensão da base (# linhas  # colunas)</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(sal)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 663  17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Descrição da base</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(sal)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   663 obs. of  17 variables:
 $ wage   : int  769 825 650 562 600 1154 1000 930 1318 1792 ...
 $ hours  : int  40 40 40 40 40 45 40 43 38 40 ...
 $ IQ     : int  93 108 96 74 91 111 95 132 119 118 ...
 $ KWW    : int  35 46 32 27 24 37 44 44 24 47 ...
 $ educ   : int  12 14 12 11 10 15 12 18 16 16 ...
 $ exper  : int  11 11 13 14 13 13 16 8 7 9 ...
 $ tenure : int  2 9 7 5 0 1 16 13 2 9 ...
 $ age    : int  31 33 32 34 30 36 36 38 28 34 ...
 $ married: int  1 1 1 1 0 1 1 1 1 1 ...
 $ black  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ south  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ urban  : int  1 1 1 1 1 0 1 0 1 1 ...
 $ sibs   : int  1 1 4 10 1 2 1 1 3 1 ...
 $ brthord: int  2 2 3 6 2 3 1 1 1 1 ...
 $ meduc  : int  8 14 12 6 8 14 12 13 10 12 ...
 $ feduc  : int  8 14 12 11 8 5 11 14 10 12 ...
 $ lwage  : num  6.65 6.72 6.48 6.33 6.4 ...
 - attr(*, "time.stamp")= chr "25 Jun 2011 23:03"
 - attr(*, "na.action")= 'omit' Named int [1:272] 2 6 8 12 13 19 20 21 31 36 ...
  ..- attr(*, "names")= chr [1:272] "2" "6" "8" "12" ...</code></pre>
</div>
</div>
<p>O modelo proposto é o abaixo:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7Blwage%7D_%7Bt%7D%20=%20%5Cbeta_%7B0%7D%20+%20%5Cbeta_%7B1%7D%5Ctext%7Beduc%7D_%7Bt%7D%20+%20%5Cbeta_%7B2%7D%5Ctext%7Bexper%7D_%7Bt%7D%20+%20%5Cbeta_%7B3%7D%5Ctext%7Bexper%7D%5E%7B2%7D_%7Bt%7D%20+%20%5Cbeta_%7B4%7D%5Ctext%7Btenure%7D_%7Bt%7D%20+%20%5Cbeta%7B5%7D%5Ctext%7Bmarried%7D_%7Bt%7D%20+%20u_%7Bt%7D%0A"></p>
<p>onde:</p>
<ul>
<li><p>lwage = logaritmo natural do salário</p></li>
<li><p>educ = anos de educação</p></li>
<li><p>exper = anos de experiência (trabalhando)</p></li>
<li><p>tenure = anos trabalhando com o empregador atual</p></li>
<li><p>married = dummy (1 = casado, 0 = não-casado)</p></li>
</ul>
<p>Há 6 coeficientes para estimar logo <img src="https://latex.codecogs.com/png.latex?k%20=%206"> . Além disso, como há <img src="https://latex.codecogs.com/png.latex?663"> observações temos que <img src="https://latex.codecogs.com/png.latex?n%20=%20663"> . A matriz de “dados” é da forma:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AX%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%2012%20&amp;%2011%20&amp;%20121%20&amp;%202%20&amp;%201%5C%5C%5C%5C%0A1%20&amp;%2014%20&amp;%2011%20&amp;%20121%20&amp;%209%20&amp;%201%5C%5C%5C%5C%0A1%20&amp;%2012%20&amp;%2013%20&amp;%20169%20&amp;%207%20&amp;%201%5C%5C%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cvdots%20%5C%5C%5C%5C%0A1%20&amp;%2013%20&amp;%2010%20&amp;%20100%20&amp;%203%20&amp;%201%0A%5Cend%7Bbmatrix%7D_%7B663%5Ctimes%206%7D%0A"></p>
<p>O código abaixo monta a matriz <img src="https://latex.codecogs.com/png.latex?X"> acima. As funções <code>head</code> e <code>tail</code> podem ser usadas para verificar as primeiras e últimas linhas da matriz. Vale esclarecer dois pontos sobre o código a ser usado neste post. Primeiro, quando se cria um objeto usando o operador <code>&lt;-</code> pode-se forçar o R a imprimir o seu valor colocando a expressão entre parêntesis. Por exemplo, teste <code>(x &lt;- 3)</code>. O segundo ponto é que o operador de multiplicação matricial é <code>%*%</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define alguns valores úteis: </span></span>
<span id="cb6-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## N = número de observações</span></span>
<span id="cb6-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## k = número de regressores</span></span>
<span id="cb6-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## const = vetor com 1^\intercals (uns)</span></span>
<span id="cb6-5">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">663</span>; k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>; const <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">663</span>)</span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monta a matriz de observações da regressão</span></span>
<span id="cb6-7">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(const, sal<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>educ, sal<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>exper, sal<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>exper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, sal<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>tenure, sal<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>married)</span>
<span id="cb6-8">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(X)</span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define o nome das colunas da matriz de observações</span></span>
<span id="cb6-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(X) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"const"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"educ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exper"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exper2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tenure"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"married"</span>)</span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Função para verificar as primeiras linhas da matriz X</span></span>
<span id="cb6-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(X)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     const educ exper exper2 tenure married
[1,]     1   12    11    121      2       1
[2,]     1   14    11    121      9       1
[3,]     1   12    13    169      7       1
[4,]     1   11    14    196      5       1
[5,]     1   10    13    169      0       0
[6,]     1   15    13    169      1       1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Função para verificar as últimas linhas da matriz X</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span>(X)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       const educ exper exper2 tenure married
[658,]     1   12     9     81      2       1
[659,]     1   16     8     64     10       1
[660,]     1   12    11    121      3       1
[661,]     1   12     9     81      3       1
[662,]     1   16    10    100      9       1
[663,]     1   13    10    100      3       1</code></pre>
</div>
</div>
<p>Lembrando que o problema de mínimos quadrados é de encontrar os valores de <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> que minimizam a soma dos erros ao quadrado.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cunderset%7B%5Cbeta%7D%7B%5Ctext%7BMin%20%7D%7D%20e%5E%5Cintercal%20e%0A"></p>
<p>Abrindo mais a expressão acima:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%20%20e%5E%5Cintercal%20e%20&amp;%20=%20(y%20-%20X%5Cbeta%20)%5E%5Cintercal(y%20-%20X%5Cbeta%20)%20%5C%5C%5C%5C%0A%20%20%20%20%20%20&amp;%20=%20y%5E%5Cintercal%20y%20-%20y%5E%5Cintercal%20X%5Cbeta%20-%20%5Cbeta%20%5E%5Cintercal%20X%5E%5Cintercal%20y%20+%20%5Cbeta%20%5E%5Cintercal%20X%5E%5Cintercal%20X%20%5Cbeta%20%5C%5C%5C%5C%0A%20%20%20%20%20%20&amp;%20=%20y%5E%5Cintercal%20y%20-%202%20y%5E%5Cintercal%20X%20%5Cbeta%20+%20%5Cbeta%5E%5Cintercal%20X%5E%5Cintercal%20X%20%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
<p>Derivando em relação a <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> e igualando a zero chega-se no estimador de MQO</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbeta_%7B%5Ctext%7BMQO%7D%7D%20=%20(X%5E%5Cintercal%20X)%5E%7B-1%7DX%5E%5Cintercal%20y%0A"></p>
<p>O código abaixo computa <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B%5Ctext%7BMQO%7D%7D"> . Note que os parêntesis por fora da expressão forçam o R a imprimir o valor do objeto. Além disso, como estamos multiplicando matrizes/vetores usamos <code>%*%</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define o vetor y (log do salário)</span></span>
<span id="cb10-2">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sal<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lwage</span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Computa a estimativa para os betas</span></span>
<span id="cb10-4">(beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">solve</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(X) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> X) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(X) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                [,1]
const   5.3563606713
educ    0.0767258959
exper   0.0104985672
exper2  0.0002881339
tenure  0.0091039254
married 0.2002468574</code></pre>
</div>
</div>
<p>Os valores estimados dos betas são reportados na tabela abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">tabela <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(beta, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(tabela) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coeficiente estimado"</span>)</span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(beta, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_styling</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: center;">5.3564</td>
</tr>
<tr class="even">
<td style="text-align: left;">educ</td>
<td style="text-align: center;">0.0767</td>
</tr>
<tr class="odd">
<td style="text-align: left;">exper</td>
<td style="text-align: center;">0.0105</td>
</tr>
<tr class="even">
<td style="text-align: left;">exper2</td>
<td style="text-align: center;">0.0003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenure</td>
<td style="text-align: center;">0.0091</td>
</tr>
<tr class="even">
<td style="text-align: left;">married</td>
<td style="text-align: center;">0.2002</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="resíduo-e-variância" class="level2">
<h2 class="anchored" data-anchor-id="resíduo-e-variância">Resíduo e variância</h2>
<p>O resíduo do modelo é simplesmente a diferença entre o observado <img src="https://latex.codecogs.com/png.latex?y_%7Bt%7D"> e o estimado <img src="https://latex.codecogs.com/png.latex?%5Chat%7By_%7Bt%7D%7D"> . Isto é,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7Be%7D_%7Bt%7D%20=%20y_%7Bt%7D%20-%20%5Chat%7By%7D_%7Bt%7D%20=%20y_%7Bt%7D%20-%20x_%7Bt%7D%5E%5Cintercal%5Chat%7B%5Cbeta%7D%0A"></p>
<p>ou, de forma equivalente,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7Be%7D%20=%20y%20-%20X%5Chat%7B%5Cbeta%7D%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Computa o resíduo da regressão</span></span>
<span id="cb13-2">u_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> beta</span></code></pre></div>
</div>
<p>Usando o histograma pode-se visualizar a distribuição dos resíduos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(u_hat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma dos resíduos"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/ols-com-matrizes/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>O estimador da variância é dado por:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7B%5Csigma%7D%5E%7B2%7D%20=%20%5Cfrac%7B1%7D%7BN-k%7D%5Csum_%7Bt%20=%201%7D%5E%7BN%7D%5Chat%7Be%7D_%7Bt%7D%5E%7B2%7D%0A"></p>
<p>Substituindo os valores calculados acima chegamos em:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7B%5Csigma%7D%5E%7B2%7D%20=%20%5Cfrac%7B%5Chat%7Be%7D%5E%5Cintercal%5Chat%7Be%7D%7D%7BN-k%7D%20=%200.1403927%0A"></p>


</section>

 ]]></description>
  <category>econometria</category>
  <category>repost</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/ols-com-matrizes/index.html</guid>
  <pubDate>Wed, 01 Jan 2020 03:00:00 GMT</pubDate>
</item>
<item>
  <title>Repost: Otimização numérica - métodos de Newton</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index.html</link>
  <description><![CDATA[ 




<section id="o-método-de-newton" class="level1">
<h1>O método de Newton</h1>
<p>Métodos de otimização numérica são frequentemente necessários para estimar modelos econométricos e resolver problemas de máximo/mínimo em geral. Em particular, para encontrar estimadores de extremo — como estimadores do método generalizado de momentos (GMM) ou estimadores de máxima verossimilhança (MLE) — é necessário resolver um problema de otimização. Na maior parte dos casos, estes métodos rodam no background de funções prontas, mas não custa entender um pouco mais sobre como eles funcionam, até porque um dos métodos mais populares, o método de Newton (e suas variantes) é bastante simples e intuitivo.</p>
<section id="exemplo-simples" class="level2">
<h2 class="anchored" data-anchor-id="exemplo-simples">Exemplo simples</h2>
<p>Como primeiro exemplo do método de Newton vou tomar emprestada uma sugestão deste <a href="https://twitter.com/fermatslibrary/status/1177196132663009280">tweet</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/static/images/Screenshot 2023-08-06 at 17.06.57.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>O algoritmo descrito no tweet para encontrar <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7By%7D"> é basicamente o seguinte:</p>
<ol type="1">
<li>Encontre um número <img src="https://latex.codecogs.com/png.latex?x"> tal que <img src="https://latex.codecogs.com/png.latex?x%5E2%20%5Capprox%20y"> (ex: <img src="https://latex.codecogs.com/png.latex?y%20=%2017">, <img src="https://latex.codecogs.com/png.latex?4%5E2%20=%2016">);</li>
<li>Compute a diferença <img src="https://latex.codecogs.com/png.latex?d%20=%20y%20-%20x%5E2"> (<img src="https://latex.codecogs.com/png.latex?d%20=%2017%20-%2016%20=%201">);</li>
<li>Atualize <img src="https://latex.codecogs.com/png.latex?x"> pela diferença <img src="https://latex.codecogs.com/png.latex?d/2x"> (<img src="https://latex.codecogs.com/png.latex?x%20=%204%20+%201/8%20=%204.125">)</li>
<li>Repita 2 e 3, com o novo valor de x.</li>
</ol>
<p>O código abaixo implementa os passos acima. Começo escolhendo um inteiro aleatório <img src="https://latex.codecogs.com/png.latex?y"> entre <img src="https://latex.codecogs.com/png.latex?0"> e <img src="https://latex.codecogs.com/png.latex?10%5E7">. O desafio será encontrar <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7By%7D">. Usando o comando <code>set.seed(1984)</code> você poderá replicar os resultados abaixo. O número sorteado foi <img src="https://latex.codecogs.com/png.latex?6588047"> e <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7B6588047%7D%20=%202566.719">.</p>
<p>Para demonstrar a poder do simples método acima vou começar com um <em>chute inicial</em> bem ruim, isto é, vou escolher um <img src="https://latex.codecogs.com/png.latex?x"> inicial igual a <img src="https://latex.codecogs.com/png.latex?1">. Como quero mostrar os passos intermediários do algoritmo vou criar um vetor numérico que salva todos os valores de x a cada iteração. Há diversas maneiras de escrever o loop abaixo e ao longo do post vou mostrar três tipos de loop (<em>for-loop</em>, <em>repeat</em> e <em>while</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Para replicar os resultados</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1984</span>)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sorteia um número inteiro</span></span>
<span id="cb1-4">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cria um vetor x de comprimento 15</span></span>
<span id="cb1-6">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Primeiro valor de x = 1</span></span>
<span id="cb1-8">x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop</span></span>
<span id="cb1-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>) {</span>
<span id="cb1-11">  x_chute <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x[i]</span>
<span id="cb1-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Computa a distância</span></span>
<span id="cb1-13">  dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_chute<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Atualiza o valor de x</span></span>
<span id="cb1-15">  x_chute_novo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_chute <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dist <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_chute)</span>
<span id="cb1-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grava o valor de x para vermos a convergência</span></span>
<span id="cb1-17">  x[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_chute_novo</span>
<span id="cb1-18">}</span></code></pre></div>
</div>
<p>Podemos ver graficamente como o algortimo se aproxima do valor verdadeiro de <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7By%7D"> rapidamente, mesmo partindo de um ponto inicial distante. Em vermelho, está o valor correto de <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7By%7D">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iteração"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(y), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Como os primeiros valores do gráfico acima são muito altos, faço um segundo gráfico usando somente os últimos valores que foram computados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iteração"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(y), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note que depois de 16 repetições, a diferença entre <img src="https://latex.codecogs.com/png.latex?x"> e <img src="https://latex.codecogs.com/png.latex?y"> é tão próxima de zero que o R arredonda ela para 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -2.565719e+03  3.291457e+06  1.644446e+06  8.209418e+05  4.091915e+05
 [6]  2.033204e+05  1.003928e+05  4.894506e+04  2.325311e+04  1.047078e+04
[11]  4.204686e+03  1.305444e+03  2.200559e+02  8.688284e+00  1.465521e-02
[16]  4.183812e-08  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</code></pre>
</div>
</div>
<p>Mas como funciona este algoritmo? Basicamente, estamos procurando a raiz de um polinômio. No caso, estamos buscando resolver <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20x%5E2%20-%20y%20=%200"> (em que <img src="https://latex.codecogs.com/png.latex?y"> é dado). A solução proposta pelo método acima é de aproximar este polinômio linearmente (usando a primeira derivada) e então encontrar a raiz desta aproximação. Para facilitar o exemplo vamos tomar <img src="https://latex.codecogs.com/png.latex?y%20=%202">. Então temos o problema de encontrar a raiz do seguinte polinômio:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP(x)%20=%20x%5E2%20-%202%0A"></p>
<p>Vamos tomar o valor <img src="https://latex.codecogs.com/png.latex?x_%7B0%7D%20=%205"> como chute inicial. A aproximação linear de <img src="https://latex.codecogs.com/png.latex?P(x)"> é a derivada com respeito a <img src="https://latex.codecogs.com/png.latex?x">, isto é, <img src="https://latex.codecogs.com/png.latex?2x">. Avaliada no ponto <img src="https://latex.codecogs.com/png.latex?x_%7B0%7D">, temos <img src="https://latex.codecogs.com/png.latex?P'(5)%20=%2010">. Assim, temos uma reta de inclinação <img src="https://latex.codecogs.com/png.latex?10"> que passa no ponto <img src="https://latex.codecogs.com/png.latex?(5,%2023)">. Com isso podemos traçar a reta vermelha no gráfico abaixo e calcular o ponto em que esta reta corta o eixo-x. A equação da reta pode ser escrita como:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7By_%7B2%7D%20-%20y_%7B1%7D%7D%7Bx_%7B2%7D%20-%20x_%7B1%7D%7D%20=%20f'(x_%7B1%7D)%0A"></p>
<p>Como queremos encontrar o ponto em que a curva corta o eixo-x estamos, na verdade, buscando o ponto <img src="https://latex.codecogs.com/png.latex?(x_%7B2%7D,%200)">. Logo, podemos substituir <img src="https://latex.codecogs.com/png.latex?y_%7B2%7D%20=%200"> na expressão acima e resolver para <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_%7B2%7D%20=%20x_%7B1%7D%20-%20%5Cfrac%7By_%7B1%7D%7D%7Bf'(x_%7B1%7D)%7D%20=%20x_%7B1%7D%20-%20%5Cfrac%7Bf(x_%7B1%7D)%7D%7Bf'(x_%7B1%7D)%7D%0A"></p>
<p>A expressão acima é essência do método de Newton. Substituindo nossos valores temos que:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B23%7D%7B5%20-%20x%7D%20=%2010%20%5Clongrightarrow%20x%20=%202.7%0A"></p>
<p>No gráfico abaixo podemos ver como funciona este processo. Parte-se de um ponto inicial <img src="https://latex.codecogs.com/png.latex?x%20=%205">. Encontra-se a reta tangente neste ponto (linha em vermelho) e computa-se o valor de <img src="https://latex.codecogs.com/png.latex?x"> em que esta reta cruza o eixo-x (ponto vermelho). O processo repete-se agora tomando o ponto em vermelho como ponto de partida. De maneira geral, o processo de atualização segue a regra abaixo:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20x_%7Bn%20+%201%7D%20=%20x_%7Bn%7D%20-%20%5Cfrac%7Bf(x_%7Bn%7D)%7D%7Bf'(x_%7Bn%7D)%7D%0A"></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb6-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Primeiro valor de x = 1</span></span>
<span id="cb6-4">x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop</span></span>
<span id="cb6-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) {</span>
<span id="cb6-7">  x_chute <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x[i]</span>
<span id="cb6-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Computa a distância</span></span>
<span id="cb6-9">  dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_chute<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb6-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Atualiza o valor de x</span></span>
<span id="cb6-11">  x_chute_novo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_chute <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dist <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_chute)</span>
<span id="cb6-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grava o valor de x para vermos a convergência</span></span>
<span id="cb6-13">  x[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_chute_novo</span>
<span id="cb6-14">}</span></code></pre></div>
</div>
<p>O gráfico abaixo mostra os próximos passos do algoritmo. Após poucas repetições já estamos muito próximos da resposta correta. Note que isto acontece porque estamos trabalhando com uma função bastante simples.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pode-se generalizar o problema acima facilmente para encontrar a n-ésima raiz de qualquer valor. No código abaixo isto pode ser feito variando o valor de <code>n</code>. O código abaixo também é uma variação em relação aos anteiores. Ele é um <em>repeat-break</em>, ao invés do <em>for-loop</em> que estávamos usando acima. Isto é, ele repete uma operação enquanto alguma condição for válida. Assim, podemos exigir que o algoritmo pare quando algum critério de convergência for atingido. No caso abaixo, especifico que o loop pare quando a distância entre os valores sucessivos de <img src="https://latex.codecogs.com/png.latex?x"> for muito pequena (menor que <img src="https://latex.codecogs.com/png.latex?10%5E%7B-8%7D">) ou quando o número de iterações chegar a 100 repetições.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dá pra melhorar um pouco o loop (usando repeat) e agora generalizar para n</span></span>
<span id="cb7-2">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb7-3">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb7-4">x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-5">i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-6">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb7-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">repeat</span> {</span>
<span id="cb7-8">  x_chute <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_chute_novo</span>
<span id="cb7-9">  dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_chute<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>n</span>
<span id="cb7-10">  x_chute_novo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_chute <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dist <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_chute<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb7-11">  x[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_chute_novo</span>
<span id="cb7-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(paste("iteration =", i))</span></span>
<span id="cb7-13">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(x_chute_novo <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x[i]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">99</span>) {</span>
<span id="cb7-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span></span>
<span id="cb7-15">  }</span>
<span id="cb7-16">  i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-17">}</span>
<span id="cb7-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distância entre valor computado e valor verdadeiro"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Contagem da iteração"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distância"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="minimizando-funções" class="level1">
<h1>Minimizando funções</h1>
<p>O método de Newton, descrito acima, pode ser aplicado para encontrar o mínimo de funções. Há vários problemas de otimização que podem ser resolvidos igualando a primeira derivada a zero. Nestes casos, podemos usar o método de Newton para encontrar o valor de <img src="https://latex.codecogs.com/png.latex?x"> que faz com que função derivada <img src="https://latex.codecogs.com/png.latex?f'(x)"> seja igual a zero. Substituindo <img src="https://latex.codecogs.com/png.latex?f'(x)"> na expressão encontrada anteiormente:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20x_%7Bn%20+%201%7D%20=%20x_%7Bn%7D%20-%20%5Cfrac%7Bf'(x)%7D%7Bf''(x)%7D%0A"></p>
<p>Obviamente, é necessário que tanto <img src="https://latex.codecogs.com/png.latex?f'(x)"> como <img src="https://latex.codecogs.com/png.latex?f''(x)"> estejam bem definidas para que o método funcione. Na verdade, é preciso mais do que isto, mas vamos discutir estes problemas mais à frente. Vamos começar com o problema simples de encontrar o mínimo da função:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20-2x%5E2%20+%20(1/3)x%5E3%0A"></p>
<p>Derivando e igualando a zero encontra-se os valores críticos <img src="https://latex.codecogs.com/png.latex?0"> e <img src="https://latex.codecogs.com/png.latex?4">. Usando a segunda derivada verifica-se que <img src="https://latex.codecogs.com/png.latex?4"> é mínimo local. O gráfico abaixo mostra este ponto na função.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>O código abaixo resolve este problema usando o método de Newton. Desta vez, uso o <code>while</code> apenas para exemplificar ainda mais uma forma de implementar este tipo de algoritmo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Objetos inicias</span></span>
<span id="cb8-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb8-3">error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb8-4">theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb8-5">delta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb8-6">i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Função objetivo</span></span>
<span id="cb8-8">f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb8-9">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb8-10">}</span>
<span id="cb8-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop</span></span>
<span id="cb8-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> (error <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> delta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {</span>
<span id="cb8-13">  i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb8-14">  theta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta</span>
<span id="cb8-15">  G <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> theta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theta<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-16">  H <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> theta</span>
<span id="cb8-17">  theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> G <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> H</span>
<span id="cb8-18">  x[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta</span>
<span id="cb8-19">  error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>((theta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> theta_0) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> theta_0)</span>
<span id="cb8-20">}</span></code></pre></div>
</div>
<p>Novamente, pode-se visualizar o funcionamento do otimizador visualmente num gráfico. Após poucos passos, o algoritmo converigiu para um valor muito próximo do correto.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="na-prática-a-teoria-é-outra" class="level2">
<h2 class="anchored" data-anchor-id="na-prática-a-teoria-é-outra">Na prática, a teoria é outra</h2>
<p>Há vários casos em que o otimizador de Newton falha em encontrar o valor desejado. Isto pode acontecer tanto porque a função viola alguma das hipóteses do método como também porque a função é complicada. A função abaixo, por exemplo, falha em convergir pois a sua derivada é descontínua no zero (há uma “quina” no zero). O resultado é que o método diverge para <img src="https://latex.codecogs.com/png.latex?%5Cinfty">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20%7Cx%7C%5E%7B1/3%7D%0A"></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A tabela abaixo mostra os valores computados para as primeiras 10 iterações.</p>
<div class="cell-output-display">
<table class="table table-hover table-condensed" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Iteração</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">x</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">f(x)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1.709976</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">-10</td>
<td style="text-align: center;">2.154435</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">-40</td>
<td style="text-align: center;">3.419952</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">-160</td>
<td style="text-align: center;">5.428835</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">-640</td>
<td style="text-align: center;">8.617739</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">-2560</td>
<td style="text-align: center;">13.679808</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">-10240</td>
<td style="text-align: center;">21.715341</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">-40960</td>
<td style="text-align: center;">34.470955</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">-163840</td>
<td style="text-align: center;">54.719230</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">-655360</td>
<td style="text-align: center;">86.861364</td>
</tr>
</tbody>
</table>


</div>
<p>Outro exemplo curioso em que o algoritmo falha em convergir é quando temos:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%0A0%20&amp;%20%5Ctext%7Bse%20%7D%20x%20=0%5C%5C%0Ax%20+%20x%5E2%20sin(%5Cfrac%7B2%7D%7Bx%7D))%20&amp;%20%5Ctext%7Bse%20%7D%20x%20%5Cneq%200%0A%5Cend%7Bmatrix%7D%5Cright.%0A"></p>
<p>Ainda que a função seja contínua, temos uma descontinuidade na sua derivada e, como resultado, o otmizador fica osciliando entre valores sem nunca convergir para o zero.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A tabela abaixo mostra os primeiros dez resultados:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-hover table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Iteração</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">x</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">f(x)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">5.0000000</td>
<td style="text-align: center;">14.7354586</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.1719653</td>
<td style="text-align: center;">0.1481520</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.4920907</td>
<td style="text-align: center;">0.2990380</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.2819031</td>
<td style="text-align: center;">0.3395412</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">-10.3200755</td>
<td style="text-align: center;">-30.8312710</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">-0.0854544</td>
<td style="text-align: center;">-0.0782425</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">-0.0171313</td>
<td style="text-align: center;">-0.0169891</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">-0.0109142</td>
<td style="text-align: center;">-0.0110166</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">-3.4206997</td>
<td style="text-align: center;">-9.8789235</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">-0.2423414</td>
<td style="text-align: center;">-0.2964612</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Pode-se visualizar o comportamento do otimizador na animação abaixo. Mostro os primeiros 50 resultados. Note como o algoritmo fica pulando para todos os lados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb9-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f</span>(x),</span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)</span>
<span id="cb9-5">)</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> .x))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tbl, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tbl, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transition_states</span>(label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-17-1.gif" class="img-fluid"></p>
</div>
</div>
<p>Em geral, o método de Newton sofre problemas com:</p>
<ol type="1">
<li><em>Pontos inciais ruins</em>. Às vezes uma escolha de ponto inicial ruim pode levar o otimizador a convergir para pontos diferentes. Em alguns casos, um ponto inicial ruim pode também levar o otimizador a ficar preso num ciclo.</li>
</ol>
<p>exemplo: <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20x%5E3%20-%202x%20+%202"> com <img src="https://latex.codecogs.com/png.latex?x_%7B0%7D%20=%200">. O otimizador fica preso entre <img src="https://latex.codecogs.com/png.latex?0"> e <img src="https://latex.codecogs.com/png.latex?1">.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Iteração</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">x</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">f(x)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<ol start="2" type="1">
<li><em>Descontinuidades</em>. Descontinuidades tanto na raiz da função, como em outras partes da função (como também na sua derivada) podem levar a problemas sérios de convergência.</li>
</ol>
<p>exemplo: <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20%7Cx%7C%5E%7B1/3%7D"> como apresentado acima.</p>
<ol start="3" type="1">
<li><em>Funções difíceis</em>. Algumas funções são simplesmente muito complicadas para o método de Newton. Em alguns casos, a convergência pode ser muito lenta e em outros o otimizador pode falhar completamente.</li>
</ol>
<p>exemplo: <img src="https://latex.codecogs.com/png.latex?f(x)%20=%207x%20-%20%5Ctext%7Bln%7D(x)">. A função tem mínimo global em <img src="https://latex.codecogs.com/png.latex?x%20=%201/7">. Ainda assim, o método de Newton tem dificuldade em encontrar este valor (a não ser que o valor incial escolhido esteja muito próximo de <img src="https://latex.codecogs.com/png.latex?1/7">).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb10-2">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(x)</span>
<span id="cb10-3">}</span>
<span id="cb10-4">grad_f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb10-5">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> x</span>
<span id="cb10-6">}</span>
<span id="cb10-7">hess_f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb10-8">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb10-9">}</span>
<span id="cb10-10">theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb10-11">error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb10-12">i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb10-13">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb10-14">x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta</span>
<span id="cb10-15">error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb10-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> (error <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>) {</span>
<span id="cb10-17">  theta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta</span>
<span id="cb10-18">  G <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grad_f</span>(theta)</span>
<span id="cb10-19">  theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grad_f</span>(theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hess_f</span>(theta)</span>
<span id="cb10-20">  x[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta</span>
<span id="cb10-21">  error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>((theta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> theta_0) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> theta_0)</span>
<span id="cb10-22">  i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb10-23">}</span></code></pre></div>
</div>
</section>
</section>
<section id="usando-funções-de-otimização" class="level1">
<h1>Usando funções de otimização</h1>
<p>Na prática, métodos de otimização comuns como os de Newton já estão implementados de maneira eficiente no R. A principal função que se para otimização é a <code>optim</code> que já está instalada no pacote base do R. Atualmente, contudo, ela já está um pouco defasada e novos pacotes foram criados para suplementá-la. Discuto um pouco mais sobre alternativas ao <code>optim</code> no meu post sobre <a href="../../../estimacao-por-maxima-verossimilhanca-no-r">estimação por máxima verossimilhança</a>.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x,y)%20=%20(1-x)%5E2%20+%20100(y%20-%20x%5E2)%5E2%0A"></p>
<p>A imagem abaixo usa o pacote <code>rgl</code> para mostrar a função em três dimensões.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">fn_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, y) {</span>
<span id="cb11-2">  (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb11-3">}</span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gráfico 3D</span></span>
<span id="cb11-5">grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb11-6">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grid</span>
<span id="cb11-7">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grid</span>
<span id="cb11-8">z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">outer</span>(x, y, fn_2)</span>
<span id="cb11-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">persp3d</span>(x, y, z, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>)</span></code></pre></div>
</div>
<p>O código abaixo é, essencialmente, igual aos que foram apresentados acima. A diferença é que agora o gradiente tem que ser montado como um vetor e a hessiana tem que ser implementada como uma matriz. Além disso, há um pequeno detalhe técnico na hora de montar a função <code>fn</code>. Como há dois parâmetros, talvez a maneira mais natural de escrever isto seria:</p>
<p><code>fn2 = function (x, y) { ... }</code></p>
<p>Mas isto não funciona bem com a função <code>optim</code>. O correto é montar uma função multivariada usando apenas um vetor numérico. Note que no código abaixo eu faço <code>fn2</code> em função de <code>theta</code> e escrevo <code>theta[1]</code> no lugar de <img src="https://latex.codecogs.com/png.latex?x"> e <code>theta[2]</code> no lugar de <img src="https://latex.codecogs.com/png.latex?y">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># parâmetros iniciais</span></span>
<span id="cb12-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb12-3">error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb12-4">theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb12-5">delta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb12-6">i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a função</span></span>
<span id="cb12-8">fn2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(theta) {</span>
<span id="cb12-9">  (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb12-10">}</span>
<span id="cb12-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gradiente</span></span>
<span id="cb12-12">grad_fn2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(theta) {</span>
<span id="cb12-13">  x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb12-14">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb12-15">  gx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-16">  gy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gx, gy)</span>
<span id="cb12-18">}</span>
<span id="cb12-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hessiana</span></span>
<span id="cb12-20">hess_fn2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(theta) {</span>
<span id="cb12-21">  x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb12-22">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb12-23">  hxx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb12-24">  hyy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span></span>
<span id="cb12-25">  hxy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hyx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x</span>
<span id="cb12-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(hxx, hxy, hyx, hyy), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-27">}</span>
<span id="cb12-28"></span>
<span id="cb12-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Otimização usando loop e NR</span></span>
<span id="cb12-30">theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb12-31">hist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb12-32">hist[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta</span>
<span id="cb12-33">i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb12-34">error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb12-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> (i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> error[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> error[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)) {</span>
<span id="cb12-36">  theta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta</span>
<span id="cb12-37">  G <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grad_fn2</span>(theta)</span>
<span id="cb12-38">  H <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hess_fn2</span>(theta)</span>
<span id="cb12-39">  theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> theta_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">solve</span>(H) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> G</span>
<span id="cb12-40">  hist[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(theta)</span>
<span id="cb12-41">  error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>((theta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> theta_0) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> theta_0))</span>
<span id="cb12-42">  i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-43">}</span>
<span id="cb12-44"></span>
<span id="cb12-45">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(hist)</span></code></pre></div>
</div>
<p>O gráfico abaixo mostra a convergência do algoritmo. Note que o valor correto de ambos os parâmetros é <img src="https://latex.codecogs.com/png.latex?1">.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Por fim, uso a função <code>optim</code> para resolver o problema acima; o método <code>BFGS</code> é uma variante do método de Newton.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optim usando BFGS</span></span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> fn2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BFGS"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trace =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>initial  value 24.200000 
iter  10 value 1.370040
iter  20 value 0.132618
iter  30 value 0.001800
final  value 0.000000 
converged</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 0.9998044 0.9996084

$value
[1] 3.827383e-08

$counts
function gradient 
     118       38 

$convergence
[1] 0

$message
NULL</code></pre>
</div>
</div>
</section>
<section id="posts-relacionados" class="level1">
<h1>Posts relacionados</h1>
<ul>
<li><a href="https://restateinsight.com/posts/general-posts/emv-no-r/">Estimação por máxima verossimilhança no R</a></li>
</ul>


</section>

 ]]></description>
  <category>econometria</category>
  <category>tutorial-R</category>
  <category>repost</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/repost-otimizacao-newton/index.html</guid>
  <pubDate>Sat, 28 Sep 2019 03:00:00 GMT</pubDate>
</item>
<item>
  <title>Crescimento do PIB per capita no mundo</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index.html</link>
  <description><![CDATA[ 




<section id="introdução" class="level1">
<h1>Introdução</h1>
<p>Como desafio pessoal às vezes tento replicar gráficos que acho interessante. O portal Nexo, em particular, costuma ter lindas visualizações de dados. Vou tentar replicar os <a href="https://www.nexojornal.com.br/grafico/2018/07/30/O-crescimento-e-a-queda-do-PIB-dos-pa%C3%ADses-ao-longo-do-tempo">gráficos desta publicação</a>. Como o foco desta postagem está na visualização e em mostrar exemplos de aplicações do <code>ggplot2</code> vou omitir as (longas) manipulações de dados, deixando indicadas as fontes (com links) que usei. Numa postagem futura pretendo fazer um tutorial mais detalhado de como reproduzir estes gráficos.</p>
<section id="pacotes" class="level2">
<h2 class="anchored" data-anchor-id="pacotes">Pacotes</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"readxl"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"here"</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel"</span>)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dplyr"</span>)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reshape2"</span>)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kableExtra"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="dados" class="level2">
<h2 class="anchored" data-anchor-id="dados">Dados</h2>
<p>Dados são do Maddison Project Database, <a href="https://www.rug.nl/ggdc/historicaldevelopment/maddison/releases/maddison-project-database-2018">disponíveis aqui</a></p>
<div class="cell-output-display">
<table class="table table-bordered table-hover table-striped" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">País</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Ano</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Região</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">PIB</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Crescimento</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Angola</td>
<td style="text-align: center;">2005</td>
<td style="text-align: center;">Africa</td>
<td style="text-align: center;">66351984</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Angola</td>
<td style="text-align: center;">2011</td>
<td style="text-align: center;">Africa</td>
<td style="text-align: center;">123013536</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Albania</td>
<td style="text-align: center;">2005</td>
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">21452400</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Albania</td>
<td style="text-align: center;">2006</td>
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">22717995</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Albania</td>
<td style="text-align: center;">2007</td>
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">24080895</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Albania</td>
<td style="text-align: center;">2008</td>
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">25890410</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Albania</td>
<td style="text-align: center;">2009</td>
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">26754552</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Albania</td>
<td style="text-align: center;">2010</td>
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">27741824</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Albania</td>
<td style="text-align: center;">2011</td>
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">28452000</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Albania</td>
<td style="text-align: center;">2012</td>
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">28852736</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>


</div>
</section>
</section>
<section id="europa" class="level1">
<h1>Europa</h1>
<p>Neste primeiro gráfico cada quadradinho representa uma variável binária que indica se o país estava em expansão ou recessão. Mapeio esta variável usando o <code>geom_tile</code> e depois ajusto o tamanho dos quadradinhos. Para dar um pouco da intuição do processo vale começar com uma versão simplificada do problema.</p>
<p>Queremos mapear a cada ano se um país está ou não em recessão. A tabela abaixo reúne esta informação para seis países (Alemanha, Bélgica, França, Itália, Polônia e Reino Unido) desde 1980. É um pequeno recorte da nossa base original.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:80%; ">
<table class="table table-hover table-condensed table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">year</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">country</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">var_pib</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1981</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1981</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1981</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1981</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1981</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1981</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1982</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1982</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1982</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1982</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1982</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1982</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1983</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1983</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1983</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1983</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1983</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1983</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1985</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1985</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1985</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1985</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1985</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1985</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1986</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1986</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1986</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1986</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1986</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1986</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1987</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1987</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1987</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1987</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1987</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1987</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1989</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1989</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1991</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1991</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1991</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1991</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1991</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1991</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1993</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1993</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1993</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1993</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1993</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1993</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1995</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1995</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1995</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1995</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1995</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1995</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1997</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1997</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1997</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1997</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1997</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1997</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1999</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1999</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1999</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1999</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1999</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1999</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2001</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2001</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2001</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2001</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2001</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2001</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2002</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2002</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2002</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2002</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2002</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2002</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2003</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2003</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2003</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2003</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2003</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2003</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2006</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2006</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2006</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2007</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2007</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2007</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2007</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2007</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2007</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2009</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2009</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2009</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2009</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2009</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2009</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">Belgium</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">France</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>A função <code>geom_tile()</code> mapeia cada observação num quadrado. A cor de cada quadrado depende da variável binária <code>var_pib</code>. O código abaixo mostra como montar este gráfico bastante simples.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(sub, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> country)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> var_pib), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>O resto do trabalho é simplesmente ajustar os eixos, os nomes das legendas, etc. No código fonte da página do Nexo encontrei as fontes usadas nos gráficos: Gotham Rounded Bold e Gotham Rounded Light. O pacote <code>showtext</code> me permite carregar estas fontes no R.</p>
<p>O gráfico abaixo mostra o resultado final considerando todos os países da Europa.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">d_europa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filtra por região (Europa)</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(region <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Restringe a amostra às observações a partir de 1900</span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7">plot_europa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d_europa, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, country))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mapeia cada variável como um 'tile' (quadradinho)</span></span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> var_pib), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Superimpõe linhas verticais tracejadas</span></span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(</span>
<span id="cb3-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># valores de corte das linhas</span></span>
<span id="cb3-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1925</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1950</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1975</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>),      </span>
<span id="cb3-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tipo da linha (2 = tracejado)</span></span>
<span id="cb3-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,                                           </span>
<span id="cb3-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cor da linha</span></span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray65"</span></span>
<span id="cb3-18">    )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                      </span>
<span id="cb3-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica o eixo-x</span></span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb3-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1925</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1950</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1975</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>),</span>
<span id="cb3-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove a área entre o gráfico e o eixo</span></span>
<span id="cb3-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb3-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># duplica o eixo (para aparecer em cima e em baixo)</span></span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sec.axis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dup_axis</span>()</span>
<span id="cb3-26">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                         </span>
<span id="cb3-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica a legenda e as cores </span></span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_discrete</span>(</span>
<span id="cb3-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb3-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># título da legenda</span></span>
<span id="cb3-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"VARIAÇÃO DO PIB NO MUNDO</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Por ano"</span>,</span>
<span id="cb3-32">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># texto da legenda</span></span>
<span id="cb3-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB EM QUEDA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB EM CRESCIMENTO"</span>), </span>
<span id="cb3-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray90"</span></span>
<span id="cb3-35">    )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define o título do gráfico e o título dos eixos</span></span>
<span id="cb3-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europa"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-38">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modifica características estéticas do gráfico</span></span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb3-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fundo do gráfico</span></span>
<span id="cb3-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb3-42">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define as margens do gráfico</span></span>
<span id="cb3-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>),</span>
<span id="cb3-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Eixos</span></span>
<span id="cb3-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb3-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb3-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family  =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Light"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>),</span>
<span id="cb3-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Legenda</span></span>
<span id="cb3-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb3-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb3-52">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray20"</span>,</span>
<span id="cb3-53">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span></span>
<span id="cb3-54">      ),</span>
<span id="cb3-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,</span>
<span id="cb3-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray20"</span>,</span>
<span id="cb3-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span></span>
<span id="cb3-59">      ),</span>
<span id="cb3-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Título</span></span>
<span id="cb3-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Crimson Text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>)</span>
<span id="cb3-62">    )</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index_files/figure-html/unnamed-chunk-9-1.png" style="width:100.0%;height:100.0%"></p>
</div>
</div>
</section>
<section id="américa-do-sul" class="level1">
<h1>América do Sul</h1>
<p>Para fazer o mesmo gráfico para os países da América do Sul e da Ásia basta filtrar por estas regiões. Esta é uma das grandes vantagens do R: para fazer os dois gráficos abaixo só precisei mudar uma linha de código. Na verdade, como é uma mudança muito simples podemos montar o processo acima numa função que cria exatamente o mapa acima para cada região.</p>
<p>O código abaixo mostra um exemplo de como estruturar isto.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Função para reproduzir o gráfico acima</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Guarda as informações do tema</span></span>
<span id="cb4-4">theme_vini <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  </span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fundo do gráfico</span></span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define as margens do gráfico</span></span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>),</span>
<span id="cb4-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Eixos</span></span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family  =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Light"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>),</span>
<span id="cb4-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Legenda</span></span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb4-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray20"</span>,</span>
<span id="cb4-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span></span>
<span id="cb4-20">      ),</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,</span>
<span id="cb4-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray20"</span>,</span>
<span id="cb4-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span></span>
<span id="cb4-25">      ),</span>
<span id="cb4-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Título</span></span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Crimson Text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>)</span>
<span id="cb4-28">    )</span>
<span id="cb4-29"></span>
<span id="cb4-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Função simples para traduzir os títulos</span></span>
<span id="cb4-31">translate_region <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(string) {</span>
<span id="cb4-32">  </span>
<span id="cb4-33">  vl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb4-34">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South America"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"América do Sul"</span>,</span>
<span id="cb4-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Asia"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ásia"</span>,</span>
<span id="cb4-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Africa"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"África"</span>,</span>
<span id="cb4-37">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oceania"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oceania"</span>,</span>
<span id="cb4-38">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"North America"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"América do Norte"</span>,</span>
<span id="cb4-39">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latin America And The Caribbean"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"América Latina"</span>,</span>
<span id="cb4-40">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europa"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europa"</span></span>
<span id="cb4-41">    )</span>
<span id="cb4-42">  </span>
<span id="cb4-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unname</span>(vl[string]))</span>
<span id="cb4-44">  </span>
<span id="cb4-45">}</span>
<span id="cb4-46"></span>
<span id="cb4-47">plot_regiao <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(name_region) {</span>
<span id="cb4-48">  </span>
<span id="cb4-49">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filtra por região e restringe a amostra às observações a partir de 1900</span></span>
<span id="cb4-50">  </span>
<span id="cb4-51">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (name_region <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South America"</span>) {</span>
<span id="cb4-52">    </span>
<span id="cb4-53">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(d, subregion <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> name_region, year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>)</span>
<span id="cb4-54">    </span>
<span id="cb4-55">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb4-56">    </span>
<span id="cb4-57">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(d, region <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> name_region, year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>)</span>
<span id="cb4-58">  }</span>
<span id="cb4-59">  </span>
<span id="cb4-60">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb4-61">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, country)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-62">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> var_pib), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-63">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(</span>
<span id="cb4-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1925</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1950</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1975</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>),      </span>
<span id="cb4-65">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,                                           </span>
<span id="cb4-66">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray65"</span></span>
<span id="cb4-67">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                                      </span>
<span id="cb4-68">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1925</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1950</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1975</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>),</span>
<span id="cb4-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sec.axis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dup_axis</span>()</span>
<span id="cb4-72">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>                         </span>
<span id="cb4-73">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_discrete</span>(</span>
<span id="cb4-74">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-75">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"VARIAÇÃO DO PIB NO MUNDO</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Por ano"</span>,</span>
<span id="cb4-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB EM QUEDA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB EM CRESCIMENTO"</span>), </span>
<span id="cb4-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray90"</span></span>
<span id="cb4-78">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-79">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">translate_region</span>(name_region), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-80">    theme_vini</span>
<span id="cb4-81">  </span>
<span id="cb4-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(p)</span>
<span id="cb4-83"> </span>
<span id="cb4-84">}</span>
<span id="cb4-85"></span>
<span id="cb4-86"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_regiao</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South America"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ásia" class="level1">
<h1>Ásia</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_regiao</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Asia"</span>)  </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index_files/figure-html/unnamed-chunk-11-1.png" style="width:100.0%;height:100.0%"></p>
</div>
</div>
</section>
<section id="américa-latina" class="level1">
<h1>América Latina</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_regiao</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latin America And The Caribbean"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="número-de-países-com-queda-no-pib" class="level1">
<h1>Número de países com queda no PIB</h1>
<section id="gráfico-2" class="level2">
<h2 class="anchored" data-anchor-id="gráfico-2">Gráfico 2</h2>
<p>Este gráfico conta o número absoluto de países que estava em recessão durante um determinado ano. Como o número de países dentro da amostra também cresce com o tempo, uma linha cinza foi adicionada para representar isto. Resolvi suprimir as flechas que aparecem na postagem original, pois a implementação disto no <code>ggplot</code> é muito trabalhosa e o resultado final não é tão bonito.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Primeiro: conta o número de países pela variável var_pib</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (1 = expansão, 0 = recessão)</span></span>
<span id="cb7-3">recession_countries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Seleciona as observações a partir de 1900</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Agrupa os dados por ano e var_pib</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, var_pib) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Soma os valores que não são NA por tipo (1 = expansão, 0 = recessão)</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tipo =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(var_pib)))</span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Segundo: conta o número de países incluídos na amostra</span></span>
<span id="cb7-12">recession_countries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> recession_countries <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">amostra =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(tipo)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb7-16"></span>
<span id="cb7-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Terceiro: remove as contagens de anos de expansão e converte os dados para longitudinal (melhor para plotar)</span></span>
<span id="cb7-18">recession_countries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> recession_countries <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove os valores que são referentes a anos de expansão</span></span>
<span id="cb7-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(var_pib <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tranforma os dados em longitudinais por ano e 'var_pib'</span></span>
<span id="cb7-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (tipo = recessão, amostra = observações válidas)</span></span>
<span id="cb7-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id.vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"var_pib"</span>))</span>
<span id="cb7-24"></span>
<span id="cb7-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base de dados para os textos no gráfico</span></span>
<span id="cb7-26">highlight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb7-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">evento =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb7-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1ª GUERRA</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">MUNDIAL"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRISE</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">DE 1929"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2ª GUERRA</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">MUNDIAL"</span>,</span>
<span id="cb7-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRISE DO</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PETRÓLEO"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRANSIÇÃO CAPITALISTA</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">DO LESTE EUROPEU"</span>,</span>
<span id="cb7-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRISE DE 2008"</span>),</span>
<span id="cb7-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1918</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1929</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1945</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1971</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1988</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2008</span>),</span>
<span id="cb7-32">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">52</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">62</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb7-33">)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obs: como plotamos dados de duas bases diferentes a sintaxe é diferente</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb8-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> recession_countries, </span>
<span id="cb8-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> variable, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> variable),</span>
<span id="cb8-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Espessura da linha</span></span>
<span id="cb8-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span></span>
<span id="cb8-9">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Destaques de texto</span></span>
<span id="cb8-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb8-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> highlight,</span>
<span id="cb8-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> evento), </span>
<span id="cb8-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb8-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Light"</span>,</span>
<span id="cb8-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>,</span>
<span id="cb8-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Troca as cores das linhas e altera a legenda</span></span>
<span id="cb8-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb8-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"amostra"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tipo"</span>),</span>
<span id="cb8-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tomato"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>),</span>
<span id="cb8-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"países incluídos na amostra"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"países com queda no PIB"</span>)</span>
<span id="cb8-24">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb8-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1925</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1950</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1975</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>),</span>
<span id="cb8-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>)</span>
<span id="cb8-28">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define o título e subtítulo do gráfico e o título dos eixos</span></span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"número</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">de países"</span>,</span>
<span id="cb8-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NÚMERO DE PAÍSES COM QUEDA NO PIB NO ANO"</span>,</span>
<span id="cb8-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Em valores absolutos"</span></span>
<span id="cb8-35">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Título e subtítulo</span></span>
<span id="cb8-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span>),</span>
<span id="cb8-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Light"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb8-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Eixos</span></span>
<span id="cb8-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb8-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Light"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb8-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey70"</span>),</span>
<span id="cb8-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>),</span>
<span id="cb8-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Legenda</span></span>
<span id="cb8-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span>,</span>
<span id="cb8-49">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,</span>
<span id="cb8-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb8-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb8-52">      ),</span>
<span id="cb8-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb8-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb8-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.17</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>),</span>
<span id="cb8-56">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fundo do gráfico  </span></span>
<span id="cb8-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb8-58">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linhas de grade</span></span>
<span id="cb8-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey70"</span>)</span>
<span id="cb8-61">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="gráfico-3" class="level2">
<h2 class="anchored" data-anchor-id="gráfico-3">Gráfico 3</h2>
<p>Este último gráfico mostra o número relativo de países em recessão.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcula o share de países em recessão na amostra a cada ano</span></span>
<span id="cb9-2">share_recession <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Agrupa os dados por ano e var_pib (indicadora)</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, var_pib) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove as observações ausentes </span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(var_pib)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Conta o número de casos</span></span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">count =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcula a proporção dos casos acima (em porcentagem)</span></span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(count) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb9-13"></span>
<span id="cb9-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tabela auxiliar para guardar os valores que vão ser plotados como</span></span>
<span id="cb9-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># texto no gráfico</span></span>
<span id="cb9-16">highlight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb9-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">evento =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb9-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1ª GUERRA</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">MUNDIAL"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRISE</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">DE 1929"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2ª GUERRA</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">MUNDIAL"</span>,</span>
<span id="cb9-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRISE DO</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PETRÓLEO"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRANSIÇÃO</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">CAPITALISTA</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">DO LESTE</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">EUROPEU"</span>,</span>
<span id="cb9-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRISE DE 2008"</span>),</span>
<span id="cb9-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1916</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1929</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1942</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1971</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1988</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2006</span>),</span>
<span id="cb9-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">77</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">81</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)</span>
<span id="cb9-23">)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> share_recession, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, freq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> var_pib)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Superimpõe linhas horizontais no gráfico</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(</span>
<span id="cb10-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb10-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>,</span>
<span id="cb10-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb10-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb10-9">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mapeia o texto no gráfico (geom_label permite escolher fill = "salmon")</span></span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(</span>
<span id="cb10-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> highlight,</span>
<span id="cb10-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> evento),</span>
<span id="cb10-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb10-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb10-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"salmon"</span>,</span>
<span id="cb10-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Medium"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define título, subtítulo e o título dos eixos</span></span>
<span id="cb10-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb10-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb10-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb10-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NÚMERO DE PAÍSES COM QUEDA NO PIB"</span>,</span>
<span id="cb10-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Em percentual dos países incluídos na amostra"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_discrete</span>(</span>
<span id="cb10-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb10-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb10-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB EM CRESCIMENTO"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB EM QUEDA"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb10-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1925</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1950</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1975</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>),</span>
<span id="cb10-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>)</span>
<span id="cb10-31">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb10-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb10-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100%"</span>)</span>
<span id="cb10-35">    )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb10-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fundo do gráfico</span></span>
<span id="cb10-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb10-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linhas de grade</span></span>
<span id="cb10-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb10-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Legenda</span></span>
<span id="cb10-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb10-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horizontal"</span>,</span>
<span id="cb10-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>,</span>
<span id="cb10-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span>),</span>
<span id="cb10-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Título e subtítulo</span></span>
<span id="cb10-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),</span>
<span id="cb10-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Light"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb10-49">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Eixos</span></span>
<span id="cb10-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb10-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gotham Rounded Light"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb10-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb10-53">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="gráfico-extra" class="level1">
<h1>Gráfico extra</h1>
<p>Resolvi fazer um gráfico próprio mostrando o crescimento do PIB nos países da América Latina dando destaque para alguns.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">destaque <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uruguay"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazil"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chile"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Venezuela"</span>)</span>
<span id="cb11-2"></span>
<span id="cb11-3">principal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, subregion <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South America"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ind =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> destaque, country, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(ind))</span>
<span id="cb11-7"></span>
<span id="cb11-8">outros <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, subregion <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South America"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ind =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> destaque, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, country))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(ind))</span>
<span id="cb11-12"></span>
<span id="cb11-13">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> principal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cgdppc,</span>
<span id="cb11-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_abbrev =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb11-18">      country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazil"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BRA"</span>,</span>
<span id="cb11-19">      country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Venezuela"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"VEN"</span>,</span>
<span id="cb11-20">      country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uruguay"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URY"</span>,</span>
<span id="cb11-21">      country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chile"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CHL"</span>,</span>
<span id="cb11-22">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> country</span>
<span id="cb11-23">    ))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb12-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> principal,</span>
<span id="cb12-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, cgdppc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> country, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> ind),</span>
<span id="cb12-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb12-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85</span></span>
<span id="cb12-7">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb12-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> outros,</span>
<span id="cb12-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, cgdppc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> country),</span>
<span id="cb12-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey70"</span>,</span>
<span id="cb12-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb12-13">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(</span>
<span id="cb12-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>),</span>
<span id="cb12-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb12-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey75"</span></span>
<span id="cb12-18">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(</span>
<span id="cb12-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> y,</span>
<span id="cb12-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, cgdppc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.025</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> country_abbrev),</span>
<span id="cb12-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb12-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bahnschrift"</span>,</span>
<span id="cb12-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb12-25">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb12-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"limegreen"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tomato"</span>)</span>
<span id="cb12-28">    )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2010</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb12-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>),</span>
<span id="cb12-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5.000"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10.000"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"15.000"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20.000"</span>)</span>
<span id="cb12-33">    )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb12-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb12-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"US$"</span>,</span>
<span id="cb12-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AMÉRICA DO SUL"</span>,</span>
<span id="cb12-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB per capita real, em milhares de dólares (constante 2011).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Em destaque: Brasil (BR), Chile (CH), Uruguai (UR) e Venezuela (VN)."</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb12-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bahnschrift"</span>),</span>
<span id="cb12-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb12-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb12-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb12-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb12-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb12-47">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>repost</category>
  <category>data-visualization</category>
  <category>ggplot2</category>
  <category>tutorial-R</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/repost-crescimento-pib-mundo/index.html</guid>
  <pubDate>Sat, 01 Jun 2019 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/nexo-crescimento-pib.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Repost: Expectativa de vida e Crescimento Econômico</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index.html</link>
  <description><![CDATA[ 




<section id="disclaimer" class="level1">
<h1>Disclaimer</h1>
<p>Este é um post antigo que estou repostando porque ainda pode ser útil como um tutorial básico para <code>R</code>. Fiz apenas algumas modificações no código para deixar ele</p>
</section>
<section id="análise-exploratória" class="level1">
<h1>Análise Exploratória</h1>
<section id="preparativos" class="level2">
<h2 class="anchored" data-anchor-id="preparativos">Preparativos</h2>
<section id="carregando-os-pacotes" class="level3">
<h3 class="anchored" data-anchor-id="carregando-os-pacotes">Carregando os pacotes</h3>
<p>Muitos já devem estar familiarizados com a <a href="https://www.ted.com/talks/hans_rosling_shows_the_best_stats_you_ve_ever_seen?language=en">apresentação do historiador Hans Rosling</a> sobre a evolução da expectativa de vida e do PIB per capita dos países em torno do mundo. Este post vai mostrar como usar o <code>ggplot2</code> e o <code>tidyverse</code> para explorar estes dados. Pode-se acessar uma versão simplificada da base de dados pelo pacote <code>gapminder</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tutorial Gapminder</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pacotes</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gapminder)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(kableExtra)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(showtext)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Carregar fontes</span></span>
<span id="cb1-12">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jost"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jost"</span>)</span>
<span id="cb1-13">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Carregar os dados</span></span>
<span id="cb1-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gapminder"</span>)</span>
<span id="cb1-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"continent_colors"</span>)</span></code></pre></div>
</div>
</section>
<section id="checagem-dos-dados" class="level3">
<h3 class="anchored" data-anchor-id="checagem-dos-dados">Checagem dos dados</h3>
<p>De início é sempre importante verificar se há problemas com os dados. Como estamos usando uma base que já foi tratada é de se esperar que tudo esteja em ordem. Tipicamente, queremos verificar quantas observações ausentes (NAs) existem; se as variáveis estão no formato correto (ex: variáveis de texto como factor, números como numeric, etc.). Neste caso, além destas checagens também vamos criar uma nova variável que é o log do PIB per capita.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Checagens iniciais #</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Verifica se há valores ausentes</span></span>
<span id="cb2-3">gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.x))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  country continent  year lifeExp   pop gdpPercap
    &lt;int&gt;     &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt;     &lt;int&gt;
1       0         0     0       0     0         0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Informações gerais sobre os dados</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(gapminder)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1,704 × 6] (S3: tbl_df/tbl/data.frame)
 $ country  : Factor w/ 142 levels "Afghanistan",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ continent: Factor w/ 5 levels "Africa","Americas",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...
 $ pop      : int [1:1704] 8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...
 $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nome das variáveis minúsculas</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(gapminder) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tolower</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(gapminder))</span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tranformações #</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Computa o log do pib per capita</span></span>
<span id="cb6-5">gapminder <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(gapminder, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lgdppc =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(gdppercap))</span></code></pre></div>
</div>
</section>
<section id="tema-dos-gráficos" class="level3">
<h3 class="anchored" data-anchor-id="tema-dos-gráficos">Tema dos gráficos</h3>
<p>Para manter o padrão das visualizações pode-se criar um tema personalizado. A maneira mais simples de fazer isto é a partir de um tema padrão do <code>ggplot2</code> mas é possível começar do zero. Aqui, por simplicidade, começo com o tema <code>bw</code> e apenas mudo a posição da legenda e o tamanho e a fonte do texto que será plotado nos eixos e no título do gráfico. Além disso, como o nome dos eixos vai ser repetido muitas vezes defino uma lista com o nome mais comum deles.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tema customizado #</span></span>
<span id="cb7-2">theme_vini <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jost"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray20"</span>),</span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),</span>
<span id="cb7-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb7-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb7-8">    )</span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nomes que serão usados várias vezes para os eixos</span></span>
<span id="cb7-11">nomes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb7-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de vida e PIB per capita"</span>,</span>
<span id="cb7-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log do PIB per capita (US$ 2010)"</span>,</span>
<span id="cb7-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de vida ao nascer"</span>,</span>
<span id="cb7-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fonte =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fonte: Gapmineder (www.gapminder.org) e World Bank Open Data."</span></span>
<span id="cb7-16">  )</span></code></pre></div>
</div>
</section>
</section>
<section id="visualizando" class="level2">
<h2 class="anchored" data-anchor-id="visualizando">Visualizando</h2>
<section id="correlações" class="level3">
<h3 class="anchored" data-anchor-id="correlações">Correlações</h3>
<p>Note que não temos dados para todos os anos do período. Os dados estão disponíveis de cinco em cinco anos começando em 1952 e terminando em 2007. Podemos começar com um gráfico de dispersão para ver a relação entre a “economia” (PIB per capita) e a “qualidade da saúde/vida” (expectativa de vida ao nascer) de um país. Apenas como exemplo incluo também uma linha de regressão quadrática no gráfico.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(gapminder<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>year)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">gap2007 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gapminder, year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2007</span>)</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gap2007, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(lgdppc, lifeexp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb10-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(2007)"</span>),</span>
<span id="cb10-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte,</span>
<span id="cb10-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relação entre expectativa de vida ao nascer e o logaritmo do PIB per capita (fit linear)"</span>,</span>
<span id="cb10-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb10-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb10-12">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-13">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Podemos nos valer de outras informações disponíveis na base para alterar atributos estéticos do gráfico. O tamanho de cada círculo pode refletir o tamanho da população daquele país; a cor do círculo, por sua vez, pode representar o continente daquele país. Por conveniência uso as cores pré-definidas do pacote <code>gapminder</code>. Além disso também podemos destacar o nome de alguns países usando o pacote <code>ggrepel</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">destaque <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb11-2">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Australia"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Argentina"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazil"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chile"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nigeria"</span>, </span>
<span id="cb11-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sudan"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Taiwan"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mozambique"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Angola"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vietnam"</span></span>
<span id="cb11-4">  )</span>
<span id="cb11-5"></span>
<span id="cb11-6">gap_highlight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gap2007 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(country)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sel =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> destaque, country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gap_highlight, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(lgdppc, lifeexp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> continent), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(</span>
<span id="cb11-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> sel),</span>
<span id="cb11-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jost"</span>,</span>
<span id="cb11-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb11-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb11-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb11-19">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb11-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(2007)"</span>),</span>
<span id="cb11-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte,</span>
<span id="cb11-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb11-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb11-25">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> continent_colors, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_size_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-29">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>O gráfico acima é um retrato do momento, mas pode ser interessante entender como estas variáveis se comportaram ao longo do tempo.</p>
</section>
<section id="expectativa-de-vida-média-mundial" class="level3">
<h3 class="anchored" data-anchor-id="expectativa-de-vida-média-mundial">Expectativa de vida (média mundial)</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcula a expectativa de vida média</span></span>
<span id="cb12-2">gap_life <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">media =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(lifeexp))</span>
<span id="cb12-5"></span>
<span id="cb12-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gap_life, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, media)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb12-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(média mundial)"</span>),</span>
<span id="cb12-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte,</span>
<span id="cb12-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb12-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb12-14">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-15">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="expectativa-de-vida-todos-os-países" class="level3">
<h3 class="anchored" data-anchor-id="expectativa-de-vida-todos-os-países">Expectativa de vida (todos os países)</h3>
<p>Podemos desagregar a análise acima por país. É claro que fica difícil discernir um país específico, mas pode-se ver uma tendência geral de crescimento, ainda que haja alguns outliers. A maior parte das quedas significativas pode ser relacionada com alguma guerra. O país cuja expectativa de vida cai bruscamente no começo dos anos 90, por exemplo, é a Ruanda, que vivia uma guerra civil nesta época.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gapminder, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, lifeexp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> country, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> continent)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb13-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de vida (1952/2007)"</span>,</span>
<span id="cb13-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte,</span>
<span id="cb13-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb13-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb13-10">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-11">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se nos atermos somente ao nível de continente a visualização fica mais simples.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">gap_life_continent <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, continent) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expec_media =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(lifeexp))</span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gap_life_continent, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, expec_media, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> continent)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb14-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de vida média (1952/2007)"</span>,</span>
<span id="cb14-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte,</span>
<span id="cb14-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb14-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb14-14">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-15">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pib-per-capita-continentes" class="level3">
<h3 class="anchored" data-anchor-id="pib-per-capita-continentes">PIB per capita (continentes)</h3>
<p>Podemos fazer o mesmo para o log do PIB per capita. Aqui o gráfico é feito usando o log do PIB per capita, mas no eixo indico o valor equivalente em dólares para facilitar a interpretação.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcula o PIB per capita médio por continente a cada ano</span></span>
<span id="cb15-2">gap_gdp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, continent) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">avg_gdp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(gdppercap))</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gap_gdp, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(year, avg_gdp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> continent)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Escala log</span></span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB per capita médio (1952/2007)"</span>,</span>
<span id="cb15-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte,</span>
<span id="cb15-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb15-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x</span>
<span id="cb15-17">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-18">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analisando-os-dados" class="level2">
<h2 class="anchored" data-anchor-id="analisando-os-dados">Analisando os dados</h2>
<p>Antes de começar a análise tabular dos dados vale definir uma função simples para apresentar as tabelas.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">print_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(df, ...) {</span>
<span id="cb16-2">  </span>
<span id="cb16-3">  str_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(string) {</span>
<span id="cb16-4">    </span>
<span id="cb16-5">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(string, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb16-6">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_title</span>(x)</span>
<span id="cb16-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(x)</span>
<span id="cb16-8">    </span>
<span id="cb16-9">  }</span>
<span id="cb16-10">  </span>
<span id="cb16-11">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_title</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(df)), ...) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-12">    kableExtra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_styling</span>(</span>
<span id="cb16-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb16-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bootstrap_options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hover"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"condensed"</span>)</span>
<span id="cb16-15">    )</span>
<span id="cb16-16">  </span>
<span id="cb16-17">}</span></code></pre></div>
</div>
<p>Podemos encontrar fatos interessantes simplesmente agregando e reorganizando os dados. No gráfico anterior vimos que o continente com maior PIB per capita médio é a Oceania. Curiosamente, a base inclui somente dois países na Oceania: Austrália e Nove Zelândia.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note que na Oceania os dados só incluem Autrália e Nova Zelândia</span></span>
<span id="cb17-2">gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(continent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oceania"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_table</span>()</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Australia</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Zealand</td>
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Podemos encontrar os países que mais cresceram (em termos absolutos e relativos) durante o período observado. Note como há vários países asiáticos listados qual seja a métrica escolhida.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Países que mais cresceram no período da amostra em termos absolutos</span></span>
<span id="cb18-2">gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">growth =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">last</span>(gdppercap) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">first</span>(gdppercap)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(growth, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Países que mais cresceram de 1952 a 2007"</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<caption>Países que mais cresceram de 1952 a 2007</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Growth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Singapore</td>
<td style="text-align: right;">44828.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Norway</td>
<td style="text-align: right;">39261.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hong Kong, China</td>
<td style="text-align: right;">36670.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ireland</td>
<td style="text-align: right;">35465.72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Austria</td>
<td style="text-align: right;">29989.42</td>
</tr>
<tr class="even">
<td style="text-align: left;">United States</td>
<td style="text-align: right;">28961.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iceland</td>
<td style="text-align: right;">28913.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Japan</td>
<td style="text-align: right;">28439.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">27856.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">Taiwan</td>
<td style="text-align: right;">27511.33</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Países que mais cresceram no período da amostra em termos relativos</span></span>
<span id="cb19-2">gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">growth =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">last</span>(gdppercap) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">first</span>(gdppercap) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(growth, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_table</span>(</span>
<span id="cb19-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Países que mais cresceram de 1952 a 2007 (%)"</span>,</span>
<span id="cb19-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb19-9">    )</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<caption>Países que mais cresceram de 1952 a 2007 (%)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Growth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Equatorial Guinea</td>
<td style="text-align: right;">3135.54</td>
</tr>
<tr class="even">
<td style="text-align: left;">Taiwan</td>
<td style="text-align: right;">2279.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Korea, Rep.</td>
<td style="text-align: right;">2165.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">Singapore</td>
<td style="text-align: right;">1936.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Botswana</td>
<td style="text-align: right;">1376.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hong Kong, China</td>
<td style="text-align: right;">1200.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">1138.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oman</td>
<td style="text-align: right;">1120.64</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Thailand</td>
<td style="text-align: right;">884.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Japan</td>
<td style="text-align: right;">884.04</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>A mesma análise também pode ser feita para a expectativa de vida. Adicionalmente também podemos encontrar qual foi a maior variação (negativa) entre um ponto observado e outro dentro da amostra.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">life_growth =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">last</span>(lifeexp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">first</span>(lifeexp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(life_growth, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Life Growth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Oman</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Indonesia</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">Saudi Arabia</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Libya</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">Korea, Rep.</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nicaragua</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">West Bank and Gaza</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Yemen, Rep.</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gambia</td>
<td style="text-align: right;">29</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">life_growth =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">last</span>(lifeexp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">first</span>(lifeexp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(life_growth, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Life Growth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Oman</td>
<td style="text-align: right;">101.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gambia</td>
<td style="text-align: right;">98.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Yemen, Rep.</td>
<td style="text-align: right;">92.63</td>
</tr>
<tr class="even">
<td style="text-align: left;">Indonesia</td>
<td style="text-align: right;">88.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: right;">83.73</td>
</tr>
<tr class="even">
<td style="text-align: left;">Saudi Arabia</td>
<td style="text-align: right;">82.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nepal</td>
<td style="text-align: right;">76.41</td>
</tr>
<tr class="even">
<td style="text-align: left;">India</td>
<td style="text-align: right;">73.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Libya</td>
<td style="text-align: right;">73.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nicaragua</td>
<td style="text-align: right;">72.28</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">gapminder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb22-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">life_diff =</span> lifeexp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(lifeexp),</span>
<span id="cb22-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">life_abs  =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(lifeexp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(lifeexp))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(life_abs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(country, year, life_diff) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Life Diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rwanda</td>
<td style="text-align: right;">1992</td>
<td style="text-align: right;">-20.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cambodia</td>
<td style="text-align: right;">1982</td>
<td style="text-align: right;">19.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">1967</td>
<td style="text-align: right;">13.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zimbabwe</td>
<td style="text-align: right;">1997</td>
<td style="text-align: right;">-13.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rwanda</td>
<td style="text-align: right;">1997</td>
<td style="text-align: right;">12.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lesotho</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">-11.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Swaziland</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">-10.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Botswana</td>
<td style="text-align: right;">1997</td>
<td style="text-align: right;">-10.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cambodia</td>
<td style="text-align: right;">1977</td>
<td style="text-align: right;">-9.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Namibia</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">-7.4</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="visualizando-o-brasil" class="level1">
<h1>Visualizando o Brasil</h1>
<p>Agora vamos analisar o Brasil mais de perto. Para tornar a análise mais concreta escolho um pequeno grupo de países para acompanhar.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizando a trajetória do Brasil</span></span>
<span id="cb23-2">countries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Argentina"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazil"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chile"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Korea, Rep."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Venezuela"</span>)</span>
<span id="cb23-3">sub_gapminder <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gapminder, country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> countries)</span>
<span id="cb23-4"></span>
<span id="cb23-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb23-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> gapminder,</span>
<span id="cb23-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> gdppercap, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> country),</span>
<span id="cb23-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray60"</span>,</span>
<span id="cb23-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb23-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sub_gapminder,</span>
<span id="cb23-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> gdppercap, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> country)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb23-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sub_gapminder,</span>
<span id="cb23-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> gdppercap, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> country),</span>
<span id="cb23-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb23-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb23-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB per capita (1952/2007)"</span>,</span>
<span id="cb23-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte,</span>
<span id="cb23-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb23-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x</span>
<span id="cb23-26">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-27">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>O Brasil em 2007 tinha a 68ª maior expectativa de vida ao nascer a 60º PIB per capita (numa amostra de 142 países). Olhando para a distribuição dos dados, o Brasil não está tão mal em termos de expectativa de vida, mas ainda está bastante atrás dos demais países em termos de PIB. Note que neste último gráfico uso os valores absolutos para facilitar a interpretação. A posição do Brasil é indicada por uma linha vertical em vermelho.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">bra_life <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gap2007 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazil"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(lifeexp)</span>
<span id="cb24-4"></span>
<span id="cb24-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gap2007, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(lifeexp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffffff"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> bra_life, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tomato"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb24-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribuição da expectativa de vida"</span>,</span>
<span id="cb24-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A linha vermelha indica a posição do Brasil."</span>,</span>
<span id="cb24-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb24-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y,</span>
<span id="cb24-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte</span>
<span id="cb24-14">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-15">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">bra_gdp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gap2007 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazil"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(lgdppc)</span>
<span id="cb25-4"></span>
<span id="cb25-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gap2007, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(lgdppc)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffffff"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> bra_gdp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tomato"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb25-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb25-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span>
<span id="cb25-11">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb25-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribuição do PIB per capita (2007)"</span>,</span>
<span id="cb25-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A linha vermelha indica a posição do Brasil."</span>,</span>
<span id="cb25-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> nomes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fonte,</span>
<span id="cb25-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PIB per capita (US$ 2010)"</span>,</span>
<span id="cb25-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb25-18">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-19">  theme_vini</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-interativo" class="level1">
<h1>Gráfico interativo</h1>
<p>Também é possível produzir gráficos interativos com o R. Estes dados são particularmente bem adaptados a este de visualização pois eles mudam no tempo.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(plotly)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb27-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">symbol =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"circle"</span>,</span>
<span id="cb27-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sizemode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"diameter"</span>,</span>
<span id="cb27-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#FFFFFF'</span>)</span>
<span id="cb27-5">  )</span>
<span id="cb27-6"></span>
<span id="cb27-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ly</span>(</span>
<span id="cb27-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> gapminder,</span>
<span id="cb27-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>lgdppc,</span>
<span id="cb27-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>lifeexp,</span>
<span id="cb27-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>continent,</span>
<span id="cb27-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors =</span> continent_colors,</span>
<span id="cb27-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>pop,</span>
<span id="cb27-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frame =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>year,</span>
<span id="cb27-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scatter"</span>,</span>
<span id="cb27-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"markers"</span>,</span>
<span id="cb27-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">marker =</span> info,</span>
<span id="cb27-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb27-19">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Country:"</span>, country,</span>
<span id="cb27-20">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;Life Expectancy:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(lifeexp, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb27-21">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;GDP per capita:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(gdppercap, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb27-22">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;Pop.:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>))</span>
<span id="cb27-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-24">  plotly<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span>( </span>
<span id="cb27-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expectativa de vida e PIB per capita"</span>,</span>
<span id="cb27-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GDP per capita (US$, log)"</span>),</span>
<span id="cb27-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Life Expectancy (years)"</span>)</span>
<span id="cb27-28">    )</span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0e30ad3f225c69161fb6" style="width:100%;height:533.952px;"></div>
<script type="application/json" data-for="htmlwidget-0e30ad3f225c69161fb6">{"x":{"visdat":{"35666ffda315":["function () ","plotlyVisDat"]},"cur_data":"35666ffda315","attrs":{"35666ffda315":{"x":{},"y":{},"mode":"markers","marker":{"symbol":"circle","sizemode":"diameter","line":{"width":2,"color":"#FFFFFF"}},"text":{},"color":{},"size":{},"frame":{},"colors":["#7F3B08","#A50026","#40004B","#276419","#313695"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Expectativa de vida e PIB per capita","xaxis":{"domain":[0,1],"automargin":true,"title":"GDP per capita (US$, log)","range":[2.2486774322932654,5.1887227933502453]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Life Expectancy (years)","range":[20.648800000000001,85.55319999999999]},"hovermode":"closest","showlegend":true,"sliders":[{"currentvalue":{"prefix":"year: ","xanchor":"right","font":{"size":16,"color":"rgba(204,204,204,1)"}},"steps":[{"method":"animate","args":[["1952"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1952","value":"1952"},{"method":"animate","args":[["1957"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1957","value":"1957"},{"method":"animate","args":[["1962"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1962","value":"1962"},{"method":"animate","args":[["1967"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1967","value":"1967"},{"method":"animate","args":[["1972"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1972","value":"1972"},{"method":"animate","args":[["1977"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1977","value":"1977"},{"method":"animate","args":[["1982"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1982","value":"1982"},{"method":"animate","args":[["1987"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1987","value":"1987"},{"method":"animate","args":[["1992"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1992","value":"1992"},{"method":"animate","args":[["1997"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"1997","value":"1997"},{"method":"animate","args":[["2002"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"2002","value":"2002"},{"method":"animate","args":[["2007"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false},"mode":"immediate"}],"label":"2007","value":"2007"}],"visible":true,"pad":{"t":40}}],"updatemenus":[{"type":"buttons","direction":"right","showactive":false,"y":0,"x":0,"yanchor":"top","xanchor":"right","pad":{"t":60,"r":5},"buttons":[{"label":"Play","method":"animate","args":[null,{"fromcurrent":true,"mode":"immediate","transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":false}}]}]}]},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[3.3889902366128295,3.546617951893976,3.0264320126717377,2.9300526050205478,2.7350039250646971,2.5305793268568042,3.0691749464286691,3.029915447835549,3.0713907290818487,3.042571943572232,2.8923964580961394,3.3274859174242151,3.1425755133131092,3.4264347203837331,3.1519280501569278,2.5747754426179159,2.5171174236159328,2.5588840279669709,3.6328090876363524,2.6859482337800413,2.9596608637313313,2.7077374684251021,2.4769045152043669,2.9312243461536549,2.4754477554867704,2.7601004101431883,3.3779521224475015,3.1592698569002877,2.56722061382276,2.6554620948372682,2.8710565594093267,3.2940153194906676,3.2274248143258331,2.6707337315928892,3.3844932769166256,2.8818862174230904,3.0323293453507603,3.4343908858518062,2.6931321343486228,2.9442771161033847,3.1614749102802429,2.9443779036382201,3.0552826850697294,3.6744289754841963,3.2084389723810651,3.0600843443064192,2.8553071488998873,2.9344018133538139,3.1668667439061169,2.8661416540551472,3.0597106180244795,2.609470734853601],"y":[43.076999999999998,30.015000000000001,38.222999999999999,47.622,31.975000000000001,39.030999999999999,38.523000000000003,35.463000000000001,38.091999999999999,40.715000000000003,39.143000000000001,42.110999999999997,40.476999999999997,34.811999999999998,41.893000000000001,34.481999999999999,35.927999999999997,34.078000000000003,37.003,30,43.149000000000001,33.609000000000002,32.5,42.270000000000003,42.137999999999998,38.479999999999997,42.722999999999999,36.680999999999997,36.256,33.685000000000002,40.542999999999999,50.985999999999997,42.872999999999998,31.286000000000001,41.725000000000001,37.444000000000003,36.323999999999998,52.723999999999997,40,46.470999999999997,37.277999999999999,30.331,32.978000000000002,45.009,38.634999999999998,41.406999999999996,41.215000000000003,38.595999999999997,44.600000000000001,39.978000000000002,42.037999999999997,48.451000000000001],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[10.629259618945621,10.284757308036966,10.114549306559425,10.026092922527592,10.30099360804077,10.162824868184376,10.337787988900558,10.084066145406517,10.178990185053525,10.00641066434841,10.958271908306536,10.054252546321832,10.199094588124854,10.000214177958215,11.512711890676478,10.010712515320479,10.094103774923674,11.419726168376613,10.024618247905162,10.01530976533753,10.37682420826115,10.177747092907902,10.035535385761884,10.437094691088317,10.047008307912341,10.054827441459514,10.065503646176497,10.320987168217217,10.195052849389482,10.257870602955506,10.06569659744733,10.031160572317752,10.67428558631673,10.435884565148502,10.029063498459834,10.22656294539239,12.256382194309907,10.013492870102452,10.168920476619746,10,10.183981323214891,10.142187272566975,10.16837902545897,10.969528877920411,10.576373224953816,10.015714027939985,10.563968785667058,10.079112205137831,10.244872976723292,10.393464020084254,10.178276122020115,10.206185257252644],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 43.08 <br>GDP per capita: 2449.01 <br>Pop.:     9,279,525","Country: Angola <br>Life Expectancy: 30.02 <br>GDP per capita: 3520.61 <br>Pop.:     4,232,095","Country: Benin <br>Life Expectancy: 38.22 <br>GDP per capita: 1062.75 <br>Pop.:     1,738,315","Country: Botswana <br>Life Expectancy: 47.62 <br>GDP per capita: 851.24 <br>Pop.:       442,308","Country: Burkina Faso <br>Life Expectancy: 31.98 <br>GDP per capita: 543.26 <br>Pop.:     4,469,979","Country: Burundi <br>Life Expectancy: 39.03 <br>GDP per capita: 339.3 <br>Pop.:     2,445,618","Country: Cameroon <br>Life Expectancy: 38.52 <br>GDP per capita: 1172.67 <br>Pop.:     5,009,067","Country: Central African Republic <br>Life Expectancy: 35.46 <br>GDP per capita: 1071.31 <br>Pop.:     1,291,695","Country: Chad <br>Life Expectancy: 38.09 <br>GDP per capita: 1178.67 <br>Pop.:     2,682,462","Country: Comoros <br>Life Expectancy: 40.72 <br>GDP per capita: 1102.99 <br>Pop.:       153,936","Country: Congo, Dem. Rep. <br>Life Expectancy: 39.14 <br>GDP per capita: 780.54 <br>Pop.:    14,100,005","Country: Congo, Rep. <br>Life Expectancy: 42.11 <br>GDP per capita: 2125.62 <br>Pop.:       854,885","Country: Cote d'Ivoire <br>Life Expectancy: 40.48 <br>GDP per capita: 1388.59 <br>Pop.:     2,977,019","Country: Djibouti <br>Life Expectancy: 34.81 <br>GDP per capita: 2669.53 <br>Pop.:        63,149","Country: Egypt <br>Life Expectancy: 41.89 <br>GDP per capita: 1418.82 <br>Pop.:    22,223,309","Country: Equatorial Guinea <br>Life Expectancy: 34.48 <br>GDP per capita: 375.64 <br>Pop.:       216,964","Country: Eritrea <br>Life Expectancy: 35.93 <br>GDP per capita: 328.94 <br>Pop.:     1,438,760","Country: Ethiopia <br>Life Expectancy: 34.08 <br>GDP per capita: 362.15 <br>Pop.:    20,860,941","Country: Gabon <br>Life Expectancy: 37 <br>GDP per capita: 4293.48 <br>Pop.:       420,702","Country: Gambia <br>Life Expectancy: 30 <br>GDP per capita: 485.23 <br>Pop.:       284,320","Country: Ghana <br>Life Expectancy: 43.15 <br>GDP per capita: 911.3 <br>Pop.:     5,581,001","Country: Guinea <br>Life Expectancy: 33.61 <br>GDP per capita: 510.2 <br>Pop.:     2,664,249","Country: Guinea-Bissau <br>Life Expectancy: 32.5 <br>GDP per capita: 299.85 <br>Pop.:       580,653","Country: Kenya <br>Life Expectancy: 42.27 <br>GDP per capita: 853.54 <br>Pop.:     6,464,046","Country: Lesotho <br>Life Expectancy: 42.14 <br>GDP per capita: 298.85 <br>Pop.:       748,747","Country: Liberia <br>Life Expectancy: 38.48 <br>GDP per capita: 575.57 <br>Pop.:       863,308","Country: Libya <br>Life Expectancy: 42.72 <br>GDP per capita: 2387.55 <br>Pop.:     1,019,729","Country: Madagascar <br>Life Expectancy: 36.68 <br>GDP per capita: 1443.01 <br>Pop.:     4,762,912","Country: Malawi <br>Life Expectancy: 36.26 <br>GDP per capita: 369.17 <br>Pop.:     2,917,802","Country: Mali <br>Life Expectancy: 33.69 <br>GDP per capita: 452.34 <br>Pop.:     3,838,168","Country: Mauritania <br>Life Expectancy: 40.54 <br>GDP per capita: 743.12 <br>Pop.:     1,022,556","Country: Mauritius <br>Life Expectancy: 50.99 <br>GDP per capita: 1967.96 <br>Pop.:       516,556","Country: Morocco <br>Life Expectancy: 42.87 <br>GDP per capita: 1688.2 <br>Pop.:     9,939,217","Country: Mozambique <br>Life Expectancy: 31.29 <br>GDP per capita: 468.53 <br>Pop.:     6,446,316","Country: Namibia <br>Life Expectancy: 41.73 <br>GDP per capita: 2423.78 <br>Pop.:       485,831","Country: Niger <br>Life Expectancy: 37.44 <br>GDP per capita: 761.88 <br>Pop.:     3,379,468","Country: Nigeria <br>Life Expectancy: 36.32 <br>GDP per capita: 1077.28 <br>Pop.:    33,119,096","Country: Reunion <br>Life Expectancy: 52.72 <br>GDP per capita: 2718.89 <br>Pop.:       257,700","Country: Rwanda <br>Life Expectancy: 40 <br>GDP per capita: 493.32 <br>Pop.:     2,534,927","Country: Sao Tome and Principe <br>Life Expectancy: 46.47 <br>GDP per capita: 879.58 <br>Pop.:        60,011","Country: Senegal <br>Life Expectancy: 37.28 <br>GDP per capita: 1450.36 <br>Pop.:     2,755,589","Country: Sierra Leone <br>Life Expectancy: 30.33 <br>GDP per capita: 879.79 <br>Pop.:     2,143,249","Country: Somalia <br>Life Expectancy: 32.98 <br>GDP per capita: 1135.75 <br>Pop.:     2,526,994","Country: South Africa <br>Life Expectancy: 45.01 <br>GDP per capita: 4725.3 <br>Pop.:    14,264,935","Country: Sudan <br>Life Expectancy: 38.63 <br>GDP per capita: 1615.99 <br>Pop.:     8,504,667","Country: Swaziland <br>Life Expectancy: 41.41 <br>GDP per capita: 1148.38 <br>Pop.:       290,243","Country: Tanzania <br>Life Expectancy: 41.22 <br>GDP per capita: 716.65 <br>Pop.:     8,322,925","Country: Togo <br>Life Expectancy: 38.6 <br>GDP per capita: 859.81 <br>Pop.:     1,219,113","Country: Tunisia <br>Life Expectancy: 44.6 <br>GDP per capita: 1468.48 <br>Pop.:     3,647,735","Country: Uganda <br>Life Expectancy: 39.98 <br>GDP per capita: 734.75 <br>Pop.:     5,824,797","Country: Zambia <br>Life Expectancy: 42.04 <br>GDP per capita: 1147.39 <br>Pop.:     2,672,000","Country: Zimbabwe <br>Life Expectancy: 48.45 <br>GDP per capita: 406.88 <br>Pop.:     3,080,907"],"frame":"1952","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[10.629259618945621,10.284757308036966,10.114549306559425,10.026092922527592,10.30099360804077,10.162824868184376,10.337787988900558,10.084066145406517,10.178990185053525,10.00641066434841,10.958271908306536,10.054252546321832,10.199094588124854,10.000214177958215,11.512711890676478,10.010712515320479,10.094103774923674,11.419726168376613,10.024618247905162,10.01530976533753,10.37682420826115,10.177747092907902,10.035535385761884,10.437094691088317,10.047008307912341,10.054827441459514,10.065503646176497,10.320987168217217,10.195052849389482,10.257870602955506,10.06569659744733,10.031160572317752,10.67428558631673,10.435884565148502,10.029063498459834,10.22656294539239,12.256382194309907,10.013492870102452,10.168920476619746,10,10.183981323214891,10.142187272566975,10.16837902545897,10.969528877920411,10.576373224953816,10.015714027939985,10.563968785667058,10.079112205137831,10.244872976723292,10.393464020084254,10.178276122020115,10.206185257252644]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.7716841063854578,3.4277013118156043,3.3240651209271301,4.055652015799267,3.5954938837938353,3.3312480945543395,3.4194616385247927,3.7471428178485775,3.1454192899578319,3.5468030038250093,3.4840581192497848,3.3852912098780523,3.2649044228437729,3.3414199233324244,3.4621779317126391,3.5413452520681394,3.4930903760317378,3.3945182793314443,3.2905484898372737,3.5750172627178163,3.4888269675210974,3.4804772115240326,4.1458326795437701,3.7571504724556046,3.8859150311115758],"y":[62.484999999999999,40.414000000000001,50.917000000000002,68.75,54.744999999999997,50.643000000000001,57.206000000000003,59.420999999999999,45.927999999999997,48.356999999999999,45.262,42.023000000000003,37.579000000000001,41.911999999999999,58.530000000000001,50.789000000000001,42.314,55.191000000000003,62.649000000000001,43.902000000000001,64.280000000000001,59.100000000000001,68.439999999999998,66.070999999999998,55.088000000000001],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[11.21606019812705,10.192699007692559,13.859199393585619,11.005064741453392,10.431195787839556,10.838881415457701,10.059127995624314,10.405954321662737,10.165945942012687,10.238117156882629,10.135335762000556,10.210654055097176,10.214415273944638,10.099474809361464,10.093239350500223,12.053344561308055,10.075472749667506,10.060067361857236,10.102097294921846,10.543682283554137,10.147903530750032,10.041145578761045,20.749371197304647,10.14967572026088,10.367170979719349],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 62.48 <br>GDP per capita: 5911.32 <br>Pop.:    17,876,956","Country: Bolivia <br>Life Expectancy: 40.41 <br>GDP per capita: 2677.33 <br>Pop.:     2,883,315","Country: Brazil <br>Life Expectancy: 50.92 <br>GDP per capita: 2108.94 <br>Pop.:    56,602,560","Country: Canada <br>Life Expectancy: 68.75 <br>GDP per capita: 11367.16 <br>Pop.:    14,785,584","Country: Chile <br>Life Expectancy: 54.74 <br>GDP per capita: 3939.98 <br>Pop.:     6,377,619","Country: Colombia <br>Life Expectancy: 50.64 <br>GDP per capita: 2144.12 <br>Pop.:    12,350,771","Country: Costa Rica <br>Life Expectancy: 57.21 <br>GDP per capita: 2627.01 <br>Pop.:       926,317","Country: Cuba <br>Life Expectancy: 59.42 <br>GDP per capita: 5586.54 <br>Pop.:     6,007,797","Country: Dominican Republic <br>Life Expectancy: 45.93 <br>GDP per capita: 1397.72 <br>Pop.:     2,491,346","Country: Ecuador <br>Life Expectancy: 48.36 <br>GDP per capita: 3522.11 <br>Pop.:     3,548,753","Country: El Salvador <br>Life Expectancy: 45.26 <br>GDP per capita: 3048.3 <br>Pop.:     2,042,865","Country: Guatemala <br>Life Expectancy: 42.02 <br>GDP per capita: 2428.24 <br>Pop.:     3,146,381","Country: Haiti <br>Life Expectancy: 37.58 <br>GDP per capita: 1840.37 <br>Pop.:     3,201,488","Country: Honduras <br>Life Expectancy: 41.91 <br>GDP per capita: 2194.93 <br>Pop.:     1,517,453","Country: Jamaica <br>Life Expectancy: 58.53 <br>GDP per capita: 2898.53 <br>Pop.:     1,426,095","Country: Mexico <br>Life Expectancy: 50.79 <br>GDP per capita: 3478.13 <br>Pop.:    30,144,317","Country: Nicaragua <br>Life Expectancy: 42.31 <br>GDP per capita: 3112.36 <br>Pop.:     1,165,790","Country: Panama <br>Life Expectancy: 55.19 <br>GDP per capita: 2480.38 <br>Pop.:       940,080","Country: Paraguay <br>Life Expectancy: 62.65 <br>GDP per capita: 1952.31 <br>Pop.:     1,555,876","Country: Peru <br>Life Expectancy: 43.9 <br>GDP per capita: 3758.52 <br>Pop.:     8,025,700","Country: Puerto Rico <br>Life Expectancy: 64.28 <br>GDP per capita: 3081.96 <br>Pop.:     2,227,000","Country: Trinidad and Tobago <br>Life Expectancy: 59.1 <br>GDP per capita: 3023.27 <br>Pop.:       662,850","Country: United States <br>Life Expectancy: 68.44 <br>GDP per capita: 13990.48 <br>Pop.:   157,553,000","Country: Uruguay <br>Life Expectancy: 66.07 <br>GDP per capita: 5716.77 <br>Pop.:     2,252,965","Country: Venezuela <br>Life Expectancy: 55.09 <br>GDP per capita: 7689.8 <br>Pop.:     5,439,568"],"frame":"1952","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[11.21606019812705,10.192699007692559,13.859199393585619,11.005064741453392,10.431195787839556,10.838881415457701,10.059127995624314,10.405954321662737,10.165945942012687,10.238117156882629,10.135335762000556,10.210654055097176,10.214415273944638,10.099474809361464,10.093239350500223,12.053344561308055,10.075472749667506,10.060067361857236,10.102097294921846,10.543682283554137,10.147903530750032,10.041145578761045,20.749371197304647,10.14967572026088,10.367170979719349]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.8917856507063857,3.9941888591046819,2.8352111067723493,2.5664012923297479,2.6025467916035643,3.4849289266728523,2.7376424130206169,2.8748768833905021,3.4822053422865116,3.6159254503329223,3.6113538549108273,3.5074451677140162,3.1894644312790241,3.0367397532404041,3.0130868621518014,5.0349585749878187,3.6843788787613345,3.2627198642560913,2.8957356431821641,2.5198279937757189,2.7370858240682567,3.2620309040668611,2.8354350828905424,3.104787802215522,3.8102025884940609,3.3645769259938039,3.0348417539083994,3.2157658381984016,3.08168852810498,2.8795531210227017,2.7818031025725949,3.1805823984758761,2.8930498767229236],"y":[28.800999999999998,50.939,37.484000000000002,39.417000000000002,44,60.960000000000001,37.372999999999998,37.468000000000004,44.869,45.32,65.390000000000001,63.030000000000001,43.158000000000001,50.055999999999997,47.453000000000003,55.564999999999998,55.927999999999997,48.463000000000001,42.244,36.319000000000003,36.156999999999996,37.578000000000003,43.436,47.752000000000002,39.875,60.396000000000001,57.593000000000004,45.883000000000003,58.5,50.847999999999999,40.411999999999999,43.159999999999997,32.548000000000002],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[10.570958440333994,10.004124939159547,13.196073516337687,10.316272523015931,47.962566414495925,10.141003151025526,35.386025309878448,15.596200380490078,11.174770127735174,10.367320999844319,10.106536334452237,15.89699311991038,10.037396031178993,10.60100034575081,11.425638926987236,10.006824550625852,10.094156261491509,10.456501207090577,10.05055173139184,11.367311607471214,10.62263982736204,10.030565201275845,12.817931410627473,11.527412361357225,10.269303597092721,10.072825215250953,10.540722969369218,10.245815823859932,10.579492046432662,11.448969923046661,11.787329940458308,10.066244600897457,10.334700359049151],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 28.8 <br>GDP per capita: 779.45 <br>Pop.:     8,425,333","Country: Bahrain <br>Life Expectancy: 50.94 <br>GDP per capita: 9867.08 <br>Pop.:       120,447","Country: Bangladesh <br>Life Expectancy: 37.48 <br>GDP per capita: 684.24 <br>Pop.:    46,886,859","Country: Cambodia <br>Life Expectancy: 39.42 <br>GDP per capita: 368.47 <br>Pop.:     4,693,836","Country: China <br>Life Expectancy: 44 <br>GDP per capita: 400.45 <br>Pop.:   556,263,527","Country: Hong Kong, China <br>Life Expectancy: 60.96 <br>GDP per capita: 3054.42 <br>Pop.:     2,125,900","Country: India <br>Life Expectancy: 37.37 <br>GDP per capita: 546.57 <br>Pop.:   372,000,000","Country: Indonesia <br>Life Expectancy: 37.47 <br>GDP per capita: 749.68 <br>Pop.:    82,052,000","Country: Iran <br>Life Expectancy: 44.87 <br>GDP per capita: 3035.33 <br>Pop.:    17,272,000","Country: Iraq <br>Life Expectancy: 45.32 <br>GDP per capita: 4129.77 <br>Pop.:     5,441,766","Country: Israel <br>Life Expectancy: 65.39 <br>GDP per capita: 4086.52 <br>Pop.:     1,620,914","Country: Japan <br>Life Expectancy: 63.03 <br>GDP per capita: 3216.96 <br>Pop.:    86,459,025","Country: Jordan <br>Life Expectancy: 43.16 <br>GDP per capita: 1546.91 <br>Pop.:       607,914","Country: Korea, Dem. Rep. <br>Life Expectancy: 50.06 <br>GDP per capita: 1088.28 <br>Pop.:     8,865,488","Country: Korea, Rep. <br>Life Expectancy: 47.45 <br>GDP per capita: 1030.59 <br>Pop.:    20,947,571","Country: Kuwait <br>Life Expectancy: 55.56 <br>GDP per capita: 108382.35 <br>Pop.:       160,000","Country: Lebanon <br>Life Expectancy: 55.93 <br>GDP per capita: 4834.8 <br>Pop.:     1,439,529","Country: Malaysia <br>Life Expectancy: 48.46 <br>GDP per capita: 1831.13 <br>Pop.:     6,748,378","Country: Mongolia <br>Life Expectancy: 42.24 <br>GDP per capita: 786.57 <br>Pop.:       800,663","Country: Myanmar <br>Life Expectancy: 36.32 <br>GDP per capita: 331 <br>Pop.:    20,092,996","Country: Nepal <br>Life Expectancy: 36.16 <br>GDP per capita: 545.87 <br>Pop.:     9,182,536","Country: Oman <br>Life Expectancy: 37.58 <br>GDP per capita: 1828.23 <br>Pop.:       507,833","Country: Pakistan <br>Life Expectancy: 43.44 <br>GDP per capita: 684.6 <br>Pop.:    41,346,560","Country: Philippines <br>Life Expectancy: 47.75 <br>GDP per capita: 1272.88 <br>Pop.:    22,438,691","Country: Saudi Arabia <br>Life Expectancy: 39.88 <br>GDP per capita: 6459.55 <br>Pop.:     4,005,677","Country: Singapore <br>Life Expectancy: 60.4 <br>GDP per capita: 2315.14 <br>Pop.:     1,127,000","Country: Sri Lanka <br>Life Expectancy: 57.59 <br>GDP per capita: 1083.53 <br>Pop.:     7,982,342","Country: Syria <br>Life Expectancy: 45.88 <br>GDP per capita: 1643.49 <br>Pop.:     3,661,549","Country: Taiwan <br>Life Expectancy: 58.5 <br>GDP per capita: 1206.95 <br>Pop.:     8,550,362","Country: Thailand <br>Life Expectancy: 50.85 <br>GDP per capita: 757.8 <br>Pop.:    21,289,402","Country: Vietnam <br>Life Expectancy: 40.41 <br>GDP per capita: 605.07 <br>Pop.:    26,246,839","Country: West Bank and Gaza <br>Life Expectancy: 43.16 <br>GDP per capita: 1515.59 <br>Pop.:     1,030,585","Country: Yemen, Rep. <br>Life Expectancy: 32.55 <br>GDP per capita: 781.72 <br>Pop.:     4,963,829"],"frame":"1952","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[10.570958440333994,10.004124939159547,13.196073516337687,10.316272523015931,47.962566414495925,10.141003151025526,35.386025309878448,15.596200380490078,11.174770127735174,10.367320999844319,10.106536334452237,15.89699311991038,10.037396031178993,10.60100034575081,11.425638926987236,10.006824550625852,10.094156261491509,10.456501207090577,10.05055173139184,11.367311607471214,10.62263982736204,10.030565201275845,12.817931410627473,11.527412361357225,10.269303597092721,10.072825215250953,10.540722969369218,10.245815823859932,10.579492046432662,11.448969923046661,11.787329940458308,10.066244600897457,10.334700359049151]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.2044065593569231,3.7879615363271912,3.9213277159305022,2.9883507643539309,3.3881521354267963,3.4940483069265413,3.8373447262436224,3.9864306677903336,3.8078406226448371,3.846943545595249,3.8539483999469684,3.5478595957564281,3.7212889686947199,3.8613963004603242,3.716861090214755,3.6929705967500874,3.422850010494709,3.951413871061022,4.0041244656118469,3.6052328048910161,3.4869006320800371,3.4975672311747799,3.5540600381109928,3.7054068733390868,3.6248018797427801,3.5836560439073355,3.930839280912017,4.1683275259262418,3.2942679883231207,3.9991091518444533],"y":[55.229999999999997,66.799999999999997,68,53.82,59.600000000000001,61.210000000000001,66.870000000000005,70.780000000000001,66.549999999999997,67.409999999999997,67.5,65.859999999999999,64.030000000000001,72.489999999999995,66.909999999999997,65.939999999999998,59.164000000000001,72.129999999999995,72.670000000000002,61.310000000000002,59.82,61.049999999999997,57.996000000000002,64.359999999999999,65.569999999999993,64.939999999999998,71.859999999999999,69.620000000000005,43.585000000000001,69.180000000000007],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.083452004785734,10.468745388300251,10.591780523848481,10.186398230696833,10.492437920575309,10.26087789900933,10.618725312244932,10.291712631437814,10.275093022506884,12.893904318382232,14.715323704498925,10.523721689583494,10.644580714283491,10.006002920842237,10.197397613435532,13.249252237988841,10.024149486204392,10.704506041618405,10.22303153444337,11.752091728319773,10.577832679154104,11.130951692689347,10.464129778222411,10.238757643166849,10.097568161412857,11.944518747751182,10.482184475027601,10.32454233121514,11.513556043954743,13.437903568933802],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 55.23 <br>GDP per capita: 1601.06 <br>Pop.:     1,282,697","Country: Austria <br>Life Expectancy: 66.8 <br>GDP per capita: 6137.08 <br>Pop.:     6,927,772","Country: Belgium <br>Life Expectancy: 68 <br>GDP per capita: 8343.11 <br>Pop.:     8,730,405","Country: Bosnia and Herzegovina <br>Life Expectancy: 53.82 <br>GDP per capita: 973.53 <br>Pop.:     2,791,000","Country: Bulgaria <br>Life Expectancy: 59.6 <br>GDP per capita: 2444.29 <br>Pop.:     7,274,900","Country: Croatia <br>Life Expectancy: 61.21 <br>GDP per capita: 3119.24 <br>Pop.:     3,882,229","Country: Czech Republic <br>Life Expectancy: 66.87 <br>GDP per capita: 6876.14 <br>Pop.:     9,125,183","Country: Denmark <br>Life Expectancy: 70.78 <br>GDP per capita: 9692.39 <br>Pop.:     4,334,000","Country: Finland <br>Life Expectancy: 66.55 <br>GDP per capita: 6424.52 <br>Pop.:     4,090,500","Country: France <br>Life Expectancy: 67.41 <br>GDP per capita: 7029.81 <br>Pop.:    42,459,667","Country: Germany <br>Life Expectancy: 67.5 <br>GDP per capita: 7144.11 <br>Pop.:    69,145,952","Country: Greece <br>Life Expectancy: 65.86 <br>GDP per capita: 3530.69 <br>Pop.:     7,733,250","Country: Hungary <br>Life Expectancy: 64.03 <br>GDP per capita: 5263.67 <br>Pop.:     9,504,000","Country: Iceland <br>Life Expectancy: 72.49 <br>GDP per capita: 7267.69 <br>Pop.:       147,962","Country: Ireland <br>Life Expectancy: 66.91 <br>GDP per capita: 5210.28 <br>Pop.:     2,952,156","Country: Italy <br>Life Expectancy: 65.94 <br>GDP per capita: 4931.4 <br>Pop.:    47,666,000","Country: Montenegro <br>Life Expectancy: 59.16 <br>GDP per capita: 2647.59 <br>Pop.:       413,834","Country: Netherlands <br>Life Expectancy: 72.13 <br>GDP per capita: 8941.57 <br>Pop.:    10,381,988","Country: Norway <br>Life Expectancy: 72.67 <br>GDP per capita: 10095.42 <br>Pop.:     3,327,728","Country: Poland <br>Life Expectancy: 61.31 <br>GDP per capita: 4029.33 <br>Pop.:    25,730,551","Country: Portugal <br>Life Expectancy: 59.82 <br>GDP per capita: 3068.32 <br>Pop.:     8,526,050","Country: Romania <br>Life Expectancy: 61.05 <br>GDP per capita: 3144.61 <br>Pop.:    16,630,000","Country: Serbia <br>Life Expectancy: 58 <br>GDP per capita: 3581.46 <br>Pop.:     6,860,147","Country: Slovak Republic <br>Life Expectancy: 64.36 <br>GDP per capita: 5074.66 <br>Pop.:     3,558,137","Country: Slovenia <br>Life Expectancy: 65.57 <br>GDP per capita: 4215.04 <br>Pop.:     1,489,518","Country: Spain <br>Life Expectancy: 64.94 <br>GDP per capita: 3834.03 <br>Pop.:    28,549,870","Country: Sweden <br>Life Expectancy: 71.86 <br>GDP per capita: 8527.84 <br>Pop.:     7,124,673","Country: Switzerland <br>Life Expectancy: 69.62 <br>GDP per capita: 14734.23 <br>Pop.:     4,815,000","Country: Turkey <br>Life Expectancy: 43.58 <br>GDP per capita: 1969.1 <br>Pop.:    22,235,677","Country: United Kingdom <br>Life Expectancy: 69.18 <br>GDP per capita: 9979.51 <br>Pop.:    50,430,000"],"frame":"1952","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.083452004785734,10.468745388300251,10.591780523848481,10.186398230696833,10.492437920575309,10.26087789900933,10.618725312244932,10.291712631437814,10.275093022506884,12.893904318382232,14.715323704498925,10.523721689583494,10.644580714283491,10.006002920842237,10.197397613435532,13.249252237988841,10.024149486204392,10.704506041618405,10.22303153444337,11.752091728319773,10.577832679154104,11.130951692689347,10.464129778222411,10.238757643166849,10.097568161412857,11.944518747751182,10.482184475027601,10.32454233121514,11.513556043954743,13.437903568933802]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.0017162212897617,4.0235230646803348],"y":[69.120000000000005,69.390000000000001],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[10.589105483467248,10.132054771360233],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 69.12 <br>GDP per capita: 10039.6 <br>Pop.:     8,691,212","Country: New Zealand <br>Life Expectancy: 69.39 <br>GDP per capita: 10556.58 <br>Pop.:     1,994,794"],"frame":"1952","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[10.589105483467248,10.132054771360233]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"frames":[{"name":"1952","data":[{"x":[3.3889902366128295,3.546617951893976,3.0264320126717377,2.9300526050205478,2.7350039250646971,2.5305793268568042,3.0691749464286691,3.029915447835549,3.0713907290818487,3.042571943572232,2.8923964580961394,3.3274859174242151,3.1425755133131092,3.4264347203837331,3.1519280501569278,2.5747754426179159,2.5171174236159328,2.5588840279669709,3.6328090876363524,2.6859482337800413,2.9596608637313313,2.7077374684251021,2.4769045152043669,2.9312243461536549,2.4754477554867704,2.7601004101431883,3.3779521224475015,3.1592698569002877,2.56722061382276,2.6554620948372682,2.8710565594093267,3.2940153194906676,3.2274248143258331,2.6707337315928892,3.3844932769166256,2.8818862174230904,3.0323293453507603,3.4343908858518062,2.6931321343486228,2.9442771161033847,3.1614749102802429,2.9443779036382201,3.0552826850697294,3.6744289754841963,3.2084389723810651,3.0600843443064192,2.8553071488998873,2.9344018133538139,3.1668667439061169,2.8661416540551472,3.0597106180244795,2.609470734853601],"y":[43.076999999999998,30.015000000000001,38.222999999999999,47.622,31.975000000000001,39.030999999999999,38.523000000000003,35.463000000000001,38.091999999999999,40.715000000000003,39.143000000000001,42.110999999999997,40.476999999999997,34.811999999999998,41.893000000000001,34.481999999999999,35.927999999999997,34.078000000000003,37.003,30,43.149000000000001,33.609000000000002,32.5,42.270000000000003,42.137999999999998,38.479999999999997,42.722999999999999,36.680999999999997,36.256,33.685000000000002,40.542999999999999,50.985999999999997,42.872999999999998,31.286000000000001,41.725000000000001,37.444000000000003,36.323999999999998,52.723999999999997,40,46.470999999999997,37.277999999999999,30.331,32.978000000000002,45.009,38.634999999999998,41.406999999999996,41.215000000000003,38.595999999999997,44.600000000000001,39.978000000000002,42.037999999999997,48.451000000000001],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[10.629259618945621,10.284757308036966,10.114549306559425,10.026092922527592,10.30099360804077,10.162824868184376,10.337787988900558,10.084066145406517,10.178990185053525,10.00641066434841,10.958271908306536,10.054252546321832,10.199094588124854,10.000214177958215,11.512711890676478,10.010712515320479,10.094103774923674,11.419726168376613,10.024618247905162,10.01530976533753,10.37682420826115,10.177747092907902,10.035535385761884,10.437094691088317,10.047008307912341,10.054827441459514,10.065503646176497,10.320987168217217,10.195052849389482,10.257870602955506,10.06569659744733,10.031160572317752,10.67428558631673,10.435884565148502,10.029063498459834,10.22656294539239,12.256382194309907,10.013492870102452,10.168920476619746,10,10.183981323214891,10.142187272566975,10.16837902545897,10.969528877920411,10.576373224953816,10.015714027939985,10.563968785667058,10.079112205137831,10.244872976723292,10.393464020084254,10.178276122020115,10.206185257252644],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 43.08 <br>GDP per capita: 2449.01 <br>Pop.:     9,279,525","Country: Angola <br>Life Expectancy: 30.02 <br>GDP per capita: 3520.61 <br>Pop.:     4,232,095","Country: Benin <br>Life Expectancy: 38.22 <br>GDP per capita: 1062.75 <br>Pop.:     1,738,315","Country: Botswana <br>Life Expectancy: 47.62 <br>GDP per capita: 851.24 <br>Pop.:       442,308","Country: Burkina Faso <br>Life Expectancy: 31.98 <br>GDP per capita: 543.26 <br>Pop.:     4,469,979","Country: Burundi <br>Life Expectancy: 39.03 <br>GDP per capita: 339.3 <br>Pop.:     2,445,618","Country: Cameroon <br>Life Expectancy: 38.52 <br>GDP per capita: 1172.67 <br>Pop.:     5,009,067","Country: Central African Republic <br>Life Expectancy: 35.46 <br>GDP per capita: 1071.31 <br>Pop.:     1,291,695","Country: Chad <br>Life Expectancy: 38.09 <br>GDP per capita: 1178.67 <br>Pop.:     2,682,462","Country: Comoros <br>Life Expectancy: 40.72 <br>GDP per capita: 1102.99 <br>Pop.:       153,936","Country: Congo, Dem. Rep. <br>Life Expectancy: 39.14 <br>GDP per capita: 780.54 <br>Pop.:    14,100,005","Country: Congo, Rep. <br>Life Expectancy: 42.11 <br>GDP per capita: 2125.62 <br>Pop.:       854,885","Country: Cote d'Ivoire <br>Life Expectancy: 40.48 <br>GDP per capita: 1388.59 <br>Pop.:     2,977,019","Country: Djibouti <br>Life Expectancy: 34.81 <br>GDP per capita: 2669.53 <br>Pop.:        63,149","Country: Egypt <br>Life Expectancy: 41.89 <br>GDP per capita: 1418.82 <br>Pop.:    22,223,309","Country: Equatorial Guinea <br>Life Expectancy: 34.48 <br>GDP per capita: 375.64 <br>Pop.:       216,964","Country: Eritrea <br>Life Expectancy: 35.93 <br>GDP per capita: 328.94 <br>Pop.:     1,438,760","Country: Ethiopia <br>Life Expectancy: 34.08 <br>GDP per capita: 362.15 <br>Pop.:    20,860,941","Country: Gabon <br>Life Expectancy: 37 <br>GDP per capita: 4293.48 <br>Pop.:       420,702","Country: Gambia <br>Life Expectancy: 30 <br>GDP per capita: 485.23 <br>Pop.:       284,320","Country: Ghana <br>Life Expectancy: 43.15 <br>GDP per capita: 911.3 <br>Pop.:     5,581,001","Country: Guinea <br>Life Expectancy: 33.61 <br>GDP per capita: 510.2 <br>Pop.:     2,664,249","Country: Guinea-Bissau <br>Life Expectancy: 32.5 <br>GDP per capita: 299.85 <br>Pop.:       580,653","Country: Kenya <br>Life Expectancy: 42.27 <br>GDP per capita: 853.54 <br>Pop.:     6,464,046","Country: Lesotho <br>Life Expectancy: 42.14 <br>GDP per capita: 298.85 <br>Pop.:       748,747","Country: Liberia <br>Life Expectancy: 38.48 <br>GDP per capita: 575.57 <br>Pop.:       863,308","Country: Libya <br>Life Expectancy: 42.72 <br>GDP per capita: 2387.55 <br>Pop.:     1,019,729","Country: Madagascar <br>Life Expectancy: 36.68 <br>GDP per capita: 1443.01 <br>Pop.:     4,762,912","Country: Malawi <br>Life Expectancy: 36.26 <br>GDP per capita: 369.17 <br>Pop.:     2,917,802","Country: Mali <br>Life Expectancy: 33.69 <br>GDP per capita: 452.34 <br>Pop.:     3,838,168","Country: Mauritania <br>Life Expectancy: 40.54 <br>GDP per capita: 743.12 <br>Pop.:     1,022,556","Country: Mauritius <br>Life Expectancy: 50.99 <br>GDP per capita: 1967.96 <br>Pop.:       516,556","Country: Morocco <br>Life Expectancy: 42.87 <br>GDP per capita: 1688.2 <br>Pop.:     9,939,217","Country: Mozambique <br>Life Expectancy: 31.29 <br>GDP per capita: 468.53 <br>Pop.:     6,446,316","Country: Namibia <br>Life Expectancy: 41.73 <br>GDP per capita: 2423.78 <br>Pop.:       485,831","Country: Niger <br>Life Expectancy: 37.44 <br>GDP per capita: 761.88 <br>Pop.:     3,379,468","Country: Nigeria <br>Life Expectancy: 36.32 <br>GDP per capita: 1077.28 <br>Pop.:    33,119,096","Country: Reunion <br>Life Expectancy: 52.72 <br>GDP per capita: 2718.89 <br>Pop.:       257,700","Country: Rwanda <br>Life Expectancy: 40 <br>GDP per capita: 493.32 <br>Pop.:     2,534,927","Country: Sao Tome and Principe <br>Life Expectancy: 46.47 <br>GDP per capita: 879.58 <br>Pop.:        60,011","Country: Senegal <br>Life Expectancy: 37.28 <br>GDP per capita: 1450.36 <br>Pop.:     2,755,589","Country: Sierra Leone <br>Life Expectancy: 30.33 <br>GDP per capita: 879.79 <br>Pop.:     2,143,249","Country: Somalia <br>Life Expectancy: 32.98 <br>GDP per capita: 1135.75 <br>Pop.:     2,526,994","Country: South Africa <br>Life Expectancy: 45.01 <br>GDP per capita: 4725.3 <br>Pop.:    14,264,935","Country: Sudan <br>Life Expectancy: 38.63 <br>GDP per capita: 1615.99 <br>Pop.:     8,504,667","Country: Swaziland <br>Life Expectancy: 41.41 <br>GDP per capita: 1148.38 <br>Pop.:       290,243","Country: Tanzania <br>Life Expectancy: 41.22 <br>GDP per capita: 716.65 <br>Pop.:     8,322,925","Country: Togo <br>Life Expectancy: 38.6 <br>GDP per capita: 859.81 <br>Pop.:     1,219,113","Country: Tunisia <br>Life Expectancy: 44.6 <br>GDP per capita: 1468.48 <br>Pop.:     3,647,735","Country: Uganda <br>Life Expectancy: 39.98 <br>GDP per capita: 734.75 <br>Pop.:     5,824,797","Country: Zambia <br>Life Expectancy: 42.04 <br>GDP per capita: 1147.39 <br>Pop.:     2,672,000","Country: Zimbabwe <br>Life Expectancy: 48.45 <br>GDP per capita: 406.88 <br>Pop.:     3,080,907"],"frame":"1952","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[10.629259618945621,10.284757308036966,10.114549306559425,10.026092922527592,10.30099360804077,10.162824868184376,10.337787988900558,10.084066145406517,10.178990185053525,10.00641066434841,10.958271908306536,10.054252546321832,10.199094588124854,10.000214177958215,11.512711890676478,10.010712515320479,10.094103774923674,11.419726168376613,10.024618247905162,10.01530976533753,10.37682420826115,10.177747092907902,10.035535385761884,10.437094691088317,10.047008307912341,10.054827441459514,10.065503646176497,10.320987168217217,10.195052849389482,10.257870602955506,10.06569659744733,10.031160572317752,10.67428558631673,10.435884565148502,10.029063498459834,10.22656294539239,12.256382194309907,10.013492870102452,10.168920476619746,10,10.183981323214891,10.142187272566975,10.16837902545897,10.969528877920411,10.576373224953816,10.015714027939985,10.563968785667058,10.079112205137831,10.244872976723292,10.393464020084254,10.178276122020115,10.206185257252644]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.7716841063854578,3.4277013118156043,3.3240651209271301,4.055652015799267,3.5954938837938353,3.3312480945543395,3.4194616385247927,3.7471428178485775,3.1454192899578319,3.5468030038250093,3.4840581192497848,3.3852912098780523,3.2649044228437729,3.3414199233324244,3.4621779317126391,3.5413452520681394,3.4930903760317378,3.3945182793314443,3.2905484898372737,3.5750172627178163,3.4888269675210974,3.4804772115240326,4.1458326795437701,3.7571504724556046,3.8859150311115758],"y":[62.484999999999999,40.414000000000001,50.917000000000002,68.75,54.744999999999997,50.643000000000001,57.206000000000003,59.420999999999999,45.927999999999997,48.356999999999999,45.262,42.023000000000003,37.579000000000001,41.911999999999999,58.530000000000001,50.789000000000001,42.314,55.191000000000003,62.649000000000001,43.902000000000001,64.280000000000001,59.100000000000001,68.439999999999998,66.070999999999998,55.088000000000001],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[11.21606019812705,10.192699007692559,13.859199393585619,11.005064741453392,10.431195787839556,10.838881415457701,10.059127995624314,10.405954321662737,10.165945942012687,10.238117156882629,10.135335762000556,10.210654055097176,10.214415273944638,10.099474809361464,10.093239350500223,12.053344561308055,10.075472749667506,10.060067361857236,10.102097294921846,10.543682283554137,10.147903530750032,10.041145578761045,20.749371197304647,10.14967572026088,10.367170979719349],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 62.48 <br>GDP per capita: 5911.32 <br>Pop.:    17,876,956","Country: Bolivia <br>Life Expectancy: 40.41 <br>GDP per capita: 2677.33 <br>Pop.:     2,883,315","Country: Brazil <br>Life Expectancy: 50.92 <br>GDP per capita: 2108.94 <br>Pop.:    56,602,560","Country: Canada <br>Life Expectancy: 68.75 <br>GDP per capita: 11367.16 <br>Pop.:    14,785,584","Country: Chile <br>Life Expectancy: 54.74 <br>GDP per capita: 3939.98 <br>Pop.:     6,377,619","Country: Colombia <br>Life Expectancy: 50.64 <br>GDP per capita: 2144.12 <br>Pop.:    12,350,771","Country: Costa Rica <br>Life Expectancy: 57.21 <br>GDP per capita: 2627.01 <br>Pop.:       926,317","Country: Cuba <br>Life Expectancy: 59.42 <br>GDP per capita: 5586.54 <br>Pop.:     6,007,797","Country: Dominican Republic <br>Life Expectancy: 45.93 <br>GDP per capita: 1397.72 <br>Pop.:     2,491,346","Country: Ecuador <br>Life Expectancy: 48.36 <br>GDP per capita: 3522.11 <br>Pop.:     3,548,753","Country: El Salvador <br>Life Expectancy: 45.26 <br>GDP per capita: 3048.3 <br>Pop.:     2,042,865","Country: Guatemala <br>Life Expectancy: 42.02 <br>GDP per capita: 2428.24 <br>Pop.:     3,146,381","Country: Haiti <br>Life Expectancy: 37.58 <br>GDP per capita: 1840.37 <br>Pop.:     3,201,488","Country: Honduras <br>Life Expectancy: 41.91 <br>GDP per capita: 2194.93 <br>Pop.:     1,517,453","Country: Jamaica <br>Life Expectancy: 58.53 <br>GDP per capita: 2898.53 <br>Pop.:     1,426,095","Country: Mexico <br>Life Expectancy: 50.79 <br>GDP per capita: 3478.13 <br>Pop.:    30,144,317","Country: Nicaragua <br>Life Expectancy: 42.31 <br>GDP per capita: 3112.36 <br>Pop.:     1,165,790","Country: Panama <br>Life Expectancy: 55.19 <br>GDP per capita: 2480.38 <br>Pop.:       940,080","Country: Paraguay <br>Life Expectancy: 62.65 <br>GDP per capita: 1952.31 <br>Pop.:     1,555,876","Country: Peru <br>Life Expectancy: 43.9 <br>GDP per capita: 3758.52 <br>Pop.:     8,025,700","Country: Puerto Rico <br>Life Expectancy: 64.28 <br>GDP per capita: 3081.96 <br>Pop.:     2,227,000","Country: Trinidad and Tobago <br>Life Expectancy: 59.1 <br>GDP per capita: 3023.27 <br>Pop.:       662,850","Country: United States <br>Life Expectancy: 68.44 <br>GDP per capita: 13990.48 <br>Pop.:   157,553,000","Country: Uruguay <br>Life Expectancy: 66.07 <br>GDP per capita: 5716.77 <br>Pop.:     2,252,965","Country: Venezuela <br>Life Expectancy: 55.09 <br>GDP per capita: 7689.8 <br>Pop.:     5,439,568"],"frame":"1952","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[11.21606019812705,10.192699007692559,13.859199393585619,11.005064741453392,10.431195787839556,10.838881415457701,10.059127995624314,10.405954321662737,10.165945942012687,10.238117156882629,10.135335762000556,10.210654055097176,10.214415273944638,10.099474809361464,10.093239350500223,12.053344561308055,10.075472749667506,10.060067361857236,10.102097294921846,10.543682283554137,10.147903530750032,10.041145578761045,20.749371197304647,10.14967572026088,10.367170979719349]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.8917856507063857,3.9941888591046819,2.8352111067723493,2.5664012923297479,2.6025467916035643,3.4849289266728523,2.7376424130206169,2.8748768833905021,3.4822053422865116,3.6159254503329223,3.6113538549108273,3.5074451677140162,3.1894644312790241,3.0367397532404041,3.0130868621518014,5.0349585749878187,3.6843788787613345,3.2627198642560913,2.8957356431821641,2.5198279937757189,2.7370858240682567,3.2620309040668611,2.8354350828905424,3.104787802215522,3.8102025884940609,3.3645769259938039,3.0348417539083994,3.2157658381984016,3.08168852810498,2.8795531210227017,2.7818031025725949,3.1805823984758761,2.8930498767229236],"y":[28.800999999999998,50.939,37.484000000000002,39.417000000000002,44,60.960000000000001,37.372999999999998,37.468000000000004,44.869,45.32,65.390000000000001,63.030000000000001,43.158000000000001,50.055999999999997,47.453000000000003,55.564999999999998,55.927999999999997,48.463000000000001,42.244,36.319000000000003,36.156999999999996,37.578000000000003,43.436,47.752000000000002,39.875,60.396000000000001,57.593000000000004,45.883000000000003,58.5,50.847999999999999,40.411999999999999,43.159999999999997,32.548000000000002],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[10.570958440333994,10.004124939159547,13.196073516337687,10.316272523015931,47.962566414495925,10.141003151025526,35.386025309878448,15.596200380490078,11.174770127735174,10.367320999844319,10.106536334452237,15.89699311991038,10.037396031178993,10.60100034575081,11.425638926987236,10.006824550625852,10.094156261491509,10.456501207090577,10.05055173139184,11.367311607471214,10.62263982736204,10.030565201275845,12.817931410627473,11.527412361357225,10.269303597092721,10.072825215250953,10.540722969369218,10.245815823859932,10.579492046432662,11.448969923046661,11.787329940458308,10.066244600897457,10.334700359049151],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 28.8 <br>GDP per capita: 779.45 <br>Pop.:     8,425,333","Country: Bahrain <br>Life Expectancy: 50.94 <br>GDP per capita: 9867.08 <br>Pop.:       120,447","Country: Bangladesh <br>Life Expectancy: 37.48 <br>GDP per capita: 684.24 <br>Pop.:    46,886,859","Country: Cambodia <br>Life Expectancy: 39.42 <br>GDP per capita: 368.47 <br>Pop.:     4,693,836","Country: China <br>Life Expectancy: 44 <br>GDP per capita: 400.45 <br>Pop.:   556,263,527","Country: Hong Kong, China <br>Life Expectancy: 60.96 <br>GDP per capita: 3054.42 <br>Pop.:     2,125,900","Country: India <br>Life Expectancy: 37.37 <br>GDP per capita: 546.57 <br>Pop.:   372,000,000","Country: Indonesia <br>Life Expectancy: 37.47 <br>GDP per capita: 749.68 <br>Pop.:    82,052,000","Country: Iran <br>Life Expectancy: 44.87 <br>GDP per capita: 3035.33 <br>Pop.:    17,272,000","Country: Iraq <br>Life Expectancy: 45.32 <br>GDP per capita: 4129.77 <br>Pop.:     5,441,766","Country: Israel <br>Life Expectancy: 65.39 <br>GDP per capita: 4086.52 <br>Pop.:     1,620,914","Country: Japan <br>Life Expectancy: 63.03 <br>GDP per capita: 3216.96 <br>Pop.:    86,459,025","Country: Jordan <br>Life Expectancy: 43.16 <br>GDP per capita: 1546.91 <br>Pop.:       607,914","Country: Korea, Dem. Rep. <br>Life Expectancy: 50.06 <br>GDP per capita: 1088.28 <br>Pop.:     8,865,488","Country: Korea, Rep. <br>Life Expectancy: 47.45 <br>GDP per capita: 1030.59 <br>Pop.:    20,947,571","Country: Kuwait <br>Life Expectancy: 55.56 <br>GDP per capita: 108382.35 <br>Pop.:       160,000","Country: Lebanon <br>Life Expectancy: 55.93 <br>GDP per capita: 4834.8 <br>Pop.:     1,439,529","Country: Malaysia <br>Life Expectancy: 48.46 <br>GDP per capita: 1831.13 <br>Pop.:     6,748,378","Country: Mongolia <br>Life Expectancy: 42.24 <br>GDP per capita: 786.57 <br>Pop.:       800,663","Country: Myanmar <br>Life Expectancy: 36.32 <br>GDP per capita: 331 <br>Pop.:    20,092,996","Country: Nepal <br>Life Expectancy: 36.16 <br>GDP per capita: 545.87 <br>Pop.:     9,182,536","Country: Oman <br>Life Expectancy: 37.58 <br>GDP per capita: 1828.23 <br>Pop.:       507,833","Country: Pakistan <br>Life Expectancy: 43.44 <br>GDP per capita: 684.6 <br>Pop.:    41,346,560","Country: Philippines <br>Life Expectancy: 47.75 <br>GDP per capita: 1272.88 <br>Pop.:    22,438,691","Country: Saudi Arabia <br>Life Expectancy: 39.88 <br>GDP per capita: 6459.55 <br>Pop.:     4,005,677","Country: Singapore <br>Life Expectancy: 60.4 <br>GDP per capita: 2315.14 <br>Pop.:     1,127,000","Country: Sri Lanka <br>Life Expectancy: 57.59 <br>GDP per capita: 1083.53 <br>Pop.:     7,982,342","Country: Syria <br>Life Expectancy: 45.88 <br>GDP per capita: 1643.49 <br>Pop.:     3,661,549","Country: Taiwan <br>Life Expectancy: 58.5 <br>GDP per capita: 1206.95 <br>Pop.:     8,550,362","Country: Thailand <br>Life Expectancy: 50.85 <br>GDP per capita: 757.8 <br>Pop.:    21,289,402","Country: Vietnam <br>Life Expectancy: 40.41 <br>GDP per capita: 605.07 <br>Pop.:    26,246,839","Country: West Bank and Gaza <br>Life Expectancy: 43.16 <br>GDP per capita: 1515.59 <br>Pop.:     1,030,585","Country: Yemen, Rep. <br>Life Expectancy: 32.55 <br>GDP per capita: 781.72 <br>Pop.:     4,963,829"],"frame":"1952","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[10.570958440333994,10.004124939159547,13.196073516337687,10.316272523015931,47.962566414495925,10.141003151025526,35.386025309878448,15.596200380490078,11.174770127735174,10.367320999844319,10.106536334452237,15.89699311991038,10.037396031178993,10.60100034575081,11.425638926987236,10.006824550625852,10.094156261491509,10.456501207090577,10.05055173139184,11.367311607471214,10.62263982736204,10.030565201275845,12.817931410627473,11.527412361357225,10.269303597092721,10.072825215250953,10.540722969369218,10.245815823859932,10.579492046432662,11.448969923046661,11.787329940458308,10.066244600897457,10.334700359049151]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.2044065593569231,3.7879615363271912,3.9213277159305022,2.9883507643539309,3.3881521354267963,3.4940483069265413,3.8373447262436224,3.9864306677903336,3.8078406226448371,3.846943545595249,3.8539483999469684,3.5478595957564281,3.7212889686947199,3.8613963004603242,3.716861090214755,3.6929705967500874,3.422850010494709,3.951413871061022,4.0041244656118469,3.6052328048910161,3.4869006320800371,3.4975672311747799,3.5540600381109928,3.7054068733390868,3.6248018797427801,3.5836560439073355,3.930839280912017,4.1683275259262418,3.2942679883231207,3.9991091518444533],"y":[55.229999999999997,66.799999999999997,68,53.82,59.600000000000001,61.210000000000001,66.870000000000005,70.780000000000001,66.549999999999997,67.409999999999997,67.5,65.859999999999999,64.030000000000001,72.489999999999995,66.909999999999997,65.939999999999998,59.164000000000001,72.129999999999995,72.670000000000002,61.310000000000002,59.82,61.049999999999997,57.996000000000002,64.359999999999999,65.569999999999993,64.939999999999998,71.859999999999999,69.620000000000005,43.585000000000001,69.180000000000007],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.083452004785734,10.468745388300251,10.591780523848481,10.186398230696833,10.492437920575309,10.26087789900933,10.618725312244932,10.291712631437814,10.275093022506884,12.893904318382232,14.715323704498925,10.523721689583494,10.644580714283491,10.006002920842237,10.197397613435532,13.249252237988841,10.024149486204392,10.704506041618405,10.22303153444337,11.752091728319773,10.577832679154104,11.130951692689347,10.464129778222411,10.238757643166849,10.097568161412857,11.944518747751182,10.482184475027601,10.32454233121514,11.513556043954743,13.437903568933802],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 55.23 <br>GDP per capita: 1601.06 <br>Pop.:     1,282,697","Country: Austria <br>Life Expectancy: 66.8 <br>GDP per capita: 6137.08 <br>Pop.:     6,927,772","Country: Belgium <br>Life Expectancy: 68 <br>GDP per capita: 8343.11 <br>Pop.:     8,730,405","Country: Bosnia and Herzegovina <br>Life Expectancy: 53.82 <br>GDP per capita: 973.53 <br>Pop.:     2,791,000","Country: Bulgaria <br>Life Expectancy: 59.6 <br>GDP per capita: 2444.29 <br>Pop.:     7,274,900","Country: Croatia <br>Life Expectancy: 61.21 <br>GDP per capita: 3119.24 <br>Pop.:     3,882,229","Country: Czech Republic <br>Life Expectancy: 66.87 <br>GDP per capita: 6876.14 <br>Pop.:     9,125,183","Country: Denmark <br>Life Expectancy: 70.78 <br>GDP per capita: 9692.39 <br>Pop.:     4,334,000","Country: Finland <br>Life Expectancy: 66.55 <br>GDP per capita: 6424.52 <br>Pop.:     4,090,500","Country: France <br>Life Expectancy: 67.41 <br>GDP per capita: 7029.81 <br>Pop.:    42,459,667","Country: Germany <br>Life Expectancy: 67.5 <br>GDP per capita: 7144.11 <br>Pop.:    69,145,952","Country: Greece <br>Life Expectancy: 65.86 <br>GDP per capita: 3530.69 <br>Pop.:     7,733,250","Country: Hungary <br>Life Expectancy: 64.03 <br>GDP per capita: 5263.67 <br>Pop.:     9,504,000","Country: Iceland <br>Life Expectancy: 72.49 <br>GDP per capita: 7267.69 <br>Pop.:       147,962","Country: Ireland <br>Life Expectancy: 66.91 <br>GDP per capita: 5210.28 <br>Pop.:     2,952,156","Country: Italy <br>Life Expectancy: 65.94 <br>GDP per capita: 4931.4 <br>Pop.:    47,666,000","Country: Montenegro <br>Life Expectancy: 59.16 <br>GDP per capita: 2647.59 <br>Pop.:       413,834","Country: Netherlands <br>Life Expectancy: 72.13 <br>GDP per capita: 8941.57 <br>Pop.:    10,381,988","Country: Norway <br>Life Expectancy: 72.67 <br>GDP per capita: 10095.42 <br>Pop.:     3,327,728","Country: Poland <br>Life Expectancy: 61.31 <br>GDP per capita: 4029.33 <br>Pop.:    25,730,551","Country: Portugal <br>Life Expectancy: 59.82 <br>GDP per capita: 3068.32 <br>Pop.:     8,526,050","Country: Romania <br>Life Expectancy: 61.05 <br>GDP per capita: 3144.61 <br>Pop.:    16,630,000","Country: Serbia <br>Life Expectancy: 58 <br>GDP per capita: 3581.46 <br>Pop.:     6,860,147","Country: Slovak Republic <br>Life Expectancy: 64.36 <br>GDP per capita: 5074.66 <br>Pop.:     3,558,137","Country: Slovenia <br>Life Expectancy: 65.57 <br>GDP per capita: 4215.04 <br>Pop.:     1,489,518","Country: Spain <br>Life Expectancy: 64.94 <br>GDP per capita: 3834.03 <br>Pop.:    28,549,870","Country: Sweden <br>Life Expectancy: 71.86 <br>GDP per capita: 8527.84 <br>Pop.:     7,124,673","Country: Switzerland <br>Life Expectancy: 69.62 <br>GDP per capita: 14734.23 <br>Pop.:     4,815,000","Country: Turkey <br>Life Expectancy: 43.58 <br>GDP per capita: 1969.1 <br>Pop.:    22,235,677","Country: United Kingdom <br>Life Expectancy: 69.18 <br>GDP per capita: 9979.51 <br>Pop.:    50,430,000"],"frame":"1952","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.083452004785734,10.468745388300251,10.591780523848481,10.186398230696833,10.492437920575309,10.26087789900933,10.618725312244932,10.291712631437814,10.275093022506884,12.893904318382232,14.715323704498925,10.523721689583494,10.644580714283491,10.006002920842237,10.197397613435532,13.249252237988841,10.024149486204392,10.704506041618405,10.22303153444337,11.752091728319773,10.577832679154104,11.130951692689347,10.464129778222411,10.238757643166849,10.097568161412857,11.944518747751182,10.482184475027601,10.32454233121514,11.513556043954743,13.437903568933802]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.0017162212897617,4.0235230646803348],"y":[69.120000000000005,69.390000000000001],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[10.589105483467248,10.132054771360233],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 69.12 <br>GDP per capita: 10039.6 <br>Pop.:     8,691,212","Country: New Zealand <br>Life Expectancy: 69.39 <br>GDP per capita: 10556.58 <br>Pop.:     1,994,794"],"frame":"1952","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[10.589105483467248,10.132054771360233]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1957","data":[{"x":[3.4791397930614889,3.5829651746839484,2.9820907283067597,2.9629526766648238,2.7904142821961777,2.579285733426615,3.1182806352651684,3.0758549924572889,3.1167722589684561,3.0831974128542199,2.9570611933808388,3.3645616081432754,3.1763505784756041,3.4571199386262572,3.1640300705285775,2.6295078732079058,2.5367627728484763,2.5785293771009474,3.6968976609894515,2.7167766269391604,3.0185180637431586,2.7606237688310094,2.6352730393605079,2.9751735977866027,2.526335548516244,2.7930706123361673,3.5376030767831246,3.2011793078990514,2.6194792285490958,2.6905346859018695,2.9274320948440957,3.308359058117067,3.2153737648155309,2.6951197595661833,3.4185412569200593,2.9219586187228557,3.0416265738404165,3.4423938179149474,2.7326264457827985,2.9348704229865588,3.1952499395624567,3.0019432123860286,3.0997315289484946,3.7393432090218073,3.2480559643510523,3.0950676078637653,2.8441885488321117,2.9665679866793528,3.1446465740314187,2.8889491191950931,3.1179195236089994,2.7149700547261855],"y":[45.685000000000002,31.998999999999999,40.357999999999997,49.618000000000002,34.905999999999999,40.533000000000001,40.427999999999997,37.463999999999999,39.881,42.460000000000001,40.652000000000001,45.052999999999997,42.469000000000001,37.328000000000003,44.444000000000003,35.982999999999997,38.046999999999997,36.667000000000002,38.999000000000002,32.064999999999998,44.779000000000003,34.558,33.488999999999997,44.686,45.046999999999997,39.485999999999997,45.289000000000001,38.865000000000002,37.207000000000001,35.307000000000002,42.338000000000001,58.088999999999999,45.423000000000002,33.779000000000003,45.225999999999999,38.597999999999999,37.802,55.090000000000003,41.5,48.945,39.329000000000001,31.57,34.976999999999997,47.984999999999999,39.624000000000002,43.423999999999999,42.973999999999997,41.207999999999998,47.100000000000001,42.570999999999998,44.076999999999998,50.469000000000001],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[10.696920947656547,10.307230704974348,10.127302928266268,10.028299610726139,10.317608917031814,10.177970212010964,10.361734968412145,10.090931647840824,10.193486647475158,10.007570419563828,11.059144880661634,10.060093161496562,10.22113901486868,10.000808115686826,11.702894273233508,10.011801696919328,10.101191918689942,11.553138492187099,10.025587577211269,10.017960029874647,10.432128738289153,10.192249288582719,10.036930613875914,10.504715204496819,10.051416838345432,10.062515597472647,10.077915388535763,10.349569278168675,10.215763270972918,10.285425436791893,10.069402463100364,10.037525848411793,10.774421835637741,10.476271170392865,10.033312180333928,10.247906754946582,12.533096567166499,10.016973773821046,10.188519670880781,10.000089684460514,10.204386107801229,10.15259101125171,10.185675772542689,11.098295969844939,10.661602469973442,10.018205126448246,10.641087934540446,10.08855378108294,10.265561420836191,10.451527132182735,10.201755158867099,10.244777763768637],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 45.69 <br>GDP per capita: 3013.98 <br>Pop.:    10,270,856","Country: Angola <br>Life Expectancy: 32 <br>GDP per capita: 3827.94 <br>Pop.:     4,561,361","Country: Benin <br>Life Expectancy: 40.36 <br>GDP per capita: 959.6 <br>Pop.:     1,925,173","Country: Botswana <br>Life Expectancy: 49.62 <br>GDP per capita: 918.23 <br>Pop.:       474,639","Country: Burkina Faso <br>Life Expectancy: 34.91 <br>GDP per capita: 617.18 <br>Pop.:     4,713,416","Country: Burundi <br>Life Expectancy: 40.53 <br>GDP per capita: 379.56 <br>Pop.:     2,667,518","Country: Cameroon <br>Life Expectancy: 40.43 <br>GDP per capita: 1313.05 <br>Pop.:     5,359,923","Country: Central African Republic <br>Life Expectancy: 37.46 <br>GDP per capita: 1190.84 <br>Pop.:     1,392,284","Country: Chad <br>Life Expectancy: 39.88 <br>GDP per capita: 1308.5 <br>Pop.:     2,894,855","Country: Comoros <br>Life Expectancy: 42.46 <br>GDP per capita: 1211.15 <br>Pop.:       170,928","Country: Congo, Dem. Rep. <br>Life Expectancy: 40.65 <br>GDP per capita: 905.86 <br>Pop.:    15,577,932","Country: Congo, Rep. <br>Life Expectancy: 45.05 <br>GDP per capita: 2315.06 <br>Pop.:       940,458","Country: Cote d'Ivoire <br>Life Expectancy: 42.47 <br>GDP per capita: 1500.9 <br>Pop.:     3,300,000","Country: Djibouti <br>Life Expectancy: 37.33 <br>GDP per capita: 2864.97 <br>Pop.:        71,851","Country: Egypt <br>Life Expectancy: 44.44 <br>GDP per capita: 1458.92 <br>Pop.:    25,009,741","Country: Equatorial Guinea <br>Life Expectancy: 35.98 <br>GDP per capita: 426.1 <br>Pop.:       232,922","Country: Eritrea <br>Life Expectancy: 38.05 <br>GDP per capita: 344.16 <br>Pop.:     1,542,611","Country: Ethiopia <br>Life Expectancy: 36.67 <br>GDP per capita: 378.9 <br>Pop.:    22,815,614","Country: Gabon <br>Life Expectancy: 39 <br>GDP per capita: 4976.2 <br>Pop.:       434,904","Country: Gambia <br>Life Expectancy: 32.06 <br>GDP per capita: 520.93 <br>Pop.:       323,150","Country: Ghana <br>Life Expectancy: 44.78 <br>GDP per capita: 1043.56 <br>Pop.:     6,391,288","Country: Guinea <br>Life Expectancy: 34.56 <br>GDP per capita: 576.27 <br>Pop.:     2,876,726","Country: Guinea-Bissau <br>Life Expectancy: 33.49 <br>GDP per capita: 431.79 <br>Pop.:       601,095","Country: Kenya <br>Life Expectancy: 44.69 <br>GDP per capita: 944.44 <br>Pop.:     7,454,779","Country: Lesotho <br>Life Expectancy: 45.05 <br>GDP per capita: 336 <br>Pop.:       813,338","Country: Liberia <br>Life Expectancy: 39.49 <br>GDP per capita: 620.97 <br>Pop.:       975,950","Country: Libya <br>Life Expectancy: 45.29 <br>GDP per capita: 3448.28 <br>Pop.:     1,201,578","Country: Madagascar <br>Life Expectancy: 38.87 <br>GDP per capita: 1589.2 <br>Pop.:     5,181,679","Country: Malawi <br>Life Expectancy: 37.21 <br>GDP per capita: 416.37 <br>Pop.:     3,221,238","Country: Mali <br>Life Expectancy: 35.31 <br>GDP per capita: 490.38 <br>Pop.:     4,241,884","Country: Mauritania <br>Life Expectancy: 42.34 <br>GDP per capita: 846.12 <br>Pop.:     1,076,852","Country: Mauritius <br>Life Expectancy: 58.09 <br>GDP per capita: 2034.04 <br>Pop.:       609,816","Country: Morocco <br>Life Expectancy: 45.42 <br>GDP per capita: 1642 <br>Pop.:    11,406,350","Country: Mozambique <br>Life Expectancy: 33.78 <br>GDP per capita: 495.59 <br>Pop.:     7,038,035","Country: Namibia <br>Life Expectancy: 45.23 <br>GDP per capita: 2621.45 <br>Pop.:       548,080","Country: Niger <br>Life Expectancy: 38.6 <br>GDP per capita: 835.52 <br>Pop.:     3,692,184","Country: Nigeria <br>Life Expectancy: 37.8 <br>GDP per capita: 1100.59 <br>Pop.:    37,173,340","Country: Reunion <br>Life Expectancy: 55.09 <br>GDP per capita: 2769.45 <br>Pop.:       308,700","Country: Rwanda <br>Life Expectancy: 41.5 <br>GDP per capita: 540.29 <br>Pop.:     2,822,082","Country: Sao Tome and Principe <br>Life Expectancy: 48.94 <br>GDP per capita: 860.74 <br>Pop.:        61,325","Country: Senegal <br>Life Expectancy: 39.33 <br>GDP per capita: 1567.65 <br>Pop.:     3,054,547","Country: Sierra Leone <br>Life Expectancy: 31.57 <br>GDP per capita: 1004.48 <br>Pop.:     2,295,678","Country: Somalia <br>Life Expectancy: 34.98 <br>GDP per capita: 1258.15 <br>Pop.:     2,780,415","Country: South Africa <br>Life Expectancy: 47.98 <br>GDP per capita: 5487.1 <br>Pop.:    16,151,549","Country: Sudan <br>Life Expectancy: 39.62 <br>GDP per capita: 1770.34 <br>Pop.:     9,753,392","Country: Swaziland <br>Life Expectancy: 43.42 <br>GDP per capita: 1244.71 <br>Pop.:       326,741","Country: Tanzania <br>Life Expectancy: 42.97 <br>GDP per capita: 698.54 <br>Pop.:     9,452,826","Country: Togo <br>Life Expectancy: 41.21 <br>GDP per capita: 925.91 <br>Pop.:     1,357,445","Country: Tunisia <br>Life Expectancy: 47.1 <br>GDP per capita: 1395.23 <br>Pop.:     3,950,849","Country: Uganda <br>Life Expectancy: 42.57 <br>GDP per capita: 774.37 <br>Pop.:     6,675,501","Country: Zambia <br>Life Expectancy: 44.08 <br>GDP per capita: 1311.96 <br>Pop.:     3,016,000","Country: Zimbabwe <br>Life Expectancy: 50.47 <br>GDP per capita: 518.76 <br>Pop.:     3,646,340"],"frame":"1957","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[10.696920947656547,10.307230704974348,10.127302928266268,10.028299610726139,10.317608917031814,10.177970212010964,10.361734968412145,10.090931647840824,10.193486647475158,10.007570419563828,11.059144880661634,10.060093161496562,10.22113901486868,10.000808115686826,11.702894273233508,10.011801696919328,10.101191918689942,11.553138492187099,10.025587577211269,10.017960029874647,10.432128738289153,10.192249288582719,10.036930613875914,10.504715204496819,10.051416838345432,10.062515597472647,10.077915388535763,10.349569278168675,10.215763270972918,10.285425436791893,10.069402463100364,10.037525848411793,10.774421835637741,10.476271170392865,10.033312180333928,10.247906754946582,12.533096567166499,10.016973773821046,10.188519670880781,10.000089684460514,10.204386107801229,10.15259101125171,10.185675772542689,11.098295969844939,10.661602469973442,10.018205126448246,10.641087934540446,10.08855378108294,10.265561420836191,10.451527132182735,10.201755158867099,10.244777763768637]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.8361250424229789,3.3279076025100207,3.3957396917069675,4.0965607018881638,3.635043471117223,3.3661997904003629,3.4756727573011919,3.7847723244190861,3.1887606351630398,3.5775546015165745,3.5342194914067324,3.417829604790855,3.2372641419627359,3.3464483682981361,3.6772898550227877,3.6161126598673863,3.5387516308065674,3.4715558614890494,3.3109384668258355,3.6279039558648574,3.5918607725416565,3.6128255258058335,4.171642426943845,3.7889296970887489,3.9913353679221744],"y":[64.399000000000001,41.890000000000001,53.284999999999997,69.959999999999994,56.073999999999998,55.118000000000002,60.026000000000003,62.325000000000003,49.828000000000003,51.356000000000002,48.57,44.142000000000003,40.695999999999998,44.664999999999999,62.609999999999999,55.189999999999998,45.432000000000002,59.201000000000001,63.195999999999998,46.262999999999998,68.540000000000006,61.799999999999997,69.489999999999995,67.043999999999997,57.906999999999996],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[11.334382394799345,10.215114867339063,14.469969066255199,11.156898349007745,10.476980387462275,10.984616752709133,10.071821895943829,10.449155408196118,10.195420323617343,10.27290107695938,10.156694860229905,10.244404829299647,10.235315234148203,10.116738521986365,10.10067858777097,12.385820759387055,10.088648175001426,10.068491558374317,10.116773467529578,10.620152960540654,10.150155880215005,10.048110798848937,21.734330443638488,10.161414829166288,10.45338136181652],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 64.4 <br>GDP per capita: 6856.86 <br>Pop.:    19,610,538","Country: Bolivia <br>Life Expectancy: 41.89 <br>GDP per capita: 2127.69 <br>Pop.:     3,211,738","Country: Brazil <br>Life Expectancy: 53.28 <br>GDP per capita: 2487.37 <br>Pop.:    65,551,171","Country: Canada <br>Life Expectancy: 69.96 <br>GDP per capita: 12489.95 <br>Pop.:    17,010,154","Country: Chile <br>Life Expectancy: 56.07 <br>GDP per capita: 4315.62 <br>Pop.:     7,048,426","Country: Colombia <br>Life Expectancy: 55.12 <br>GDP per capita: 2323.81 <br>Pop.:    14,485,993","Country: Costa Rica <br>Life Expectancy: 60.03 <br>GDP per capita: 2990.01 <br>Pop.:     1,112,300","Country: Cuba <br>Life Expectancy: 62.33 <br>GDP per capita: 6092.17 <br>Pop.:     6,640,752","Country: Dominican Republic <br>Life Expectancy: 49.83 <br>GDP per capita: 1544.4 <br>Pop.:     2,923,186","Country: Ecuador <br>Life Expectancy: 51.36 <br>GDP per capita: 3780.55 <br>Pop.:     4,058,385","Country: El Salvador <br>Life Expectancy: 48.57 <br>GDP per capita: 3421.52 <br>Pop.:     2,355,805","Country: Guatemala <br>Life Expectancy: 44.14 <br>GDP per capita: 2617.16 <br>Pop.:     3,640,876","Country: Haiti <br>Life Expectancy: 40.7 <br>GDP per capita: 1726.89 <br>Pop.:     3,507,701","Country: Honduras <br>Life Expectancy: 44.66 <br>GDP per capita: 2220.49 <br>Pop.:     1,770,390","Country: Jamaica <br>Life Expectancy: 62.61 <br>GDP per capita: 4756.53 <br>Pop.:     1,535,090","Country: Mexico <br>Life Expectancy: 55.19 <br>GDP per capita: 4131.55 <br>Pop.:    35,015,548","Country: Nicaragua <br>Life Expectancy: 45.43 <br>GDP per capita: 3457.42 <br>Pop.:     1,358,828","Country: Panama <br>Life Expectancy: 59.2 <br>GDP per capita: 2961.8 <br>Pop.:     1,063,506","Country: Paraguay <br>Life Expectancy: 63.2 <br>GDP per capita: 2046.15 <br>Pop.:     1,770,902","Country: Peru <br>Life Expectancy: 46.26 <br>GDP per capita: 4245.26 <br>Pop.:     9,146,100","Country: Puerto Rico <br>Life Expectancy: 68.54 <br>GDP per capita: 3907.16 <br>Pop.:     2,260,000","Country: Trinidad and Tobago <br>Life Expectancy: 61.8 <br>GDP per capita: 4100.39 <br>Pop.:       764,900","Country: United States <br>Life Expectancy: 69.49 <br>GDP per capita: 14847.13 <br>Pop.:   171,984,000","Country: Uruguay <br>Life Expectancy: 67.04 <br>GDP per capita: 6150.77 <br>Pop.:     2,424,959","Country: Venezuela <br>Life Expectancy: 57.91 <br>GDP per capita: 9802.47 <br>Pop.:     6,702,668"],"frame":"1957","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[11.334382394799345,10.215114867339063,14.469969066255199,11.156898349007745,10.476980387462275,10.984616752709133,10.071821895943829,10.449155408196118,10.195420323617343,10.27290107695938,10.156694860229905,10.244404829299647,10.235315234148203,10.116738521986365,10.10067858777097,12.385820759387055,10.088648175001426,10.068491558374317,10.116773467529578,10.620152960540654,10.150155880215005,10.048110798848937,21.734330443638488,10.161414829166288,10.45338136181652]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.914265405417257,4.0657962273129957,2.820620084228771,2.6375280902306697,2.7604126822060184,3.559796117967275,2.7708976440255548,2.9339427396180775,3.5172299066284571,3.7944415866547452,3.7312081638283052,3.6352518968467953,3.2755602459192374,3.1962134080936724,3.1724842828549011,5.0550843678476554,3.7846020980504753,3.2576946487462699,2.9603102579862983,2.5440680443502757,2.7766549602495685,3.3507801974699909,2.8733691617117723,3.189755481945582,3.911561940355254,3.4537928088356931,3.0304161713012827,3.3257690427500282,3.1783613920918978,2.8995892993082846,2.8301300424480327,3.2617546499422398,2.905704401680433],"y":[30.332000000000001,53.832000000000001,39.347999999999999,41.366,50.548960000000001,64.75,40.249000000000002,39.917999999999999,47.180999999999997,48.436999999999998,67.840000000000003,65.5,45.668999999999997,54.081000000000003,52.680999999999997,58.033000000000001,59.488999999999997,52.101999999999997,45.247999999999998,41.905000000000001,37.686,40.079999999999998,45.557000000000002,51.334000000000003,42.868000000000002,63.179000000000002,61.456000000000003,48.283999999999999,62.399999999999999,53.630000000000003,42.887,45.670999999999999,33.969999999999999],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[10.626625666878871,10.005367690040099,13.501752079518614,10.35918319297436,53.500921273496438,10.182664790826106,37.911386831211132,16.147138710225143,11.346767723242158,10.422392787094275,10.128615297221192,16.245355411777886,10.046858970317512,10.638259188371482,11.53921064562585,10.010431449408456,10.108344902819596,10.524130183872824,10.056112372702772,11.479167923106701,10.656752820310286,10.034260692470738,13.181950943927241,11.775409892812547,10.297558502094629,10.094593080781685,10.618954847131317,10.279147797567946,10.689642377980968,11.70509038221487,11.975142032342017,10.068964756521003,10.371165282609928],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 30.33 <br>GDP per capita: 820.85 <br>Pop.:     9,240,934","Country: Bahrain <br>Life Expectancy: 53.83 <br>GDP per capita: 11635.8 <br>Pop.:       138,655","Country: Bangladesh <br>Life Expectancy: 39.35 <br>GDP per capita: 661.64 <br>Pop.:    51,365,468","Country: Cambodia <br>Life Expectancy: 41.37 <br>GDP per capita: 434.04 <br>Pop.:     5,322,536","Country: China <br>Life Expectancy: 50.55 <br>GDP per capita: 575.99 <br>Pop.:   637,408,000","Country: Hong Kong, China <br>Life Expectancy: 64.75 <br>GDP per capita: 3629.08 <br>Pop.:     2,736,300","Country: India <br>Life Expectancy: 40.25 <br>GDP per capita: 590.06 <br>Pop.:   409,000,000","Country: Indonesia <br>Life Expectancy: 39.92 <br>GDP per capita: 858.9 <br>Pop.:    90,124,000","Country: Iran <br>Life Expectancy: 47.18 <br>GDP per capita: 3290.26 <br>Pop.:    19,792,000","Country: Iraq <br>Life Expectancy: 48.44 <br>GDP per capita: 6229.33 <br>Pop.:     6,248,643","Country: Israel <br>Life Expectancy: 67.84 <br>GDP per capita: 5385.28 <br>Pop.:     1,944,401","Country: Japan <br>Life Expectancy: 65.5 <br>GDP per capita: 4317.69 <br>Pop.:    91,563,009","Country: Jordan <br>Life Expectancy: 45.67 <br>GDP per capita: 1886.08 <br>Pop.:       746,559","Country: Korea, Dem. Rep. <br>Life Expectancy: 54.08 <br>GDP per capita: 1571.13 <br>Pop.:     9,411,381","Country: Korea, Rep. <br>Life Expectancy: 52.68 <br>GDP per capita: 1487.59 <br>Pop.:    22,611,552","Country: Kuwait <br>Life Expectancy: 58.03 <br>GDP per capita: 113523.13 <br>Pop.:       212,846","Country: Lebanon <br>Life Expectancy: 59.49 <br>GDP per capita: 6089.79 <br>Pop.:     1,647,412","Country: Malaysia <br>Life Expectancy: 52.1 <br>GDP per capita: 1810.07 <br>Pop.:     7,739,235","Country: Mongolia <br>Life Expectancy: 45.25 <br>GDP per capita: 912.66 <br>Pop.:       882,134","Country: Myanmar <br>Life Expectancy: 41.91 <br>GDP per capita: 350 <br>Pop.:    21,731,844","Country: Nepal <br>Life Expectancy: 37.69 <br>GDP per capita: 597.94 <br>Pop.:     9,682,338","Country: Oman <br>Life Expectancy: 40.08 <br>GDP per capita: 2242.75 <br>Pop.:       561,977","Country: Pakistan <br>Life Expectancy: 45.56 <br>GDP per capita: 747.08 <br>Pop.:    46,679,944","Country: Philippines <br>Life Expectancy: 51.33 <br>GDP per capita: 1547.94 <br>Pop.:    26,072,194","Country: Saudi Arabia <br>Life Expectancy: 42.87 <br>GDP per capita: 8157.59 <br>Pop.:     4,419,650","Country: Singapore <br>Life Expectancy: 63.18 <br>GDP per capita: 2843.1 <br>Pop.:     1,445,929","Country: Sri Lanka <br>Life Expectancy: 61.46 <br>GDP per capita: 1072.55 <br>Pop.:     9,128,546","Country: Syria <br>Life Expectancy: 48.28 <br>GDP per capita: 2117.23 <br>Pop.:     4,149,908","Country: Taiwan <br>Life Expectancy: 62.4 <br>GDP per capita: 1507.86 <br>Pop.:    10,164,215","Country: Thailand <br>Life Expectancy: 53.63 <br>GDP per capita: 793.58 <br>Pop.:    25,041,917","Country: Vietnam <br>Life Expectancy: 42.89 <br>GDP per capita: 676.29 <br>Pop.:    28,998,543","Country: West Bank and Gaza <br>Life Expectancy: 45.67 <br>GDP per capita: 1827.07 <br>Pop.:     1,070,439","Country: Yemen, Rep. <br>Life Expectancy: 33.97 <br>GDP per capita: 804.83 <br>Pop.:     5,498,090"],"frame":"1957","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[10.626625666878871,10.005367690040099,13.501752079518614,10.35918319297436,53.500921273496438,10.182664790826106,37.911386831211132,16.147138710225143,11.346767723242158,10.422392787094275,10.128615297221192,16.245355411777886,10.046858970317512,10.638259188371482,11.53921064562585,10.010431449408456,10.108344902819596,10.524130183872824,10.056112372702772,11.479167923106701,10.656752820310286,10.034260692470738,13.181950943927241,11.775409892812547,10.297558502094629,10.094593080781685,10.618954847131317,10.279147797567946,10.689642377980968,11.70509038221487,11.975142032342017,10.068964756521003,10.371165282609928]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.2883127871412121,3.9465798831491665,3.9874410446425981,3.1316151925453872,3.4783746605643442,3.6373127351608234,3.9167877751962603,4.0453096504366197,3.8776831533073586,3.9376600374082598,4.0080815466577988,3.6916383665182302,3.7810498817699782,3.9658600031445621,3.7481165077065777,3.7957866327403589,3.5661144388271913,4.0521625174659706,4.0664740090696645,3.6752514647927059,3.5768676843883633,3.5958675529105459,3.6973244664662945,3.7848499223060212,3.7680663080658499,3.659421983600029,3.9961559578049415,4.2530832122810684,3.3461092036565603,4.0524314375698403],"y":[59.280000000000001,67.480000000000004,69.239999999999995,58.450000000000003,66.609999999999999,64.769999999999996,69.030000000000001,71.810000000000002,67.489999999999995,68.930000000000007,69.099999999999994,67.859999999999999,66.409999999999997,73.469999999999999,68.900000000000006,67.810000000000002,61.448,72.989999999999995,73.439999999999998,65.769999999999996,61.509999999999998,64.099999999999994,61.685000000000002,67.450000000000003,67.849999999999994,66.659999999999997,72.489999999999995,70.560000000000002,48.079000000000001,70.420000000000002],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.096679984940502,10.471345009100913,10.609437988111667,10.205850339712503,10.518125215440165,10.268318364834331,10.645246727194982,10.302212060848305,10.291030101296915,13.020254025053717,14.843169585492278,10.54849534960174,10.667445474003665,10.007173323527853,10.19235125858577,13.352723807349392,10.026128482347934,10.748487942632977,10.2342393618871,11.923051536747515,10.59773525806277,11.212809375318953,10.492180947977261,10.258287560618582,10.100540716682508,12.032684169183948,10.498505750033946,10.345769018597153,11.748023029643836,13.506156583023873],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 59.28 <br>GDP per capita: 1942.28 <br>Pop.:     1,476,505","Country: Austria <br>Life Expectancy: 67.48 <br>GDP per capita: 8842.6 <br>Pop.:     6,965,860","Country: Belgium <br>Life Expectancy: 69.24 <br>GDP per capita: 9714.96 <br>Pop.:     8,989,111","Country: Bosnia and Herzegovina <br>Life Expectancy: 58.45 <br>GDP per capita: 1353.99 <br>Pop.:     3,076,000","Country: Bulgaria <br>Life Expectancy: 66.61 <br>GDP per capita: 3008.67 <br>Pop.:     7,651,254","Country: Croatia <br>Life Expectancy: 64.77 <br>GDP per capita: 4338.23 <br>Pop.:     3,991,242","Country: Czech Republic <br>Life Expectancy: 69.03 <br>GDP per capita: 8256.34 <br>Pop.:     9,513,758","Country: Denmark <br>Life Expectancy: 71.81 <br>GDP per capita: 11099.66 <br>Pop.:     4,487,831","Country: Finland <br>Life Expectancy: 67.49 <br>GDP per capita: 7545.42 <br>Pop.:     4,324,000","Country: France <br>Life Expectancy: 68.93 <br>GDP per capita: 8662.83 <br>Pop.:    44,310,863","Country: Germany <br>Life Expectancy: 69.1 <br>GDP per capita: 10187.83 <br>Pop.:    71,019,069","Country: Greece <br>Life Expectancy: 67.86 <br>GDP per capita: 4916.3 <br>Pop.:     8,096,218","Country: Hungary <br>Life Expectancy: 66.41 <br>GDP per capita: 6040.18 <br>Pop.:     9,839,000","Country: Iceland <br>Life Expectancy: 73.47 <br>GDP per capita: 9244 <br>Pop.:       165,110","Country: Ireland <br>Life Expectancy: 68.9 <br>GDP per capita: 5599.08 <br>Pop.:     2,878,220","Country: Italy <br>Life Expectancy: 67.81 <br>GDP per capita: 6248.66 <br>Pop.:    49,182,000","Country: Montenegro <br>Life Expectancy: 61.45 <br>GDP per capita: 3682.26 <br>Pop.:       442,829","Country: Netherlands <br>Life Expectancy: 72.99 <br>GDP per capita: 11276.19 <br>Pop.:    11,026,383","Country: Norway <br>Life Expectancy: 73.44 <br>GDP per capita: 11653.97 <br>Pop.:     3,491,938","Country: Poland <br>Life Expectancy: 65.77 <br>GDP per capita: 4734.25 <br>Pop.:    28,235,346","Country: Portugal <br>Life Expectancy: 61.51 <br>GDP per capita: 3774.57 <br>Pop.:     8,817,650","Country: Romania <br>Life Expectancy: 64.1 <br>GDP per capita: 3943.37 <br>Pop.:    17,829,327","Country: Serbia <br>Life Expectancy: 61.69 <br>GDP per capita: 4981.09 <br>Pop.:     7,271,135","Country: Slovak Republic <br>Life Expectancy: 67.45 <br>GDP per capita: 6093.26 <br>Pop.:     3,844,277","Country: Slovenia <br>Life Expectancy: 67.85 <br>GDP per capita: 5862.28 <br>Pop.:     1,533,070","Country: Spain <br>Life Expectancy: 66.66 <br>GDP per capita: 4564.8 <br>Pop.:    29,841,614","Country: Sweden <br>Life Expectancy: 72.49 <br>GDP per capita: 9911.88 <br>Pop.:     7,363,802","Country: Switzerland <br>Life Expectancy: 70.56 <br>GDP per capita: 17909.49 <br>Pop.:     5,126,000","Country: Turkey <br>Life Expectancy: 48.08 <br>GDP per capita: 2218.75 <br>Pop.:    25,670,939","Country: United Kingdom <br>Life Expectancy: 70.42 <br>GDP per capita: 11283.18 <br>Pop.:    51,430,000"],"frame":"1957","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.096679984940502,10.471345009100913,10.609437988111667,10.205850339712503,10.518125215440165,10.268318364834331,10.645246727194982,10.302212060848305,10.291030101296915,13.020254025053717,14.843169585492278,10.54849534960174,10.667445474003665,10.007173323527853,10.19235125858577,13.352723807349392,10.026128482347934,10.748487942632977,10.2342393618871,11.923051536747515,10.59773525806277,11.212809375318953,10.492180947977261,10.258287560618582,10.100540716682508,12.032684169183948,10.498505750033946,10.345769018597153,11.748023029643836,13.506156583023873]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.0394002211337243,4.0880437361756714],"y":[70.329999999999998,70.260000000000005],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[10.658816177179244,10.148067815754947],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 70.33 <br>GDP per capita: 10949.65 <br>Pop.:     9,712,569","Country: New Zealand <br>Life Expectancy: 70.26 <br>GDP per capita: 12247.4 <br>Pop.:     2,229,407"],"frame":"1957","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[10.658816177179244,10.148067815754947]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1962","data":[{"x":[3.4066792822632332,3.6303543074457933,2.9774945409988858,2.9928423519185503,2.858845076946678,2.5504769030305896,3.1460062427395981,3.0766654714894144,3.1429578127051285,3.1481855188851422,2.952460486902138,3.3917787175845451,3.2377621946386363,3.4801491817353334,3.2287431037905456,2.7655508184773105,2.5809202375083737,2.6226868418497919,3.8216091034172091,2.7778980379087579,3.0755619672849699,2.8365606176448144,2.7176990993540255,2.9527761618763915,2.6146870031093932,2.8022229250017467,3.829755899565531,3.2157398762375649,2.6313433883056003,2.6956343031274983,3.02362115947219,3.4029604184470719,3.194889779902554,2.745610575539799,3.5014995799913624,2.9990287498363628,3.0610479588194508,3.5015690657243885,2.7763183369987132,3.030012894155321,3.2187950388636661,3.0479131331434792,3.1365583376981152,3.7610801913822582,3.2921660493994129,3.2686205861080708,2.858539487715098,3.0283820453311909,3.2201874075611321,2.8849492025341887,3.16218363938167,2.7220348591193506],"y":[48.302999999999997,34,42.618000000000002,51.520000000000003,37.814,42.045000000000002,42.643000000000001,39.475000000000001,41.716000000000001,44.466999999999999,42.122,48.435000000000002,44.93,39.692999999999998,46.991999999999997,37.484999999999999,40.158000000000001,40.058999999999997,40.488999999999997,33.896000000000001,46.451999999999998,35.753,34.488,47.948999999999998,47.747,40.502000000000002,47.808,40.847999999999999,38.409999999999997,36.936,44.247999999999998,60.246000000000002,47.923999999999999,36.161000000000001,48.386000000000003,39.487000000000002,39.359999999999999,57.665999999999997,43,51.893000000000001,41.454000000000001,32.767000000000003,36.981000000000002,49.951000000000001,40.869999999999997,44.991999999999997,44.246000000000002,43.921999999999997,49.579000000000001,45.344000000000001,46.023000000000003,52.357999999999997],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[10.746751927219597,10.325294138165342,10.142777388126797,10.030901756888323,10.331683780585413,10.198063694600037,10.391336983153151,10.099886033771357,10.210929524262045,10.008987420389353,11.189405894558565,10.067428039908766,10.257477465594347,10.002039877832109,11.91881732451241,10.012914084542968,10.10965577020821,11.712151497787557,10.027004305024738,10.021432060701409,10.497921913751419,10.21021873737331,10.03875467567747,10.588241741573938,10.056863770134891,10.071855749438818,10.094315564026395,10.385173121703691,10.24356750132279,10.316036094575123,10.07417369005033,10.043750523296808,10.887056645151938,10.527522972950226,10.0383159453029,10.27410389982669,12.853749978144815,10.020400075128368,10.204160531589661,10.000364061577157,10.230028492182814,10.16434534057926,10.206133794480021,11.248801237239071,10.759193018374921,10.021158093102851,10.737401946819398,10.100201362696453,10.288474162425269,10.520687638348148,10.22939762957358,10.287872443853052],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 48.3 <br>GDP per capita: 2550.82 <br>Pop.:    11,000,948","Country: Angola <br>Life Expectancy: 34 <br>GDP per capita: 4269.28 <br>Pop.:     4,826,015","Country: Benin <br>Life Expectancy: 42.62 <br>GDP per capita: 949.5 <br>Pop.:     2,151,895","Country: Botswana <br>Life Expectancy: 51.52 <br>GDP per capita: 983.65 <br>Pop.:       512,764","Country: Burkina Faso <br>Life Expectancy: 37.81 <br>GDP per capita: 722.51 <br>Pop.:     4,919,632","Country: Burundi <br>Life Expectancy: 42.05 <br>GDP per capita: 355.2 <br>Pop.:     2,961,915","Country: Cameroon <br>Life Expectancy: 42.64 <br>GDP per capita: 1399.61 <br>Pop.:     5,793,633","Country: Central African Republic <br>Life Expectancy: 39.48 <br>GDP per capita: 1193.07 <br>Pop.:     1,523,478","Country: Chad <br>Life Expectancy: 41.72 <br>GDP per capita: 1389.82 <br>Pop.:     3,150,417","Country: Comoros <br>Life Expectancy: 44.47 <br>GDP per capita: 1406.65 <br>Pop.:       191,689","Country: Congo, Dem. Rep. <br>Life Expectancy: 42.12 <br>GDP per capita: 896.31 <br>Pop.:    17,486,434","Country: Congo, Rep. <br>Life Expectancy: 48.44 <br>GDP per capita: 2464.78 <br>Pop.:     1,047,924","Country: Cote d'Ivoire <br>Life Expectancy: 44.93 <br>GDP per capita: 1728.87 <br>Pop.:     3,832,408","Country: Djibouti <br>Life Expectancy: 39.69 <br>GDP per capita: 3020.99 <br>Pop.:        89,898","Country: Egypt <br>Life Expectancy: 46.99 <br>GDP per capita: 1693.34 <br>Pop.:    28,173,309","Country: Equatorial Guinea <br>Life Expectancy: 37.48 <br>GDP per capita: 582.84 <br>Pop.:       249,220","Country: Eritrea <br>Life Expectancy: 40.16 <br>GDP per capita: 381 <br>Pop.:     1,666,618","Country: Ethiopia <br>Life Expectancy: 40.06 <br>GDP per capita: 419.46 <br>Pop.:    25,145,372","Country: Gabon <br>Life Expectancy: 40.49 <br>GDP per capita: 6631.46 <br>Pop.:       455,661","Country: Gambia <br>Life Expectancy: 33.9 <br>GDP per capita: 599.65 <br>Pop.:       374,020","Country: Ghana <br>Life Expectancy: 46.45 <br>GDP per capita: 1190.04 <br>Pop.:     7,355,248","Country: Guinea <br>Life Expectancy: 35.75 <br>GDP per capita: 686.37 <br>Pop.:     3,140,003","Country: Guinea-Bissau <br>Life Expectancy: 34.49 <br>GDP per capita: 522.03 <br>Pop.:       627,820","Country: Kenya <br>Life Expectancy: 47.95 <br>GDP per capita: 896.97 <br>Pop.:     8,678,557","Country: Lesotho <br>Life Expectancy: 47.75 <br>GDP per capita: 411.8 <br>Pop.:       893,143","Country: Liberia <br>Life Expectancy: 40.5 <br>GDP per capita: 634.2 <br>Pop.:     1,112,796","Country: Libya <br>Life Expectancy: 47.81 <br>GDP per capita: 6757.03 <br>Pop.:     1,441,863","Country: Madagascar <br>Life Expectancy: 40.85 <br>GDP per capita: 1643.39 <br>Pop.:     5,703,324","Country: Malawi <br>Life Expectancy: 38.41 <br>GDP per capita: 427.9 <br>Pop.:     3,628,608","Country: Mali <br>Life Expectancy: 36.94 <br>GDP per capita: 496.17 <br>Pop.:     4,690,372","Country: Mauritania <br>Life Expectancy: 44.25 <br>GDP per capita: 1055.9 <br>Pop.:     1,146,757","Country: Mauritius <br>Life Expectancy: 60.25 <br>GDP per capita: 2529.07 <br>Pop.:       701,016","Country: Morocco <br>Life Expectancy: 47.92 <br>GDP per capita: 1566.35 <br>Pop.:    13,056,604","Country: Mozambique <br>Life Expectancy: 36.16 <br>GDP per capita: 556.69 <br>Pop.:     7,788,944","Country: Namibia <br>Life Expectancy: 48.39 <br>GDP per capita: 3173.22 <br>Pop.:       621,392","Country: Niger <br>Life Expectancy: 39.49 <br>GDP per capita: 997.77 <br>Pop.:     4,076,008","Country: Nigeria <br>Life Expectancy: 39.36 <br>GDP per capita: 1150.93 <br>Pop.:    41,871,351","Country: Reunion <br>Life Expectancy: 57.67 <br>GDP per capita: 3173.72 <br>Pop.:       358,900","Country: Rwanda <br>Life Expectancy: 43 <br>GDP per capita: 597.47 <br>Pop.:     3,051,242","Country: Sao Tome and Principe <br>Life Expectancy: 51.89 <br>GDP per capita: 1071.55 <br>Pop.:        65,345","Country: Senegal <br>Life Expectancy: 41.45 <br>GDP per capita: 1654.99 <br>Pop.:     3,430,243","Country: Sierra Leone <br>Life Expectancy: 32.77 <br>GDP per capita: 1116.64 <br>Pop.:     2,467,895","Country: Somalia <br>Life Expectancy: 36.98 <br>GDP per capita: 1369.49 <br>Pop.:     3,080,153","Country: South Africa <br>Life Expectancy: 49.95 <br>GDP per capita: 5768.73 <br>Pop.:    18,356,657","Country: Sudan <br>Life Expectancy: 40.87 <br>GDP per capita: 1959.59 <br>Pop.:    11,183,227","Country: Swaziland <br>Life Expectancy: 44.99 <br>GDP per capita: 1856.18 <br>Pop.:       370,006","Country: Tanzania <br>Life Expectancy: 44.25 <br>GDP per capita: 722 <br>Pop.:    10,863,958","Country: Togo <br>Life Expectancy: 43.92 <br>GDP per capita: 1067.53 <br>Pop.:     1,528,098","Country: Tunisia <br>Life Expectancy: 49.58 <br>GDP per capita: 1660.3 <br>Pop.:     4,286,552","Country: Uganda <br>Life Expectancy: 45.34 <br>GDP per capita: 767.27 <br>Pop.:     7,688,797","Country: Zambia <br>Life Expectancy: 46.02 <br>GDP per capita: 1452.73 <br>Pop.:     3,421,000","Country: Zimbabwe <br>Life Expectancy: 52.36 <br>GDP per capita: 527.27 <br>Pop.:     4,277,736"],"frame":"1962","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[10.746751927219597,10.325294138165342,10.142777388126797,10.030901756888323,10.331683780585413,10.198063694600037,10.391336983153151,10.099886033771357,10.210929524262045,10.008987420389353,11.189405894558565,10.067428039908766,10.257477465594347,10.002039877832109,11.91881732451241,10.012914084542968,10.10965577020821,11.712151497787557,10.027004305024738,10.021432060701409,10.497921913751419,10.21021873737331,10.03875467567747,10.588241741573938,10.056863770134891,10.071855749438818,10.094315564026395,10.385173121703691,10.24356750132279,10.316036094575123,10.07417369005033,10.043750523296808,10.887056645151938,10.527522972950226,10.0383159453029,10.27410389982669,12.853749978144815,10.020400075128368,10.204160531589661,10.000364061577157,10.230028492182814,10.16434534057926,10.206133794480021,11.248801237239071,10.759193018374921,10.021158093102851,10.737401946819398,10.100201362696453,10.288474162425269,10.520687638348148,10.22939762957358,10.287872443853052]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.8532823322547602,3.3386501987305803,3.5233022974337582,4.1291252501549787,3.6550514068335684,3.3966092233643916,3.5391936969699951,3.7143931310948237,3.2206669110189456,3.6113104872974842,3.5771244044919683,3.4393902452483687,3.2544487440278522,3.3600548186716255,3.7198371876270602,3.6610180597179709,3.5604284704625555,3.5485786114930282,3.3320397655207725,3.6952222465851623,3.7082801888769055,3.6987548859213319,4.2087945033174501,3.7484483486071687,3.9254654686227801],"y":[65.141999999999996,43.427999999999997,55.664999999999999,71.299999999999997,57.923999999999999,57.863,62.841999999999999,65.245999999999995,53.459000000000003,54.640000000000001,52.307000000000002,46.954000000000001,43.590000000000003,48.040999999999997,65.609999999999999,58.298999999999999,48.631999999999998,61.817,64.361000000000004,49.095999999999997,69.620000000000005,64.900000000000006,70.209999999999994,68.253,60.770000000000003],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[11.448586409360487,10.241199804264006,15.185821625441967,11.291745487680432,10.539283922820143,11.156879988946955,10.087717135636224,10.491036890955083,10.231611347832576,10.315444682208032,10.183441987897551,10.283171312748555,10.260734635932755,10.138563924807976,10.109554073217215,12.802569363481149,10.104467107824068,10.078880963926094,10.133079863378851,10.713686891049688,10.162990586502586,10.056478481870352,22.727684810705405,10.173257204882015,10.551713956987186],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 65.14 <br>GDP per capita: 7133.17 <br>Pop.:    21,283,783","Country: Bolivia <br>Life Expectancy: 43.43 <br>GDP per capita: 2180.97 <br>Pop.:     3,593,918","Country: Brazil <br>Life Expectancy: 55.66 <br>GDP per capita: 3336.59 <br>Pop.:    76,039,390","Country: Canada <br>Life Expectancy: 71.3 <br>GDP per capita: 13462.49 <br>Pop.:    18,985,849","Country: Chile <br>Life Expectancy: 57.92 <br>GDP per capita: 4519.09 <br>Pop.:     7,961,258","Country: Colombia <br>Life Expectancy: 57.86 <br>GDP per capita: 2492.35 <br>Pop.:    17,009,885","Country: Costa Rica <br>Life Expectancy: 62.84 <br>GDP per capita: 3460.94 <br>Pop.:     1,345,187","Country: Cuba <br>Life Expectancy: 65.25 <br>GDP per capita: 5180.76 <br>Pop.:     7,254,373","Country: Dominican Republic <br>Life Expectancy: 53.46 <br>GDP per capita: 1662.14 <br>Pop.:     3,453,434","Country: Ecuador <br>Life Expectancy: 54.64 <br>GDP per capita: 4086.11 <br>Pop.:     4,681,707","Country: El Salvador <br>Life Expectancy: 52.31 <br>GDP per capita: 3776.8 <br>Pop.:     2,747,687","Country: Guatemala <br>Life Expectancy: 46.95 <br>GDP per capita: 2750.36 <br>Pop.:     4,208,858","Country: Haiti <br>Life Expectancy: 43.59 <br>GDP per capita: 1796.59 <br>Pop.:     3,880,130","Country: Honduras <br>Life Expectancy: 48.04 <br>GDP per capita: 2291.16 <br>Pop.:     2,090,162","Country: Jamaica <br>Life Expectancy: 65.61 <br>GDP per capita: 5246.11 <br>Pop.:     1,665,128","Country: Mexico <br>Life Expectancy: 58.3 <br>GDP per capita: 4581.61 <br>Pop.:    41,121,485","Country: Nicaragua <br>Life Expectancy: 48.63 <br>GDP per capita: 3634.36 <br>Pop.:     1,590,597","Country: Panama <br>Life Expectancy: 61.82 <br>GDP per capita: 3536.54 <br>Pop.:     1,215,725","Country: Paraguay <br>Life Expectancy: 64.36 <br>GDP per capita: 2148.03 <br>Pop.:     2,009,813","Country: Peru <br>Life Expectancy: 49.1 <br>GDP per capita: 4957.04 <br>Pop.:    10,516,500","Country: Puerto Rico <br>Life Expectancy: 69.62 <br>GDP per capita: 5108.34 <br>Pop.:     2,448,046","Country: Trinidad and Tobago <br>Life Expectancy: 64.9 <br>GDP per capita: 4997.52 <br>Pop.:       887,498","Country: United States <br>Life Expectancy: 70.21 <br>GDP per capita: 16173.15 <br>Pop.:   186,538,000","Country: Uruguay <br>Life Expectancy: 68.25 <br>GDP per capita: 5603.36 <br>Pop.:     2,598,466","Country: Venezuela <br>Life Expectancy: 60.77 <br>GDP per capita: 8422.97 <br>Pop.:     8,143,375"],"frame":"1962","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[11.448586409360487,10.241199804264006,15.185821625441967,11.291745487680432,10.539283922820143,11.156879988946955,10.087717135636224,10.491036890955083,10.231611347832576,10.315444682208032,10.183441987897551,10.283171312748555,10.260734635932755,10.138563924807976,10.109554073217215,12.802569363481149,10.104467107824068,10.078880963926094,10.133079863378851,10.713686891049688,10.162990586502586,10.056478481870352,22.727684810705405,10.173257204882015,10.551713956987186]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.9310003034014152,4.1056217292856862,2.8365402935718977,2.6962809246907486,2.6881296183975638,3.6714180037641557,2.8184549604275992,2.9290558929345507,3.6219371680916108,3.9212565356311093,3.8516026325771726,3.8180046943435983,3.3706997864687236,3.2099688022376403,3.1864885780712728,4.979812839412971,3.7569828433832519,3.3089664980246409,3.0238094638882607,2.5888317255942073,2.8145118616386817,3.4660721352898589,2.9049008741886864,3.2173660509526316,4.065445998288185,3.565226093419398,3.0311950863922199,3.341045985312026,3.2607578484600763,3.0009540395998529,2.8876449549003014,3.342216601054377,2.9167818884388841],"y":[31.997,56.923000000000002,41.216000000000001,43.414999999999999,44.501359999999998,67.650000000000006,43.604999999999997,42.518000000000001,49.325000000000003,51.457000000000001,69.390000000000001,68.730000000000004,48.125999999999998,56.655999999999999,55.292000000000002,60.469999999999999,62.094000000000001,55.737000000000002,48.250999999999998,45.107999999999997,39.393000000000001,43.164999999999999,47.670000000000002,54.756999999999998,45.914000000000001,65.798000000000002,62.192,50.305,65.200000000000003,56.061,45.363,48.127000000000002,35.18],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[10.696663429034386,10.007634236132002,13.875356861358149,10.411129401697075,55.436713259119074,10.221493930541948,40.982772465264404,16.754863547683151,11.557123512667761,10.49007363616723,10.153630231644247,16.536710329168855,10.059622283952354,10.741055940181724,11.799169654306484,10.020356802717435,10.124687131501267,10.603791689268052,10.06485872344636,11.609025561690359,10.701098100371874,10.038778154714317,13.620184914326749,12.065694739448611,10.333280696356079,10.115360493631886,10.707232613025276,10.325881523604602,10.809407511624142,11.99321911613583,12.302592487981507,10.073243879239381,10.413618043096827],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 32 <br>GDP per capita: 853.1 <br>Pop.:    10,267,083","Country: Bahrain <br>Life Expectancy: 56.92 <br>GDP per capita: 12753.28 <br>Pop.:       171,863","Country: Bangladesh <br>Life Expectancy: 41.22 <br>GDP per capita: 686.34 <br>Pop.:    56,839,289","Country: Cambodia <br>Life Expectancy: 43.42 <br>GDP per capita: 496.91 <br>Pop.:     6,083,619","Country: China <br>Life Expectancy: 44.5 <br>GDP per capita: 487.67 <br>Pop.:   665,770,000","Country: Hong Kong, China <br>Life Expectancy: 67.65 <br>GDP per capita: 4692.65 <br>Pop.:     3,305,200","Country: India <br>Life Expectancy: 43.6 <br>GDP per capita: 658.35 <br>Pop.:   454,000,000","Country: Indonesia <br>Life Expectancy: 42.52 <br>GDP per capita: 849.29 <br>Pop.:    99,028,000","Country: Iran <br>Life Expectancy: 49.33 <br>GDP per capita: 4187.33 <br>Pop.:    22,874,000","Country: Iraq <br>Life Expectancy: 51.46 <br>GDP per capita: 8341.74 <br>Pop.:     7,240,260","Country: Israel <br>Life Expectancy: 69.39 <br>GDP per capita: 7105.63 <br>Pop.:     2,310,904","Country: Japan <br>Life Expectancy: 68.73 <br>GDP per capita: 6576.65 <br>Pop.:    95,831,757","Country: Jordan <br>Life Expectancy: 48.13 <br>GDP per capita: 2348.01 <br>Pop.:       933,559","Country: Korea, Dem. Rep. <br>Life Expectancy: 56.66 <br>GDP per capita: 1621.69 <br>Pop.:    10,917,494","Country: Korea, Rep. <br>Life Expectancy: 55.29 <br>GDP per capita: 1536.34 <br>Pop.:    26,420,307","Country: Kuwait <br>Life Expectancy: 60.47 <br>GDP per capita: 95458.11 <br>Pop.:       358,266","Country: Lebanon <br>Life Expectancy: 62.09 <br>GDP per capita: 5714.56 <br>Pop.:     1,886,848","Country: Malaysia <br>Life Expectancy: 55.74 <br>GDP per capita: 2036.88 <br>Pop.:     8,906,385","Country: Mongolia <br>Life Expectancy: 48.25 <br>GDP per capita: 1056.35 <br>Pop.:     1,010,280","Country: Myanmar <br>Life Expectancy: 45.11 <br>GDP per capita: 388 <br>Pop.:    23,634,436","Country: Nepal <br>Life Expectancy: 39.39 <br>GDP per capita: 652.4 <br>Pop.:    10,332,057","Country: Oman <br>Life Expectancy: 43.16 <br>GDP per capita: 2924.64 <br>Pop.:       628,164","Country: Pakistan <br>Life Expectancy: 47.67 <br>GDP per capita: 803.34 <br>Pop.:    53,100,671","Country: Philippines <br>Life Expectancy: 54.76 <br>GDP per capita: 1649.55 <br>Pop.:    30,325,264","Country: Saudi Arabia <br>Life Expectancy: 45.91 <br>GDP per capita: 11626.42 <br>Pop.:     4,943,029","Country: Singapore <br>Life Expectancy: 65.8 <br>GDP per capita: 3674.74 <br>Pop.:     1,750,200","Country: Sri Lanka <br>Life Expectancy: 62.19 <br>GDP per capita: 1074.47 <br>Pop.:    10,421,936","Country: Syria <br>Life Expectancy: 50.3 <br>GDP per capita: 2193.04 <br>Pop.:     4,834,621","Country: Taiwan <br>Life Expectancy: 65.2 <br>GDP per capita: 1822.88 <br>Pop.:    11,918,938","Country: Thailand <br>Life Expectancy: 56.06 <br>GDP per capita: 1002.2 <br>Pop.:    29,263,397","Country: Vietnam <br>Life Expectancy: 45.36 <br>GDP per capita: 772.05 <br>Pop.:    33,796,140","Country: West Bank and Gaza <br>Life Expectancy: 48.13 <br>GDP per capita: 2198.96 <br>Pop.:     1,133,134","Country: Yemen, Rep. <br>Life Expectancy: 35.18 <br>GDP per capita: 825.62 <br>Pop.:     6,120,081"],"frame":"1962","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[10.696663429034386,10.007634236132002,13.875356861358149,10.411129401697075,55.436713259119074,10.221493930541948,40.982772465264404,16.754863547683151,11.557123512667761,10.49007363616723,10.153630231644247,16.536710329168855,10.059622283952354,10.741055940181724,11.799169654306484,10.020356802717435,10.124687131501267,10.603791689268052,10.06485872344636,11.609025561690359,10.701098100371874,10.038778154714317,13.620184914326749,12.065694739448611,10.333280696356079,10.115360493631886,10.707232613025276,10.325881523604602,10.809407511624142,11.99321911613583,12.302592487981507,10.073243879239381,10.413618043096827]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.3641547827552789,4.031437595748411,4.0410453776316073,3.2329157658468115,3.6288319744683792,3.7386133084847186,4.0059037539734978,4.1330057245523655,3.9718249842075486,4.0236838858258608,4.1106726193013392,3.7793937779826914,3.8779676521418338,4.0149470240296026,3.8216181469726571,3.916115980192544,3.6674150121073441,4.1068993909967739,4.1287352487231681,3.727439758762745,3.6746733241439609,3.6753197619270122,3.7986250397510806,3.8739659010849676,3.8693668813635309,3.7554055549397827,4.0909434191302232,4.3102915942824751,3.3660248878803913,4.096116338423399],"y":[64.819999999999993,69.540000000000006,70.25,61.93,69.510000000000005,67.129999999999995,69.900000000000006,72.349999999999994,68.75,70.510000000000005,70.299999999999997,69.510000000000005,67.959999999999994,73.680000000000007,70.290000000000006,69.239999999999995,63.728000000000002,73.230000000000004,73.469999999999999,67.640000000000001,64.390000000000001,66.799999999999997,64.531000000000006,70.329999999999998,69.150000000000006,69.689999999999998,73.370000000000005,71.319999999999993,52.097999999999999,70.760000000000005],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.113854627382016,10.482538776423741,10.625087653459365,10.224483412559094,10.542811784612432,10.274141370731424,10.652517311267912,10.313068931293586,10.302458590735199,13.212259104352022,15.028821059961952,10.572521434356657,10.682734149159842,10.008329734345581,10.189060098246346,13.46610571435582,10.028292034641575,10.801677926031456,10.244271258151073,12.065991844818946,10.611532604861077,11.270919581997155,10.51572311886228,10.28511829822849,10.103945996061491,12.122535644823781,10.512005240678764,10.382625646205792,12.029072287931315,13.633243695259591],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 64.82 <br>GDP per capita: 2312.89 <br>Pop.:     1,728,137","Country: Austria <br>Life Expectancy: 69.54 <br>GDP per capita: 10750.72 <br>Pop.:     7,129,864","Country: Belgium <br>Life Expectancy: 70.25 <br>GDP per capita: 10991.21 <br>Pop.:     9,218,400","Country: Bosnia and Herzegovina <br>Life Expectancy: 61.93 <br>GDP per capita: 1709.68 <br>Pop.:     3,349,000","Country: Bulgaria <br>Life Expectancy: 69.51 <br>GDP per capita: 4254.34 <br>Pop.:     8,012,946","Country: Croatia <br>Life Expectancy: 67.13 <br>GDP per capita: 5477.89 <br>Pop.:     4,076,557","Country: Czech Republic <br>Life Expectancy: 69.9 <br>GDP per capita: 10136.87 <br>Pop.:     9,620,282","Country: Denmark <br>Life Expectancy: 72.35 <br>GDP per capita: 13583.31 <br>Pop.:     4,646,899","Country: Finland <br>Life Expectancy: 68.75 <br>GDP per capita: 9371.84 <br>Pop.:     4,491,443","Country: France <br>Life Expectancy: 70.51 <br>GDP per capita: 10560.49 <br>Pop.:    47,124,000","Country: Germany <br>Life Expectancy: 70.3 <br>GDP per capita: 12902.46 <br>Pop.:    73,739,117","Country: Greece <br>Life Expectancy: 69.51 <br>GDP per capita: 6017.19 <br>Pop.:     8,448,233","Country: Hungary <br>Life Expectancy: 67.96 <br>GDP per capita: 7550.36 <br>Pop.:    10,063,000","Country: Iceland <br>Life Expectancy: 73.68 <br>GDP per capita: 10350.16 <br>Pop.:       182,053","Country: Ireland <br>Life Expectancy: 70.29 <br>GDP per capita: 6631.6 <br>Pop.:     2,830,000","Country: Italy <br>Life Expectancy: 69.24 <br>GDP per capita: 8243.58 <br>Pop.:    50,843,200","Country: Montenegro <br>Life Expectancy: 63.73 <br>GDP per capita: 4649.59 <br>Pop.:       474,528","Country: Netherlands <br>Life Expectancy: 73.23 <br>GDP per capita: 12790.85 <br>Pop.:    11,805,689","Country: Norway <br>Life Expectancy: 73.47 <br>GDP per capita: 13450.4 <br>Pop.:     3,638,919","Country: Poland <br>Life Expectancy: 67.64 <br>GDP per capita: 5338.75 <br>Pop.:    30,329,617","Country: Portugal <br>Life Expectancy: 64.39 <br>GDP per capita: 4727.95 <br>Pop.:     9,019,800","Country: Romania <br>Life Expectancy: 66.8 <br>GDP per capita: 4735 <br>Pop.:    18,680,721","Country: Serbia <br>Life Expectancy: 64.53 <br>GDP per capita: 6289.63 <br>Pop.:     7,616,060","Country: Slovak Republic <br>Life Expectancy: 70.33 <br>GDP per capita: 7481.11 <br>Pop.:     4,237,384","Country: Slovenia <br>Life Expectancy: 69.15 <br>GDP per capita: 7402.3 <br>Pop.:     1,582,962","Country: Spain <br>Life Expectancy: 69.69 <br>GDP per capita: 5693.84 <br>Pop.:    31,158,061","Country: Sweden <br>Life Expectancy: 73.37 <br>GDP per capita: 12329.44 <br>Pop.:     7,561,588","Country: Switzerland <br>Life Expectancy: 71.32 <br>GDP per capita: 20431.09 <br>Pop.:     5,666,000","Country: Turkey <br>Life Expectancy: 52.1 <br>GDP per capita: 2322.87 <br>Pop.:    29,788,695","Country: United Kingdom <br>Life Expectancy: 70.76 <br>GDP per capita: 12477.18 <br>Pop.:    53,292,000"],"frame":"1962","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.113854627382016,10.482538776423741,10.625087653459365,10.224483412559094,10.542811784612432,10.274141370731424,10.652517311267912,10.313068931293586,10.302458590735199,13.212259104352022,15.028821059961952,10.572521434356657,10.682734149159842,10.008329734345581,10.189060098246346,13.46610571435582,10.028292034641575,10.801677926031456,10.244271258151073,12.065991844818946,10.611532604861077,11.270919581997155,10.51572311886228,10.28511829822849,10.103945996061491,12.122535644823781,10.512005240678764,10.382625646205792,12.029072287931315,13.633243695259591]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.086972638306241,4.1197729725815551],"y":[70.930000000000007,71.239999999999995],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[10.732693171377324,10.165755106585291],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 70.93 <br>GDP per capita: 12217.23 <br>Pop.:    10,794,968","Country: New Zealand <br>Life Expectancy: 71.24 <br>GDP per capita: 13175.68 <br>Pop.:     2,488,550"],"frame":"1962","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[10.732693171377324,10.165755106585291]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1967","data":[{"x":[3.5114811879749945,3.7421574583839643,3.015289076615387,3.0844723543805377,2.900272370942091,2.615926405202885,3.1785318256936015,3.0553999748340015,3.0780254143279975,3.2732396963509443,2.9353022840690572,3.4278007842362048,3.3121880386404632,3.4800142069749325,3.2588480889459599,2.9617038878732118,2.6709829431201166,2.71274954741178,3.9221419590145032,2.8661590481010029,3.0514215704171108,2.8504989181546958,2.8546585823592179,3.0239666906738907,2.6977862660055312,2.8534570617051016,4.2735279357110905,3.2132646189128011,2.6950566134878549,2.7364043811039469,3.1526384504098619,3.3936432044255502,3.2332613731352451,2.7533295728750962,3.5790623839008622,3.0229991739927828,3.0062580890695076,3.6043530536575381,2.7083900600520385,3.1413997852670503,3.2074740370927417,3.0813629597688932,3.1088129405187179,3.8521430389766578,3.2273718353575278,3.4171563066617288,2.9285078210123725,3.1695559301340905,3.2860880765114411,2.9585249534507088,3.2497063237255377,2.7557186882170761],"y":[51.406999999999996,35.984999999999999,44.884999999999998,53.298000000000002,40.697000000000003,43.548000000000002,44.798999999999999,41.478000000000002,43.600999999999999,46.472000000000001,44.055999999999997,52.039999999999999,47.350000000000001,42.073999999999998,49.292999999999999,38.987000000000002,42.189,42.115000000000002,44.597999999999999,35.856999999999999,48.072000000000003,37.197000000000003,35.491999999999997,50.654000000000003,48.491999999999997,41.536000000000001,50.226999999999997,42.881,39.487000000000002,38.487000000000002,46.289000000000001,61.557000000000002,50.335000000000001,38.113,51.158999999999999,40.118000000000002,41.039999999999999,60.542000000000002,44.100000000000001,54.424999999999997,43.563000000000002,34.113,38.976999999999997,51.927,42.857999999999997,46.633000000000003,45.756999999999998,46.768999999999998,52.052999999999997,48.051000000000002,47.768000000000001,53.994999999999997],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[10.866846586414798,10.354059643965661,10.161576930074753,10.033684910043874,10.345901088179417,10.223254107522317,10.428321448657179,10.114230087212526,10.23451435328087,10.010740772068312,11.356942404811607,10.076426244274344,10.319755747337004,10.004614313270574,12.15824063932568,10.013640569624943,10.120146326726868,11.897453312066048,10.029280065273543,10.025907615594338,10.575386695888158,10.231473749756171,10.036943718454618,10.691505480506585,10.063910006550508,10.083227384116364,10.115976408831035,10.428256608293795,10.278966517562523,10.351667171062761,10.079892268835867,10.049776786669861,11.004021289373984,10.588402272663078,10.044134378248049,10.305367465942703,13.223435671915299,10.02416245427707,10.231450611984394,10.000735494479835,10.266584670023429,10.177606559951892,10.229932664951031,11.429034514438218,10.863818200179621,10.024617428868993,10.856391111945381,10.114360586975467,10.32263029127842,10.60337596015923,10.262090823322724,10.33685735905344],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 51.41 <br>GDP per capita: 3246.99 <br>Pop.:    12,760,499","Country: Angola <br>Life Expectancy: 35.98 <br>GDP per capita: 5522.78 <br>Pop.:     5,247,469","Country: Benin <br>Life Expectancy: 44.88 <br>GDP per capita: 1035.83 <br>Pop.:     2,427,334","Country: Botswana <br>Life Expectancy: 53.3 <br>GDP per capita: 1214.71 <br>Pop.:       553,541","Country: Burkina Faso <br>Life Expectancy: 40.7 <br>GDP per capita: 794.83 <br>Pop.:     5,127,935","Country: Burundi <br>Life Expectancy: 43.55 <br>GDP per capita: 412.98 <br>Pop.:     3,330,989","Country: Cameroon <br>Life Expectancy: 44.8 <br>GDP per capita: 1508.45 <br>Pop.:     6,335,506","Country: Central African Republic <br>Life Expectancy: 41.48 <br>GDP per capita: 1136.06 <br>Pop.:     1,733,638","Country: Chad <br>Life Expectancy: 43.6 <br>GDP per capita: 1196.81 <br>Pop.:     3,495,967","Country: Comoros <br>Life Expectancy: 46.47 <br>GDP per capita: 1876.03 <br>Pop.:       217,378","Country: Congo, Dem. Rep. <br>Life Expectancy: 44.06 <br>GDP per capita: 861.59 <br>Pop.:    19,941,073","Country: Congo, Rep. <br>Life Expectancy: 52.04 <br>GDP per capita: 2677.94 <br>Pop.:     1,179,760","Country: Cote d'Ivoire <br>Life Expectancy: 47.35 <br>GDP per capita: 2052.05 <br>Pop.:     4,744,870","Country: Djibouti <br>Life Expectancy: 42.07 <br>GDP per capita: 3020.05 <br>Pop.:       127,617","Country: Egypt <br>Life Expectancy: 49.29 <br>GDP per capita: 1814.88 <br>Pop.:    31,681,188","Country: Equatorial Guinea <br>Life Expectancy: 38.99 <br>GDP per capita: 915.6 <br>Pop.:       259,864","Country: Eritrea <br>Life Expectancy: 42.19 <br>GDP per capita: 468.79 <br>Pop.:     1,820,319","Country: Ethiopia <br>Life Expectancy: 42.12 <br>GDP per capita: 516.12 <br>Pop.:    27,860,297","Country: Gabon <br>Life Expectancy: 44.6 <br>GDP per capita: 8358.76 <br>Pop.:       489,004","Country: Gambia <br>Life Expectancy: 35.86 <br>GDP per capita: 734.78 <br>Pop.:       439,593","Country: Ghana <br>Life Expectancy: 48.07 <br>GDP per capita: 1125.7 <br>Pop.:     8,490,213","Country: Guinea <br>Life Expectancy: 37.2 <br>GDP per capita: 708.76 <br>Pop.:     3,451,418","Country: Guinea-Bissau <br>Life Expectancy: 35.49 <br>GDP per capita: 715.58 <br>Pop.:       601,287","Country: Kenya <br>Life Expectancy: 50.65 <br>GDP per capita: 1056.74 <br>Pop.:    10,191,512","Country: Lesotho <br>Life Expectancy: 48.49 <br>GDP per capita: 498.64 <br>Pop.:       996,380","Country: Liberia <br>Life Expectancy: 41.54 <br>GDP per capita: 713.6 <br>Pop.:     1,279,406","Country: Libya <br>Life Expectancy: 50.23 <br>GDP per capita: 18772.75 <br>Pop.:     1,759,224","Country: Madagascar <br>Life Expectancy: 42.88 <br>GDP per capita: 1634.05 <br>Pop.:     6,334,556","Country: Malawi <br>Life Expectancy: 39.49 <br>GDP per capita: 495.51 <br>Pop.:     4,147,252","Country: Mali <br>Life Expectancy: 38.49 <br>GDP per capita: 545.01 <br>Pop.:     5,212,416","Country: Mauritania <br>Life Expectancy: 46.29 <br>GDP per capita: 1421.15 <br>Pop.:     1,230,542","Country: Mauritius <br>Life Expectancy: 61.56 <br>GDP per capita: 2475.39 <br>Pop.:       789,309","Country: Morocco <br>Life Expectancy: 50.34 <br>GDP per capita: 1711.04 <br>Pop.:    14,770,296","Country: Mozambique <br>Life Expectancy: 38.11 <br>GDP per capita: 566.67 <br>Pop.:     8,680,909","Country: Namibia <br>Life Expectancy: 51.16 <br>GDP per capita: 3793.69 <br>Pop.:       706,640","Country: Niger <br>Life Expectancy: 40.12 <br>GDP per capita: 1054.38 <br>Pop.:     4,534,062","Country: Nigeria <br>Life Expectancy: 41.04 <br>GDP per capita: 1014.51 <br>Pop.:    47,287,752","Country: Reunion <br>Life Expectancy: 60.54 <br>GDP per capita: 4021.18 <br>Pop.:       414,024","Country: Rwanda <br>Life Expectancy: 44.1 <br>GDP per capita: 510.96 <br>Pop.:     3,451,079","Country: Sao Tome and Principe <br>Life Expectancy: 54.42 <br>GDP per capita: 1384.84 <br>Pop.:        70,787","Country: Senegal <br>Life Expectancy: 43.56 <br>GDP per capita: 1612.4 <br>Pop.:     3,965,841","Country: Sierra Leone <br>Life Expectancy: 34.11 <br>GDP per capita: 1206.04 <br>Pop.:     2,662,190","Country: Somalia <br>Life Expectancy: 38.98 <br>GDP per capita: 1284.73 <br>Pop.:     3,428,839","Country: South Africa <br>Life Expectancy: 51.93 <br>GDP per capita: 7114.48 <br>Pop.:    20,997,321","Country: Sudan <br>Life Expectancy: 42.86 <br>GDP per capita: 1688 <br>Pop.:    12,716,129","Country: Swaziland <br>Life Expectancy: 46.63 <br>GDP per capita: 2613.1 <br>Pop.:       420,690","Country: Tanzania <br>Life Expectancy: 45.76 <br>GDP per capita: 848.22 <br>Pop.:    12,607,312","Country: Togo <br>Life Expectancy: 46.77 <br>GDP per capita: 1477.6 <br>Pop.:     1,735,550","Country: Tunisia <br>Life Expectancy: 52.05 <br>GDP per capita: 1932.36 <br>Pop.:     4,786,986","Country: Uganda <br>Life Expectancy: 48.05 <br>GDP per capita: 908.92 <br>Pop.:     8,900,294","Country: Zambia <br>Life Expectancy: 47.77 <br>GDP per capita: 1777.08 <br>Pop.:     3,900,000","Country: Zimbabwe <br>Life Expectancy: 53.99 <br>GDP per capita: 569.8 <br>Pop.:     4,995,432"],"frame":"1967","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[10.866846586414798,10.354059643965661,10.161576930074753,10.033684910043874,10.345901088179417,10.223254107522317,10.428321448657179,10.114230087212526,10.23451435328087,10.010740772068312,11.356942404811607,10.076426244274344,10.319755747337004,10.004614313270574,12.15824063932568,10.013640569624943,10.120146326726868,11.897453312066048,10.029280065273543,10.025907615594338,10.575386695888158,10.231473749756171,10.036943718454618,10.691505480506585,10.063910006550508,10.083227384116364,10.115976408831035,10.428256608293795,10.278966517562523,10.351667171062761,10.079892268835867,10.049776786669861,11.004021289373984,10.588402272663078,10.044134378248049,10.305367465942703,13.223435671915299,10.02416245427707,10.231450611984394,10.000735494479835,10.266584670023429,10.177606559951892,10.229932664951031,11.429034514438218,10.863818200179621,10.024617428868993,10.856391111945381,10.114360586975467,10.32263029127842,10.60337596015923,10.262090823322724,10.33685735905344]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.9059551655297824,3.4127772993608403,3.5352769450657298,4.2061938829090044,3.7081364599628714,3.4279289154193675,3.6192736750930834,3.7551327224046194,3.2184627674033699,3.6607776823798006,3.6393465554725735,3.5108841565079323,3.1619838639730946,3.4045377069966345,3.7870850656549924,3.7600252452869518,3.6668354922817294,3.6455214072666569,3.3616100527902733,3.7625355252765109,3.8406879674873702,3.7498420535568613,4.2907103725017741,3.7359675438336657,3.9796154797619803],"y":[65.634,45.031999999999996,57.631999999999998,72.129999999999995,60.523000000000003,59.963000000000001,65.424000000000007,68.290000000000006,56.750999999999998,56.677999999999997,55.854999999999997,50.015999999999998,46.243000000000002,50.923999999999999,67.510000000000005,60.109999999999999,51.884,64.070999999999998,64.950999999999993,51.445,71.099999999999994,65.400000000000006,70.760000000000005,68.468000000000004,63.478999999999999],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[11.561234050441335,10.271691633549704,16.005569878218839,11.416915918774469,10.600551240918097,11.344858481679015,10.104338792157579,10.55143801005122,10.272270487362201,10.366683380186689,10.216561080454618,10.316063464033773,10.290629933875305,10.166583629923331,10.122929479882419,13.271745633059352,10.123229383626331,10.091832724132841,10.152065940814316,10.823963285915019,10.176703640828494,10.061437541115094,23.558597004237946,10.183502869586118,10.658610257835733],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 65.63 <br>GDP per capita: 8052.95 <br>Pop.:    22,934,225","Country: Bolivia <br>Life Expectancy: 45.03 <br>GDP per capita: 2586.89 <br>Pop.:     4,040,665","Country: Brazil <br>Life Expectancy: 57.63 <br>GDP per capita: 3429.86 <br>Pop.:    88,049,823","Country: Canada <br>Life Expectancy: 72.13 <br>GDP per capita: 16076.59 <br>Pop.:    20,819,767","Country: Chile <br>Life Expectancy: 60.52 <br>GDP per capita: 5106.65 <br>Pop.:     8,858,908","Country: Colombia <br>Life Expectancy: 59.96 <br>GDP per capita: 2678.73 <br>Pop.:    19,764,027","Country: Costa Rica <br>Life Expectancy: 65.42 <br>GDP per capita: 4161.73 <br>Pop.:     1,588,717","Country: Cuba <br>Life Expectancy: 68.29 <br>GDP per capita: 5690.27 <br>Pop.:     8,139,332","Country: Dominican Republic <br>Life Expectancy: 56.75 <br>GDP per capita: 1653.72 <br>Pop.:     4,049,146","Country: Ecuador <br>Life Expectancy: 56.68 <br>GDP per capita: 4579.07 <br>Pop.:     5,432,424","Country: El Salvador <br>Life Expectancy: 55.85 <br>GDP per capita: 4358.6 <br>Pop.:     3,232,927","Country: Guatemala <br>Life Expectancy: 50.02 <br>GDP per capita: 3242.53 <br>Pop.:     4,690,773","Country: Haiti <br>Life Expectancy: 46.24 <br>GDP per capita: 1452.06 <br>Pop.:     4,318,137","Country: Honduras <br>Life Expectancy: 50.92 <br>GDP per capita: 2538.27 <br>Pop.:     2,500,689","Country: Jamaica <br>Life Expectancy: 67.51 <br>GDP per capita: 6124.7 <br>Pop.:     1,861,096","Country: Mexico <br>Life Expectancy: 60.11 <br>GDP per capita: 5754.73 <br>Pop.:    47,995,559","Country: Nicaragua <br>Life Expectancy: 51.88 <br>GDP per capita: 4643.39 <br>Pop.:     1,865,490","Country: Panama <br>Life Expectancy: 64.07 <br>GDP per capita: 4421.01 <br>Pop.:     1,405,486","Country: Paraguay <br>Life Expectancy: 64.95 <br>GDP per capita: 2299.38 <br>Pop.:     2,287,985","Country: Peru <br>Life Expectancy: 51.44 <br>GDP per capita: 5788.09 <br>Pop.:    12,132,200","Country: Puerto Rico <br>Life Expectancy: 71.1 <br>GDP per capita: 6929.28 <br>Pop.:     2,648,961","Country: Trinidad and Tobago <br>Life Expectancy: 65.4 <br>GDP per capita: 5621.37 <br>Pop.:       960,155","Country: United States <br>Life Expectancy: 70.76 <br>GDP per capita: 19530.37 <br>Pop.:   198,712,000","Country: Uruguay <br>Life Expectancy: 68.47 <br>GDP per capita: 5444.62 <br>Pop.:     2,748,579","Country: Venezuela <br>Life Expectancy: 63.48 <br>GDP per capita: 9541.47 <br>Pop.:     9,709,552"],"frame":"1967","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[11.561234050441335,10.271691633549704,16.005569878218839,11.416915918774469,10.600551240918097,11.344858481679015,10.104338792157579,10.55143801005122,10.272270487362201,10.366683380186689,10.216561080454618,10.316063464033773,10.290629933875305,10.166583629923331,10.122929479882419,13.271745633059352,10.123229383626331,10.091832724132841,10.152065940814316,10.823963285915019,10.176703640828494,10.061437541115094,23.558597004237946,10.183502869586118,10.658610257835733]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.9223086768880684,4.1703988104990311,2.8580473393137411,2.7188605303893532,2.7872519159133398,3.7922489662686965,2.8455758798631394,2.8822009859516231,3.7713472521760778,3.9509224483675749,3.9239555852536214,3.9933387174416626,3.4380351784185481,3.331131715557198,3.3073308766251421,4.9079210526107406,3.7786564059150232,3.357504605466588,3.0885050397031306,2.5428254269591797,2.8302307096380663,3.6740287280587216,2.9742390834018027,3.2586677900019598,4.2279650468415104,3.6970041611317952,3.0551926177838475,3.2746019958851154,3.4222382376130973,3.1124242290514208,2.8042234800923187,3.4231991654299403,2.9357299717042968],"y":[34.020000000000003,59.923000000000002,43.453000000000003,45.414999999999999,58.381120000000003,70,47.192999999999998,45.963999999999999,52.469000000000001,54.459000000000003,70.75,71.430000000000007,51.628999999999998,59.942,57.716000000000001,64.623999999999995,63.869999999999997,59.371000000000002,51.253,49.378999999999998,41.472000000000001,46.988,49.799999999999997,56.393000000000001,49.901000000000003,67.945999999999998,64.266000000000005,53.655000000000001,67.5,58.284999999999997,47.838000000000001,51.631,36.984000000000002],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[10.783405024340219,10.009703599266199,14.283687002188348,10.470949619390289,61.496215850035725,10.249996389225963,44.531929197948173,17.458893388022247,11.807202556293788,10.577370742754743,10.179749363329249,16.877533256593942,10.081565559729299,10.857052961423014,12.052435635919418,10.035149756232274,10.145166175366937,10.689005099588408,10.074360908067979,11.761628039448437,10.764548354619471,10.044689616517672,14.134896455267199,12.409098586348502,10.379363015626259,10.130881229035968,10.797016722940203,10.383636609850495,10.927468435758502,12.318161614772579,12.689434873650796,10.073892419379264,10.455982961954591],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 34.02 <br>GDP per capita: 836.2 <br>Pop.:    11,537,966","Country: Bahrain <br>Life Expectancy: 59.92 <br>GDP per capita: 14804.67 <br>Pop.:       202,182","Country: Bangladesh <br>Life Expectancy: 43.45 <br>GDP per capita: 721.19 <br>Pop.:    62,821,884","Country: Cambodia <br>Life Expectancy: 45.42 <br>GDP per capita: 523.43 <br>Pop.:     6,960,067","Country: China <br>Life Expectancy: 58.38 <br>GDP per capita: 612.71 <br>Pop.:   754,550,000","Country: Hong Kong, China <br>Life Expectancy: 70 <br>GDP per capita: 6197.96 <br>Pop.:     3,722,800","Country: India <br>Life Expectancy: 47.19 <br>GDP per capita: 700.77 <br>Pop.:   506,000,000","Country: Indonesia <br>Life Expectancy: 45.96 <br>GDP per capita: 762.43 <br>Pop.:   109,343,000","Country: Iran <br>Life Expectancy: 52.47 <br>GDP per capita: 5906.73 <br>Pop.:    26,538,000","Country: Iraq <br>Life Expectancy: 54.46 <br>GDP per capita: 8931.46 <br>Pop.:     8,519,282","Country: Israel <br>Life Expectancy: 70.75 <br>GDP per capita: 8393.74 <br>Pop.:     2,693,585","Country: Japan <br>Life Expectancy: 71.43 <br>GDP per capita: 9847.79 <br>Pop.:   100,825,279","Country: Jordan <br>Life Expectancy: 51.63 <br>GDP per capita: 2741.8 <br>Pop.:     1,255,058","Country: Korea, Dem. Rep. <br>Life Expectancy: 59.94 <br>GDP per capita: 2143.54 <br>Pop.:    12,617,009","Country: Korea, Rep. <br>Life Expectancy: 57.72 <br>GDP per capita: 2029.23 <br>Pop.:    30,131,000","Country: Kuwait <br>Life Expectancy: 64.62 <br>GDP per capita: 80894.88 <br>Pop.:       575,003","Country: Lebanon <br>Life Expectancy: 63.87 <br>GDP per capita: 6006.98 <br>Pop.:     2,186,894","Country: Malaysia <br>Life Expectancy: 59.37 <br>GDP per capita: 2277.74 <br>Pop.:    10,154,878","Country: Mongolia <br>Life Expectancy: 51.25 <br>GDP per capita: 1226.04 <br>Pop.:     1,149,500","Country: Myanmar <br>Life Expectancy: 49.38 <br>GDP per capita: 349 <br>Pop.:    25,870,271","Country: Nepal <br>Life Expectancy: 41.47 <br>GDP per capita: 676.44 <br>Pop.:    11,261,690","Country: Oman <br>Life Expectancy: 46.99 <br>GDP per capita: 4720.94 <br>Pop.:       714,775","Country: Pakistan <br>Life Expectancy: 49.8 <br>GDP per capita: 942.41 <br>Pop.:    60,641,899","Country: Philippines <br>Life Expectancy: 56.39 <br>GDP per capita: 1814.13 <br>Pop.:    35,356,600","Country: Saudi Arabia <br>Life Expectancy: 49.9 <br>GDP per capita: 16903.05 <br>Pop.:     5,618,198","Country: Singapore <br>Life Expectancy: 67.95 <br>GDP per capita: 4977.42 <br>Pop.:     1,977,600","Country: Sri Lanka <br>Life Expectancy: 64.27 <br>GDP per capita: 1135.51 <br>Pop.:    11,737,396","Country: Syria <br>Life Expectancy: 53.66 <br>GDP per capita: 1881.92 <br>Pop.:     5,680,812","Country: Taiwan <br>Life Expectancy: 67.5 <br>GDP per capita: 2643.86 <br>Pop.:    13,648,692","Country: Thailand <br>Life Expectancy: 58.28 <br>GDP per capita: 1295.46 <br>Pop.:    34,024,249","Country: Vietnam <br>Life Expectancy: 47.84 <br>GDP per capita: 637.12 <br>Pop.:    39,463,910","Country: West Bank and Gaza <br>Life Expectancy: 51.63 <br>GDP per capita: 2649.72 <br>Pop.:     1,142,636","Country: Yemen, Rep. <br>Life Expectancy: 36.98 <br>GDP per capita: 862.44 <br>Pop.:     6,740,785"],"frame":"1967","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[10.783405024340219,10.009703599266199,14.283687002188348,10.470949619390289,61.496215850035725,10.249996389225963,44.531929197948173,17.458893388022247,11.807202556293788,10.577370742754743,10.179749363329249,16.877533256593942,10.081565559729299,10.857052961423014,12.052435635919418,10.035149756232274,10.145166175366937,10.689005099588408,10.074360908067979,11.761628039448437,10.764548354619471,10.044689616517672,14.134896455267199,12.409098586348502,10.379363015626259,10.130881229035968,10.797016722940203,10.383636609850495,10.927468435758502,12.318161614772579,12.689434873650796,10.073892419379264,10.455982961954591]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.4409400686578051,4.1083824193136085,4.1188940858239746,3.3369302826794054,3.74640086253428,3.8426278253319288,4.0568837033470313,4.2024123287676014,4.0382877084652833,4.1139406015436917,4.1686632030124073,3.9300875826785662,3.969725431164286,4.1245008234996154,3.883977473062878,4.0009717884712304,3.771429528946098,4.1864831361563457,4.2138331094718406,3.8167153024709708,3.8035607598812735,3.810962443035351,3.9026395565553464,3.9249458504406074,3.9733813981731432,3.9027376472408295,4.1835060632515271,4.3610880896180904,3.4512269229580035,4.1505369625724482],"y":[66.219999999999999,70.140000000000001,70.939999999999998,64.790000000000006,70.420000000000002,68.5,70.379999999999995,72.959999999999994,69.829999999999998,71.549999999999997,70.799999999999997,71,69.5,73.730000000000004,71.079999999999998,71.060000000000002,67.177999999999997,73.819999999999993,74.079999999999998,69.609999999999999,66.599999999999994,66.799999999999997,66.914000000000001,70.980000000000004,69.180000000000007,71.439999999999998,74.159999999999997,72.769999999999996,54.335999999999999,71.359999999999999],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.13132214350699,10.499406416807878,10.64816399752322,10.24059112388435,10.563102040641128,10.280817129786561,10.66717990152584,10.326166752950485,10.310259978498708,13.379137723802248,15.208281167017487,10.590827438759728,10.693683434186198,10.009464304198801,10.193844634534059,13.590592386754704,10.03010121728606,10.855675137827577,10.254311276523723,12.165351920863724,10.617211255633372,11.312150750037869,10.539963995852537,10.299100201176897,10.10831077631255,12.238034350809201,10.53291407377416,10.409722092799552,12.276327158340322,13.74702146974774],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 66.22 <br>GDP per capita: 2760.2 <br>Pop.:     1,984,060","Country: Austria <br>Life Expectancy: 70.14 <br>GDP per capita: 12834.6 <br>Pop.:     7,376,998","Country: Belgium <br>Life Expectancy: 70.94 <br>GDP per capita: 13149.04 <br>Pop.:     9,556,500","Country: Bosnia and Herzegovina <br>Life Expectancy: 64.79 <br>GDP per capita: 2172.35 <br>Pop.:     3,585,000","Country: Bulgaria <br>Life Expectancy: 70.42 <br>GDP per capita: 5577 <br>Pop.:     8,310,226","Country: Croatia <br>Life Expectancy: 68.5 <br>GDP per capita: 6960.3 <br>Pop.:     4,174,366","Country: Czech Republic <br>Life Expectancy: 70.38 <br>GDP per capita: 11399.44 <br>Pop.:     9,835,109","Country: Denmark <br>Life Expectancy: 72.96 <br>GDP per capita: 15937.21 <br>Pop.:     4,838,800","Country: Finland <br>Life Expectancy: 69.83 <br>GDP per capita: 10921.64 <br>Pop.:     4,605,744","Country: France <br>Life Expectancy: 71.55 <br>GDP per capita: 12999.92 <br>Pop.:    49,569,000","Country: Germany <br>Life Expectancy: 70.8 <br>GDP per capita: 14745.63 <br>Pop.:    76,368,453","Country: Greece <br>Life Expectancy: 71 <br>GDP per capita: 8513.1 <br>Pop.:     8,716,441","Country: Hungary <br>Life Expectancy: 69.5 <br>GDP per capita: 9326.64 <br>Pop.:    10,223,422","Country: Iceland <br>Life Expectancy: 73.73 <br>GDP per capita: 13319.9 <br>Pop.:       198,676","Country: Ireland <br>Life Expectancy: 71.08 <br>GDP per capita: 7655.57 <br>Pop.:     2,900,100","Country: Italy <br>Life Expectancy: 71.06 <br>GDP per capita: 10022.4 <br>Pop.:    52,667,100","Country: Montenegro <br>Life Expectancy: 67.18 <br>GDP per capita: 5907.85 <br>Pop.:       501,035","Country: Netherlands <br>Life Expectancy: 73.82 <br>GDP per capita: 15363.25 <br>Pop.:    12,596,822","Country: Norway <br>Life Expectancy: 74.08 <br>GDP per capita: 16361.88 <br>Pop.:     3,786,019","Country: Poland <br>Life Expectancy: 69.61 <br>GDP per capita: 6557.15 <br>Pop.:    31,785,378","Country: Portugal <br>Life Expectancy: 66.6 <br>GDP per capita: 6361.52 <br>Pop.:     9,103,000","Country: Romania <br>Life Expectancy: 66.8 <br>GDP per capita: 6470.87 <br>Pop.:    19,284,814","Country: Serbia <br>Life Expectancy: 66.91 <br>GDP per capita: 7991.71 <br>Pop.:     7,971,222","Country: Slovak Republic <br>Life Expectancy: 70.98 <br>GDP per capita: 8412.9 <br>Pop.:     4,442,238","Country: Slovenia <br>Life Expectancy: 69.18 <br>GDP per capita: 9405.49 <br>Pop.:     1,646,912","Country: Spain <br>Life Expectancy: 71.44 <br>GDP per capita: 7993.51 <br>Pop.:    32,850,275","Country: Sweden <br>Life Expectancy: 74.16 <br>GDP per capita: 15258.3 <br>Pop.:     7,867,931","Country: Switzerland <br>Life Expectancy: 72.77 <br>GDP per capita: 22966.14 <br>Pop.:     6,063,000","Country: Turkey <br>Life Expectancy: 54.34 <br>GDP per capita: 2826.36 <br>Pop.:    33,411,317","Country: United Kingdom <br>Life Expectancy: 71.36 <br>GDP per capita: 14142.85 <br>Pop.:    54,959,000"],"frame":"1967","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.13132214350699,10.499406416807878,10.64816399752322,10.24059112388435,10.563102040641128,10.280817129786561,10.66717990152584,10.326166752950485,10.310259978498708,13.379137723802248,15.208281167017487,10.590827438759728,10.693683434186198,10.009464304198801,10.193844634534059,13.590592386754704,10.03010121728606,10.855675137827577,10.254311276523723,12.165351920863724,10.617211255633372,11.312150750037869,10.539963995852537,10.299100201176897,10.10831077631255,12.238034350809201,10.53291407377416,10.409722092799552,12.276327158340322,13.74702146974774]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.1621497665619112,4.160285978925514],"y":[71.099999999999994,71.519999999999996],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[10.806221870444503,10.182108528761272],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 71.1 <br>GDP per capita: 14526.12 <br>Pop.:    11,872,264","Country: New Zealand <br>Life Expectancy: 71.52 <br>GDP per capita: 14463.92 <br>Pop.:     2,728,150"],"frame":"1967","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[10.806221870444503,10.182108528761272]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1972","data":[{"x":[3.6214529541240323,3.7382483013658501,3.0357485889912157,3.3548018175910084,2.9318319840337232,2.6666111041794101,3.2263798742975069,3.0293891657445404,3.0430099781518227,3.2872591218352252,2.9565987013389754,3.5069313629025629,3.3762485776604954,3.5675218560882951,3.3062122562853618,2.8276356213979761,2.7112369661648557,2.7530035704035161,4.0569790716353991,2.878571676930044,3.0712277572813074,2.8702085053101332,2.9139327838480185,3.0871991184228902,2.6959906166399419,2.9047184947393467,4.3224569999011493,3.2426812799065963,2.7668751327137411,2.7644517778646858,3.2005363636168687,3.4108588828462456,3.2856011806604903,2.8602887659871894,3.5735771576868127,2.979643616011117,3.2300371269357706,3.703089970400089,2.7712792236273116,3.185537977334981,3.2034985123007074,3.1315416013544821,3.098497019204177,3.890195296715043,3.2200172364286068,3.5269639825025032,2.9618883898688173,3.2173944935016525,3.4398513255106518,2.9780598791155093,3.2488307679411474,2.9027435944745257],"y":[54.518000000000001,37.927999999999997,47.014000000000003,56.024000000000001,43.591000000000001,44.057000000000002,47.048999999999999,43.457000000000001,45.569000000000003,48.944000000000003,45.988999999999997,54.906999999999996,49.801000000000002,44.366,51.137,40.515999999999998,44.142000000000003,43.515000000000001,48.689999999999998,38.308,49.875,38.841999999999999,36.485999999999997,53.558999999999997,49.767000000000003,42.613999999999997,52.773000000000003,44.850999999999999,41.765999999999998,39.976999999999997,48.436999999999998,62.944000000000003,52.862000000000002,40.328000000000003,53.866999999999997,40.545999999999999,42.820999999999998,64.274000000000001,44.600000000000001,56.479999999999997,45.814999999999998,35.399999999999999,40.972999999999999,53.695999999999998,45.082999999999998,49.552,47.619999999999997,49.759,55.601999999999997,51.015999999999998,50.106999999999999,55.634999999999998],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[11.003372271463,10.398245894504418,10.184378419250866,10.038176640901142,10.366783166093288,10.236836047808158,10.475110391382234,10.127445372306674,10.262027211513592,10.012969164725339,11.566246824808168,10.087394367132591,10.410315621010078,10.008110983435422,12.371615191311474,10.014851309841887,10.150168643528639,12.096074702044216,10.032622620132576,10.031197770210431,10.634350952531671,10.25604271898516,10.038586841515823,10.817996948688336,10.072127601193937,10.097097898145776,10.144960256023426,10.479301262953394,10.318808873272532,10.393693418464609,10.086870730008492,10.054010179868799,11.13304501263149,10.665438562377361,10.051993166796409,10.341282201956899,13.663826847078139,10.027411912024883,10.268378359233715,10.00113190798567,10.3090964011145,10.192405383225942,10.258006631212588,11.629595245558741,10.992194611851499,10.028672681701154,10.999673367617405,10.136256222148576,10.357884406369239,10.691421734058297,10.30348607160931,10.395944198110259],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 54.52 <br>GDP per capita: 4182.66 <br>Pop.:    14,760,787","Country: Angola <br>Life Expectancy: 37.93 <br>GDP per capita: 5473.29 <br>Pop.:     5,894,858","Country: Benin <br>Life Expectancy: 47.01 <br>GDP per capita: 1085.8 <br>Pop.:     2,761,407","Country: Botswana <br>Life Expectancy: 56.02 <br>GDP per capita: 2263.61 <br>Pop.:       619,351","Country: Burkina Faso <br>Life Expectancy: 43.59 <br>GDP per capita: 854.74 <br>Pop.:     5,433,886","Country: Burundi <br>Life Expectancy: 44.06 <br>GDP per capita: 464.1 <br>Pop.:     3,529,983","Country: Cameroon <br>Life Expectancy: 47.05 <br>GDP per capita: 1684.15 <br>Pop.:     7,021,028","Country: Central African Republic <br>Life Expectancy: 43.46 <br>GDP per capita: 1070.01 <br>Pop.:     1,927,260","Country: Chad <br>Life Expectancy: 45.57 <br>GDP per capita: 1104.1 <br>Pop.:     3,899,068","Country: Comoros <br>Life Expectancy: 48.94 <br>GDP per capita: 1937.58 <br>Pop.:       250,027","Country: Congo, Dem. Rep. <br>Life Expectancy: 45.99 <br>GDP per capita: 904.9 <br>Pop.:    23,007,669","Country: Congo, Rep. <br>Life Expectancy: 54.91 <br>GDP per capita: 3213.15 <br>Pop.:     1,340,458","Country: Cote d'Ivoire <br>Life Expectancy: 49.8 <br>GDP per capita: 2378.2 <br>Pop.:     6,071,696","Country: Djibouti <br>Life Expectancy: 44.37 <br>GDP per capita: 3694.21 <br>Pop.:       178,848","Country: Egypt <br>Life Expectancy: 51.14 <br>GDP per capita: 2024.01 <br>Pop.:    34,807,417","Country: Equatorial Guinea <br>Life Expectancy: 40.52 <br>GDP per capita: 672.41 <br>Pop.:       277,603","Country: Eritrea <br>Life Expectancy: 44.14 <br>GDP per capita: 514.32 <br>Pop.:     2,260,187","Country: Ethiopia <br>Life Expectancy: 43.52 <br>GDP per capita: 566.24 <br>Pop.:    30,770,372","Country: Gabon <br>Life Expectancy: 48.69 <br>GDP per capita: 11401.95 <br>Pop.:       537,977","Country: Gambia <br>Life Expectancy: 38.31 <br>GDP per capita: 756.09 <br>Pop.:       517,101","Country: Ghana <br>Life Expectancy: 49.88 <br>GDP per capita: 1178.22 <br>Pop.:     9,354,120","Country: Guinea <br>Life Expectancy: 38.84 <br>GDP per capita: 741.67 <br>Pop.:     3,811,387","Country: Guinea-Bissau <br>Life Expectancy: 36.49 <br>GDP per capita: 820.22 <br>Pop.:       625,361","Country: Kenya <br>Life Expectancy: 53.56 <br>GDP per capita: 1222.36 <br>Pop.:    12,044,785","Country: Lesotho <br>Life Expectancy: 49.77 <br>GDP per capita: 496.58 <br>Pop.:     1,116,779","Country: Liberia <br>Life Expectancy: 42.61 <br>GDP per capita: 803.01 <br>Pop.:     1,482,628","Country: Libya <br>Life Expectancy: 52.77 <br>GDP per capita: 21011.5 <br>Pop.:     2,183,877","Country: Madagascar <br>Life Expectancy: 44.85 <br>GDP per capita: 1748.56 <br>Pop.:     7,082,430","Country: Malawi <br>Life Expectancy: 41.77 <br>GDP per capita: 584.62 <br>Pop.:     4,730,997","Country: Mali <br>Life Expectancy: 39.98 <br>GDP per capita: 581.37 <br>Pop.:     5,828,158","Country: Mauritania <br>Life Expectancy: 48.44 <br>GDP per capita: 1586.85 <br>Pop.:     1,332,786","Country: Mauritius <br>Life Expectancy: 62.94 <br>GDP per capita: 2575.48 <br>Pop.:       851,334","Country: Morocco <br>Life Expectancy: 52.86 <br>GDP per capita: 1930.19 <br>Pop.:    16,660,670","Country: Mozambique <br>Life Expectancy: 40.33 <br>GDP per capita: 724.92 <br>Pop.:     9,809,596","Country: Namibia <br>Life Expectancy: 53.87 <br>GDP per capita: 3746.08 <br>Pop.:       821,782","Country: Niger <br>Life Expectancy: 40.55 <br>GDP per capita: 954.21 <br>Pop.:     5,060,262","Country: Nigeria <br>Life Expectancy: 42.82 <br>GDP per capita: 1698.39 <br>Pop.:    53,740,085","Country: Reunion <br>Life Expectancy: 64.27 <br>GDP per capita: 5047.66 <br>Pop.:       461,633","Country: Rwanda <br>Life Expectancy: 44.6 <br>GDP per capita: 590.58 <br>Pop.:     3,992,121","Country: Sao Tome and Principe <br>Life Expectancy: 56.48 <br>GDP per capita: 1532.99 <br>Pop.:        76,595","Country: Senegal <br>Life Expectancy: 45.81 <br>GDP per capita: 1597.71 <br>Pop.:     4,588,696","Country: Sierra Leone <br>Life Expectancy: 35.4 <br>GDP per capita: 1353.76 <br>Pop.:     2,879,013","Country: Somalia <br>Life Expectancy: 40.97 <br>GDP per capita: 1254.58 <br>Pop.:     3,840,161","Country: South Africa <br>Life Expectancy: 53.7 <br>GDP per capita: 7765.96 <br>Pop.:    23,935,810","Country: Sudan <br>Life Expectancy: 45.08 <br>GDP per capita: 1659.65 <br>Pop.:    14,597,019","Country: Swaziland <br>Life Expectancy: 49.55 <br>GDP per capita: 3364.84 <br>Pop.:       480,105","Country: Tanzania <br>Life Expectancy: 47.62 <br>GDP per capita: 915.99 <br>Pop.:    14,706,593","Country: Togo <br>Life Expectancy: 49.76 <br>GDP per capita: 1649.66 <br>Pop.:     2,056,351","Country: Tunisia <br>Life Expectancy: 55.6 <br>GDP per capita: 2753.29 <br>Pop.:     5,303,507","Country: Uganda <br>Life Expectancy: 51.02 <br>GDP per capita: 950.74 <br>Pop.:    10,190,285","Country: Zambia <br>Life Expectancy: 50.11 <br>GDP per capita: 1773.5 <br>Pop.:     4,506,497","Country: Zimbabwe <br>Life Expectancy: 55.63 <br>GDP per capita: 799.36 <br>Pop.:     5,861,135"],"frame":"1972","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[11.003372271463,10.398245894504418,10.184378419250866,10.038176640901142,10.366783166093288,10.236836047808158,10.475110391382234,10.127445372306674,10.262027211513592,10.012969164725339,11.566246824808168,10.087394367132591,10.410315621010078,10.008110983435422,12.371615191311474,10.014851309841887,10.150168643528639,12.096074702044216,10.032622620132576,10.031197770210431,10.634350952531671,10.25604271898516,10.038586841515823,10.817996948688336,10.072127601193937,10.097097898145776,10.144960256023426,10.479301262953394,10.318808873272532,10.393693418464609,10.086870730008492,10.054010179868799,11.13304501263149,10.665438562377361,10.051993166796409,10.341282201956899,13.663826847078139,10.027411912024883,10.268378359233715,10.00113190798567,10.3090964011145,10.192405383225942,10.258006631212588,11.629595245558741,10.992194611851499,10.028672681701154,10.999673367617405,10.136256222148576,10.357884406369239,10.691421734058297,10.30348607160931,10.395944198110259]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.9751117615378058,3.4742645495460733,3.6977271414129218,4.2780803998194843,3.7398905867974395,3.5138379635575769,3.7091127500702807,3.724721837645331,3.34041922627685,3.7227157324536604,3.6551620713179189,3.6054567824903887,3.2186554699800589,3.4030934576066794,3.8712160892056029,3.833109273075149,3.6710425595549974,3.7295089825911916,3.4019754240077367,3.7736275608701724,3.960139661960012,3.8208285600055905,4.338576723540454,3.7561345088425413,4.0214067913932325],"y":[67.064999999999998,46.713999999999999,59.503999999999998,72.879999999999995,63.441000000000003,61.622999999999998,67.849000000000004,70.722999999999999,59.631,58.795999999999999,58.207000000000001,53.738,48.042000000000002,53.884,69,62.360999999999997,55.151000000000003,66.215999999999994,65.814999999999998,55.448,72.159999999999997,65.900000000000006,71.340000000000003,68.673000000000002,65.712000000000003],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[11.687200038667608,10.307538594320908,16.878541967889177,11.516888360861664,10.659154370864059,11.534524257172396,10.121134425611849,10.598670187849775,10.314736352427806,10.42580598382289,10.254644624244539,10.347378492922411,10.316577272723842,10.198284220088564,10.132247381365994,13.817000875576207,10.144894118852774,10.106227148298409,10.174324545516356,10.948354404094177,10.190229408883738,10.062464339459066,24.321938713821318,10.189027746317667,10.78188182182477],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 67.06 <br>GDP per capita: 9443.04 <br>Pop.:    24,779,799","Country: Bolivia <br>Life Expectancy: 46.71 <br>GDP per capita: 2980.33 <br>Pop.:     4,565,872","Country: Brazil <br>Life Expectancy: 59.5 <br>GDP per capita: 4985.71 <br>Pop.:   100,840,058","Country: Canada <br>Life Expectancy: 72.88 <br>GDP per capita: 18970.57 <br>Pop.:    22,284,500","Country: Chile <br>Life Expectancy: 63.44 <br>GDP per capita: 5494.02 <br>Pop.:     9,717,524","Country: Colombia <br>Life Expectancy: 61.62 <br>GDP per capita: 3264.66 <br>Pop.:    22,542,890","Country: Costa Rica <br>Life Expectancy: 67.85 <br>GDP per capita: 5118.15 <br>Pop.:     1,834,796","Country: Cuba <br>Life Expectancy: 70.72 <br>GDP per capita: 5305.45 <br>Pop.:     8,831,348","Country: Dominican Republic <br>Life Expectancy: 59.63 <br>GDP per capita: 2189.87 <br>Pop.:     4,671,329","Country: Ecuador <br>Life Expectancy: 58.8 <br>GDP per capita: 5280.99 <br>Pop.:     6,298,651","Country: El Salvador <br>Life Expectancy: 58.21 <br>GDP per capita: 4520.25 <br>Pop.:     3,790,903","Country: Guatemala <br>Life Expectancy: 53.74 <br>GDP per capita: 4031.41 <br>Pop.:     5,149,581","Country: Haiti <br>Life Expectancy: 48.04 <br>GDP per capita: 1654.46 <br>Pop.:     4,698,301","Country: Honduras <br>Life Expectancy: 53.88 <br>GDP per capita: 2529.84 <br>Pop.:     2,965,146","Country: Jamaica <br>Life Expectancy: 69 <br>GDP per capita: 7433.89 <br>Pop.:     1,997,616","Country: Mexico <br>Life Expectancy: 62.36 <br>GDP per capita: 6809.41 <br>Pop.:    55,984,294","Country: Nicaragua <br>Life Expectancy: 55.15 <br>GDP per capita: 4688.59 <br>Pop.:     2,182,908","Country: Panama <br>Life Expectancy: 66.22 <br>GDP per capita: 5364.25 <br>Pop.:     1,616,384","Country: Paraguay <br>Life Expectancy: 65.82 <br>GDP per capita: 2523.34 <br>Pop.:     2,614,104","Country: Peru <br>Life Expectancy: 55.45 <br>GDP per capita: 5937.83 <br>Pop.:    13,954,700","Country: Puerto Rico <br>Life Expectancy: 72.16 <br>GDP per capita: 9123.04 <br>Pop.:     2,847,132","Country: Trinidad and Tobago <br>Life Expectancy: 65.9 <br>GDP per capita: 6619.55 <br>Pop.:       975,199","Country: United States <br>Life Expectancy: 71.34 <br>GDP per capita: 21806.04 <br>Pop.:   209,896,000","Country: Uruguay <br>Life Expectancy: 68.67 <br>GDP per capita: 5703.41 <br>Pop.:     2,829,526","Country: Venezuela <br>Life Expectancy: 65.71 <br>GDP per capita: 10505.26 <br>Pop.:    11,515,649"],"frame":"1972","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[11.687200038667608,10.307538594320908,16.878541967889177,11.516888360861664,10.659154370864059,11.534524257172396,10.121134425611849,10.598670187849775,10.314736352427806,10.42580598382289,10.254644624244539,10.347378492922411,10.316577272723842,10.198284220088564,10.132247381365994,13.817000875576207,10.144894118852774,10.106227148298409,10.174324545516356,10.948354404094177,10.190229408883738,10.062464339459066,24.321938713821318,10.189027746317667,10.78188182182477]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.8692206308775194,4.2617066548942049,2.7995015715034701,2.6249253506191907,2.8305245731879944,3.9199107280903096,2.8597580772182765,3.0457562381838721,3.9828959236255654,3.981185842463443,4.1067663634473126,4.1696387710820595,3.3244586708574659,3.5683920093487456,3.4815682618989903,5.0388103158678046,3.8742721194509575,3.4547068970268824,3.1528207855628172,2.5526682161121932,2.8291674341800372,4.0260442977636508,3.0211640600365772,3.2987164529395239,4.3951066325303207,3.9343851260999863,3.0840023907234819,3.4101735264811497,3.6087959286465519,3.1830872409996234,2.8447887395894171,3.4960171248956784,3.1021066716968924],"y":[36.088000000000001,63.299999999999997,45.252000000000002,40.317,63.118879999999997,72,50.651000000000003,49.203000000000003,55.234000000000002,56.950000000000003,71.629999999999995,73.420000000000002,56.527999999999999,63.982999999999997,62.612000000000002,67.712000000000003,65.421000000000006,63.009999999999998,53.753999999999998,53.07,43.970999999999997,52.143000000000001,51.929000000000002,58.064999999999998,53.886000000000003,69.521000000000001,65.042000000000002,57.295999999999999,69.390000000000001,60.405000000000001,50.253999999999998,56.531999999999996,39.847999999999999],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[10.888616636041981,10.011656864023429,14.825439227010044,10.504430384669019,68.832049804436721,10.276812998461953,48.695363057442606,18.273766123243625,12.085401841724924,10.682632179156791,10.207208096921798,17.311826775730989,10.106033787509491,11.0047683186132,12.282721305459322,10.053368601536352,10.178823374687088,10.776818335468471,10.086032173477381,11.938820986134942,10.843100953294776,10.052489229702815,14.7276071311917,12.784049317625893,10.437689174841042,10.142811855898913,10.884335329227154,10.453279255307441,11.035127122774435,12.676619892484288,13.043743368105829,10.070270641439588,10.501459262712665],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 36.09 <br>GDP per capita: 739.98 <br>Pop.:    13,079,460","Country: Bahrain <br>Life Expectancy: 63.3 <br>GDP per capita: 18268.66 <br>Pop.:       230,800","Country: Bangladesh <br>Life Expectancy: 45.25 <br>GDP per capita: 630.23 <br>Pop.:    70,759,295","Country: Cambodia <br>Life Expectancy: 40.32 <br>GDP per capita: 421.62 <br>Pop.:     7,450,606","Country: China <br>Life Expectancy: 63.12 <br>GDP per capita: 676.9 <br>Pop.:   862,030,000","Country: Hong Kong, China <br>Life Expectancy: 72 <br>GDP per capita: 8315.93 <br>Pop.:     4,115,700","Country: India <br>Life Expectancy: 50.65 <br>GDP per capita: 724.03 <br>Pop.:   567,000,000","Country: Indonesia <br>Life Expectancy: 49.2 <br>GDP per capita: 1111.11 <br>Pop.:   121,282,000","Country: Iran <br>Life Expectancy: 55.23 <br>GDP per capita: 9613.82 <br>Pop.:    30,614,000","Country: Iraq <br>Life Expectancy: 56.95 <br>GDP per capita: 9576.04 <br>Pop.:    10,061,506","Country: Israel <br>Life Expectancy: 71.63 <br>GDP per capita: 12786.93 <br>Pop.:     3,095,893","Country: Japan <br>Life Expectancy: 73.42 <br>GDP per capita: 14778.79 <br>Pop.:   107,188,273","Country: Jordan <br>Life Expectancy: 56.53 <br>GDP per capita: 2110.86 <br>Pop.:     1,613,551","Country: Korea, Dem. Rep. <br>Life Expectancy: 63.98 <br>GDP per capita: 3701.62 <br>Pop.:    14,781,241","Country: Korea, Rep. <br>Life Expectancy: 62.61 <br>GDP per capita: 3030.88 <br>Pop.:    33,505,000","Country: Kuwait <br>Life Expectancy: 67.71 <br>GDP per capita: 109347.87 <br>Pop.:       841,934","Country: Lebanon <br>Life Expectancy: 65.42 <br>GDP per capita: 7486.38 <br>Pop.:     2,680,018","Country: Malaysia <br>Life Expectancy: 63.01 <br>GDP per capita: 2849.09 <br>Pop.:    11,441,462","Country: Mongolia <br>Life Expectancy: 53.75 <br>GDP per capita: 1421.74 <br>Pop.:     1,320,500","Country: Myanmar <br>Life Expectancy: 53.07 <br>GDP per capita: 357 <br>Pop.:    28,466,390","Country: Nepal <br>Life Expectancy: 43.97 <br>GDP per capita: 674.79 <br>Pop.:    12,412,593","Country: Oman <br>Life Expectancy: 52.14 <br>GDP per capita: 10618.04 <br>Pop.:       829,050","Country: Pakistan <br>Life Expectancy: 51.93 <br>GDP per capita: 1049.94 <br>Pop.:    69,325,921","Country: Philippines <br>Life Expectancy: 58.06 <br>GDP per capita: 1989.37 <br>Pop.:    40,850,141","Country: Saudi Arabia <br>Life Expectancy: 53.89 <br>GDP per capita: 24837.43 <br>Pop.:     6,472,756","Country: Singapore <br>Life Expectancy: 69.52 <br>GDP per capita: 8597.76 <br>Pop.:     2,152,400","Country: Sri Lanka <br>Life Expectancy: 65.04 <br>GDP per capita: 1213.4 <br>Pop.:    13,016,733","Country: Syria <br>Life Expectancy: 57.3 <br>GDP per capita: 2571.42 <br>Pop.:     6,701,172","Country: Taiwan <br>Life Expectancy: 69.39 <br>GDP per capita: 4062.52 <br>Pop.:    15,226,039","Country: Thailand <br>Life Expectancy: 60.41 <br>GDP per capita: 1524.36 <br>Pop.:    39,276,153","Country: Vietnam <br>Life Expectancy: 50.25 <br>GDP per capita: 699.5 <br>Pop.:    44,655,014","Country: West Bank and Gaza <br>Life Expectancy: 56.53 <br>GDP per capita: 3133.41 <br>Pop.:     1,089,572","Country: Yemen, Rep. <br>Life Expectancy: 39.85 <br>GDP per capita: 1265.05 <br>Pop.:     7,407,075"],"frame":"1972","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[10.888616636041981,10.011656864023429,14.825439227010044,10.504430384669019,68.832049804436721,10.276812998461953,48.695363057442606,18.273766123243625,12.085401841724924,10.682632179156791,10.207208096921798,17.311826775730989,10.106033787509491,11.0047683186132,12.282721305459322,10.053368601536352,10.178823374687088,10.776818335468471,10.086032173477381,11.938820986134942,10.843100953294776,10.052489229702815,14.7276071311917,12.784049317625893,10.437689174841042,10.142811855898913,10.884335329227154,10.453279255307441,11.035127122774435,12.676619892484288,13.043743368105829,10.070270641439588,10.501459262712665]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.5202767761285583,4.2217173713005751,4.2219914412455939,3.4563918091082697,3.8193790301283554,3.962089351738038,4.1175514611333295,4.2756846000415036,4.1571204420277397,4.2070198277460182,4.2556627187459952,4.1046519743247716,4.0072635603389894,4.1986038584300402,3.9791281210850418,4.0888188575377171,3.8908910553598126,4.2740364532281809,4.277954118204188,3.903443087304284,3.9553147325781945,3.9037091968278945,4.0221010830951052,3.9856136082143259,4.0928429245134081,4.026890657000318,4.2512006555736077,4.4344908683560513,3.5379067482536724,4.2012637128758632],"y":[67.689999999999998,70.629999999999995,71.439999999999998,67.450000000000003,70.900000000000006,69.609999999999999,70.290000000000006,73.469999999999999,70.870000000000005,72.379999999999995,71,72.340000000000003,69.760000000000005,74.459999999999994,71.280000000000001,72.189999999999998,70.635999999999996,73.75,74.340000000000003,70.849999999999994,69.260000000000005,69.209999999999994,68.700000000000003,70.349999999999994,69.819999999999993,73.060000000000002,74.719999999999999,73.780000000000001,57.005000000000003,72.010000000000005],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.150398451427082,10.510818525522781,10.658579407473365,10.256562329181428,10.581255567810722,10.284294211336366,10.669026077303963,10.336595540491391,10.312574642965545,13.526768993279076,15.368582584764926,10.602579720496854,10.705332107847937,10.010187717895141,10.202328484185456,13.706517674078185,10.031919682340462,10.905708146312334,10.264343445799753,12.250952598786029,10.608164318615732,11.406192073453651,10.563311031370272,10.309419715642246,10.11155948327721,12.351531332397386,10.550275046944138,10.432818912767631,12.55491111775887,13.823464845528623],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 67.69 <br>GDP per capita: 3313.42 <br>Pop.:     2,263,554","Country: Austria <br>Life Expectancy: 70.63 <br>GDP per capita: 16661.63 <br>Pop.:     7,544,201","Country: Belgium <br>Life Expectancy: 71.44 <br>GDP per capita: 16672.14 <br>Pop.:     9,709,100","Country: Bosnia and Herzegovina <br>Life Expectancy: 67.45 <br>GDP per capita: 2860.17 <br>Pop.:     3,819,000","Country: Bulgaria <br>Life Expectancy: 70.9 <br>GDP per capita: 6597.49 <br>Pop.:     8,576,200","Country: Croatia <br>Life Expectancy: 69.61 <br>GDP per capita: 9164.09 <br>Pop.:     4,225,310","Country: Czech Republic <br>Life Expectancy: 70.29 <br>GDP per capita: 13108.45 <br>Pop.:     9,862,158","Country: Denmark <br>Life Expectancy: 73.47 <br>GDP per capita: 18866.21 <br>Pop.:     4,991,596","Country: Finland <br>Life Expectancy: 70.87 <br>GDP per capita: 14358.88 <br>Pop.:     4,639,657","Country: France <br>Life Expectancy: 72.38 <br>GDP per capita: 16107.19 <br>Pop.:    51,732,000","Country: Germany <br>Life Expectancy: 71 <br>GDP per capita: 18016.18 <br>Pop.:    78,717,088","Country: Greece <br>Life Expectancy: 72.34 <br>GDP per capita: 12724.83 <br>Pop.:     8,888,628","Country: Hungary <br>Life Expectancy: 69.76 <br>GDP per capita: 10168.66 <br>Pop.:    10,394,091","Country: Iceland <br>Life Expectancy: 74.46 <br>GDP per capita: 15798.06 <br>Pop.:       209,275","Country: Ireland <br>Life Expectancy: 71.28 <br>GDP per capita: 9530.77 <br>Pop.:     3,024,400","Country: Italy <br>Life Expectancy: 72.19 <br>GDP per capita: 12269.27 <br>Pop.:    54,365,564","Country: Montenegro <br>Life Expectancy: 70.64 <br>GDP per capita: 7778.41 <br>Pop.:       527,678","Country: Netherlands <br>Life Expectancy: 73.75 <br>GDP per capita: 18794.75 <br>Pop.:    13,329,874","Country: Norway <br>Life Expectancy: 74.34 <br>GDP per capita: 18965.06 <br>Pop.:     3,933,004","Country: Poland <br>Life Expectancy: 70.85 <br>GDP per capita: 8006.51 <br>Pop.:    33,039,545","Country: Portugal <br>Life Expectancy: 69.26 <br>GDP per capita: 9022.25 <br>Pop.:     8,970,450","Country: Romania <br>Life Expectancy: 69.21 <br>GDP per capita: 8011.41 <br>Pop.:    20,662,648","Country: Serbia <br>Life Expectancy: 68.7 <br>GDP per capita: 10522.07 <br>Pop.:     8,313,288","Country: Slovak Republic <br>Life Expectancy: 70.35 <br>GDP per capita: 9674.17 <br>Pop.:     4,593,433","Country: Slovenia <br>Life Expectancy: 69.82 <br>GDP per capita: 12383.49 <br>Pop.:     1,694,510","Country: Spain <br>Life Expectancy: 73.06 <br>GDP per capita: 10638.75 <br>Pop.:    34,513,161","Country: Sweden <br>Life Expectancy: 74.72 <br>GDP per capita: 17832.02 <br>Pop.:     8,122,293","Country: Switzerland <br>Life Expectancy: 73.78 <br>GDP per capita: 27195.11 <br>Pop.:     6,401,400","Country: Turkey <br>Life Expectancy: 57.01 <br>GDP per capita: 3450.7 <br>Pop.:    37,492,953","Country: United Kingdom <br>Life Expectancy: 72.01 <br>GDP per capita: 15895.12 <br>Pop.:    56,079,000"],"frame":"1972","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.150398451427082,10.510818525522781,10.658579407473365,10.256562329181428,10.581255567810722,10.284294211336366,10.669026077303963,10.336595540491391,10.312574642965545,13.526768993279076,15.368582584764926,10.602579720496854,10.705332107847937,10.010187717895141,10.202328484185456,13.706517674078185,10.031919682340462,10.905708146312334,10.264343445799753,12.250952598786029,10.608164318615732,11.406192073453651,10.563311031370272,10.309419715642246,10.11155948327721,12.351531332397386,10.550275046944138,10.432818912767631,12.55491111775887,13.823464845528623]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.2250152444663822,4.205367796870557],"y":[71.930000000000007,71.890000000000001],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[10.895274035036326,10.195823971942673],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 71.93 <br>GDP per capita: 16788.63 <br>Pop.:    13,177,000","Country: New Zealand <br>Life Expectancy: 71.89 <br>GDP per capita: 16046.04 <br>Pop.:     2,929,100"],"frame":"1972","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[10.895274035036326,10.195823971942673]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1977","data":[{"x":[3.6911183530496898,3.4783712868584864,3.0124834262036022,3.5071617703478073,2.8712149835887169,2.7451554449973283,3.251256767481872,3.0450781155775246,3.0546072907338493,3.0691510183611159,2.9007806215537344,3.5131082104263265,3.4010102840839487,3.4887989579220777,3.4449021621473928,2.9816223887272773,2.7039391611549011,2.7457057654619716,4.3373708614866953,2.9468231486966898,2.9970471864270807,2.9418521079977484,2.883505834937679,3.1029867543384531,2.872371641526537,2.8063987207202028,4.3414584993460537,3.1887115876386662,2.8216600218142123,2.8365742816530246,3.1753645756243167,3.5694889605217628,3.3748619396576061,2.7009802395539166,3.5884382151405165,2.9078932638139743,3.2970930897846071,3.6354640490023047,2.8261270452494891,3.2399402243814448,3.1936168304000399,3.1297817541303088,3.1616651715203168,3.9046426035868569,3.3430122148809409,3.5776538393432196,2.9833972607424988,3.1854789744349987,3.4942766262882694,2.9262051061422851,3.201038696890671,2.8360630060504155],"y":[58.014000000000003,39.482999999999997,49.189999999999998,59.319000000000003,46.137,45.909999999999997,49.354999999999997,46.774999999999999,47.383000000000003,50.939,47.804000000000002,55.625,52.374000000000002,46.518999999999998,53.319000000000003,42.024000000000001,44.534999999999997,44.509999999999998,52.789999999999999,41.841999999999999,51.756,40.762,37.465000000000003,56.155000000000001,52.207999999999998,43.764000000000003,57.442,46.881,43.767000000000003,41.713999999999999,50.851999999999997,64.930000000000007,55.729999999999997,42.494999999999997,56.436999999999998,41.290999999999997,44.514000000000003,67.063999999999993,45,58.549999999999997,48.878999999999998,36.787999999999997,41.973999999999997,55.527000000000001,47.799999999999997,52.536999999999999,49.918999999999997,52.887,59.837000000000003,50.350000000000001,51.386000000000003,57.673999999999999],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[11.166634641467695,10.416525211978978,10.212147840563553,10.049241887798438,10.397885245577966,10.257614449393627,10.539188846371516,10.143844728761138,10.295416039982342,10.016703423632235,11.80330326159882,10.100793184581628,10.50504247769938,10.011513123175757,12.643019616177886,10.009054717861245,10.167399458200748,12.358673191285742,10.044115745175203,10.037420602264065,10.715160678382937,10.284411333508544,10.046768125555758,10.985600346895186,10.081324353577505,10.112181063476529,10.181673961820561,10.542417282190991,10.380663099038646,10.438978679036246,10.095327414960281,10.058220776561029,11.251550741658676,10.755414599767908,10.062589037715808,10.383723564190445,14.241867629672205,10.029491035340095,10.313763269205923,10.001828156982402,10.35497327881227,10.210279755567907,10.293054895212912,11.847603699430152,11.163370918839934,10.033540486666059,11.165048509673255,10.153471748145529,10.405767581416185,10.777930586586082,10.351949329023009,10.449247891030211],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 58.01 <br>GDP per capita: 4910.42 <br>Pop.:    17,152,804","Country: Angola <br>Life Expectancy: 39.48 <br>GDP per capita: 3008.65 <br>Pop.:     6,162,675","Country: Benin <br>Life Expectancy: 49.19 <br>GDP per capita: 1029.16 <br>Pop.:     3,168,267","Country: Botswana <br>Life Expectancy: 59.32 <br>GDP per capita: 3214.86 <br>Pop.:       781,472","Country: Burkina Faso <br>Life Expectancy: 46.14 <br>GDP per capita: 743.39 <br>Pop.:     5,889,574","Country: Burundi <br>Life Expectancy: 45.91 <br>GDP per capita: 556.1 <br>Pop.:     3,834,415","Country: Cameroon <br>Life Expectancy: 49.35 <br>GDP per capita: 1783.43 <br>Pop.:     7,959,865","Country: Central African Republic <br>Life Expectancy: 46.77 <br>GDP per capita: 1109.37 <br>Pop.:     2,167,533","Country: Chad <br>Life Expectancy: 47.38 <br>GDP per capita: 1133.98 <br>Pop.:     4,388,260","Country: Comoros <br>Life Expectancy: 50.94 <br>GDP per capita: 1172.6 <br>Pop.:       304,739","Country: Congo, Dem. Rep. <br>Life Expectancy: 47.8 <br>GDP per capita: 795.76 <br>Pop.:    26,480,870","Country: Congo, Rep. <br>Life Expectancy: 55.62 <br>GDP per capita: 3259.18 <br>Pop.:     1,536,769","Country: Cote d'Ivoire <br>Life Expectancy: 52.37 <br>GDP per capita: 2517.74 <br>Pop.:     7,459,574","Country: Djibouti <br>Life Expectancy: 46.52 <br>GDP per capita: 3081.76 <br>Pop.:       228,694","Country: Egypt <br>Life Expectancy: 53.32 <br>GDP per capita: 2785.49 <br>Pop.:    38,783,863","Country: Equatorial Guinea <br>Life Expectancy: 42.02 <br>GDP per capita: 958.57 <br>Pop.:       192,675","Country: Eritrea <br>Life Expectancy: 44.53 <br>GDP per capita: 505.75 <br>Pop.:     2,512,642","Country: Ethiopia <br>Life Expectancy: 44.51 <br>GDP per capita: 556.81 <br>Pop.:    34,617,799","Country: Gabon <br>Life Expectancy: 52.79 <br>GDP per capita: 21745.57 <br>Pop.:       706,367","Country: Gambia <br>Life Expectancy: 41.84 <br>GDP per capita: 884.76 <br>Pop.:       608,274","Country: Ghana <br>Life Expectancy: 51.76 <br>GDP per capita: 993.22 <br>Pop.:    10,538,093","Country: Guinea <br>Life Expectancy: 40.76 <br>GDP per capita: 874.69 <br>Pop.:     4,227,026","Country: Guinea-Bissau <br>Life Expectancy: 37.47 <br>GDP per capita: 764.73 <br>Pop.:       745,228","Country: Kenya <br>Life Expectancy: 56.16 <br>GDP per capita: 1267.61 <br>Pop.:    14,500,404","Country: Lesotho <br>Life Expectancy: 52.21 <br>GDP per capita: 745.37 <br>Pop.:     1,251,524","Country: Liberia <br>Life Expectancy: 43.76 <br>GDP per capita: 640.32 <br>Pop.:     1,703,617","Country: Libya <br>Life Expectancy: 57.44 <br>GDP per capita: 21951.21 <br>Pop.:     2,721,783","Country: Madagascar <br>Life Expectancy: 46.88 <br>GDP per capita: 1544.23 <br>Pop.:     8,007,166","Country: Malawi <br>Life Expectancy: 43.77 <br>GDP per capita: 663.22 <br>Pop.:     5,637,246","Country: Mali <br>Life Expectancy: 41.71 <br>GDP per capita: 686.4 <br>Pop.:     6,491,649","Country: Mauritania <br>Life Expectancy: 50.85 <br>GDP per capita: 1497.49 <br>Pop.:     1,456,688","Country: Mauritius <br>Life Expectancy: 64.93 <br>GDP per capita: 3710.98 <br>Pop.:       913,025","Country: Morocco <br>Life Expectancy: 55.73 <br>GDP per capita: 2370.62 <br>Pop.:    18,396,941","Country: Mozambique <br>Life Expectancy: 42.49 <br>GDP per capita: 502.32 <br>Pop.:    11,127,868","Country: Namibia <br>Life Expectancy: 56.44 <br>GDP per capita: 3876.49 <br>Pop.:       977,026","Country: Niger <br>Life Expectancy: 41.29 <br>GDP per capita: 808.9 <br>Pop.:     5,682,086","Country: Nigeria <br>Life Expectancy: 44.51 <br>GDP per capita: 1981.95 <br>Pop.:    62,209,173","Country: Reunion <br>Life Expectancy: 67.06 <br>GDP per capita: 4319.8 <br>Pop.:       492,095","Country: Rwanda <br>Life Expectancy: 45 <br>GDP per capita: 670.08 <br>Pop.:     4,657,072","Country: Sao Tome and Principe <br>Life Expectancy: 58.55 <br>GDP per capita: 1737.56 <br>Pop.:        86,796","Country: Senegal <br>Life Expectancy: 48.88 <br>GDP per capita: 1561.77 <br>Pop.:     5,260,855","Country: Sierra Leone <br>Life Expectancy: 36.79 <br>GDP per capita: 1348.29 <br>Pop.:     3,140,897","Country: Somalia <br>Life Expectancy: 41.97 <br>GDP per capita: 1450.99 <br>Pop.:     4,353,666","Country: South Africa <br>Life Expectancy: 55.53 <br>GDP per capita: 8028.65 <br>Pop.:    27,129,932","Country: Sudan <br>Life Expectancy: 47.8 <br>GDP per capita: 2202.99 <br>Pop.:    17,104,986","Country: Swaziland <br>Life Expectancy: 52.54 <br>GDP per capita: 3781.41 <br>Pop.:       551,425","Country: Tanzania <br>Life Expectancy: 49.92 <br>GDP per capita: 962.49 <br>Pop.:    17,129,565","Country: Togo <br>Life Expectancy: 52.89 <br>GDP per capita: 1532.78 <br>Pop.:     2,308,582","Country: Tunisia <br>Life Expectancy: 59.84 <br>GDP per capita: 3120.88 <br>Pop.:     6,005,061","Country: Uganda <br>Life Expectancy: 50.35 <br>GDP per capita: 843.73 <br>Pop.:    11,457,758","Country: Zambia <br>Life Expectancy: 51.39 <br>GDP per capita: 1588.69 <br>Pop.:     5,216,550","Country: Zimbabwe <br>Life Expectancy: 57.67 <br>GDP per capita: 685.59 <br>Pop.:     6,642,107"],"frame":"1977","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[11.166634641467695,10.416525211978978,10.212147840563553,10.049241887798438,10.397885245577966,10.257614449393627,10.539188846371516,10.143844728761138,10.295416039982342,10.016703423632235,11.80330326159882,10.100793184581628,10.50504247769938,10.011513123175757,12.643019616177886,10.009054717861245,10.167399458200748,12.358673191285742,10.044115745175203,10.037420602264065,10.715160678382937,10.284411333508544,10.046768125555758,10.985600346895186,10.081324353577505,10.112181063476529,10.181673961820561,10.542417282190991,10.380663099038646,10.438978679036246,10.095327414960281,10.058220776561029,11.251550741658676,10.755414599767908,10.062589037715808,10.383723564190445,14.241867629672205,10.029491035340095,10.313763269205923,10.001828156982402,10.35497327881227,10.210279755567907,10.293054895212912,11.847603699430152,11.163370918839934,10.033540486666059,11.165048509673255,10.153471748145529,10.405767581416185,10.777930586586082,10.351949329023009,10.449247891030211]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.0034185974017218,3.5499955861630674,3.8234819664553501,4.3442130766871854,3.6773115900854365,3.5815864993917419,3.7728259120361201,3.8048543703613706,3.4284569760962196,3.8247519683562174,3.7108720574987411,3.6884191766121526,3.2728388574858203,3.5055851493977763,3.8228344174874307,3.8850743726643246,3.7392851792172004,3.7285089755203842,3.5116659336205438,3.798048903863704,3.9899178967965394,3.8976025836911923,4.3815235791423897,3.8132032124622239,4.11872592974958],"y":[68.480999999999995,50.023000000000003,61.488999999999997,74.209999999999994,67.052000000000007,63.837000000000003,70.75,72.649000000000001,61.787999999999997,61.310000000000002,56.695999999999998,56.029000000000003,49.923000000000002,57.402000000000001,70.109999999999999,65.031999999999996,57.469999999999999,68.680999999999997,66.352999999999994,58.447000000000003,73.439999999999998,68.299999999999997,73.379999999999995,69.480999999999995,67.456000000000003],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[11.837631661059536,10.342609996093008,17.798175776666309,11.620080092864445,10.719371889352294,11.708673324189528,10.139812613700753,10.646900497726383,10.357836151488277,10.49270861202919,10.288203470971389,10.385180356523183,10.330927673695323,10.204433065874923,10.143113124703106,14.347714608682132,10.170263081659911,10.121474735140103,10.199604779405178,11.087276520720096,10.206179865264531,10.066819564288153,25.027879638554939,10.192030469419546,10.917562944076623],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 68.48 <br>GDP per capita: 10079.03 <br>Pop.:    26,983,828","Country: Bolivia <br>Life Expectancy: 50.02 <br>GDP per capita: 3548.1 <br>Pop.:     5,079,716","Country: Brazil <br>Life Expectancy: 61.49 <br>GDP per capita: 6660.12 <br>Pop.:   114,313,951","Country: Canada <br>Life Expectancy: 74.21 <br>GDP per capita: 22090.88 <br>Pop.:    23,796,400","Country: Chile <br>Life Expectancy: 67.05 <br>GDP per capita: 4756.76 <br>Pop.:    10,599,793","Country: Colombia <br>Life Expectancy: 63.84 <br>GDP per capita: 3815.81 <br>Pop.:    25,094,412","Country: Costa Rica <br>Life Expectancy: 70.75 <br>GDP per capita: 5926.88 <br>Pop.:     2,108,457","Country: Cuba <br>Life Expectancy: 72.65 <br>GDP per capita: 6380.49 <br>Pop.:     9,537,988","Country: Dominican Republic <br>Life Expectancy: 61.79 <br>GDP per capita: 2681.99 <br>Pop.:     5,302,800","Country: Ecuador <br>Life Expectancy: 61.31 <br>GDP per capita: 6679.62 <br>Pop.:     7,278,866","Country: El Salvador <br>Life Expectancy: 56.7 <br>GDP per capita: 5138.92 <br>Pop.:     4,282,586","Country: Guatemala <br>Life Expectancy: 56.03 <br>GDP per capita: 4879.99 <br>Pop.:     5,703,430","Country: Haiti <br>Life Expectancy: 49.92 <br>GDP per capita: 1874.3 <br>Pop.:     4,908,554","Country: Honduras <br>Life Expectancy: 57.4 <br>GDP per capita: 3203.21 <br>Pop.:     3,055,235","Country: Jamaica <br>Life Expectancy: 70.11 <br>GDP per capita: 6650.2 <br>Pop.:     2,156,814","Country: Mexico <br>Life Expectancy: 65.03 <br>GDP per capita: 7674.93 <br>Pop.:    63,759,976","Country: Nicaragua <br>Life Expectancy: 57.47 <br>GDP per capita: 5486.37 <br>Pop.:     2,554,598","Country: Panama <br>Life Expectancy: 68.68 <br>GDP per capita: 5351.91 <br>Pop.:     1,839,782","Country: Paraguay <br>Life Expectancy: 66.35 <br>GDP per capita: 3248.37 <br>Pop.:     2,984,494","Country: Peru <br>Life Expectancy: 58.45 <br>GDP per capita: 6281.29 <br>Pop.:    15,990,099","Country: Puerto Rico <br>Life Expectancy: 73.44 <br>GDP per capita: 9770.52 <br>Pop.:     3,080,828","Country: Trinidad and Tobago <br>Life Expectancy: 68.3 <br>GDP per capita: 7899.55 <br>Pop.:     1,039,009","Country: United States <br>Life Expectancy: 73.38 <br>GDP per capita: 24072.63 <br>Pop.:   220,239,000","Country: Uruguay <br>Life Expectancy: 69.48 <br>GDP per capita: 6504.34 <br>Pop.:     2,873,520","Country: Venezuela <br>Life Expectancy: 67.46 <br>GDP per capita: 13143.95 <br>Pop.:    13,503,563"],"frame":"1977","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[11.837631661059536,10.342609996093008,17.798175776666309,11.620080092864445,10.719371889352294,11.708673324189528,10.139812613700753,10.646900497726383,10.357836151488277,10.49270861202919,10.288203470971389,10.385180356523183,10.330927673695323,10.204433065874923,10.143113124703106,14.347714608682132,10.170263081659911,10.121474735140103,10.199604779405178,11.087276520720096,10.206179865264531,10.066819564288153,25.027879638554939,10.192030469419546,10.917562944076623]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.895485177175058,4.2864587593306771,2.8194631441213511,2.7201362919720538,2.8699573649904884,4.0486802989640038,2.9102707019706675,3.1407286086160719,4.0751305354383804,4.1669696143464741,4.1240677290325536,4.2203794898568407,3.4552030536596505,3.6134508071824585,3.6681268489459771,4.7728017852094968,3.9375026882347894,3.5829630310821168,3.2168284982446189,2.5693739096150461,2.8414298278457881,4.0736576518931686,3.0703782174951728,3.375335124183688,4.5336165409208693,4.0496090791886523,3.1299397171770273,3.5045367264477179,3.7479180466129307,3.2925273397940913,2.8534165708888217,3.5661818483960137,3.2623953581037641],"y":[38.438000000000002,65.593000000000004,46.923000000000002,31.219999999999999,63.967359999999999,73.599999999999994,54.207999999999998,52.701999999999998,57.701999999999998,60.412999999999997,73.060000000000002,75.379999999999995,61.134,67.159000000000006,64.766000000000005,69.343000000000004,66.099000000000004,65.256,55.491,56.058999999999997,46.747999999999998,57.366999999999997,54.042999999999999,60.060000000000002,58.689999999999998,70.795000000000002,65.948999999999998,61.195,70.590000000000003,62.494,55.764000000000003,60.765000000000001,44.174999999999997],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[11.011534308152962,10.016203197291969,15.485378371030112,10.472215030271521,74.389551476720882,10.308755409056106,53.268315001477468,19.327797419836617,12.417567352083784,10.806948901550589,10.23451100888318,17.768043572511854,10.128154657629098,11.110156364356385,12.482770889757326,10.073736870760154,10.208565922384105,10.872640038756792,10.100194673901072,12.147791034615475,10.946886827785212,10.064466473374383,15.330060447106462,13.193623437890896,10.550699034667666,10.154612802035086,10.959420674786685,10.537321307399983,11.141544287464072,13.009157586528982,13.444968165410209,10.081977330163305,10.569501716254269],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 38.44 <br>GDP per capita: 786.11 <br>Pop.:    14,880,372","Country: Bahrain <br>Life Expectancy: 65.59 <br>GDP per capita: 19340.1 <br>Pop.:       297,410","Country: Bangladesh <br>Life Expectancy: 46.92 <br>GDP per capita: 659.88 <br>Pop.:    80,428,306","Country: Cambodia <br>Life Expectancy: 31.22 <br>GDP per capita: 524.97 <br>Pop.:     6,978,607","Country: China <br>Life Expectancy: 63.97 <br>GDP per capita: 741.24 <br>Pop.:   943,455,000","Country: Hong Kong, China <br>Life Expectancy: 73.6 <br>GDP per capita: 11186.14 <br>Pop.:     4,583,700","Country: India <br>Life Expectancy: 54.21 <br>GDP per capita: 813.34 <br>Pop.:   634,000,000","Country: Indonesia <br>Life Expectancy: 52.7 <br>GDP per capita: 1382.7 <br>Pop.:   136,725,000","Country: Iran <br>Life Expectancy: 57.7 <br>GDP per capita: 11888.6 <br>Pop.:    35,480,679","Country: Iraq <br>Life Expectancy: 60.41 <br>GDP per capita: 14688.24 <br>Pop.:    11,882,916","Country: Israel <br>Life Expectancy: 73.06 <br>GDP per capita: 13306.62 <br>Pop.:     3,495,918","Country: Japan <br>Life Expectancy: 75.38 <br>GDP per capita: 16610.38 <br>Pop.:   113,872,473","Country: Jordan <br>Life Expectancy: 61.13 <br>GDP per capita: 2852.35 <br>Pop.:     1,937,652","Country: Korea, Dem. Rep. <br>Life Expectancy: 67.16 <br>GDP per capita: 4106.3 <br>Pop.:    16,325,320","Country: Korea, Rep. <br>Life Expectancy: 64.77 <br>GDP per capita: 4657.22 <br>Pop.:    36,436,000","Country: Kuwait <br>Life Expectancy: 69.34 <br>GDP per capita: 59265.48 <br>Pop.:     1,140,357","Country: Lebanon <br>Life Expectancy: 66.1 <br>GDP per capita: 8659.7 <br>Pop.:     3,115,787","Country: Malaysia <br>Life Expectancy: 65.26 <br>GDP per capita: 3827.92 <br>Pop.:    12,845,381","Country: Mongolia <br>Life Expectancy: 55.49 <br>GDP per capita: 1647.51 <br>Pop.:     1,528,000","Country: Myanmar <br>Life Expectancy: 56.06 <br>GDP per capita: 371 <br>Pop.:    31,528,087","Country: Nepal <br>Life Expectancy: 46.75 <br>GDP per capita: 694.11 <br>Pop.:    13,933,198","Country: Oman <br>Life Expectancy: 57.37 <br>GDP per capita: 11848.34 <br>Pop.:     1,004,533","Country: Pakistan <br>Life Expectancy: 54.04 <br>GDP per capita: 1175.92 <br>Pop.:    78,152,686","Country: Philippines <br>Life Expectancy: 60.06 <br>GDP per capita: 2373.2 <br>Pop.:    46,850,962","Country: Saudi Arabia <br>Life Expectancy: 58.69 <br>GDP per capita: 34167.76 <br>Pop.:     8,128,505","Country: Singapore <br>Life Expectancy: 70.8 <br>GDP per capita: 11210.09 <br>Pop.:     2,325,300","Country: Sri Lanka <br>Life Expectancy: 65.95 <br>GDP per capita: 1348.78 <br>Pop.:    14,116,836","Country: Syria <br>Life Expectancy: 61.2 <br>GDP per capita: 3195.48 <br>Pop.:     7,932,503","Country: Taiwan <br>Life Expectancy: 70.59 <br>GDP per capita: 5596.52 <br>Pop.:    16,785,196","Country: Thailand <br>Life Expectancy: 62.49 <br>GDP per capita: 1961.22 <br>Pop.:    44,148,285","Country: Vietnam <br>Life Expectancy: 55.76 <br>GDP per capita: 713.54 <br>Pop.:    50,533,506","Country: West Bank and Gaza <br>Life Expectancy: 60.76 <br>GDP per capita: 3682.83 <br>Pop.:     1,261,091","Country: Yemen, Rep. <br>Life Expectancy: 44.17 <br>GDP per capita: 1829.77 <br>Pop.:     8,403,990"],"frame":"1977","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[11.011534308152962,10.016203197291969,15.485378371030112,10.472215030271521,74.389551476720882,10.308755409056106,53.268315001477468,19.327797419836617,12.417567352083784,10.806948901550589,10.23451100888318,17.768043572511854,10.128154657629098,11.110156364356385,12.482770889757326,10.073736870760154,10.208565922384105,10.872640038756792,10.100194673901072,12.147791034615475,10.946886827785212,10.064466473374383,15.330060447106462,13.193623437890896,10.550699034667666,10.154612802035086,10.959420674786685,10.537321307399983,11.141544287464072,13.009157586528982,13.444968165410209,10.081977330163305,10.569501716254269]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.5481441180718352,4.2955543963882183,4.2814418775448253,3.5475878207479483,3.8815124973301063,4.0532853631746137,4.1702664286382793,4.3101174427422162,4.1932755403994921,4.2622762721427403,4.3120275123298297,4.1521514368552737,4.0672508395761779,4.2934722188970156,4.0473130808908246,4.1539972221168746,3.9820870669340911,4.3265214043340769,4.3675674136179259,3.9780956341662259,4.0074270888689396,3.9711086521578145,4.1132970945224097,4.0383285758015504,4.1840389362986556,4.12178698250771,4.2754432404618408,4.4310788140524542,3.6303385991107318,4.2412662020020857],"y":[68.930000000000007,72.170000000000002,72.799999999999997,69.859999999999999,70.810000000000002,70.640000000000001,70.709999999999994,74.689999999999998,72.519999999999996,73.829999999999998,72.5,73.680000000000007,69.950000000000003,76.109999999999999,72.030000000000001,73.480000000000004,73.066000000000003,75.239999999999995,75.370000000000005,70.670000000000002,70.409999999999997,69.459999999999994,70.299999999999997,70.450000000000003,70.969999999999999,74.390000000000001,75.439999999999998,75.390000000000001,59.506999999999998,72.760000000000005],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.16715415686811,10.512472227801169,10.666271522161315,10.274785883943478,10.59632733488812,10.290666517490857,10.689485396048561,10.343204002074634,10.319348413348914,13.624576859277418,15.330612409231406,10.631235816715586,10.721923050512952,10.011044156715943,10.21922110517275,13.822116507235272,10.034130738731911,10.941412321778062,10.271864996205492,12.358909005449423,10.655405642318176,11.474168594583645,10.588774797613983,10.325416174554535,10.115136555492656,12.482975648799595,10.55910391558176,10.427019044642313,12.890107130196345,13.830290146937628],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 68.93 <br>GDP per capita: 3533 <br>Pop.:     2,509,048","Country: Austria <br>Life Expectancy: 72.17 <br>GDP per capita: 19749.42 <br>Pop.:     7,568,430","Country: Belgium <br>Life Expectancy: 72.8 <br>GDP per capita: 19117.97 <br>Pop.:     9,821,800","Country: Bosnia and Herzegovina <br>Life Expectancy: 69.86 <br>GDP per capita: 3528.48 <br>Pop.:     4,086,000","Country: Bulgaria <br>Life Expectancy: 70.81 <br>GDP per capita: 7612.24 <br>Pop.:     8,797,022","Country: Croatia <br>Life Expectancy: 70.64 <br>GDP per capita: 11305.39 <br>Pop.:     4,318,673","Country: Czech Republic <br>Life Expectancy: 70.71 <br>GDP per capita: 14800.16 <br>Pop.:    10,161,915","Country: Denmark <br>Life Expectancy: 74.69 <br>GDP per capita: 20422.9 <br>Pop.:     5,088,419","Country: Finland <br>Life Expectancy: 72.52 <br>GDP per capita: 15605.42 <br>Pop.:     4,738,902","Country: France <br>Life Expectancy: 73.83 <br>GDP per capita: 18292.64 <br>Pop.:    53,165,019","Country: Germany <br>Life Expectancy: 72.5 <br>GDP per capita: 20512.92 <br>Pop.:    78,160,773","Country: Greece <br>Life Expectancy: 73.68 <br>GDP per capita: 14195.52 <br>Pop.:     9,308,479","Country: Hungary <br>Life Expectancy: 69.95 <br>GDP per capita: 11674.84 <br>Pop.:    10,637,171","Country: Iceland <br>Life Expectancy: 76.11 <br>GDP per capita: 19654.96 <br>Pop.:       221,823","Country: Ireland <br>Life Expectancy: 72.03 <br>GDP per capita: 11150.98 <br>Pop.:     3,271,900","Country: Italy <br>Life Expectancy: 73.48 <br>GDP per capita: 14255.98 <br>Pop.:    56,059,245","Country: Montenegro <br>Life Expectancy: 73.07 <br>GDP per capita: 9595.93 <br>Pop.:       560,073","Country: Netherlands <br>Life Expectancy: 75.24 <br>GDP per capita: 21209.06 <br>Pop.:    13,852,989","Country: Norway <br>Life Expectancy: 75.37 <br>GDP per capita: 23311.35 <br>Pop.:     4,043,205","Country: Poland <br>Life Expectancy: 70.67 <br>GDP per capita: 9508.14 <br>Pop.:    34,621,254","Country: Portugal <br>Life Expectancy: 70.41 <br>GDP per capita: 10172.49 <br>Pop.:     9,662,600","Country: Romania <br>Life Expectancy: 69.46 <br>GDP per capita: 9356.4 <br>Pop.:    21,658,597","Country: Serbia <br>Life Expectancy: 70.3 <br>GDP per capita: 12980.67 <br>Pop.:     8,686,367","Country: Slovak Republic <br>Life Expectancy: 70.45 <br>GDP per capita: 10922.66 <br>Pop.:     4,827,803","Country: Slovenia <br>Life Expectancy: 70.97 <br>GDP per capita: 15277.03 <br>Pop.:     1,746,919","Country: Spain <br>Life Expectancy: 74.39 <br>GDP per capita: 13236.92 <br>Pop.:    36,439,000","Country: Sweden <br>Life Expectancy: 75.44 <br>GDP per capita: 18855.73 <br>Pop.:     8,251,648","Country: Switzerland <br>Life Expectancy: 75.39 <br>GDP per capita: 26982.29 <br>Pop.:     6,316,424","Country: Turkey <br>Life Expectancy: 59.51 <br>GDP per capita: 4269.12 <br>Pop.:    42,404,033","Country: United Kingdom <br>Life Expectancy: 72.76 <br>GDP per capita: 17428.75 <br>Pop.:    56,179,000"],"frame":"1977","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.16715415686811,10.512472227801169,10.666271522161315,10.274785883943478,10.59632733488812,10.290666517490857,10.689485396048561,10.343204002074634,10.319348413348914,13.624576859277418,15.330612409231406,10.631235816715586,10.721923050512952,10.011044156715943,10.21922110517275,13.822116507235272,10.034130738731911,10.941412321778062,10.271864996205492,12.358909005449423,10.655405642318176,11.474168594583645,10.588774797613983,10.325416174554535,10.115136555492656,12.482975648799595,10.55910391558176,10.427019044642313,12.890107130196345,13.830290146937628]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.2632619055916319,4.2104179894321065],"y":[73.489999999999995,72.219999999999999],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[10.956503813976532,10.211918032665112],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 73.49 <br>GDP per capita: 18334.2 <br>Pop.:    14,074,100","Country: New Zealand <br>Life Expectancy: 72.22 <br>GDP per capita: 16233.72 <br>Pop.:     3,164,900"],"frame":"1977","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[10.956503813976532,10.211918032665112]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1982","data":[{"x":[3.7593021441908228,3.4404294682589094,3.1064960599355054,3.6581204004364039,2.906980392190595,2.7478802133276887,3.3743786319356888,2.9807998284533461,2.9019528741820224,3.1028109193648992,2.8284973717552191,3.6883759918242802,3.4154258089036604,3.459312266612204,3.5445305866160686,2.9674662307010133,2.7200565903771321,2.7618231947313938,4.1793610831069445,2.9221073606977832,2.9425202525996403,2.9331076750026175,2.9233082599735454,3.1297626307554856,2.9016016679898771,2.757547526647723,4.2396566646963842,3.1149039701140153,2.8012691614187584,2.7909983584084328,3.1705990983232688,3.5667953564584884,3.4317850435255424,2.6648406667312905,3.622328076211855,2.9589087621122427,3.1978244642071321,3.721581404898934,2.9452571212213607,3.2765119213922418,3.1814090715946577,3.1658408215600637,3.0707052544810138,3.932892952169627,3.2777338865932002,3.5905502781003449,2.9416319683520458,3.1285859858649032,3.5514784425979555,2.8339538735847247,3.1488119062588331,2.8969972051938737],"y":[61.368000000000002,39.942,50.904000000000003,61.484000000000002,48.122,47.470999999999997,52.960999999999999,48.295000000000002,49.517000000000003,52.933,47.783999999999999,56.695,53.982999999999997,48.811999999999998,56.006,43.661999999999999,43.890000000000001,44.915999999999997,56.564,45.579999999999998,53.744,42.890999999999998,39.326999999999998,58.765999999999998,55.078000000000003,44.851999999999997,62.155000000000001,48.969000000000001,45.642000000000003,43.915999999999997,53.598999999999997,66.710999999999999,59.649999999999999,42.795000000000002,58.968000000000004,42.597999999999999,45.826000000000001,69.885000000000005,46.218000000000004,60.350999999999999,52.378999999999998,38.445,42.954999999999998,58.161000000000001,50.338000000000001,55.561,50.607999999999997,55.470999999999997,64.048000000000002,49.848999999999997,51.820999999999998,60.363],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[11.363268094157474,10.474793424384801,10.244454449240891,10.062133175834701,10.44873524264138,10.30853085663975,10.62730116695932,10.164964804935142,10.328645565916208,10.019700003962846,12.087619723417781,10.117035081332586,10.611952429150746,10.016788876405876,13.113825358214473,10.015389143592916,10.175907537672147,12.59714628763685,10.04735824111558,10.044740669772212,10.77401149851703,10.317409686483686,10.052280170720657,11.201351400578581,10.092264151434904,10.129466685318951,10.224147198211686,10.621885017279217,10.439741474721718,10.473556133745376,10.106619739635455,10.063613788469356,11.374528271663014,10.855019977145327,10.070914813386571,10.435261551635888,14.981061627629551,10.031246161597421,10.371811979918432,10.002633337789623,10.415508788093149,10.232368137252807,10.393743516176952,12.121304906473711,11.386016823753696,10.040261770481592,11.350342952626225,10.176417251181372,10.455526554049371,10.879057118888525,10.412275233297619,10.517119848542618],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 61.37 <br>GDP per capita: 5745.16 <br>Pop.:    20,033,753","Country: Angola <br>Life Expectancy: 39.94 <br>GDP per capita: 2756.95 <br>Pop.:     7,016,384","Country: Benin <br>Life Expectancy: 50.9 <br>GDP per capita: 1277.9 <br>Pop.:     3,641,603","Country: Botswana <br>Life Expectancy: 61.48 <br>GDP per capita: 4551.14 <br>Pop.:       970,347","Country: Burkina Faso <br>Life Expectancy: 48.12 <br>GDP per capita: 807.2 <br>Pop.:     6,634,596","Country: Burundi <br>Life Expectancy: 47.47 <br>GDP per capita: 559.6 <br>Pop.:     4,580,410","Country: Cameroon <br>Life Expectancy: 52.96 <br>GDP per capita: 2367.98 <br>Pop.:     9,250,831","Country: Central African Republic <br>Life Expectancy: 48.3 <br>GDP per capita: 956.75 <br>Pop.:     2,476,971","Country: Chad <br>Life Expectancy: 49.52 <br>GDP per capita: 797.91 <br>Pop.:     4,875,118","Country: Comoros <br>Life Expectancy: 52.93 <br>GDP per capita: 1267.1 <br>Pop.:       348,643","Country: Congo, Dem. Rep. <br>Life Expectancy: 47.78 <br>GDP per capita: 673.75 <br>Pop.:    30,646,495","Country: Congo, Rep. <br>Life Expectancy: 56.7 <br>GDP per capita: 4879.51 <br>Pop.:     1,774,735","Country: Cote d'Ivoire <br>Life Expectancy: 53.98 <br>GDP per capita: 2602.71 <br>Pop.:     9,025,951","Country: Djibouti <br>Life Expectancy: 48.81 <br>GDP per capita: 2879.47 <br>Pop.:       305,991","Country: Egypt <br>Life Expectancy: 56.01 <br>GDP per capita: 3503.73 <br>Pop.:    45,681,811","Country: Equatorial Guinea <br>Life Expectancy: 43.66 <br>GDP per capita: 927.83 <br>Pop.:       285,483","Country: Eritrea <br>Life Expectancy: 43.89 <br>GDP per capita: 524.88 <br>Pop.:     2,637,297","Country: Ethiopia <br>Life Expectancy: 44.92 <br>GDP per capita: 577.86 <br>Pop.:    38,111,756","Country: Gabon <br>Life Expectancy: 56.56 <br>GDP per capita: 15113.36 <br>Pop.:       753,874","Country: Gambia <br>Life Expectancy: 45.58 <br>GDP per capita: 835.81 <br>Pop.:       715,523","Country: Ghana <br>Life Expectancy: 53.74 <br>GDP per capita: 876.03 <br>Pop.:    11,400,338","Country: Guinea <br>Life Expectancy: 42.89 <br>GDP per capita: 857.25 <br>Pop.:     4,710,497","Country: Guinea-Bissau <br>Life Expectancy: 39.33 <br>GDP per capita: 838.12 <br>Pop.:       825,987","Country: Kenya <br>Life Expectancy: 58.77 <br>GDP per capita: 1348.23 <br>Pop.:    17,661,452","Country: Lesotho <br>Life Expectancy: 55.08 <br>GDP per capita: 797.26 <br>Pop.:     1,411,807","Country: Liberia <br>Life Expectancy: 44.85 <br>GDP per capita: 572.2 <br>Pop.:     1,956,875","Country: Libya <br>Life Expectancy: 62.16 <br>GDP per capita: 17364.28 <br>Pop.:     3,344,074","Country: Madagascar <br>Life Expectancy: 48.97 <br>GDP per capita: 1302.88 <br>Pop.:     9,171,477","Country: Malawi <br>Life Expectancy: 45.64 <br>GDP per capita: 632.8 <br>Pop.:     6,502,825","Country: Mali <br>Life Expectancy: 43.92 <br>GDP per capita: 618.01 <br>Pop.:     6,998,256","Country: Mauritania <br>Life Expectancy: 53.6 <br>GDP per capita: 1481.15 <br>Pop.:     1,622,136","Country: Mauritius <br>Life Expectancy: 66.71 <br>GDP per capita: 3688.04 <br>Pop.:       992,040","Country: Morocco <br>Life Expectancy: 59.65 <br>GDP per capita: 2702.62 <br>Pop.:    20,198,730","Country: Mozambique <br>Life Expectancy: 42.8 <br>GDP per capita: 462.21 <br>Pop.:    12,587,223","Country: Namibia <br>Life Expectancy: 58.97 <br>GDP per capita: 4191.1 <br>Pop.:     1,099,010","Country: Niger <br>Life Expectancy: 42.6 <br>GDP per capita: 909.72 <br>Pop.:     6,437,188","Country: Nigeria <br>Life Expectancy: 45.83 <br>GDP per capita: 1576.97 <br>Pop.:    73,039,376","Country: Reunion <br>Life Expectancy: 69.89 <br>GDP per capita: 5267.22 <br>Pop.:       517,810","Country: Rwanda <br>Life Expectancy: 46.22 <br>GDP per capita: 881.57 <br>Pop.:     5,507,565","Country: Sao Tome and Principe <br>Life Expectancy: 60.35 <br>GDP per capita: 1890.22 <br>Pop.:        98,593","Country: Senegal <br>Life Expectancy: 52.38 <br>GDP per capita: 1518.48 <br>Pop.:     6,147,783","Country: Sierra Leone <br>Life Expectancy: 38.44 <br>GDP per capita: 1465.01 <br>Pop.:     3,464,522","Country: Somalia <br>Life Expectancy: 42.95 <br>GDP per capita: 1176.81 <br>Pop.:     5,828,892","Country: South Africa <br>Life Expectancy: 58.16 <br>GDP per capita: 8568.27 <br>Pop.:    31,140,029","Country: Sudan <br>Life Expectancy: 50.34 <br>GDP per capita: 1895.54 <br>Pop.:    20,367,053","Country: Swaziland <br>Life Expectancy: 55.56 <br>GDP per capita: 3895.38 <br>Pop.:       649,901","Country: Tanzania <br>Life Expectancy: 50.61 <br>GDP per capita: 874.24 <br>Pop.:    19,844,382","Country: Togo <br>Life Expectancy: 55.47 <br>GDP per capita: 1344.58 <br>Pop.:     2,644,765","Country: Tunisia <br>Life Expectancy: 64.05 <br>GDP per capita: 3560.23 <br>Pop.:     6,734,098","Country: Uganda <br>Life Expectancy: 49.85 <br>GDP per capita: 682.27 <br>Pop.:    12,939,400","Country: Zambia <br>Life Expectancy: 51.82 <br>GDP per capita: 1408.68 <br>Pop.:     6,100,407","Country: Zimbabwe <br>Life Expectancy: 60.36 <br>GDP per capita: 788.86 <br>Pop.:     7,636,524"],"frame":"1982","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[11.363268094157474,10.474793424384801,10.244454449240891,10.062133175834701,10.44873524264138,10.30853085663975,10.62730116695932,10.164964804935142,10.328645565916208,10.019700003962846,12.087619723417781,10.117035081332586,10.611952429150746,10.016788876405876,13.113825358214473,10.015389143592916,10.175907537672147,12.59714628763685,10.04735824111558,10.044740669772212,10.77401149851703,10.317409686483686,10.052280170720657,11.201351400578581,10.092264151434904,10.129466685318951,10.224147198211686,10.621885017279217,10.439741474721718,10.473556133745376,10.106619739635455,10.063613788469356,11.374528271663014,10.855019977145327,10.070914813386571,10.435261551635888,14.981061627629551,10.031246161597421,10.371811979918432,10.002633337789623,10.415508788093149,10.232368137252807,10.393743516176952,12.121304906473711,11.386016823753696,10.040261770481592,11.350342952626225,10.176417251181372,10.455526554049371,10.879057118888525,10.412275233297619,10.517119848542618]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.9541410373229584,3.4992072317240126,3.8470069602435792,4.3598125748827901,3.7072009317089019,3.6432133201030172,3.7212114815354225,3.8643281943149241,3.4565318816019097,3.8581635717359357,3.6126084272293593,3.6830916178110749,3.303446525346478,3.4943996220364943,3.7830492472839885,3.9827752441691615,3.540371795289281,3.8456933348415334,3.6292570191280102,3.8085149265022782,4.0141419054325675,3.9599723900093653,4.3981060362026012,3.8401200927598391,4.0473687314529228],"y":[69.941999999999993,53.859000000000002,63.335999999999999,75.760000000000005,70.564999999999998,66.653000000000006,73.450000000000003,73.716999999999999,63.726999999999997,64.341999999999999,56.603999999999999,58.137,51.460999999999999,60.908999999999999,71.209999999999994,67.405000000000001,59.298000000000002,70.471999999999994,66.873999999999995,61.405999999999999,73.75,68.831999999999994,74.650000000000006,70.805000000000007,68.557000000000002],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[11.99854128141553,10.381002862542786,18.798013361035615,11.716009704168041,10.779934085561683,11.89092470650929,10.161374423381949,10.664048111974317,10.403261876762912,10.566898546296875,10.301327638291726,10.432425092876331,10.350710468564261,10.24635495441823,10.152770584931782,14.885611698508979,10.199258668370726,10.134888022228125,10.225673676871811,11.232998753392824,10.219705769825802,10.07210712528971,25.843423642169896,10.197523267234473,11.062068430267168],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 69.94 <br>GDP per capita: 8997.9 <br>Pop.:    29,341,374","Country: Bolivia <br>Life Expectancy: 53.86 <br>GDP per capita: 3156.51 <br>Pop.:     5,642,224","Country: Brazil <br>Life Expectancy: 63.34 <br>GDP per capita: 7030.84 <br>Pop.:   128,962,939","Country: Canada <br>Life Expectancy: 75.76 <br>GDP per capita: 22898.79 <br>Pop.:    25,201,900","Country: Chile <br>Life Expectancy: 70.56 <br>GDP per capita: 5095.67 <br>Pop.:    11,487,112","Country: Colombia <br>Life Expectancy: 66.65 <br>GDP per capita: 4397.58 <br>Pop.:    27,764,644","Country: Costa Rica <br>Life Expectancy: 73.45 <br>GDP per capita: 5262.73 <br>Pop.:     2,424,367","Country: Cuba <br>Life Expectancy: 73.72 <br>GDP per capita: 7316.92 <br>Pop.:     9,789,224","Country: Dominican Republic <br>Life Expectancy: 63.73 <br>GDP per capita: 2861.09 <br>Pop.:     5,968,349","Country: Ecuador <br>Life Expectancy: 64.34 <br>GDP per capita: 7213.79 <br>Pop.:     8,365,850","Country: El Salvador <br>Life Expectancy: 56.6 <br>GDP per capita: 4098.34 <br>Pop.:     4,474,873","Country: Guatemala <br>Life Expectancy: 58.14 <br>GDP per capita: 4820.49 <br>Pop.:     6,395,630","Country: Haiti <br>Life Expectancy: 51.46 <br>GDP per capita: 2011.16 <br>Pop.:     5,198,399","Country: Honduras <br>Life Expectancy: 60.91 <br>GDP per capita: 3121.76 <br>Pop.:     3,669,448","Country: Jamaica <br>Life Expectancy: 71.21 <br>GDP per capita: 6068.05 <br>Pop.:     2,298,309","Country: Mexico <br>Life Expectancy: 67.4 <br>GDP per capita: 9611.15 <br>Pop.:    71,640,904","Country: Nicaragua <br>Life Expectancy: 59.3 <br>GDP per capita: 3470.34 <br>Pop.:     2,979,423","Country: Panama <br>Life Expectancy: 70.47 <br>GDP per capita: 7009.6 <br>Pop.:     2,036,305","Country: Paraguay <br>Life Expectancy: 66.87 <br>GDP per capita: 4258.5 <br>Pop.:     3,366,439","Country: Peru <br>Life Expectancy: 61.41 <br>GDP per capita: 6434.5 <br>Pop.:    18,125,129","Country: Puerto Rico <br>Life Expectancy: 73.75 <br>GDP per capita: 10330.99 <br>Pop.:     3,279,001","Country: Trinidad and Tobago <br>Life Expectancy: 68.83 <br>GDP per capita: 9119.53 <br>Pop.:     1,116,479","Country: United States <br>Life Expectancy: 74.65 <br>GDP per capita: 25009.56 <br>Pop.:   232,187,835","Country: Uruguay <br>Life Expectancy: 70.81 <br>GDP per capita: 6920.22 <br>Pop.:     2,953,997","Country: Venezuela <br>Life Expectancy: 68.56 <br>GDP per capita: 11152.41 <br>Pop.:    15,620,766"],"frame":"1982","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[11.99854128141553,10.381002862542786,18.798013361035615,11.716009704168041,10.779934085561683,11.89092470650929,10.161374423381949,10.664048111974317,10.403261876762912,10.566898546296875,10.301327638291726,10.432425092876331,10.350710468564261,10.24635495441823,10.152770584931782,14.885611698508979,10.199258668370726,10.134888022228125,10.225673676871811,11.232998753392824,10.219705769825802,10.07210712528971,25.843423642169896,10.197523267234473,11.062068430267168]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.9903439343158915,4.2835533021611791,2.8305770353390072,2.7955153893800402,2.9833652624303233,4.1631771986973689,2.9323334779430588,3.18094921762256,3.8812896039039648,4.1619040133275433,4.1865899165074447,4.2874457695335204,3.6192411283547417,3.6134745020876,3.7499636396724561,4.4962934489136464,3.883122889653257,3.6919965218656055,3.3011609458894369,2.6273658565927325,2.8563500582887893,4.112430411228762,3.1593956768098224,3.4155198417077881,4.5275419408883133,4.1809615642390332,3.2169782335040558,3.5754000562329113,3.8707756926291883,3.3789825838171939,2.8495642279657094,3.6370924868569041,3.2961290124081595],"y":[39.853999999999999,69.052000000000007,50.009,50.957000000000001,65.525000000000006,75.450000000000003,56.595999999999997,56.158999999999999,59.619999999999997,62.037999999999997,74.450000000000003,77.109999999999999,63.738999999999997,69.099999999999994,67.123000000000005,71.308999999999997,66.983000000000004,68,57.488999999999997,58.055999999999997,49.594000000000001,62.728000000000002,56.158000000000001,62.082000000000001,63.012,71.760000000000005,68.757000000000005,64.590000000000003,72.159999999999997,64.596999999999994,58.816000000000003,64.406000000000006,49.113],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[10.875126837325164,10.021701455348023,16.348512812514578,10.492273089546282,78.268097255403362,10.355222061048629,58.319038044142836,20.462026007985443,12.935749149272629,10.96327574152852,10.259252931249872,18.080813077832623,10.156096008284278,11.20040036308025,12.680022100477636,10.09811254745324,10.206592659493747,10.981608364607085,10.11575854521006,12.362948764847387,11.074050110384652,10.084704515847301,16.2384672493429,13.644490017403268,10.764069354966587,10.176902120593468,11.047693321704587,10.638198647947984,11.258679700727368,13.32850490782967,13.827777139211847,10.093224403090137,10.65506560580198],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 39.85 <br>GDP per capita: 978.01 <br>Pop.:    12,881,816","Country: Bahrain <br>Life Expectancy: 69.05 <br>GDP per capita: 19211.15 <br>Pop.:       377,967","Country: Bangladesh <br>Life Expectancy: 50.01 <br>GDP per capita: 676.98 <br>Pop.:    93,074,406","Country: Cambodia <br>Life Expectancy: 50.96 <br>GDP per capita: 624.48 <br>Pop.:     7,272,485","Country: China <br>Life Expectancy: 65.53 <br>GDP per capita: 962.42 <br>Pop.: 1,000,281,000","Country: Hong Kong, China <br>Life Expectancy: 75.45 <br>GDP per capita: 14560.53 <br>Pop.:     5,264,500","Country: India <br>Life Expectancy: 56.6 <br>GDP per capita: 855.72 <br>Pop.:   708,000,000","Country: Indonesia <br>Life Expectancy: 56.16 <br>GDP per capita: 1516.87 <br>Pop.:   153,343,000","Country: Iran <br>Life Expectancy: 59.62 <br>GDP per capita: 7608.33 <br>Pop.:    43,072,751","Country: Iraq <br>Life Expectancy: 62.04 <br>GDP per capita: 14517.91 <br>Pop.:    14,173,318","Country: Israel <br>Life Expectancy: 74.45 <br>GDP per capita: 15367.03 <br>Pop.:     3,858,421","Country: Japan <br>Life Expectancy: 77.11 <br>GDP per capita: 19384.11 <br>Pop.:   118,454,974","Country: Jordan <br>Life Expectancy: 63.74 <br>GDP per capita: 4161.42 <br>Pop.:     2,347,031","Country: Korea, Dem. Rep. <br>Life Expectancy: 69.1 <br>GDP per capita: 4106.53 <br>Pop.:    17,647,518","Country: Korea, Rep. <br>Life Expectancy: 67.12 <br>GDP per capita: 5622.94 <br>Pop.:    39,326,000","Country: Kuwait <br>Life Expectancy: 71.31 <br>GDP per capita: 31354.04 <br>Pop.:     1,497,494","Country: Lebanon <br>Life Expectancy: 66.98 <br>GDP per capita: 7640.52 <br>Pop.:     3,086,876","Country: Malaysia <br>Life Expectancy: 68 <br>GDP per capita: 4920.36 <br>Pop.:    14,441,916","Country: Mongolia <br>Life Expectancy: 57.49 <br>GDP per capita: 2000.6 <br>Pop.:     1,756,032","Country: Myanmar <br>Life Expectancy: 58.06 <br>GDP per capita: 424 <br>Pop.:    34,680,442","Country: Nepal <br>Life Expectancy: 49.59 <br>GDP per capita: 718.37 <br>Pop.:    15,796,314","Country: Oman <br>Life Expectancy: 62.73 <br>GDP per capita: 12954.79 <br>Pop.:     1,301,048","Country: Pakistan <br>Life Expectancy: 56.16 <br>GDP per capita: 1443.43 <br>Pop.:    91,462,088","Country: Philippines <br>Life Expectancy: 62.08 <br>GDP per capita: 2603.27 <br>Pop.:    53,456,774","Country: Saudi Arabia <br>Life Expectancy: 63.01 <br>GDP per capita: 33693.18 <br>Pop.:    11,254,672","Country: Singapore <br>Life Expectancy: 71.76 <br>GDP per capita: 15169.16 <br>Pop.:     2,651,869","Country: Sri Lanka <br>Life Expectancy: 68.76 <br>GDP per capita: 1648.08 <br>Pop.:    15,410,151","Country: Syria <br>Life Expectancy: 64.59 <br>GDP per capita: 3761.84 <br>Pop.:     9,410,494","Country: Taiwan <br>Life Expectancy: 72.16 <br>GDP per capita: 7426.35 <br>Pop.:    18,501,390","Country: Thailand <br>Life Expectancy: 64.6 <br>GDP per capita: 2393.22 <br>Pop.:    48,827,160","Country: Vietnam <br>Life Expectancy: 58.82 <br>GDP per capita: 707.24 <br>Pop.:    56,142,181","Country: West Bank and Gaza <br>Life Expectancy: 64.41 <br>GDP per capita: 4336.03 <br>Pop.:     1,425,876","Country: Yemen, Rep. <br>Life Expectancy: 49.11 <br>GDP per capita: 1977.56 <br>Pop.:     9,657,618"],"frame":"1982","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[10.875126837325164,10.021701455348023,16.348512812514578,10.492273089546282,78.268097255403362,10.355222061048629,58.319038044142836,20.462026007985443,12.935749149272629,10.96327574152852,10.259252931249872,18.080813077832623,10.156096008284278,11.20040036308025,12.680022100477636,10.09811254745324,10.206592659493747,10.981608364607085,10.11575854521006,12.362948764847387,11.074050110384652,10.084704515847301,16.2384672493429,13.644490017403268,10.764069354966587,10.176902120593468,11.047693321704587,10.638198647947984,11.258679700727368,13.32850490782967,13.827777139211847,10.093224403090137,10.65506560580198]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.5600119821466922,4.3343951097966116,4.3218022937065177,3.6155937585176763,3.9150932220627768,4.1212913008792347,4.186878069282022,4.3362203151692666,4.2679494190906793,4.3073654616624273,4.3430447121924631,4.1837941232239473,4.0985049598861574,4.3667890578882869,4.1010015854262543,4.2184694238856544,4.0500930048274402,4.3304028237137393,4.4199332126451241,3.9269353889924212,4.0701798820754993,3.9825115690160562,4.1813030321985476,4.054940216614626,4.2520448739106547,4.1438316914702247,4.3152854509511753,4.453283398121143,3.6275047619036034,4.2608444243129],"y":[70.420000000000002,73.180000000000007,73.930000000000007,70.689999999999998,71.079999999999998,70.459999999999994,70.959999999999994,74.629999999999995,74.549999999999997,74.890000000000001,73.799999999999997,75.239999999999995,69.390000000000001,76.989999999999995,73.099999999999994,74.980000000000004,74.100999999999999,76.049999999999997,75.969999999999999,71.319999999999993,72.769999999999996,69.659999999999997,70.162000000000006,70.799999999999997,71.063000000000002,76.299999999999997,76.420000000000002,76.209999999999994,61.036000000000001,74.040000000000006],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.18565406808421,10.512894236187288,10.668626455906466,10.280702942493988,10.602816558455746,10.297129736660116,10.699162922663378,10.345210026411754,10.325356794432277,13.711158947289324,15.342522082419025,10.663860825703654,10.726589099568207,10.011875068909475,10.233424557404893,13.854631628870656,10.034299664941782,10.97263206945903,10.276750683460088,12.468532014210869,10.668854898744625,11.521818003057334,10.612421532116587,10.340448218377732,10.122940127352617,12.588379460989035,10.564128156454959,10.437373163385805,13.226236707360542,13.84125867931396],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 70.42 <br>GDP per capita: 3630.88 <br>Pop.:     2,780,097","Country: Austria <br>Life Expectancy: 73.18 <br>GDP per capita: 21597.08 <br>Pop.:     7,574,613","Country: Belgium <br>Life Expectancy: 73.93 <br>GDP per capita: 20979.85 <br>Pop.:     9,856,303","Country: Bosnia and Herzegovina <br>Life Expectancy: 70.69 <br>GDP per capita: 4126.61 <br>Pop.:     4,172,693","Country: Bulgaria <br>Life Expectancy: 71.08 <br>GDP per capita: 8224.19 <br>Pop.:     8,892,098","Country: Croatia <br>Life Expectancy: 70.46 <br>GDP per capita: 13221.82 <br>Pop.:     4,413,368","Country: Czech Republic <br>Life Expectancy: 70.96 <br>GDP per capita: 15377.23 <br>Pop.:    10,303,704","Country: Denmark <br>Life Expectancy: 74.63 <br>GDP per capita: 21688.04 <br>Pop.:     5,117,810","Country: Finland <br>Life Expectancy: 74.55 <br>GDP per capita: 18533.16 <br>Pop.:     4,826,933","Country: France <br>Life Expectancy: 74.89 <br>GDP per capita: 20293.9 <br>Pop.:    54,433,565","Country: Germany <br>Life Expectancy: 73.8 <br>GDP per capita: 22031.53 <br>Pop.:    78,335,266","Country: Greece <br>Life Expectancy: 75.24 <br>GDP per capita: 15268.42 <br>Pop.:     9,786,480","Country: Hungary <br>Life Expectancy: 69.39 <br>GDP per capita: 12545.99 <br>Pop.:    10,705,535","Country: Iceland <br>Life Expectancy: 76.99 <br>GDP per capita: 23269.61 <br>Pop.:       233,997","Country: Ireland <br>Life Expectancy: 73.1 <br>GDP per capita: 12618.32 <br>Pop.:     3,480,000","Country: Italy <br>Life Expectancy: 74.98 <br>GDP per capita: 16537.48 <br>Pop.:    56,535,636","Country: Montenegro <br>Life Expectancy: 74.1 <br>GDP per capita: 11222.59 <br>Pop.:       562,548","Country: Netherlands <br>Life Expectancy: 76.05 <br>GDP per capita: 21399.46 <br>Pop.:    14,310,401","Country: Norway <br>Life Expectancy: 75.97 <br>GDP per capita: 26298.64 <br>Pop.:     4,114,787","Country: Poland <br>Life Expectancy: 71.32 <br>GDP per capita: 8451.53 <br>Pop.:    36,227,381","Country: Portugal <br>Life Expectancy: 72.77 <br>GDP per capita: 11753.84 <br>Pop.:     9,859,650","Country: Romania <br>Life Expectancy: 69.66 <br>GDP per capita: 9605.31 <br>Pop.:    22,356,726","Country: Serbia <br>Life Expectancy: 70.16 <br>GDP per capita: 15181.09 <br>Pop.:     9,032,824","Country: Slovak Republic <br>Life Expectancy: 70.8 <br>GDP per capita: 11348.55 <br>Pop.:     5,048,043","Country: Slovenia <br>Life Expectancy: 71.06 <br>GDP per capita: 17866.72 <br>Pop.:     1,861,252","Country: Spain <br>Life Expectancy: 76.3 <br>GDP per capita: 13926.17 <br>Pop.:    37,983,310","Country: Sweden <br>Life Expectancy: 76.42 <br>GDP per capita: 20667.38 <br>Pop.:     8,325,260","Country: Switzerland <br>Life Expectancy: 76.21 <br>GDP per capita: 28397.72 <br>Pop.:     6,468,126","Country: Turkey <br>Life Expectancy: 61.04 <br>GDP per capita: 4241.36 <br>Pop.:    47,328,791","Country: United Kingdom <br>Life Expectancy: 74.04 <br>GDP per capita: 18232.42 <br>Pop.:    56,339,704"],"frame":"1982","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.18565406808421,10.512894236187288,10.668626455906466,10.280702942493988,10.602816558455746,10.297129736660116,10.699162922663378,10.345210026411754,10.325356794432277,13.711158947289324,15.342522082419025,10.663860825703654,10.726589099568207,10.011875068909475,10.233424557404893,13.854631628870656,10.034299664941782,10.97263206945903,10.276750683460088,12.468532014210869,10.668854898744625,11.521818003057334,10.612421532116587,10.340448218377732,10.122940127352617,12.588379460989035,10.564128156454959,10.437373163385805,13.226236707360542,13.84125867931396]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.2895222711818111,4.2463116856325076],"y":[74.739999999999995,73.840000000000003],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[11.032271484917921,10.215040608059732],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 74.74 <br>GDP per capita: 19477.01 <br>Pop.:    15,184,200","Country: New Zealand <br>Life Expectancy: 73.84 <br>GDP per capita: 17632.41 <br>Pop.:     3,210,650"],"frame":"1982","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[11.032271484917921,10.215040608059732]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1987","data":[{"x":[3.7544521975849201,3.3856435017630679,3.0884394606106547,3.7928036430212502,2.960024905370803,2.793663861516678,3.4154181393391547,2.9267931536025182,2.9788130615095882,3.1192495569806185,2.8278697235535595,3.6233728334302224,3.3338412998613882,3.4594079543992424,3.5894425217078569,2.9853801296045974,2.7169495195654556,2.7587161238637243,4.0742460891485193,2.7865092717384816,2.9278865449821039,2.906104616992403,2.8671228572820513,3.134156972682149,2.8887371530706911,2.7042482283709006,4.0707982249902335,3.0627481304325248,2.803127420705593,2.8351650157214126,3.152778507253009,3.6797536681597327,3.440129010722452,2.5909267073277822,3.5674653039083379,2.8249714759402638,3.1414590433721243,3.7245525407751132,2.9283913541102655,3.180849704947923,3.1588811400575798,3.1120845377057749,3.0387174850597991,3.8935300431379449,3.178349257344117,3.6004108677239106,2.9200304438412745,3.0799772152932663,3.5809727677805401,2.7907947607983909,3.0839736082590066,2.8489014566814181],"y":[65.799000000000007,39.905999999999999,52.337000000000003,63.622,49.557000000000002,48.210999999999999,54.984999999999999,50.484999999999999,51.051000000000002,54.926000000000002,47.411999999999999,57.469999999999999,54.655000000000001,50.039999999999999,59.796999999999997,45.664000000000001,46.453000000000003,46.683999999999997,60.189999999999998,49.265000000000001,55.728999999999999,45.552,41.244999999999997,59.338999999999999,57.18,46.027000000000001,66.233999999999995,49.350000000000001,47.457000000000001,46.363999999999997,56.145000000000003,68.739999999999995,62.677,42.860999999999997,60.835000000000001,44.555,46.886000000000003,71.912999999999997,44.020000000000003,61.728000000000002,55.768999999999998,40.006,44.500999999999998,60.834000000000003,51.744,57.677999999999997,51.534999999999997,56.941000000000003,66.894000000000005,51.509,50.820999999999998,62.350999999999999],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[11.583124907903459,10.533343999509913,10.285555390530721,10.074475846143708,10.513709040669495,10.345770588416476,10.731717085022822,10.189743242664374,10.371224321467116,10.022871789780625,12.417633284495395,10.136784773489689,10.730381441790092,10.017132462078806,13.599599191000056,10.019194999911594,10.194927059084515,12.930751595327941,10.055993817217299,10.053810335043543,10.962919665554013,10.381551480270042,10.059210377012322,11.442737057799956,10.105054288504284,10.150798414089648,10.255254942696533,10.717245739710373,10.529966635613693,10.516948123959168,10.121574248034646,10.067068960801638,11.564863199706533,10.875818649875981,10.083143978933146,10.496378713102843,15.562041111998278,10.034264651145554,10.429267367179454,10.00346732136879,10.485370116207241,10.259968495849593,10.468341739974923,12.448465491562359,11.683525364642012,10.049096918396511,11.56849651240559,10.211192093607249,10.523156964144913,11.039018295360725,10.492267697558169,10.624952375985439],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 65.8 <br>GDP per capita: 5681.36 <br>Pop.:    23,254,956","Country: Angola <br>Life Expectancy: 39.91 <br>GDP per capita: 2430.21 <br>Pop.:     7,874,230","Country: Benin <br>Life Expectancy: 52.34 <br>GDP per capita: 1225.86 <br>Pop.:     4,243,788","Country: Botswana <br>Life Expectancy: 63.62 <br>GDP per capita: 6205.88 <br>Pop.:     1,151,184","Country: Burkina Faso <br>Life Expectancy: 49.56 <br>GDP per capita: 912.06 <br>Pop.:     7,586,551","Country: Burundi <br>Life Expectancy: 48.21 <br>GDP per capita: 621.82 <br>Pop.:     5,126,023","Country: Cameroon <br>Life Expectancy: 54.98 <br>GDP per capita: 2602.66 <br>Pop.:    10,780,667","Country: Central African Republic <br>Life Expectancy: 50.48 <br>GDP per capita: 844.88 <br>Pop.:     2,840,009","Country: Chad <br>Life Expectancy: 51.05 <br>GDP per capita: 952.39 <br>Pop.:     5,498,955","Country: Comoros <br>Life Expectancy: 54.93 <br>GDP per capita: 1315.98 <br>Pop.:       395,114","Country: Congo, Dem. Rep. <br>Life Expectancy: 47.41 <br>GDP per capita: 672.77 <br>Pop.:    35,481,645","Country: Congo, Rep. <br>Life Expectancy: 57.47 <br>GDP per capita: 4201.19 <br>Pop.:     2,064,095","Country: Cote d'Ivoire <br>Life Expectancy: 54.66 <br>GDP per capita: 2156.96 <br>Pop.:    10,761,098","Country: Djibouti <br>Life Expectancy: 50.04 <br>GDP per capita: 2880.1 <br>Pop.:       311,025","Country: Egypt <br>Life Expectancy: 59.8 <br>GDP per capita: 3885.46 <br>Pop.:    52,799,062","Country: Equatorial Guinea <br>Life Expectancy: 45.66 <br>GDP per capita: 966.9 <br>Pop.:       341,244","Country: Eritrea <br>Life Expectancy: 46.45 <br>GDP per capita: 521.13 <br>Pop.:     2,915,959","Country: Ethiopia <br>Life Expectancy: 46.68 <br>GDP per capita: 573.74 <br>Pop.:    42,999,530","Country: Gabon <br>Life Expectancy: 60.19 <br>GDP per capita: 11864.41 <br>Pop.:       880,397","Country: Gambia <br>Life Expectancy: 49.26 <br>GDP per capita: 611.66 <br>Pop.:       848,406","Country: Ghana <br>Life Expectancy: 55.73 <br>GDP per capita: 847.01 <br>Pop.:    14,168,101","Country: Guinea <br>Life Expectancy: 45.55 <br>GDP per capita: 805.57 <br>Pop.:     5,650,262","Country: Guinea-Bissau <br>Life Expectancy: 41.24 <br>GDP per capita: 736.42 <br>Pop.:       927,524","Country: Kenya <br>Life Expectancy: 59.34 <br>GDP per capita: 1361.94 <br>Pop.:    21,198,082","Country: Lesotho <br>Life Expectancy: 57.18 <br>GDP per capita: 773.99 <br>Pop.:     1,599,200","Country: Liberia <br>Life Expectancy: 46.03 <br>GDP per capita: 506.11 <br>Pop.:     2,269,414","Country: Libya <br>Life Expectancy: 66.23 <br>GDP per capita: 11770.59 <br>Pop.:     3,799,845","Country: Madagascar <br>Life Expectancy: 49.35 <br>GDP per capita: 1155.44 <br>Pop.:    10,568,642","Country: Malawi <br>Life Expectancy: 47.46 <br>GDP per capita: 635.52 <br>Pop.:     7,824,747","Country: Mali <br>Life Expectancy: 46.36 <br>GDP per capita: 684.17 <br>Pop.:     7,634,008","Country: Mauritania <br>Life Expectancy: 56.15 <br>GDP per capita: 1421.6 <br>Pop.:     1,841,240","Country: Mauritius <br>Life Expectancy: 68.74 <br>GDP per capita: 4783.59 <br>Pop.:     1,042,663","Country: Morocco <br>Life Expectancy: 62.68 <br>GDP per capita: 2755.05 <br>Pop.:    22,987,397","Country: Mozambique <br>Life Expectancy: 42.86 <br>GDP per capita: 389.88 <br>Pop.:    12,891,952","Country: Namibia <br>Life Expectancy: 60.84 <br>GDP per capita: 3693.73 <br>Pop.:     1,278,184","Country: Niger <br>Life Expectancy: 44.56 <br>GDP per capita: 668.3 <br>Pop.:     7,332,638","Country: Nigeria <br>Life Expectancy: 46.89 <br>GDP per capita: 1385.03 <br>Pop.:    81,551,520","Country: Reunion <br>Life Expectancy: 71.91 <br>GDP per capita: 5303.38 <br>Pop.:       562,035","Country: Rwanda <br>Life Expectancy: 44.02 <br>GDP per capita: 847.99 <br>Pop.:     6,349,365","Country: Sao Tome and Principe <br>Life Expectancy: 61.73 <br>GDP per capita: 1516.53 <br>Pop.:       110,812","Country: Senegal <br>Life Expectancy: 55.77 <br>GDP per capita: 1441.72 <br>Pop.:     7,171,347","Country: Sierra Leone <br>Life Expectancy: 40.01 <br>GDP per capita: 1294.45 <br>Pop.:     3,868,905","Country: Somalia <br>Life Expectancy: 44.5 <br>GDP per capita: 1093.24 <br>Pop.:     6,921,858","Country: South Africa <br>Life Expectancy: 60.83 <br>GDP per capita: 7825.82 <br>Pop.:    35,933,379","Country: Sudan <br>Life Expectancy: 51.74 <br>GDP per capita: 1507.82 <br>Pop.:    24,725,960","Country: Swaziland <br>Life Expectancy: 57.68 <br>GDP per capita: 3984.84 <br>Pop.:       779,348","Country: Tanzania <br>Life Expectancy: 51.53 <br>GDP per capita: 831.82 <br>Pop.:    23,040,630","Country: Togo <br>Life Expectancy: 56.94 <br>GDP per capita: 1202.2 <br>Pop.:     3,154,264","Country: Tunisia <br>Life Expectancy: 66.89 <br>GDP per capita: 3810.42 <br>Pop.:     7,724,976","Country: Uganda <br>Life Expectancy: 51.51 <br>GDP per capita: 617.72 <br>Pop.:    15,283,050","Country: Zambia <br>Life Expectancy: 50.82 <br>GDP per capita: 1213.32 <br>Pop.:     7,272,406","Country: Zimbabwe <br>Life Expectancy: 62.35 <br>GDP per capita: 706.16 <br>Pop.:     9,216,418"],"frame":"1987","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[11.583124907903459,10.533343999509913,10.285555390530721,10.074475846143708,10.513709040669495,10.345770588416476,10.731717085022822,10.189743242664374,10.371224321467116,10.022871789780625,12.417633284495395,10.136784773489689,10.730381441790092,10.017132462078806,13.599599191000056,10.019194999911594,10.194927059084515,12.930751595327941,10.055993817217299,10.053810335043543,10.962919665554013,10.381551480270042,10.059210377012322,11.442737057799956,10.105054288504284,10.150798414089648,10.255254942696533,10.717245739710373,10.529966635613693,10.516948123959168,10.121574248034646,10.067068960801638,11.564863199706533,10.875818649875981,10.083143978933146,10.496378713102843,15.562041111998278,10.034264651145554,10.429267367179454,10.00346732136879,10.485370116207241,10.259968495849593,10.468341739974923,12.448465491562359,11.683525364642012,10.049096918396511,11.56849651240559,10.211192093607249,10.523156964144913,11.039018295360725,10.492267697558169,10.624952375985439]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.960930581236068,3.4399152824365928,3.8924895095777403,4.425314328200769,3.7440631573789771,3.6904813000981016,3.7505018624886635,3.876963629827765,3.4623743619017842,3.8116940849535821,3.6170467155259125,3.6280296939631218,3.2607904791375675,3.4804520390635081,3.8028583528334723,3.9389276104300608,3.4707021340972082,3.8472504684140501,3.6019379043049082,3.8035215342233002,4.0892458222015948,3.8685620276353108,4.4754438201021545,3.872296097082633,3.9949144861359622],"y":[70.774000000000001,57.250999999999998,65.204999999999998,76.859999999999999,72.492000000000004,67.768000000000001,74.751999999999995,74.174000000000007,66.046000000000006,67.230999999999995,63.154000000000003,60.781999999999996,53.636000000000003,64.492000000000004,71.769999999999996,69.498000000000005,62.008000000000003,71.522999999999996,67.378,64.134,74.629999999999995,69.581999999999994,75.019999999999996,71.918000000000006,70.189999999999998],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[12.154127030166471,10.416094808472128,19.751858583607309,11.808001116558641,10.846565544543003,12.109307118644901,10.186999608003982,10.694803943918515,10.450148148286059,10.64738987183741,10.326398403680306,10.495953360319033,10.388782272835758,10.294320101335098,10.154701940471488,15.464505643779169,10.224166240802617,10.149721722792378,10.261170226668677,11.374336753705476,10.230999391308245,10.077216341165451,26.567977027339847,10.203744938986867,11.218327972773205],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 70.77 <br>GDP per capita: 9139.67 <br>Pop.:    31,620,918","Country: Bolivia <br>Life Expectancy: 57.25 <br>GDP per capita: 2753.69 <br>Pop.:     6,156,369","Country: Brazil <br>Life Expectancy: 65.2 <br>GDP per capita: 7807.1 <br>Pop.:   142,938,076","Country: Canada <br>Life Expectancy: 76.86 <br>GDP per capita: 26626.52 <br>Pop.:    26,549,700","Country: Chile <br>Life Expectancy: 72.49 <br>GDP per capita: 5547.06 <br>Pop.:    12,463,354","Country: Colombia <br>Life Expectancy: 67.77 <br>GDP per capita: 4903.22 <br>Pop.:    30,964,245","Country: Costa Rica <br>Life Expectancy: 74.75 <br>GDP per capita: 5629.92 <br>Pop.:     2,799,811","Country: Cuba <br>Life Expectancy: 74.17 <br>GDP per capita: 7532.92 <br>Pop.:    10,239,839","Country: Dominican Republic <br>Life Expectancy: 66.05 <br>GDP per capita: 2899.84 <br>Pop.:     6,655,297","Country: Ecuador <br>Life Expectancy: 67.23 <br>GDP per capita: 6481.78 <br>Pop.:     9,545,158","Country: El Salvador <br>Life Expectancy: 63.15 <br>GDP per capita: 4140.44 <br>Pop.:     4,842,194","Country: Guatemala <br>Life Expectancy: 60.78 <br>GDP per capita: 4246.49 <br>Pop.:     7,326,406","Country: Haiti <br>Life Expectancy: 53.64 <br>GDP per capita: 1823.02 <br>Pop.:     5,756,203","Country: Honduras <br>Life Expectancy: 64.49 <br>GDP per capita: 3023.1 <br>Pop.:     4,372,203","Country: Jamaica <br>Life Expectancy: 71.77 <br>GDP per capita: 6351.24 <br>Pop.:     2,326,606","Country: Mexico <br>Life Expectancy: 69.5 <br>GDP per capita: 8688.16 <br>Pop.:    80,122,492","Country: Nicaragua <br>Life Expectancy: 62.01 <br>GDP per capita: 2955.98 <br>Pop.:     3,344,353","Country: Panama <br>Life Expectancy: 71.52 <br>GDP per capita: 7034.78 <br>Pop.:     2,253,639","Country: Paraguay <br>Life Expectancy: 67.38 <br>GDP per capita: 3998.88 <br>Pop.:     3,886,512","Country: Peru <br>Life Expectancy: 64.13 <br>GDP per capita: 6360.94 <br>Pop.:    20,195,924","Country: Puerto Rico <br>Life Expectancy: 74.63 <br>GDP per capita: 12281.34 <br>Pop.:     3,444,468","Country: Trinidad and Tobago <br>Life Expectancy: 69.58 <br>GDP per capita: 7388.6 <br>Pop.:     1,191,336","Country: United States <br>Life Expectancy: 75.02 <br>GDP per capita: 29884.35 <br>Pop.:   242,803,533","Country: Uruguay <br>Life Expectancy: 71.92 <br>GDP per capita: 7452.4 <br>Pop.:     3,045,153","Country: Venezuela <br>Life Expectancy: 70.19 <br>GDP per capita: 9883.58 <br>Pop.:    17,910,182"],"frame":"1987","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[12.154127030166471,10.416094808472128,19.751858583607309,11.808001116558641,10.846565544543003,12.109307118644901,10.186999608003982,10.694803943918515,10.450148148286059,10.64738987183741,10.326398403680306,10.495953360319033,10.388782272835758,10.294320101335098,10.154701940471488,15.464505643779169,10.224166240802617,10.149721722792378,10.261170226668677,11.374336753705476,10.230999391308245,10.077216341165451,26.567977027339847,10.203744938986867,11.218327972773205]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.9306413749286353,4.2677353364072825,2.8762059455533509,2.8349897925895373,3.1395340370941218,4.3018646170164363,2.9896778850098498,3.2426301069972827,3.8223564968521901,4.0660862584188333,4.2335666640513905,4.3497813255083981,3.6482311588491769,3.613471014413737,3.9311062654170961,4.4489910677681976,3.7305474129591527,3.7201429780109065,3.3688460493300871,2.5854607295085006,2.8896559703455038,4.2580436877236298,3.23164454298501,3.3403717254022243,4.3263002424041126,4.2755769373597659,3.2734103184190602,3.4937053520591888,4.0435415299695148,3.4746028433042633,2.9142370540580087,3.7081826428810891,3.294849985667561],"y":[40.822000000000003,70.75,52.819000000000003,53.914000000000001,67.274000000000001,76.200000000000003,58.552999999999997,60.137,63.039999999999999,65.043999999999997,75.599999999999994,78.670000000000002,65.869,70.647000000000006,69.810000000000002,74.174000000000007,67.926000000000002,69.5,60.222000000000001,58.338999999999999,52.536999999999999,67.733999999999995,58.244999999999997,64.150999999999996,66.295000000000002,73.560000000000002,69.010999999999996,66.974000000000004,73.400000000000006,66.084000000000003,62.82,67.046000000000006,52.921999999999997],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[10.942433932892962,10.026932707612957,17.078126271390129,10.567304037453583,83.984560197503285,10.377063708087592,63.779279171348648,21.54950128148257,13.537532220589025,11.125026580283174,10.282781588038102,18.329004993872076,10.188380434732037,11.297322100196661,12.836731020828442,10.12500375723363,10.206761722209649,11.110597620092477,10.13344296941381,12.591469138430865,11.218805607365807,10.104691318975354,17.175225739355231,14.092298998390429,10.993745729849708,10.186640665402882,11.121758284703471,10.763262263074971,11.344433401907263,13.607194386408,14.284001443824259,10.111334248330712,10.761657839472756],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 40.82 <br>GDP per capita: 852.4 <br>Pop.:    13,867,957","Country: Bahrain <br>Life Expectancy: 70.75 <br>GDP per capita: 18524.02 <br>Pop.:       454,612","Country: Bangladesh <br>Life Expectancy: 52.82 <br>GDP per capita: 751.98 <br>Pop.:   103,764,241","Country: Cambodia <br>Life Expectancy: 53.91 <br>GDP per capita: 683.9 <br>Pop.:     8,371,791","Country: China <br>Life Expectancy: 67.27 <br>GDP per capita: 1378.9 <br>Pop.: 1,084,035,000","Country: Hong Kong, China <br>Life Expectancy: 76.2 <br>GDP per capita: 20038.47 <br>Pop.:     5,584,510","Country: India <br>Life Expectancy: 58.55 <br>GDP per capita: 976.51 <br>Pop.:   788,000,000","Country: Indonesia <br>Life Expectancy: 60.14 <br>GDP per capita: 1748.36 <br>Pop.:   169,276,000","Country: Iran <br>Life Expectancy: 63.04 <br>GDP per capita: 6642.88 <br>Pop.:    51,889,696","Country: Iraq <br>Life Expectancy: 65.04 <br>GDP per capita: 11643.57 <br>Pop.:    16,543,189","Country: Israel <br>Life Expectancy: 75.6 <br>GDP per capita: 17122.48 <br>Pop.:     4,203,148","Country: Japan <br>Life Expectancy: 78.67 <br>GDP per capita: 22375.94 <br>Pop.:   122,091,325","Country: Jordan <br>Life Expectancy: 65.87 <br>GDP per capita: 4448.68 <br>Pop.:     2,820,042","Country: Korea, Dem. Rep. <br>Life Expectancy: 70.65 <br>GDP per capita: 4106.49 <br>Pop.:    19,067,554","Country: Korea, Rep. <br>Life Expectancy: 69.81 <br>GDP per capita: 8533.09 <br>Pop.:    41,622,000","Country: Kuwait <br>Life Expectancy: 74.17 <br>GDP per capita: 28118.43 <br>Pop.:     1,891,487","Country: Lebanon <br>Life Expectancy: 67.93 <br>GDP per capita: 5377.09 <br>Pop.:     3,089,353","Country: Malaysia <br>Life Expectancy: 69.5 <br>GDP per capita: 5249.8 <br>Pop.:    16,331,785","Country: Mongolia <br>Life Expectancy: 60.22 <br>GDP per capita: 2338.01 <br>Pop.:     2,015,133","Country: Myanmar <br>Life Expectancy: 58.34 <br>GDP per capita: 385 <br>Pop.:    38,028,578","Country: Nepal <br>Life Expectancy: 52.54 <br>GDP per capita: 775.63 <br>Pop.:    17,917,180","Country: Oman <br>Life Expectancy: 67.73 <br>GDP per capita: 18115.22 <br>Pop.:     1,593,882","Country: Pakistan <br>Life Expectancy: 58.24 <br>GDP per capita: 1704.69 <br>Pop.:   105,186,881","Country: Philippines <br>Life Expectancy: 64.15 <br>GDP per capita: 2189.63 <br>Pop.:    60,017,788","Country: Saudi Arabia <br>Life Expectancy: 66.3 <br>GDP per capita: 21198.26 <br>Pop.:    14,619,745","Country: Singapore <br>Life Expectancy: 73.56 <br>GDP per capita: 18861.53 <br>Pop.:     2,794,552","Country: Sri Lanka <br>Life Expectancy: 69.01 <br>GDP per capita: 1876.77 <br>Pop.:    16,495,304","Country: Syria <br>Life Expectancy: 66.97 <br>GDP per capita: 3116.77 <br>Pop.:    11,242,847","Country: Taiwan <br>Life Expectancy: 73.4 <br>GDP per capita: 11054.56 <br>Pop.:    19,757,799","Country: Thailand <br>Life Expectancy: 66.08 <br>GDP per capita: 2982.65 <br>Pop.:    52,910,342","Country: Vietnam <br>Life Expectancy: 62.82 <br>GDP per capita: 820.8 <br>Pop.:    62,826,491","Country: West Bank and Gaza <br>Life Expectancy: 67.05 <br>GDP per capita: 5107.2 <br>Pop.:     1,691,210","Country: Yemen, Rep. <br>Life Expectancy: 52.92 <br>GDP per capita: 1971.74 <br>Pop.:    11,219,340"],"frame":"1987","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[10.942433932892962,10.026932707612957,17.078126271390129,10.567304037453583,83.984560197503285,10.377063708087592,63.779279171348648,21.54950128148257,13.537532220589025,11.125026580283174,10.282781588038102,18.329004993872076,10.188380434732037,11.297322100196661,12.836731020828442,10.12500375723363,10.206761722209649,11.110597620092477,10.13344296941381,12.591469138430865,11.218805607365807,10.104691318975354,17.175225739355231,14.092298998390429,10.993745729849708,10.186640665402882,11.121758284703471,10.763262263074971,11.344433401907263,13.607194386408,14.284001443824259,10.111334248330712,10.761657839472756]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.5727476520809116,4.3745252055465347,4.3526756560098301,3.6348916933091768,3.9159195600355714,4.140589235946142,4.2124657675121204,4.399953514402462,4.3251257774548089,4.3437323157840044,4.3916263500340795,4.2073792727730677,4.1134914503473929,4.430126778686919,4.1421662076625063,4.2834648459207463,4.0693909393407832,4.3738554503775919,4.4988751114316567,3.9581982900240202,4.1152545691815856,3.9866048478327034,4.2006009671761158,4.0805279146955851,4.2713428086653513,4.1976935103486346,4.3726714047304478,4.4811803184236272,3.7066361790138531,4.3357544370030165],"y":[72,74.939999999999998,75.349999999999994,71.140000000000001,71.340000000000003,71.519999999999996,71.579999999999998,74.799999999999997,74.829999999999998,76.340000000000003,74.846999999999994,76.670000000000002,69.579999999999998,77.230000000000004,74.359999999999999,76.420000000000002,74.864999999999995,76.829999999999998,75.890000000000001,70.980000000000004,74.060000000000002,69.530000000000001,71.218000000000004,71.079999999999998,72.25,76.900000000000006,77.189999999999998,77.409999999999997,63.107999999999997,75.007000000000005],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.205803995915938,10.513187041617734,10.669574968043275,10.292052326688941,10.608267244160981,10.301971741985694,10.699701643703591,10.345838909683581,10.33250943729686,13.792826067503588,15.300412156821903,10.67669307488273,10.720255561125718,10.012603942846944,10.237512912948889,13.867877286556075,10.034772317064357,10.996853494340272,10.281621218545556,12.571821279770784,10.672652428195583,11.544317267887056,10.625932830532843,10.350773193084208,10.12871556089889,12.649629169809355,10.570690205988621,10.449782653395607,13.605214093457191,13.885071381106604],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 72 <br>GDP per capita: 3738.93 <br>Pop.:     3,075,321","Country: Austria <br>Life Expectancy: 74.94 <br>GDP per capita: 23687.83 <br>Pop.:     7,578,903","Country: Belgium <br>Life Expectancy: 75.35 <br>GDP per capita: 22525.56 <br>Pop.:     9,870,200","Country: Bosnia and Herzegovina <br>Life Expectancy: 71.14 <br>GDP per capita: 4314.11 <br>Pop.:     4,338,977","Country: Bulgaria <br>Life Expectancy: 71.34 <br>GDP per capita: 8239.85 <br>Pop.:     8,971,958","Country: Croatia <br>Life Expectancy: 71.52 <br>GDP per capita: 13822.58 <br>Pop.:     4,484,310","Country: Czech Republic <br>Life Expectancy: 71.58 <br>GDP per capita: 16310.44 <br>Pop.:    10,311,597","Country: Denmark <br>Life Expectancy: 74.8 <br>GDP per capita: 25116.18 <br>Pop.:     5,127,024","Country: Finland <br>Life Expectancy: 74.83 <br>GDP per capita: 21141.01 <br>Pop.:     4,931,729","Country: France <br>Life Expectancy: 76.34 <br>GDP per capita: 22066.44 <br>Pop.:    55,630,100","Country: Germany <br>Life Expectancy: 74.85 <br>GDP per capita: 24639.19 <br>Pop.:    77,718,298","Country: Greece <br>Life Expectancy: 76.67 <br>GDP per capita: 16120.53 <br>Pop.:     9,974,490","Country: Hungary <br>Life Expectancy: 69.58 <br>GDP per capita: 12986.48 <br>Pop.:    10,612,740","Country: Iceland <br>Life Expectancy: 77.23 <br>GDP per capita: 26923.21 <br>Pop.:       244,676","Country: Ireland <br>Life Expectancy: 74.36 <br>GDP per capita: 13872.87 <br>Pop.:     3,539,900","Country: Italy <br>Life Expectancy: 76.42 <br>GDP per capita: 19207.23 <br>Pop.:    56,729,703","Country: Montenegro <br>Life Expectancy: 74.86 <br>GDP per capita: 11732.51 <br>Pop.:       569,473","Country: Netherlands <br>Life Expectancy: 76.83 <br>GDP per capita: 23651.32 <br>Pop.:    14,665,278","Country: Norway <br>Life Expectancy: 75.89 <br>GDP per capita: 31540.97 <br>Pop.:     4,186,147","Country: Poland <br>Life Expectancy: 70.98 <br>GDP per capita: 9082.35 <br>Pop.:    37,740,710","Country: Portugal <br>Life Expectancy: 74.06 <br>GDP per capita: 13039.31 <br>Pop.:     9,915,289","Country: Romania <br>Life Expectancy: 69.53 <br>GDP per capita: 9696.27 <br>Pop.:    22,686,371","Country: Serbia <br>Life Expectancy: 71.22 <br>GDP per capita: 15870.88 <br>Pop.:     9,230,783","Country: Slovak Republic <br>Life Expectancy: 71.08 <br>GDP per capita: 12037.27 <br>Pop.:     5,199,318","Country: Slovenia <br>Life Expectancy: 72.25 <br>GDP per capita: 18678.53 <br>Pop.:     1,945,870","Country: Spain <br>Life Expectancy: 76.9 <br>GDP per capita: 15764.98 <br>Pop.:    38,880,702","Country: Sweden <br>Life Expectancy: 77.19 <br>GDP per capita: 23586.93 <br>Pop.:     8,421,403","Country: Switzerland <br>Life Expectancy: 77.41 <br>GDP per capita: 30281.7 <br>Pop.:     6,649,942","Country: Turkey <br>Life Expectancy: 63.11 <br>GDP per capita: 5089.04 <br>Pop.:    52,881,328","Country: United Kingdom <br>Life Expectancy: 75.01 <br>GDP per capita: 21664.79 <br>Pop.:    56,981,620"],"frame":"1987","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.205803995915938,10.513187041617734,10.669574968043275,10.292052326688941,10.608267244160981,10.301971741985694,10.699701643703591,10.345838909683581,10.33250943729686,13.792826067503588,15.300412156821903,10.67669307488273,10.720255561125718,10.012603942846944,10.237512912948889,13.867877286556075,10.034772317064357,10.996853494340272,10.281621218545556,12.571821279770784,10.672652428195583,11.544317267887056,10.625932830532843,10.350773193084208,10.12871556089889,12.649629169809355,10.570690205988621,10.449782653395607,13.605214093457191,13.885071381106604]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.3402237195220348,4.2789179455147934],"y":[76.319999999999993,74.319999999999993],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[11.105510313434259,10.22231064610855],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 76.32 <br>GDP per capita: 21888.89 <br>Pop.:    16,257,249","Country: New Zealand <br>Life Expectancy: 74.32 <br>GDP per capita: 19007.19 <br>Pop.:     3,317,166"],"frame":"1987","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[11.105510313434259,10.22231064610855]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1992","data":[{"x":[3.7009819093097804,3.4195998585587133,3.0759874851178277,3.9005916825095475,2.9693006939831466,2.8005107928817181,3.2536198364143298,2.8738467416136055,3.0245120611648049,3.0958341918970893,2.6605991118977625,3.6038196062835839,3.2169766529355299,3.3760577181586222,3.5791837641867263,3.0538675402635107,2.7655631418994782,2.624646570001604,4.1310459907384169,2.8232292418629577,2.9661699745777828,2.9000110461052619,2.8724708739708422,3.1277271826516868,2.9901106670199629,2.8038822696281938,3.9840832735073892,3.0173156182977596,2.7506626573152877,2.8686528861924701,3.1339761070826722,3.7823474666870589,3.4695344402176782,2.6137327843184912,3.5803019261086964,2.7643126969049336,3.2094743221922615,3.7854192351526845,2.8675079071267588,3.1549646978909278,3.1360541492148606,3.0288542968547683,2.9670611328244711,3.8588420145044422,3.1738261750383434,3.550597945503887,2.9168130558058625,3.0146460644819584,3.6367606403025023,2.8090010324478722,3.0831027677192613,2.8409968556879672],"y":[67.744,40.646999999999998,53.918999999999997,62.744999999999997,50.259999999999998,44.735999999999997,54.314,49.396000000000001,51.723999999999997,57.939,45.548000000000002,56.433,52.043999999999997,51.603999999999999,63.673999999999999,47.545000000000002,49.991,48.091000000000001,61.366,52.643999999999998,57.500999999999998,48.576000000000001,43.265999999999998,59.284999999999997,59.685000000000002,40.802,68.754999999999995,52.213999999999999,49.420000000000002,48.387999999999998,58.332999999999998,69.745000000000005,65.393000000000001,44.283999999999999,61.999000000000002,47.390999999999998,47.472000000000001,73.614999999999995,23.599,62.741999999999997,58.195999999999998,38.332999999999998,39.658000000000001,61.887999999999998,53.555999999999997,58.473999999999997,50.439999999999998,58.061,70.001000000000005,48.825000000000003,46.100000000000001,60.377000000000002],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[11.790847291286426,10.592161580426145,10.335918129326547,10.087541520630969,10.601875008126374,10.392401934931998,10.846826066297785,10.218758622749275,10.434731157463393,10.026920217311378,12.840153431713961,10.160330561784454,10.867672243126245,10.022123873252227,14.050283125446724,10.022375180850107,10.246286155380027,13.551105219730019,10.063183726227575,10.065889616971175,11.106977002454041,10.473031814091136,10.067633754493233,11.703631269279652,10.118977562113589,10.126470309747383,10.293794416620576,10.829300330351792,10.679406746469937,10.570336109351521,10.140563942879856,10.070723158923007,11.756711638337501,10.894163626750096,10.101986520279977,10.568739193580855,16.368295129612417,10.038370479461157,10.493482396449931,10.004497873628535,10.562944649190637,10.286722244059606,10.412233735465051,12.723578375696341,11.922522029864204,10.061586946962937,11.811807791913488,10.251685856083734,10.577629762943214,11.241671049616123,10.567943704701635,10.726507537216369],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 67.74 <br>GDP per capita: 5023.22 <br>Pop.:    26,298,373","Country: Angola <br>Life Expectancy: 40.65 <br>GDP per capita: 2627.85 <br>Pop.:     8,735,988","Country: Benin <br>Life Expectancy: 53.92 <br>GDP per capita: 1191.21 <br>Pop.:     4,981,671","Country: Botswana <br>Life Expectancy: 62.74 <br>GDP per capita: 7954.11 <br>Pop.:     1,342,614","Country: Burkina Faso <br>Life Expectancy: 50.26 <br>GDP per capita: 931.75 <br>Pop.:     8,878,303","Country: Burundi <br>Life Expectancy: 44.74 <br>GDP per capita: 631.7 <br>Pop.:     5,809,236","Country: Cameroon <br>Life Expectancy: 54.31 <br>GDP per capita: 1793.16 <br>Pop.:    12,467,171","Country: Central African Republic <br>Life Expectancy: 49.4 <br>GDP per capita: 747.91 <br>Pop.:     3,265,124","Country: Chad <br>Life Expectancy: 51.72 <br>GDP per capita: 1058.06 <br>Pop.:     6,429,417","Country: Comoros <br>Life Expectancy: 57.94 <br>GDP per capita: 1246.91 <br>Pop.:       454,429","Country: Congo, Dem. Rep. <br>Life Expectancy: 45.55 <br>GDP per capita: 457.72 <br>Pop.:    41,672,143","Country: Congo, Rep. <br>Life Expectancy: 56.43 <br>GDP per capita: 4016.24 <br>Pop.:     2,409,073","Country: Cote d'Ivoire <br>Life Expectancy: 52.04 <br>GDP per capita: 1648.07 <br>Pop.:    12,772,596","Country: Djibouti <br>Life Expectancy: 51.6 <br>GDP per capita: 2377.16 <br>Pop.:       384,156","Country: Egypt <br>Life Expectancy: 63.67 <br>GDP per capita: 3794.76 <br>Pop.:    59,402,198","Country: Equatorial Guinea <br>Life Expectancy: 47.55 <br>GDP per capita: 1132.06 <br>Pop.:       387,838","Country: Eritrea <br>Life Expectancy: 49.99 <br>GDP per capita: 582.86 <br>Pop.:     3,668,440","Country: Ethiopia <br>Life Expectancy: 48.09 <br>GDP per capita: 421.35 <br>Pop.:    52,088,559","Country: Gabon <br>Life Expectancy: 61.37 <br>GDP per capita: 13522.16 <br>Pop.:       985,739","Country: Gambia <br>Life Expectancy: 52.64 <br>GDP per capita: 665.62 <br>Pop.:     1,025,384","Country: Ghana <br>Life Expectancy: 57.5 <br>GDP per capita: 925.06 <br>Pop.:    16,278,738","Country: Guinea <br>Life Expectancy: 48.58 <br>GDP per capita: 794.35 <br>Pop.:     6,990,574","Country: Guinea-Bissau <br>Life Expectancy: 43.27 <br>GDP per capita: 745.54 <br>Pop.:     1,050,938","Country: Kenya <br>Life Expectancy: 59.28 <br>GDP per capita: 1341.92 <br>Pop.:    25,020,539","Country: Lesotho <br>Life Expectancy: 59.69 <br>GDP per capita: 977.49 <br>Pop.:     1,803,195","Country: Liberia <br>Life Expectancy: 40.8 <br>GDP per capita: 636.62 <br>Pop.:     1,912,974","Country: Libya <br>Life Expectancy: 68.75 <br>GDP per capita: 9640.14 <br>Pop.:     4,364,501","Country: Madagascar <br>Life Expectancy: 52.21 <br>GDP per capita: 1040.68 <br>Pop.:    12,210,395","Country: Malawi <br>Life Expectancy: 49.42 <br>GDP per capita: 563.2 <br>Pop.:    10,014,249","Country: Mali <br>Life Expectancy: 48.39 <br>GDP per capita: 739.01 <br>Pop.:     8,416,215","Country: Mauritania <br>Life Expectancy: 58.33 <br>GDP per capita: 1361.37 <br>Pop.:     2,119,465","Country: Mauritius <br>Life Expectancy: 69.75 <br>GDP per capita: 6058.25 <br>Pop.:     1,096,202","Country: Morocco <br>Life Expectancy: 65.39 <br>GDP per capita: 2948.05 <br>Pop.:    25,798,239","Country: Mozambique <br>Life Expectancy: 44.28 <br>GDP per capita: 410.9 <br>Pop.:    13,160,731","Country: Namibia <br>Life Expectancy: 62 <br>GDP per capita: 3804.54 <br>Pop.:     1,554,253","Country: Niger <br>Life Expectancy: 47.39 <br>GDP per capita: 581.18 <br>Pop.:     8,392,818","Country: Nigeria <br>Life Expectancy: 47.47 <br>GDP per capita: 1619.85 <br>Pop.:    93,364,244","Country: Reunion <br>Life Expectancy: 73.61 <br>GDP per capita: 6101.26 <br>Pop.:       622,191","Country: Rwanda <br>Life Expectancy: 23.6 <br>GDP per capita: 737.07 <br>Pop.:     7,290,203","Country: Sao Tome and Principe <br>Life Expectancy: 62.74 <br>GDP per capita: 1428.78 <br>Pop.:       125,911","Country: Senegal <br>Life Expectancy: 58.2 <br>GDP per capita: 1367.9 <br>Pop.:     8,307,920","Country: Sierra Leone <br>Life Expectancy: 38.33 <br>GDP per capita: 1068.7 <br>Pop.:     4,260,884","Country: Somalia <br>Life Expectancy: 39.66 <br>GDP per capita: 926.96 <br>Pop.:     6,099,799","Country: South Africa <br>Life Expectancy: 61.89 <br>GDP per capita: 7225.07 <br>Pop.:    39,964,159","Country: Sudan <br>Life Expectancy: 53.56 <br>GDP per capita: 1492.2 <br>Pop.:    28,227,588","Country: Swaziland <br>Life Expectancy: 58.47 <br>GDP per capita: 3553.02 <br>Pop.:       962,344","Country: Tanzania <br>Life Expectancy: 50.44 <br>GDP per capita: 825.68 <br>Pop.:    26,605,473","Country: Togo <br>Life Expectancy: 58.06 <br>GDP per capita: 1034.3 <br>Pop.:     3,747,553","Country: Tunisia <br>Life Expectancy: 70 <br>GDP per capita: 4332.72 <br>Pop.:     8,523,077","Country: Uganda <br>Life Expectancy: 48.83 <br>GDP per capita: 644.17 <br>Pop.:    18,252,190","Country: Zambia <br>Life Expectancy: 46.1 <br>GDP per capita: 1210.88 <br>Pop.:     8,381,163","Country: Zimbabwe <br>Life Expectancy: 60.38 <br>GDP per capita: 693.42 <br>Pop.:    10,704,340"],"frame":"1992","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[11.790847291286426,10.592161580426145,10.335918129326547,10.087541520630969,10.601875008126374,10.392401934931998,10.846826066297785,10.218758622749275,10.434731157463393,10.026920217311378,12.840153431713961,10.160330561784454,10.867672243126245,10.022123873252227,14.050283125446724,10.022375180850107,10.246286155380027,13.551105219730019,10.063183726227575,10.065889616971175,11.106977002454041,10.473031814091136,10.067633754493233,11.703631269279652,10.118977562113589,10.126470309747383,10.293794416620576,10.829300330351792,10.679406746469937,10.570336109351521,10.140563942879856,10.070723158923007,11.756711638337501,10.894163626750096,10.101986520279977,10.568739193580855,16.368295129612417,10.038370479461157,10.493482396449931,10.004497873628535,10.562944649190637,10.286722244059606,10.412233735465051,12.723578375696341,11.922522029864204,10.061586946962937,11.811807791913488,10.251685856083734,10.577629762943214,11.241671049616123,10.567943704701635,10.726507537216369]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.9688759104282534,3.4715410204746604,3.8420024897636309,4.4206633237626605,3.8805921578839024,3.735969856796634,3.7896100624998752,3.7476327029410892,3.4834752094273305,3.8514847708935598,3.6477966927999601,3.6473292512163944,3.1632536876415047,3.4887895977816146,3.8695205870497764,3.9764593090803189,3.3364900981768706,3.8207755214216097,3.6228780248414565,3.6480066662137691,4.1655881556674625,3.8675258769188066,4.5052033422328996,3.9104645708506638,4.0307586094650629],"y":[71.867999999999995,59.957000000000001,67.057000000000002,77.950000000000003,74.126000000000005,68.421000000000006,75.712999999999994,74.414000000000001,68.456999999999994,69.613,66.798000000000002,63.372999999999998,55.088999999999999,66.399000000000001,71.766000000000005,71.454999999999998,65.843000000000004,72.462000000000003,68.224999999999994,66.457999999999998,73.911000000000001,69.861999999999995,76.090000000000003,72.751999999999995,71.150000000000006],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[12.313704556446469,10.466402876603667,20.641734419506236,11.942719052275654,10.922301819097912,12.330342866703262,10.212485624730284,10.727798884242953,10.497644328743114,10.729514355499091,10.355914760888629,10.575163918050169,10.42771918406085,10.342448304702629,10.15825191624034,16.009747440452252,10.270140515551493,10.16551260362623,10.301946829635551,11.526849820015096,10.240603136414832,10.076693045306422,27.529706769846214,10.210850692030771,11.379089825353695],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 71.87 <br>GDP per capita: 9308.42 <br>Pop.:    33,958,947","Country: Bolivia <br>Life Expectancy: 59.96 <br>GDP per capita: 2961.7 <br>Pop.:     6,893,451","Country: Brazil <br>Life Expectancy: 67.06 <br>GDP per capita: 6950.28 <br>Pop.:   155,975,974","Country: Canada <br>Life Expectancy: 77.95 <br>GDP per capita: 26342.88 <br>Pop.:    28,523,502","Country: Chile <br>Life Expectancy: 74.13 <br>GDP per capita: 7596.13 <br>Pop.:    13,572,994","Country: Colombia <br>Life Expectancy: 68.42 <br>GDP per capita: 5444.65 <br>Pop.:    34,202,721","Country: Costa Rica <br>Life Expectancy: 75.71 <br>GDP per capita: 6160.42 <br>Pop.:     3,173,216","Country: Cuba <br>Life Expectancy: 74.41 <br>GDP per capita: 5592.84 <br>Pop.:    10,723,260","Country: Dominican Republic <br>Life Expectancy: 68.46 <br>GDP per capita: 3044.21 <br>Pop.:     7,351,181","Country: Ecuador <br>Life Expectancy: 69.61 <br>GDP per capita: 7103.7 <br>Pop.:    10,748,394","Country: El Salvador <br>Life Expectancy: 66.8 <br>GDP per capita: 4444.23 <br>Pop.:     5,274,649","Country: Guatemala <br>Life Expectancy: 63.37 <br>GDP per capita: 4439.45 <br>Pop.:     8,486,949","Country: Haiti <br>Life Expectancy: 55.09 <br>GDP per capita: 1456.31 <br>Pop.:     6,326,682","Country: Honduras <br>Life Expectancy: 66.4 <br>GDP per capita: 3081.69 <br>Pop.:     5,077,347","Country: Jamaica <br>Life Expectancy: 71.77 <br>GDP per capita: 7404.92 <br>Pop.:     2,378,618","Country: Mexico <br>Life Expectancy: 71.46 <br>GDP per capita: 9472.38 <br>Pop.:    88,111,030","Country: Nicaragua <br>Life Expectancy: 65.84 <br>GDP per capita: 2170.15 <br>Pop.:     4,017,939","Country: Panama <br>Life Expectancy: 72.46 <br>GDP per capita: 6618.74 <br>Pop.:     2,484,997","Country: Paraguay <br>Life Expectancy: 68.22 <br>GDP per capita: 4196.41 <br>Pop.:     4,483,945","Country: Peru <br>Life Expectancy: 66.46 <br>GDP per capita: 4446.38 <br>Pop.:    22,430,449","Country: Puerto Rico <br>Life Expectancy: 73.91 <br>GDP per capita: 14641.59 <br>Pop.:     3,585,176","Country: Trinidad and Tobago <br>Life Expectancy: 69.86 <br>GDP per capita: 7370.99 <br>Pop.:     1,183,669","Country: United States <br>Life Expectancy: 76.09 <br>GDP per capita: 32003.93 <br>Pop.:   256,894,189","Country: Uruguay <br>Life Expectancy: 72.75 <br>GDP per capita: 8137 <br>Pop.:     3,149,262","Country: Venezuela <br>Life Expectancy: 71.15 <br>GDP per capita: 10733.93 <br>Pop.:    20,265,563"],"frame":"1992","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[12.313704556446469,10.466402876603667,20.641734419506236,11.942719052275654,10.922301819097912,12.330342866703262,10.212485624730284,10.727798884242953,10.497644328743114,10.729514355499091,10.355914760888629,10.575163918050169,10.42771918406085,10.342448304702629,10.15825191624034,16.009747440452252,10.270140515551493,10.16551260362623,10.301946829635551,11.526849820015096,10.240603136414832,10.076693045306422,27.529706769846214,10.210850692030771,11.379089825353695]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.8124730898185284,4.2795660950462917,2.9231456249111223,2.8339773925299694,3.219003723089541,4.3937085947130852,3.0661047363601099,3.3771497198181208,3.859477742523397,3.5735261138994345,4.2565138379776455,4.428538032474437,3.5354958551341364,3.5712502527353762,4.0829389154417948,4.5432348842015946,3.8382700770199594,3.8620068479200307,3.2517360208249722,2.5403294747908736,2.95315075053154,4.2699028615379842,3.2948693517581438,3.3578060666427443,4.3951798751481022,4.3939240989821471,3.3331931171130145,3.5238170362715793,4.1822907352786407,3.6643501430287206,2.9952064566477556,3.7794272678399001,3.274041561282063],"y":[41.673999999999999,72.600999999999999,56.018000000000001,55.802999999999997,68.689999999999998,77.600999999999999,60.222999999999999,62.680999999999997,65.742000000000004,59.460999999999999,76.930000000000007,79.359999999999999,68.015000000000001,69.977999999999994,72.244,75.189999999999998,69.292000000000002,70.692999999999998,61.271000000000001,59.32,55.726999999999997,71.197000000000003,60.838000000000001,66.457999999999998,68.768000000000001,75.787999999999997,70.379000000000005,69.248999999999995,74.260000000000005,67.298000000000002,67.662000000000006,69.718000000000004,55.598999999999997],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[11.109651360305133,10.032043425055008,17.756584300964214,10.688678577169002,89.508617892883322,10.393798391600281,69.512532354914754,22.610153120442298,14.118247770552266,11.215032922011979,10.332838485077788,18.481751417236865,10.259866389340514,11.409517838071219,12.985758064443411,10.092693326387502,10.21567836422339,11.246265296500553,10.153759775864989,12.763327497789104,11.383229097646201,10.12662278698086,18.190702478108065,14.58153510182176,11.152509884960796,10.216761607810014,11.196273922354393,10.898144893314983,11.407848574105618,13.863604101849923,14.769569562025376,10.139561579114929,10.90831015596849],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 41.67 <br>GDP per capita: 649.34 <br>Pop.:    16,317,921","Country: Bahrain <br>Life Expectancy: 72.6 <br>GDP per capita: 19035.58 <br>Pop.:       529,491","Country: Bangladesh <br>Life Expectancy: 56.02 <br>GDP per capita: 837.81 <br>Pop.:   113,704,579","Country: Cambodia <br>Life Expectancy: 55.8 <br>GDP per capita: 682.3 <br>Pop.:    10,150,094","Country: China <br>Life Expectancy: 68.69 <br>GDP per capita: 1655.78 <br>Pop.: 1,164,970,000","Country: Hong Kong, China <br>Life Expectancy: 77.6 <br>GDP per capita: 24757.6 <br>Pop.:     5,829,696","Country: India <br>Life Expectancy: 60.22 <br>GDP per capita: 1164.41 <br>Pop.:   872,000,000","Country: Indonesia <br>Life Expectancy: 62.68 <br>GDP per capita: 2383.14 <br>Pop.:   184,816,000","Country: Iran <br>Life Expectancy: 65.74 <br>GDP per capita: 7235.65 <br>Pop.:    60,397,973","Country: Iraq <br>Life Expectancy: 59.46 <br>GDP per capita: 3745.64 <br>Pop.:    17,861,905","Country: Israel <br>Life Expectancy: 76.93 <br>GDP per capita: 18051.52 <br>Pop.:     4,936,550","Country: Japan <br>Life Expectancy: 79.36 <br>GDP per capita: 26824.9 <br>Pop.:   124,329,269","Country: Jordan <br>Life Expectancy: 68.02 <br>GDP per capita: 3431.59 <br>Pop.:     3,867,409","Country: Korea, Dem. Rep. <br>Life Expectancy: 69.98 <br>GDP per capita: 3726.06 <br>Pop.:    20,711,375","Country: Korea, Rep. <br>Life Expectancy: 72.24 <br>GDP per capita: 12104.28 <br>Pop.:    43,805,450","Country: Kuwait <br>Life Expectancy: 75.19 <br>GDP per capita: 34932.92 <br>Pop.:     1,418,095","Country: Lebanon <br>Life Expectancy: 69.29 <br>GDP per capita: 6890.81 <br>Pop.:     3,219,994","Country: Malaysia <br>Life Expectancy: 70.69 <br>GDP per capita: 7277.91 <br>Pop.:    18,319,502","Country: Mongolia <br>Life Expectancy: 61.27 <br>GDP per capita: 1785.4 <br>Pop.:     2,312,802","Country: Myanmar <br>Life Expectancy: 59.32 <br>GDP per capita: 347 <br>Pop.:    40,546,538","Country: Nepal <br>Life Expectancy: 55.73 <br>GDP per capita: 897.74 <br>Pop.:    20,326,209","Country: Oman <br>Life Expectancy: 71.2 <br>GDP per capita: 18616.71 <br>Pop.:     1,915,208","Country: Pakistan <br>Life Expectancy: 60.84 <br>GDP per capita: 1971.83 <br>Pop.:   120,065,004","Country: Philippines <br>Life Expectancy: 66.46 <br>GDP per capita: 2279.32 <br>Pop.:    67,185,766","Country: Saudi Arabia <br>Life Expectancy: 68.77 <br>GDP per capita: 24841.62 <br>Pop.:    16,945,857","Country: Singapore <br>Life Expectancy: 75.79 <br>GDP per capita: 24769.89 <br>Pop.:     3,235,865","Country: Sri Lanka <br>Life Expectancy: 70.38 <br>GDP per capita: 2153.74 <br>Pop.:    17,587,060","Country: Syria <br>Life Expectancy: 69.25 <br>GDP per capita: 3340.54 <br>Pop.:    13,219,062","Country: Taiwan <br>Life Expectancy: 74.26 <br>GDP per capita: 15215.66 <br>Pop.:    20,686,918","Country: Thailand <br>Life Expectancy: 67.3 <br>GDP per capita: 4616.9 <br>Pop.:    56,667,095","Country: Vietnam <br>Life Expectancy: 67.66 <br>GDP per capita: 989.02 <br>Pop.:    69,940,728","Country: West Bank and Gaza <br>Life Expectancy: 69.72 <br>GDP per capita: 6017.65 <br>Pop.:     2,104,779","Country: Yemen, Rep. <br>Life Expectancy: 55.6 <br>GDP per capita: 1879.5 <br>Pop.:    13,367,997"],"frame":"1992","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[11.109651360305133,10.032043425055008,17.756584300964214,10.688678577169002,89.508617892883322,10.393798391600281,69.512532354914754,22.610153120442298,14.118247770552266,11.215032922011979,10.332838485077788,18.481751417236865,10.259866389340514,11.409517838071219,12.985758064443411,10.092693326387502,10.21567836422339,11.246265296500553,10.153759775864989,12.763327497789104,11.383229097646201,10.12662278698086,18.190702478108065,14.58153510182176,11.152509884960796,10.216761607810014,11.196273922354393,10.898144893314983,11.407848574105618,13.863604101849923,14.769569562025376,10.139561579114929,10.90831015596849]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.3974946982640559,4.4320391084552915,4.4078253332836166,3.4059916770786165,3.7995213601663793,3.9267433599002302,4.1552455617675035,4.4217147869489821,4.3148604282091867,4.3927636949730235,4.4233327760895182,4.2440666371763802,4.0226604504950103,4.4004411388674907,4.2444952167267793,4.3426919558442156,3.8453051513849981,4.4279881075266072,4.5310400726585911,3.8886781824694538,4.2097097768717067,3.8194392910640556,3.969652018526669,3.9776535512763882,4.1527382119631877,4.269584492309229,4.3780346285366258,4.5034029164668334,3.7542220256563805,4.3561232763109539],"y":[71.581000000000003,76.040000000000006,76.459999999999994,72.177999999999997,71.189999999999998,72.527000000000001,72.400000000000006,75.329999999999998,75.700000000000003,77.459999999999994,76.069999999999993,77.030000000000001,69.170000000000002,78.769999999999996,75.466999999999999,77.439999999999998,75.435000000000002,77.420000000000002,77.319999999999993,70.989999999999995,74.859999999999999,69.359999999999999,71.659000000000006,71.379999999999995,73.640000000000001,77.569999999999993,78.159999999999997,78.030000000000001,66.146000000000001,76.420000000000002],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.222947583236039,10.536124559050929,10.681548048280984,10.286389783627973,10.586873200388419,10.30263400098141,10.69998182232643,10.348867227665744,10.339970174267046,13.911864716064787,15.496944390291787,10.700645719394485,10.702232943237149,10.013582418056938,10.238731980033551,13.875463199554101,10.038331575243125,11.03159195790964,10.288460853087521,12.614819791358347,10.673498151293172,11.551869873414207,10.666585281267087,10.357842157753517,10.132356176670454,12.695272417439893,10.59099302057191,10.473364411028797,13.966806003551802,13.945456802009499],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 71.58 <br>GDP per capita: 2497.44 <br>Pop.:     3,326,498","Country: Austria <br>Life Expectancy: 76.04 <br>GDP per capita: 27042.02 <br>Pop.:     7,914,969","Country: Belgium <br>Life Expectancy: 76.46 <br>GDP per capita: 25575.57 <br>Pop.:    10,045,622","Country: Bosnia and Herzegovina <br>Life Expectancy: 72.18 <br>GDP per capita: 2546.78 <br>Pop.:     4,256,013","Country: Bulgaria <br>Life Expectancy: 71.19 <br>GDP per capita: 6302.62 <br>Pop.:     8,658,506","Country: Croatia <br>Life Expectancy: 72.53 <br>GDP per capita: 8447.79 <br>Pop.:     4,494,013","Country: Czech Republic <br>Life Expectancy: 72.4 <br>GDP per capita: 14297.02 <br>Pop.:    10,315,702","Country: Denmark <br>Life Expectancy: 75.33 <br>GDP per capita: 26406.74 <br>Pop.:     5,171,393","Country: Finland <br>Life Expectancy: 75.7 <br>GDP per capita: 20647.16 <br>Pop.:     5,041,039","Country: France <br>Life Expectancy: 77.46 <br>GDP per capita: 24703.8 <br>Pop.:    57,374,179","Country: Germany <br>Life Expectancy: 76.07 <br>GDP per capita: 26505.3 <br>Pop.:    80,597,764","Country: Greece <br>Life Expectancy: 77.03 <br>GDP per capita: 17541.5 <br>Pop.:    10,325,429","Country: Hungary <br>Life Expectancy: 69.17 <br>GDP per capita: 10535.63 <br>Pop.:    10,348,684","Country: Iceland <br>Life Expectancy: 78.77 <br>GDP per capita: 25144.39 <br>Pop.:       259,012","Country: Ireland <br>Life Expectancy: 75.47 <br>GDP per capita: 17558.82 <br>Pop.:     3,557,761","Country: Italy <br>Life Expectancy: 77.44 <br>GDP per capita: 22013.64 <br>Pop.:    56,840,847","Country: Montenegro <br>Life Expectancy: 75.44 <br>GDP per capita: 7003.34 <br>Pop.:       621,621","Country: Netherlands <br>Life Expectancy: 77.42 <br>GDP per capita: 26790.95 <br>Pop.:    15,174,244","Country: Norway <br>Life Expectancy: 77.32 <br>GDP per capita: 33965.66 <br>Pop.:     4,286,357","Country: Poland <br>Life Expectancy: 70.99 <br>GDP per capita: 7738.88 <br>Pop.:    38,370,697","Country: Portugal <br>Life Expectancy: 74.86 <br>GDP per capita: 16207.27 <br>Pop.:     9,927,680","Country: Romania <br>Life Expectancy: 69.36 <br>GDP per capita: 6598.41 <br>Pop.:    22,797,027","Country: Serbia <br>Life Expectancy: 71.66 <br>GDP per capita: 9325.07 <br>Pop.:     9,826,397","Country: Slovak Republic <br>Life Expectancy: 71.38 <br>GDP per capita: 9498.47 <br>Pop.:     5,302,888","Country: Slovenia <br>Life Expectancy: 73.64 <br>GDP per capita: 14214.72 <br>Pop.:     1,999,210","Country: Spain <br>Life Expectancy: 77.57 <br>GDP per capita: 18603.06 <br>Pop.:    39,549,438","Country: Sweden <br>Life Expectancy: 78.16 <br>GDP per capita: 23880.02 <br>Pop.:     8,718,867","Country: Switzerland <br>Life Expectancy: 78.03 <br>GDP per capita: 31871.53 <br>Pop.:     6,995,447","Country: Turkey <br>Life Expectancy: 66.15 <br>GDP per capita: 5678.35 <br>Pop.:    58,179,144","Country: United Kingdom <br>Life Expectancy: 76.42 <br>GDP per capita: 22705.09 <br>Pop.:    57,866,349"],"frame":"1992","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.222947583236039,10.536124559050929,10.681548048280984,10.286389783627973,10.586873200388419,10.30263400098141,10.69998182232643,10.348867227665744,10.339970174267046,13.911864716064787,15.496944390291787,10.700645719394485,10.702232943237149,10.013582418056938,10.238731980033551,13.875463199554101,10.038331575243125,11.03159195790964,10.288460853087521,12.614819791358347,10.673498151293172,11.551869873414207,10.666585281267087,10.357842157753517,10.132356176670454,12.695272417439893,10.59099302057191,10.473364411028797,13.966806003551802,13.945456802009499]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.3696752766164506,4.2639513191505269],"y":[77.560000000000002,76.329999999999998],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[11.189101690874766,10.230535680330517],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 77.56 <br>GDP per capita: 23424.77 <br>Pop.:    17,481,977","Country: New Zealand <br>Life Expectancy: 76.33 <br>GDP per capita: 18363.32 <br>Pop.:     3,437,674"],"frame":"1992","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[11.189101690874766,10.230535680330517]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"1997","data":[{"x":[3.6809964299690434,3.3573899007297774,3.0909543737120537,3.9368726065692394,2.9760265278558058,2.6656889863455748,3.2289999150430573,2.869528776308429,3.0021493607599248,3.0695268487036258,2.4944167939203763,3.5420986359756279,3.2519459877171379,3.2776131066652661,3.6204673043652367,3.4493982833654235,2.9606946645023062,2.7125566055933938,4.1679916478871766,2.8153985286187813,3.002272272444853,2.9392444953303642,2.9012754477012508,3.1336937645407259,3.0741388787143853,2.7847413239717929,3.9762328392591142,2.9940072258418731,2.8402791566341592,2.8977688925536316,3.1711810164363872,3.8707377093265785,3.4745224733261812,2.6742603128310041,3.5910116265496934,2.7636564690940171,3.210837670296864,3.7833275723402959,2.7708111603499734,3.1268052380110181,3.1437541418174448,2.7594020186339279,2.9687613813918023,3.8738544641368757,3.2127762375870548,3.5884698635434105,2.8971794951256777,2.992238362979732,3.6881348218957815,2.9119876129845284,3.0299329216522608,2.8989718479854227],"y":[69.152000000000001,40.963000000000001,54.777000000000001,52.555999999999997,50.323999999999998,45.326000000000001,52.198999999999998,46.066000000000003,51.573,60.659999999999997,42.587000000000003,52.962000000000003,47.991,53.156999999999996,67.216999999999999,48.244999999999997,53.378,49.402000000000001,60.460999999999999,55.860999999999997,58.555999999999997,51.454999999999998,44.872999999999998,54.406999999999996,55.558,42.220999999999997,71.555000000000007,54.978000000000002,47.494999999999997,49.902999999999999,60.43,70.736000000000004,67.659999999999997,46.344000000000001,58.908999999999999,51.313000000000002,47.463999999999999,74.772000000000006,36.087000000000003,63.305999999999997,60.186999999999998,39.896999999999998,43.795000000000002,60.235999999999997,55.372999999999998,54.289000000000001,48.466000000000001,58.390000000000001,71.972999999999999,44.578000000000003,40.238,46.808999999999997],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[11.980156717793243,10.669904220583245,10.409932312082947,10.100777281629345,10.70251680752275,10.41372240195537,10.96481082006842,10.248202222244577,10.512034111703725,10.031940431256745,13.258328933320623,10.187077143427988,10.994170400103377,10.024427548983795,14.509768763831403,10.025933415233665,10.27289657226045,14.081618288974518,10.072769862056525,10.080248890834488,11.253007738750455,10.545261248782095,10.077378237314873,11.924995450841815,10.131237714528561,10.146110182804815,10.320765891945536,10.962715793800925,10.707099860912871,10.636457513558547,10.162765010291018,10.07438261252646,11.94312850210718,11.129131657815622,10.117037197176023,10.655654902325633,17.244909200114606,10.042644414950463,10.488184597496259,10.005842253247067,10.646717989166707,10.308380836514781,10.448661392880135,12.919522268184771,12.190970757955448,10.067875916187225,12.090376735668935,10.290817834423095,10.625993302703327,11.44356783348746,10.638696553685772,10.774326144911987],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 69.15 <br>GDP per capita: 4797.3 <br>Pop.:    29,072,015","Country: Angola <br>Life Expectancy: 40.96 <br>GDP per capita: 2277.14 <br>Pop.:     9,875,024","Country: Benin <br>Life Expectancy: 54.78 <br>GDP per capita: 1232.98 <br>Pop.:     6,066,080","Country: Botswana <br>Life Expectancy: 52.56 <br>GDP per capita: 8647.14 <br>Pop.:     1,536,536","Country: Burkina Faso <br>Life Expectancy: 50.32 <br>GDP per capita: 946.29 <br>Pop.:    10,352,843","Country: Burundi <br>Life Expectancy: 45.33 <br>GDP per capita: 463.12 <br>Pop.:     6,121,610","Country: Cameroon <br>Life Expectancy: 52.2 <br>GDP per capita: 1694.34 <br>Pop.:    14,195,809","Country: Central African Republic <br>Life Expectancy: 46.07 <br>GDP per capita: 740.51 <br>Pop.:     3,696,513","Country: Chad <br>Life Expectancy: 51.57 <br>GDP per capita: 1004.96 <br>Pop.:     7,562,011","Country: Comoros <br>Life Expectancy: 60.66 <br>GDP per capita: 1173.62 <br>Pop.:       527,982","Country: Congo, Dem. Rep. <br>Life Expectancy: 42.59 <br>GDP per capita: 312.19 <br>Pop.:    47,798,986","Country: Congo, Rep. <br>Life Expectancy: 52.96 <br>GDP per capita: 3484.16 <br>Pop.:     2,800,947","Country: Cote d'Ivoire <br>Life Expectancy: 47.99 <br>GDP per capita: 1786.27 <br>Pop.:    14,625,967","Country: Djibouti <br>Life Expectancy: 53.16 <br>GDP per capita: 1895.02 <br>Pop.:       417,908","Country: Egypt <br>Life Expectancy: 67.22 <br>GDP per capita: 4173.18 <br>Pop.:    66,134,291","Country: Equatorial Guinea <br>Life Expectancy: 48.24 <br>GDP per capita: 2814.48 <br>Pop.:       439,971","Country: Eritrea <br>Life Expectancy: 53.38 <br>GDP per capita: 913.47 <br>Pop.:     4,058,319","Country: Ethiopia <br>Life Expectancy: 49.4 <br>GDP per capita: 515.89 <br>Pop.:    59,861,301","Country: Gabon <br>Life Expectancy: 60.46 <br>GDP per capita: 14722.84 <br>Pop.:     1,126,189","Country: Gambia <br>Life Expectancy: 55.86 <br>GDP per capita: 653.73 <br>Pop.:     1,235,767","Country: Ghana <br>Life Expectancy: 58.56 <br>GDP per capita: 1005.25 <br>Pop.:    18,418,288","Country: Guinea <br>Life Expectancy: 51.45 <br>GDP per capita: 869.45 <br>Pop.:     8,048,834","Country: Guinea-Bissau <br>Life Expectancy: 44.87 <br>GDP per capita: 796.66 <br>Pop.:     1,193,708","Country: Kenya <br>Life Expectancy: 54.41 <br>GDP per capita: 1360.49 <br>Pop.:    28,263,827","Country: Lesotho <br>Life Expectancy: 55.56 <br>GDP per capita: 1186.15 <br>Pop.:     1,982,823","Country: Liberia <br>Life Expectancy: 42.22 <br>GDP per capita: 609.17 <br>Pop.:     2,200,725","Country: Libya <br>Life Expectancy: 71.56 <br>GDP per capita: 9467.45 <br>Pop.:     4,759,670","Country: Madagascar <br>Life Expectancy: 54.98 <br>GDP per capita: 986.3 <br>Pop.:    14,165,114","Country: Malawi <br>Life Expectancy: 47.49 <br>GDP per capita: 692.28 <br>Pop.:    10,419,991","Country: Mali <br>Life Expectancy: 49.9 <br>GDP per capita: 790.26 <br>Pop.:     9,384,984","Country: Mauritania <br>Life Expectancy: 60.43 <br>GDP per capita: 1483.14 <br>Pop.:     2,444,741","Country: Mauritius <br>Life Expectancy: 70.74 <br>GDP per capita: 7425.71 <br>Pop.:     1,149,818","Country: Morocco <br>Life Expectancy: 67.66 <br>GDP per capita: 2982.1 <br>Pop.:    28,529,501","Country: Mozambique <br>Life Expectancy: 46.34 <br>GDP per capita: 472.35 <br>Pop.:    16,603,334","Country: Namibia <br>Life Expectancy: 58.91 <br>GDP per capita: 3899.52 <br>Pop.:     1,774,766","Country: Niger <br>Life Expectancy: 51.31 <br>GDP per capita: 580.31 <br>Pop.:     9,666,252","Country: Nigeria <br>Life Expectancy: 47.46 <br>GDP per capita: 1624.94 <br>Pop.:   106,207,839","Country: Reunion <br>Life Expectancy: 74.77 <br>GDP per capita: 6071.94 <br>Pop.:       684,810","Country: Rwanda <br>Life Expectancy: 36.09 <br>GDP per capita: 589.94 <br>Pop.:     7,212,583","Country: Sao Tome and Principe <br>Life Expectancy: 63.31 <br>GDP per capita: 1339.08 <br>Pop.:       145,608","Country: Senegal <br>Life Expectancy: 60.19 <br>GDP per capita: 1392.37 <br>Pop.:     9,535,314","Country: Sierra Leone <br>Life Expectancy: 39.9 <br>GDP per capita: 574.65 <br>Pop.:     4,578,212","Country: Somalia <br>Life Expectancy: 43.8 <br>GDP per capita: 930.6 <br>Pop.:     6,633,514","Country: South Africa <br>Life Expectancy: 60.24 <br>GDP per capita: 7479.19 <br>Pop.:    42,835,005","Country: Sudan <br>Life Expectancy: 55.37 <br>GDP per capita: 1632.21 <br>Pop.:    32,160,729","Country: Swaziland <br>Life Expectancy: 54.29 <br>GDP per capita: 3876.77 <br>Pop.:     1,054,486","Country: Tanzania <br>Life Expectancy: 48.47 <br>GDP per capita: 789.19 <br>Pop.:    30,686,889","Country: Togo <br>Life Expectancy: 58.39 <br>GDP per capita: 982.29 <br>Pop.:     4,320,890","Country: Tunisia <br>Life Expectancy: 71.97 <br>GDP per capita: 4876.8 <br>Pop.:     9,231,669","Country: Uganda <br>Life Expectancy: 44.58 <br>GDP per capita: 816.56 <br>Pop.:    21,210,254","Country: Zambia <br>Life Expectancy: 40.24 <br>GDP per capita: 1071.35 <br>Pop.:     9,417,789","Country: Zimbabwe <br>Life Expectancy: 46.81 <br>GDP per capita: 792.45 <br>Pop.:    11,404,948"],"frame":"1997","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[11.980156717793243,10.669904220583245,10.409932312082947,10.100777281629345,10.70251680752275,10.41372240195537,10.96481082006842,10.248202222244577,10.512034111703725,10.031940431256745,13.258328933320623,10.187077143427988,10.994170400103377,10.024427548983795,14.509768763831403,10.025933415233665,10.27289657226045,14.081618288974518,10.072769862056525,10.080248890834488,11.253007738750455,10.545261248782095,10.077378237314873,11.924995450841815,10.131237714528561,10.146110182804815,10.320765891945536,10.962715793800925,10.707099860912871,10.636457513558547,10.162765010291018,10.07438261252646,11.94312850210718,11.129131657815622,10.117037197176023,10.655654902325633,17.244909200114606,10.042644414950463,10.488184597496259,10.005842253247067,10.646717989166707,10.308380836514781,10.448661392880135,12.919522268184771,12.190970757955448,10.067875916187225,12.090376735668935,10.290817834423095,10.625993302703327,11.44356783348746,10.638696553685772,10.774326144911987]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.0400990085793165,3.5219409417333374,3.9008028883111212,4.461722457696081,4.0050969577094184,3.7865641629641145,3.8245843235980739,3.7349589949402873,3.5580003194756658,3.8709570078023439,3.7122139678916919,3.6706459812089198,3.1276641369752598,3.4997495981078313,3.8525973778175704,3.9897744173357648,3.3527656260155569,3.8520950730863111,3.6281231893996098,3.7662899524233602,4.230434443802678,3.9441159889407822,4.5534877726647736,3.9652130267889731,4.0071285387737259],"y":[73.275000000000006,62.049999999999997,69.388000000000005,78.609999999999999,75.816000000000003,70.313000000000002,77.260000000000005,76.150999999999996,69.956999999999994,72.311999999999998,69.534999999999997,66.322000000000003,56.670999999999999,67.659000000000006,72.262,73.670000000000002,68.426000000000002,73.738,69.400000000000006,68.385999999999996,74.917000000000002,69.465000000000003,76.810000000000002,74.222999999999999,72.146000000000001],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[12.466899538619863,10.520987337333018,21.499725655113949,12.064369197661968,10.9923932281225,12.566164469962999,10.236025475012823,10.745527399893806,10.541406523305332,10.808921618416836,10.390641211927516,10.66504808688375,10.467774352668792,10.39640982017238,10.168673673720797,16.541036819479011,10.310521251036645,10.18254405124418,10.347688498112408,11.685037987940277,10.252496497132082,10.073582891960367,28.622954268997955,10.218602596359064,11.523024170322334],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 73.28 <br>GDP per capita: 10967.28 <br>Pop.:    36,203,463","Country: Bolivia <br>Life Expectancy: 62.05 <br>GDP per capita: 3326.14 <br>Pop.:     7,693,188","Country: Brazil <br>Life Expectancy: 69.39 <br>GDP per capita: 7957.98 <br>Pop.:   168,546,719","Country: Canada <br>Life Expectancy: 78.61 <br>GDP per capita: 28954.93 <br>Pop.:    30,305,843","Country: Chile <br>Life Expectancy: 75.82 <br>GDP per capita: 10118.05 <br>Pop.:    14,599,929","Country: Colombia <br>Life Expectancy: 70.31 <br>GDP per capita: 6117.36 <br>Pop.:    37,657,830","Country: Costa Rica <br>Life Expectancy: 77.26 <br>GDP per capita: 6677.05 <br>Pop.:     3,518,107","Country: Cuba <br>Life Expectancy: 76.15 <br>GDP per capita: 5431.99 <br>Pop.:    10,983,007","Country: Dominican Republic <br>Life Expectancy: 69.96 <br>GDP per capita: 3614.1 <br>Pop.:     7,992,357","Country: Ecuador <br>Life Expectancy: 72.31 <br>GDP per capita: 7429.46 <br>Pop.:    11,911,819","Country: El Salvador <br>Life Expectancy: 69.53 <br>GDP per capita: 5154.83 <br>Pop.:     5,783,439","Country: Guatemala <br>Life Expectancy: 66.32 <br>GDP per capita: 4684.31 <br>Pop.:     9,803,875","Country: Haiti <br>Life Expectancy: 56.67 <br>GDP per capita: 1341.73 <br>Pop.:     6,913,545","Country: Honduras <br>Life Expectancy: 67.66 <br>GDP per capita: 3160.45 <br>Pop.:     5,867,957","Country: Jamaica <br>Life Expectancy: 72.26 <br>GDP per capita: 7121.92 <br>Pop.:     2,531,311","Country: Mexico <br>Life Expectancy: 73.67 <br>GDP per capita: 9767.3 <br>Pop.:    95,895,146","Country: Nicaragua <br>Life Expectancy: 68.43 <br>GDP per capita: 2253.02 <br>Pop.:     4,609,572","Country: Panama <br>Life Expectancy: 73.74 <br>GDP per capita: 7113.69 <br>Pop.:     2,734,531","Country: Paraguay <br>Life Expectancy: 69.4 <br>GDP per capita: 4247.4 <br>Pop.:     5,154,123","Country: Peru <br>Life Expectancy: 68.39 <br>GDP per capita: 5838.35 <br>Pop.:    24,748,122","Country: Puerto Rico <br>Life Expectancy: 74.92 <br>GDP per capita: 16999.43 <br>Pop.:     3,759,430","Country: Trinidad and Tobago <br>Life Expectancy: 69.47 <br>GDP per capita: 8792.57 <br>Pop.:     1,138,101","Country: United States <br>Life Expectancy: 76.81 <br>GDP per capita: 35767.43 <br>Pop.:   272,911,760","Country: Uruguay <br>Life Expectancy: 74.22 <br>GDP per capita: 9230.24 <br>Pop.:     3,262,838","Country: Venezuela <br>Life Expectancy: 72.15 <br>GDP per capita: 10165.5 <br>Pop.:    22,374,398"],"frame":"1997","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[12.466899538619863,10.520987337333018,21.499725655113949,12.064369197661968,10.9923932281225,12.566164469962999,10.236025475012823,10.745527399893806,10.541406523305332,10.808921618416836,10.390641211927516,10.66504808688375,10.467774352668792,10.39640982017238,10.168673673720797,16.541036819479011,10.310521251036645,10.18254405124418,10.347688498112408,11.685037987940277,10.252496497132082,10.073582891960367,28.622954268997955,10.218602596359064,11.523024170322334]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.8030071221803685,4.3073252129890163,2.9880101843097031,2.8658647570622273,3.359690213282962,4.4529761554020242,3.1640009472103405,3.4940621021345808,3.9171687772403097,3.4880201860013784,4.3200758216218302,4.4596425119437466,3.5617427555463288,3.2280811463718955,4.2039442739125494,4.6053117271122268,3.9422543571838355,4.0057341698571527,3.2792680722142546,2.6180480967120925,3.004704818923905,4.2945115449614013,3.3116162465010937,3.4042408464012484,4.3135865288538735,4.5252972285887125,3.4256120176144402,3.6036032229426165,4.305497993899202,3.7673507349821169,3.1417308822791501,3.8519103784563393,3.3258202453085919],"y":[41.762999999999998,73.924999999999997,59.411999999999999,56.533999999999999,70.426000000000002,80,61.765000000000001,66.040999999999997,68.042000000000002,58.811,78.269000000000005,80.689999999999998,69.772000000000006,67.727000000000004,74.647000000000006,76.156000000000006,70.265000000000001,71.938000000000002,63.625,60.328000000000003,59.426000000000002,72.498999999999995,61.817999999999998,68.563999999999993,70.533000000000001,77.158000000000001,70.456999999999994,71.527000000000001,75.25,67.521000000000001,70.671999999999997,71.096000000000004,58.020000000000003],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[11.512992137552331,10.036757660738209,18.412544157756798,10.800126739780231,93.952230375217496,10.439270051153397,75.450544580751057,23.597228210212926,14.318230057378376,11.413908417961604,10.373437903220085,18.592814769354657,10.304833249601421,11.469152544072138,13.14740618241186,10.116394185530281,10.230038388869856,11.39345899590405,10.166181892682395,12.947701344088028,11.565799358047792,10.151769040203023,19.248612593491792,15.115766595273888,11.444899108527286,10.25542311812325,11.272143631551847,11.025228865912052,11.472121550185054,14.105873772109792,15.186477263895316,10.188790225828633,11.076110191108933],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 41.76 <br>GDP per capita: 635.34 <br>Pop.:    22,227,415","Country: Bahrain <br>Life Expectancy: 73.92 <br>GDP per capita: 20292.02 <br>Pop.:       598,561","Country: Bangladesh <br>Life Expectancy: 59.41 <br>GDP per capita: 972.77 <br>Pop.:   123,315,288","Country: Cambodia <br>Life Expectancy: 56.53 <br>GDP per capita: 734.29 <br>Pop.:    11,782,962","Country: China <br>Life Expectancy: 70.43 <br>GDP per capita: 2289.23 <br>Pop.: 1,230,075,000","Country: Hong Kong, China <br>Life Expectancy: 80 <br>GDP per capita: 28377.63 <br>Pop.:     6,495,918","Country: India <br>Life Expectancy: 61.76 <br>GDP per capita: 1458.82 <br>Pop.:   959,000,000","Country: Indonesia <br>Life Expectancy: 66.04 <br>GDP per capita: 3119.34 <br>Pop.:   199,278,000","Country: Iran <br>Life Expectancy: 68.04 <br>GDP per capita: 8263.59 <br>Pop.:    63,327,987","Country: Iraq <br>Life Expectancy: 58.81 <br>GDP per capita: 3076.24 <br>Pop.:    20,775,703","Country: Israel <br>Life Expectancy: 78.27 <br>GDP per capita: 20896.61 <br>Pop.:     5,531,387","Country: Japan <br>Life Expectancy: 80.69 <br>GDP per capita: 28816.58 <br>Pop.:   125,956,499","Country: Jordan <br>Life Expectancy: 69.77 <br>GDP per capita: 3645.38 <br>Pop.:     4,526,235","Country: Korea, Dem. Rep. <br>Life Expectancy: 67.73 <br>GDP per capita: 1690.76 <br>Pop.:    21,585,105","Country: Korea, Rep. <br>Life Expectancy: 74.65 <br>GDP per capita: 15993.53 <br>Pop.:    46,173,816","Country: Kuwait <br>Life Expectancy: 76.16 <br>GDP per capita: 40300.62 <br>Pop.:     1,765,345","Country: Lebanon <br>Life Expectancy: 70.26 <br>GDP per capita: 8754.96 <br>Pop.:     3,430,388","Country: Malaysia <br>Life Expectancy: 71.94 <br>GDP per capita: 10132.91 <br>Pop.:    20,476,091","Country: Mongolia <br>Life Expectancy: 63.62 <br>GDP per capita: 1902.25 <br>Pop.:     2,494,803","Country: Myanmar <br>Life Expectancy: 60.33 <br>GDP per capita: 415 <br>Pop.:    43,247,867","Country: Nepal <br>Life Expectancy: 59.43 <br>GDP per capita: 1010.89 <br>Pop.:    23,001,113","Country: Oman <br>Life Expectancy: 72.5 <br>GDP per capita: 19702.06 <br>Pop.:     2,283,635","Country: Pakistan <br>Life Expectancy: 61.82 <br>GDP per capita: 2049.35 <br>Pop.:   135,564,834","Country: Philippines <br>Life Expectancy: 68.56 <br>GDP per capita: 2536.53 <br>Pop.:    75,012,988","Country: Saudi Arabia <br>Life Expectancy: 70.53 <br>GDP per capita: 20586.69 <br>Pop.:    21,229,759","Country: Singapore <br>Life Expectancy: 77.16 <br>GDP per capita: 33519.48 <br>Pop.:     3,802,309","Country: Sri Lanka <br>Life Expectancy: 70.46 <br>GDP per capita: 2664.48 <br>Pop.:    18,698,655","Country: Syria <br>Life Expectancy: 71.53 <br>GDP per capita: 4014.24 <br>Pop.:    15,081,016","Country: Taiwan <br>Life Expectancy: 75.25 <br>GDP per capita: 20206.82 <br>Pop.:    21,628,605","Country: Thailand <br>Life Expectancy: 67.52 <br>GDP per capita: 5852.63 <br>Pop.:    60,216,677","Country: Vietnam <br>Life Expectancy: 70.67 <br>GDP per capita: 1385.9 <br>Pop.:    76,048,996","Country: West Bank and Gaza <br>Life Expectancy: 71.1 <br>GDP per capita: 7110.67 <br>Pop.:     2,826,046","Country: Yemen, Rep. <br>Life Expectancy: 58.02 <br>GDP per capita: 2117.48 <br>Pop.:    15,826,497"],"frame":"1997","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[11.512992137552331,10.036757660738209,18.412544157756798,10.800126739780231,93.952230375217496,10.439270051153397,75.450544580751057,23.597228210212926,14.318230057378376,11.413908417961604,10.373437903220085,18.592814769354657,10.304833249601421,11.469152544072138,13.14740618241186,10.116394185530281,10.230038388869856,11.39345899590405,10.166181892682395,12.947701344088028,11.565799358047792,10.151769040203023,19.248612593491792,15.115766595273888,11.444899108527286,10.25542311812325,11.272143631551847,11.025228865912052,11.472121550185054,14.105873772109792,15.186477263895316,10.188790225828633,11.076110191108933]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.5042063454148353,4.4638321037955153,4.4402980694955296,3.6781864680088376,3.7760026109996878,3.9945636895636336,4.2054348319286019,4.4742795916904852,4.3751870037153733,4.4131284416994507,4.4438711083864408,4.2729479522522853,4.0686598673999654,4.4481046861831537,4.3895549517452652,4.3922575918518163,3.8106097297502455,4.4806698235000875,4.6157729783088062,4.0068759117684536,4.2465239769248866,3.866083294295342,3.8984136228120887,4.0837258245842181,4.23454530801608,4.3105934653784468,4.4025467189008491,4.5069826696036799,3.8196380168952548,4.4162165115532188],"y":[72.950000000000003,77.510000000000005,77.530000000000001,73.244,70.319999999999993,73.680000000000007,74.010000000000005,76.109999999999999,77.129999999999995,78.640000000000001,77.340000000000003,77.869,71.040000000000006,78.950000000000003,76.122,78.819999999999993,75.444999999999993,78.030000000000001,78.319999999999993,72.75,75.969999999999999,69.719999999999999,72.231999999999999,72.709999999999994,75.129999999999995,78.769999999999996,79.390000000000001,79.370000000000005,68.834999999999994,77.218000000000004],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.229877994286745,10.546697428704579,10.69207027419818,10.242092690194333,10.546436770443769,10.299261073531106,10.698958368380151,10.356529993557636,10.346342753433595,13.997129725663797,15.593406989382412,10.712722612466624,10.695134629771783,10.014413739768555,10.24620377399202,13.919051075918333,10.043179586833944,11.060955769631471,10.296604461463678,12.634221393143591,10.689110004471065,11.535859832152113,10.7014077642968,10.363310725748443,10.133202650551199,12.716158112763512,10.603193383346538,10.486899939265056,14.299096007408364,14.009745476282177],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 72.95 <br>GDP per capita: 3193.05 <br>Pop.:     3,428,038","Country: Austria <br>Life Expectancy: 77.51 <br>GDP per capita: 29095.92 <br>Pop.:     8,069,876","Country: Belgium <br>Life Expectancy: 77.53 <br>GDP per capita: 27561.2 <br>Pop.:    10,199,787","Country: Bosnia and Herzegovina <br>Life Expectancy: 73.24 <br>GDP per capita: 4766.36 <br>Pop.:     3,607,000","Country: Bulgaria <br>Life Expectancy: 70.32 <br>GDP per capita: 5970.39 <br>Pop.:     8,066,057","Country: Croatia <br>Life Expectancy: 73.68 <br>GDP per capita: 9875.6 <br>Pop.:     4,444,595","Country: Czech Republic <br>Life Expectancy: 74.01 <br>GDP per capita: 16048.51 <br>Pop.:    10,300,707","Country: Denmark <br>Life Expectancy: 76.11 <br>GDP per capita: 29804.35 <br>Pop.:     5,283,663","Country: Finland <br>Life Expectancy: 77.13 <br>GDP per capita: 23723.95 <br>Pop.:     5,134,406","Country: France <br>Life Expectancy: 78.64 <br>GDP per capita: 25889.78 <br>Pop.:    58,623,428","Country: Germany <br>Life Expectancy: 77.34 <br>GDP per capita: 27788.88 <br>Pop.:    82,011,073","Country: Greece <br>Life Expectancy: 77.87 <br>GDP per capita: 18747.7 <br>Pop.:    10,502,372","Country: Hungary <br>Life Expectancy: 71.04 <br>GDP per capita: 11712.78 <br>Pop.:    10,244,684","Country: Iceland <br>Life Expectancy: 78.95 <br>GDP per capita: 28061.1 <br>Pop.:       271,192","Country: Ireland <br>Life Expectancy: 76.12 <br>GDP per capita: 24521.95 <br>Pop.:     3,667,233","Country: Italy <br>Life Expectancy: 78.82 <br>GDP per capita: 24675.02 <br>Pop.:    57,479,469","Country: Montenegro <br>Life Expectancy: 75.44 <br>GDP per capita: 6465.61 <br>Pop.:       692,651","Country: Netherlands <br>Life Expectancy: 78.03 <br>GDP per capita: 30246.13 <br>Pop.:    15,604,464","Country: Norway <br>Life Expectancy: 78.32 <br>GDP per capita: 41283.16 <br>Pop.:     4,405,672","Country: Poland <br>Life Expectancy: 72.75 <br>GDP per capita: 10159.58 <br>Pop.:    38,654,957","Country: Portugal <br>Life Expectancy: 75.97 <br>GDP per capita: 17641.03 <br>Pop.:    10,156,415","Country: Romania <br>Life Expectancy: 69.72 <br>GDP per capita: 7346.55 <br>Pop.:    22,562,458","Country: Serbia <br>Life Expectancy: 72.23 <br>GDP per capita: 7914.32 <br>Pop.:    10,336,594","Country: Slovak Republic <br>Life Expectancy: 72.71 <br>GDP per capita: 12126.23 <br>Pop.:     5,383,010","Country: Slovenia <br>Life Expectancy: 75.13 <br>GDP per capita: 17161.11 <br>Pop.:     2,011,612","Country: Spain <br>Life Expectancy: 78.77 <br>GDP per capita: 20445.3 <br>Pop.:    39,855,442","Country: Sweden <br>Life Expectancy: 79.39 <br>GDP per capita: 25266.59 <br>Pop.:     8,897,619","Country: Switzerland <br>Life Expectancy: 79.37 <br>GDP per capita: 32135.32 <br>Pop.:     7,193,761","Country: Turkey <br>Life Expectancy: 68.83 <br>GDP per capita: 6601.43 <br>Pop.:    63,047,647","Country: United Kingdom <br>Life Expectancy: 77.22 <br>GDP per capita: 26074.53 <br>Pop.:    58,808,266"],"frame":"1997","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.229877994286745,10.546697428704579,10.69207027419818,10.242092690194333,10.546436770443769,10.299261073531106,10.698958368380151,10.356529993557636,10.346342753433595,13.997129725663797,15.593406989382412,10.712722612466624,10.695134629771783,10.014413739768555,10.24620377399202,13.919051075918333,10.043179586833944,11.060955769631471,10.296604461463678,12.634221393143591,10.689110004471065,11.535859832152113,10.7014077642968,10.363310725748443,10.133202650551199,12.716158112763512,10.603193383346538,10.486899939265056,14.299096007408364,14.009745476282177]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.4313305726587133,4.323260636811197],"y":[78.829999999999998,77.549999999999997],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[11.263037860436063,10.246814911480183],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 78.83 <br>GDP per capita: 26997.94 <br>Pop.:    18,565,243","Country: New Zealand <br>Life Expectancy: 77.55 <br>GDP per capita: 21050.41 <br>Pop.:     3,676,187"],"frame":"1997","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[11.263037860436063,10.246814911480183]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"2002","data":[{"x":[3.7232947629701716,3.4429948647284108,3.1376319237991015,4.0415349951441693,3.0160488902182916,2.6497276032610531,3.28645904069983,2.868462576561444,3.063026151197457,3.0317362058211357,2.3823158577958554,3.5420858710743435,3.2171681955495828,3.2806377442435712,3.6771143892095659,3.8866878557609157,2.8838600873869096,2.7243197326852391,4.097663777361201,2.8199291021452937,3.0460987641022039,2.9756999238053794,2.7601997882865623,3.1097522070256196,3.1055730507326365,2.7254888612379546,3.9793060065932173,2.9516468954698474,2.8230978853605677,2.9783675985566846,3.1983875051599959,3.9552939603103834,3.5130171367645686,2.8018274697161716,3.6098424038924457,2.778928304706227,3.2082495351755087,3.8004534805050576,2.8952311959563284,3.1313274515106237,3.1817393624783286,2.8447813319512401,2.9455088721024416,3.8871076867643541,3.2995940866023554,3.6157519916666896,2.9537955406109284,2.9475418293749702,3.7576158275315175,2.9674173882915644,3.0300383536456925,2.8273942330887638],"y":[70.994,41.003,54.405999999999999,46.634,50.649999999999999,47.359999999999999,49.856000000000002,43.308,50.524999999999999,62.973999999999997,44.966000000000001,52.969999999999999,46.832000000000001,53.372999999999998,69.805999999999997,49.347999999999999,55.240000000000002,50.725000000000001,56.761000000000003,58.040999999999997,58.453000000000003,53.676000000000002,45.503999999999998,50.991999999999997,44.593000000000004,43.753,72.736999999999995,57.286000000000001,45.009,51.817999999999998,62.247,71.953999999999994,69.614999999999995,44.026000000000003,51.478999999999999,54.496000000000002,46.607999999999997,75.744,43.412999999999997,64.337000000000003,61.600000000000001,41.012,45.936,53.365000000000002,56.369,43.869,49.651000000000003,57.561,73.042000000000002,47.813000000000002,39.192999999999998,39.988999999999997],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[12.131345812135542,10.737548554293664,10.475457457958884,10.107180165134148,10.832086008868865,10.47511380403294,11.083173763790128,10.272193156697238,10.598969886834645,10.037837491674127,13.775745887233576,10.223104360409405,11.10520160505153,10.026441558923565,14.99970719077772,10.029732104985861,10.297231911422209,14.633477761387743,10.084585482590729,10.09540099170947,11.398554765936014,10.597064194428235,10.086848411272884,12.138150637640322,10.135602426526606,10.188012482733077,10.362326176020193,11.120268526164928,10.802961492214434,10.718032969974889,10.188982153304256,10.07782174540043,12.123199200626766,11.256795235008342,10.13050945486822,10.756287351059079,18.179527412111096,10.046683014047186,10.53185410446534,10.007532470887995,10.737816856892051,10.361678250157436,10.525090845046142,13.028632696810401,12.527428700370432,10.073048334354013,12.357033753887299,10.335625119137058,10.662775261514552,11.684474695814991,10.719100105850186,10.809927940856578],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 70.99 <br>GDP per capita: 5288.04 <br>Pop.:    31,287,142","Country: Angola <br>Life Expectancy: 41 <br>GDP per capita: 2773.29 <br>Pop.:    10,866,106","Country: Benin <br>Life Expectancy: 54.41 <br>GDP per capita: 1372.88 <br>Pop.:     7,026,113","Country: Botswana <br>Life Expectancy: 46.63 <br>GDP per capita: 11003.61 <br>Pop.:     1,630,347","Country: Burkina Faso <br>Life Expectancy: 50.65 <br>GDP per capita: 1037.65 <br>Pop.:    12,251,209","Country: Burundi <br>Life Expectancy: 47.36 <br>GDP per capita: 446.4 <br>Pop.:     7,021,078","Country: Cameroon <br>Life Expectancy: 49.86 <br>GDP per capita: 1934.01 <br>Pop.:    15,929,988","Country: Central African Republic <br>Life Expectancy: 43.31 <br>GDP per capita: 738.69 <br>Pop.:     4,048,013","Country: Chad <br>Life Expectancy: 50.52 <br>GDP per capita: 1156.18 <br>Pop.:     8,835,739","Country: Comoros <br>Life Expectancy: 62.97 <br>GDP per capita: 1075.81 <br>Pop.:       614,382","Country: Congo, Dem. Rep. <br>Life Expectancy: 44.97 <br>GDP per capita: 241.17 <br>Pop.:    55,379,852","Country: Congo, Rep. <br>Life Expectancy: 52.97 <br>GDP per capita: 3484.06 <br>Pop.:     3,328,795","Country: Cote d'Ivoire <br>Life Expectancy: 46.83 <br>GDP per capita: 1648.8 <br>Pop.:    16,252,726","Country: Djibouti <br>Life Expectancy: 53.37 <br>GDP per capita: 1908.26 <br>Pop.:       447,416","Country: Egypt <br>Life Expectancy: 69.81 <br>GDP per capita: 4754.6 <br>Pop.:    73,312,559","Country: Equatorial Guinea <br>Life Expectancy: 49.35 <br>GDP per capita: 7703.5 <br>Pop.:       495,627","Country: Eritrea <br>Life Expectancy: 55.24 <br>GDP per capita: 765.35 <br>Pop.:     4,414,865","Country: Ethiopia <br>Life Expectancy: 50.73 <br>GDP per capita: 530.05 <br>Pop.:    67,946,797","Country: Gabon <br>Life Expectancy: 56.76 <br>GDP per capita: 12521.71 <br>Pop.:     1,299,304","Country: Gambia <br>Life Expectancy: 58.04 <br>GDP per capita: 660.59 <br>Pop.:     1,457,766","Country: Ghana <br>Life Expectancy: 58.45 <br>GDP per capita: 1111.98 <br>Pop.:    20,550,751","Country: Guinea <br>Life Expectancy: 53.68 <br>GDP per capita: 945.58 <br>Pop.:     8,807,818","Country: Guinea-Bissau <br>Life Expectancy: 45.5 <br>GDP per capita: 575.7 <br>Pop.:     1,332,459","Country: Kenya <br>Life Expectancy: 50.99 <br>GDP per capita: 1287.51 <br>Pop.:    31,386,842","Country: Lesotho <br>Life Expectancy: 44.59 <br>GDP per capita: 1275.18 <br>Pop.:     2,046,772","Country: Liberia <br>Life Expectancy: 43.75 <br>GDP per capita: 531.48 <br>Pop.:     2,814,651","Country: Libya <br>Life Expectancy: 72.74 <br>GDP per capita: 9534.68 <br>Pop.:     5,368,585","Country: Madagascar <br>Life Expectancy: 57.29 <br>GDP per capita: 894.64 <br>Pop.:    16,473,477","Country: Malawi <br>Life Expectancy: 45.01 <br>GDP per capita: 665.42 <br>Pop.:    11,824,495","Country: Mali <br>Life Expectancy: 51.82 <br>GDP per capita: 951.41 <br>Pop.:    10,580,176","Country: Mauritania <br>Life Expectancy: 62.25 <br>GDP per capita: 1579.02 <br>Pop.:     2,828,858","Country: Mauritius <br>Life Expectancy: 71.95 <br>GDP per capita: 9021.82 <br>Pop.:     1,200,206","Country: Morocco <br>Life Expectancy: 69.61 <br>GDP per capita: 3258.5 <br>Pop.:    31,167,783","Country: Mozambique <br>Life Expectancy: 44.03 <br>GDP per capita: 633.62 <br>Pop.:    18,473,780","Country: Namibia <br>Life Expectancy: 51.48 <br>GDP per capita: 4072.32 <br>Pop.:     1,972,153","Country: Niger <br>Life Expectancy: 54.5 <br>GDP per capita: 601.07 <br>Pop.:    11,140,655","Country: Nigeria <br>Life Expectancy: 46.61 <br>GDP per capita: 1615.29 <br>Pop.:   119,901,274","Country: Reunion <br>Life Expectancy: 75.74 <br>GDP per capita: 6316.17 <br>Pop.:       743,981","Country: Rwanda <br>Life Expectancy: 43.41 <br>GDP per capita: 785.65 <br>Pop.:     7,852,401","Country: Sao Tome and Principe <br>Life Expectancy: 64.34 <br>GDP per capita: 1353.09 <br>Pop.:       170,372","Country: Senegal <br>Life Expectancy: 61.6 <br>GDP per capita: 1519.64 <br>Pop.:    10,870,037","Country: Sierra Leone <br>Life Expectancy: 41.01 <br>GDP per capita: 699.49 <br>Pop.:     5,359,092","Country: Somalia <br>Life Expectancy: 45.94 <br>GDP per capita: 882.08 <br>Pop.:     7,753,310","Country: South Africa <br>Life Expectancy: 53.37 <br>GDP per capita: 7710.95 <br>Pop.:    44,433,622","Country: Sudan <br>Life Expectancy: 56.37 <br>GDP per capita: 1993.4 <br>Pop.:    37,090,298","Country: Swaziland <br>Life Expectancy: 43.87 <br>GDP per capita: 4128.12 <br>Pop.:     1,130,269","Country: Tanzania <br>Life Expectancy: 49.65 <br>GDP per capita: 899.07 <br>Pop.:    34,593,779","Country: Togo <br>Life Expectancy: 57.56 <br>GDP per capita: 886.22 <br>Pop.:     4,977,378","Country: Tunisia <br>Life Expectancy: 73.04 <br>GDP per capita: 5722.9 <br>Pop.:     9,770,575","Country: Uganda <br>Life Expectancy: 47.81 <br>GDP per capita: 927.72 <br>Pop.:    24,739,869","Country: Zambia <br>Life Expectancy: 39.19 <br>GDP per capita: 1071.61 <br>Pop.:    10,595,811","Country: Zimbabwe <br>Life Expectancy: 39.99 <br>GDP per capita: 672.04 <br>Pop.:    11,926,563"],"frame":"2002","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[12.131345812135542,10.737548554293664,10.475457457958884,10.107180165134148,10.832086008868865,10.47511380403294,11.083173763790128,10.272193156697238,10.598969886834645,10.037837491674127,13.775745887233576,10.223104360409405,11.10520160505153,10.026441558923565,14.99970719077772,10.029732104985861,10.297231911422209,14.633477761387743,10.084585482590729,10.09540099170947,11.398554765936014,10.597064194428235,10.086848411272884,12.138150637640322,10.135602426526606,10.188012482733077,10.362326176020193,11.120268526164928,10.802961492214434,10.718032969974889,10.188982153304256,10.07782174540043,12.123199200626766,11.256795235008342,10.13050945486822,10.756287351059079,18.179527412111096,10.046683014047186,10.53185410446534,10.007532470887995,10.737816856892051,10.361678250157436,10.525090845046142,13.028632696810401,12.527428700370432,10.073048334354013,12.357033753887299,10.335625119137058,10.662775261514552,11.684474695814991,10.719100105850186,10.809927940856578]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.9443662219912961,3.5331697135430002,3.910155329325562,4.5228218281709873,4.0325697629816002,3.7600649452572528,3.887811181633416,3.8021335538653216,3.6593273799595125,3.7614049060594232,3.7284811022326649,3.6864885746444371,3.1039284966942482,3.4913236787948225,3.8447737405292188,4.0311029581144391,3.393496026186444,3.8666436059289926,3.5779137385760769,3.7715154652848497,4.2754404988947696,4.0592073636828987,4.5921445401029528,3.8880110248794315,3.9347532886881731],"y":[74.340000000000003,63.883000000000003,71.006,79.769999999999996,77.859999999999999,71.682000000000002,78.123000000000005,77.158000000000001,70.846999999999994,74.173000000000002,70.733999999999995,68.977999999999994,58.137,68.564999999999998,72.046999999999997,74.902000000000001,70.835999999999999,74.712000000000003,70.754999999999995,69.906000000000006,77.778000000000006,68.975999999999999,77.310000000000002,75.307000000000002,72.766000000000005],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[12.612118610072718,10.572309918265992,22.275591315011752,12.173330015680712,11.053624167363944,12.794839163611336,10.257649872707939,10.762180589307672,10.586314617721106,10.877817234634566,10.429561947188267,10.75888062432943,10.515149179266796,10.451651830439477,10.17777507664368,16.990467969852052,10.347191957434903,10.200040301888087,10.397538315507346,11.822998760862738,10.259333811071569,10.071107423392334,29.630625797818489,10.225444756262553,11.653610751096474],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 74.34 <br>GDP per capita: 8797.64 <br>Pop.:    38,331,121","Country: Bolivia <br>Life Expectancy: 63.88 <br>GDP per capita: 3413.26 <br>Pop.:     8,445,134","Country: Brazil <br>Life Expectancy: 71.01 <br>GDP per capita: 8131.21 <br>Pop.:   179,914,212","Country: Canada <br>Life Expectancy: 79.77 <br>GDP per capita: 33328.97 <br>Pop.:    31,902,268","Country: Chile <br>Life Expectancy: 77.86 <br>GDP per capita: 10778.78 <br>Pop.:    15,497,046","Country: Colombia <br>Life Expectancy: 71.68 <br>GDP per capita: 5755.26 <br>Pop.:    41,008,227","Country: Costa Rica <br>Life Expectancy: 78.12 <br>GDP per capita: 7723.45 <br>Pop.:     3,834,934","Country: Cuba <br>Life Expectancy: 77.16 <br>GDP per capita: 6340.65 <br>Pop.:    11,226,999","Country: Dominican Republic <br>Life Expectancy: 70.85 <br>GDP per capita: 4563.81 <br>Pop.:     8,650,322","Country: Ecuador <br>Life Expectancy: 74.17 <br>GDP per capita: 5773.04 <br>Pop.:    12,921,234","Country: El Salvador <br>Life Expectancy: 70.73 <br>GDP per capita: 5351.57 <br>Pop.:     6,353,681","Country: Guatemala <br>Life Expectancy: 68.98 <br>GDP per capita: 4858.35 <br>Pop.:    11,178,650","Country: Haiti <br>Life Expectancy: 58.14 <br>GDP per capita: 1270.36 <br>Pop.:     7,607,651","Country: Honduras <br>Life Expectancy: 68.56 <br>GDP per capita: 3099.73 <br>Pop.:     6,677,328","Country: Jamaica <br>Life Expectancy: 72.05 <br>GDP per capita: 6994.77 <br>Pop.:     2,664,659","Country: Mexico <br>Life Expectancy: 74.9 <br>GDP per capita: 10742.44 <br>Pop.:   102,479,927","Country: Nicaragua <br>Life Expectancy: 70.84 <br>GDP per capita: 2474.55 <br>Pop.:     5,146,848","Country: Panama <br>Life Expectancy: 74.71 <br>GDP per capita: 7356.03 <br>Pop.:     2,990,875","Country: Paraguay <br>Life Expectancy: 70.75 <br>GDP per capita: 3783.67 <br>Pop.:     5,884,491","Country: Peru <br>Life Expectancy: 69.91 <br>GDP per capita: 5909.02 <br>Pop.:    26,769,436","Country: Puerto Rico <br>Life Expectancy: 77.78 <br>GDP per capita: 18855.61 <br>Pop.:     3,859,606","Country: Trinidad and Tobago <br>Life Expectancy: 68.98 <br>GDP per capita: 11460.6 <br>Pop.:     1,101,832","Country: United States <br>Life Expectancy: 77.31 <br>GDP per capita: 39097.1 <br>Pop.:   287,675,526","Country: Uruguay <br>Life Expectancy: 75.31 <br>GDP per capita: 7727 <br>Pop.:     3,363,085","Country: Venezuela <br>Life Expectancy: 72.77 <br>GDP per capita: 8605.05 <br>Pop.:    24,287,670"],"frame":"2002","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[12.612118610072718,10.572309918265992,22.275591315011752,12.173330015680712,11.053624167363944,12.794839163611336,10.257649872707939,10.762180589307672,10.586314617721106,10.877817234634566,10.429561947188267,10.75888062432943,10.515149179266796,10.451651830439477,10.17777507664368,16.990467969852052,10.347191957434903,10.200040301888087,10.397538315507346,11.822998760862738,10.259333811071569,10.071107423392334,29.630625797818489,10.225444756262553,11.653610751096474]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.861375511734737,4.3692819109901562,3.0555275676981242,2.9524175462912088,3.4940544853983302,4.4801365671286479,3.2422355887477936,3.4584735972526914,3.965707783762737,3.6425354767785927,4.3405550567612554,4.4564357560925147,3.5848869910617371,3.2166298217571287,4.284069344820078,4.5454321364287775,3.9691333813441148,4.0088971761458172,3.330563786642788,2.786041210242554,3.0241597469911659,4.2961129095274355,3.3207095561615465,3.4233967966722161,4.2790858503682552,4.5565811487931027,3.4793418818977582,3.6118215526759307,4.3661505886219354,3.7718216522983541,3.2466109995218191,3.654704651592898,3.3492427100342104],"y":[42.128999999999998,74.795000000000002,62.012999999999998,56.752000000000002,72.028000000000006,81.495000000000005,62.878999999999998,68.587999999999994,69.450999999999993,57.045999999999999,79.695999999999998,82,71.263000000000005,66.662000000000006,77.045000000000002,76.903999999999996,71.028000000000006,73.043999999999997,65.033000000000001,59.908000000000001,61.340000000000003,74.192999999999998,63.609999999999999,70.302999999999997,71.626000000000005,78.769999999999996,70.814999999999998,73.052999999999997,76.989999999999995,68.563999999999993,73.016999999999996,72.370000000000005,60.308],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[11.720548870870102,10.040705142061123,19.25488886765546,10.878190783380681,97.387063309300402,10.457463438083218,80.581297490328708,24.401385222222164,14.562564859085565,11.634100354006771,10.407437596164941,18.668530704511365,10.358154893064079,11.512169688732547,13.269943139210246,10.140024471056488,10.246923638531628,11.542678786030809,10.178428599253593,13.108110533344712,11.76187688993781,10.181106028490317,20.466156953410231,15.660568979042257,11.668207340689777,10.282414932846409,11.332078514308733,11.166840083040105,11.528473559220298,14.282653924567079,15.518128965564106,10.22725298336484,11.27232122589451],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 42.13 <br>GDP per capita: 726.73 <br>Pop.:    25,268,405","Country: Bahrain <br>Life Expectancy: 74.8 <br>GDP per capita: 23403.56 <br>Pop.:       656,397","Country: Bangladesh <br>Life Expectancy: 62.01 <br>GDP per capita: 1136.39 <br>Pop.:   135,656,790","Country: Cambodia <br>Life Expectancy: 56.75 <br>GDP per capita: 896.23 <br>Pop.:    12,926,707","Country: China <br>Life Expectancy: 72.03 <br>GDP per capita: 3119.28 <br>Pop.: 1,280,400,000","Country: Hong Kong, China <br>Life Expectancy: 81.5 <br>GDP per capita: 30209.02 <br>Pop.:     6,762,476","Country: India <br>Life Expectancy: 62.88 <br>GDP per capita: 1746.77 <br>Pop.: 1,034,172,547","Country: Indonesia <br>Life Expectancy: 68.59 <br>GDP per capita: 2873.91 <br>Pop.:   211,060,000","Country: Iran <br>Life Expectancy: 69.45 <br>GDP per capita: 9240.76 <br>Pop.:    66,907,826","Country: Iraq <br>Life Expectancy: 57.05 <br>GDP per capita: 4390.72 <br>Pop.:    24,001,816","Country: Israel <br>Life Expectancy: 79.7 <br>GDP per capita: 21905.6 <br>Pop.:     6,029,529","Country: Japan <br>Life Expectancy: 82 <br>GDP per capita: 28604.59 <br>Pop.:   127,065,841","Country: Jordan <br>Life Expectancy: 71.26 <br>GDP per capita: 3844.92 <br>Pop.:     5,307,470","Country: Korea, Dem. Rep. <br>Life Expectancy: 66.66 <br>GDP per capita: 1646.76 <br>Pop.:    22,215,365","Country: Korea, Rep. <br>Life Expectancy: 77.04 <br>GDP per capita: 19233.99 <br>Pop.:    47,969,150","Country: Kuwait <br>Life Expectancy: 76.9 <br>GDP per capita: 35110.11 <br>Pop.:     2,111,561","Country: Lebanon <br>Life Expectancy: 71.03 <br>GDP per capita: 9313.94 <br>Pop.:     3,677,780","Country: Malaysia <br>Life Expectancy: 73.04 <br>GDP per capita: 10206.98 <br>Pop.:    22,662,365","Country: Mongolia <br>Life Expectancy: 65.03 <br>GDP per capita: 2140.74 <br>Pop.:     2,674,234","Country: Myanmar <br>Life Expectancy: 59.91 <br>GDP per capita: 611 <br>Pop.:    45,598,081","Country: Nepal <br>Life Expectancy: 61.34 <br>GDP per capita: 1057.21 <br>Pop.:    25,873,917","Country: Oman <br>Life Expectancy: 74.19 <br>GDP per capita: 19774.84 <br>Pop.:     2,713,462","Country: Pakistan <br>Life Expectancy: 63.61 <br>GDP per capita: 2092.71 <br>Pop.:   153,403,524","Country: Philippines <br>Life Expectancy: 70.3 <br>GDP per capita: 2650.92 <br>Pop.:    82,995,088","Country: Saudi Arabia <br>Life Expectancy: 71.63 <br>GDP per capita: 19014.54 <br>Pop.:    24,501,530","Country: Singapore <br>Life Expectancy: 78.77 <br>GDP per capita: 36023.11 <br>Pop.:     4,197,776","Country: Sri Lanka <br>Life Expectancy: 70.82 <br>GDP per capita: 3015.38 <br>Pop.:    19,576,783","Country: Syria <br>Life Expectancy: 73.05 <br>GDP per capita: 4090.93 <br>Pop.:    17,155,814","Country: Taiwan <br>Life Expectancy: 76.99 <br>GDP per capita: 23235.42 <br>Pop.:    22,454,239","Country: Thailand <br>Life Expectancy: 68.56 <br>GDP per capita: 5913.19 <br>Pop.:    62,806,748","Country: Vietnam <br>Life Expectancy: 73.02 <br>GDP per capita: 1764.46 <br>Pop.:    80,908,147","Country: West Bank and Gaza <br>Life Expectancy: 72.37 <br>GDP per capita: 4515.49 <br>Pop.:     3,389,578","Country: Yemen, Rep. <br>Life Expectancy: 60.31 <br>GDP per capita: 2234.82 <br>Pop.:    18,701,257"],"frame":"2002","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[11.720548870870102,10.040705142061123,19.25488886765546,10.878190783380681,97.387063309300402,10.457463438083218,80.581297490328708,24.401385222222164,14.562564859085565,11.634100354006771,10.407437596164941,18.668530704511365,10.358154893064079,11.512169688732547,13.269943139210246,10.140024471056488,10.246923638531628,11.542678786030809,10.178428599253593,13.108110533344712,11.76187688993781,10.181106028490317,20.466156953410231,15.660568979042257,11.668207340689777,10.282414932846409,11.332078514308733,11.166840083040105,11.528473559220298,14.282653924567079,15.518128965564106,10.22725298336484,11.27232122589451]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.6631552876111546,4.5107809622284991,4.4840987892278834,3.7795225567177479,3.8863089447639965,4.0655195497593537,4.2454191418045202,4.5074038091979114,4.4503197997011812,4.4612888674186006,4.4776392324491363,4.3524575768106599,4.1715490603360585,4.4936420742289096,4.5324619837144677,4.4466629353612905,3.8167180514948735,4.5279488391389853,4.6501518025890993,4.0792622734957824,4.3003978081841314,3.8968215299567097,3.8595030746228405,4.1347754721585934,4.3151307241505537,4.3950724122632021,4.4674842500735137,4.53757931986706,3.8134532643953132,4.4695127351694275],"y":[75.650999999999996,78.980000000000004,78.319999999999993,74.090000000000003,72.140000000000001,74.876000000000005,75.510000000000005,77.180000000000007,78.370000000000005,79.590000000000003,78.670000000000002,78.256,72.590000000000003,80.5,77.783000000000001,80.239999999999995,73.980999999999995,78.530000000000001,79.049999999999997,74.670000000000002,77.290000000000006,71.322000000000003,73.212999999999994,73.799999999999997,76.659999999999997,79.780000000000001,80.040000000000006,80.620000000000005,70.844999999999999,78.471000000000004],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.235370587342629,10.552050922117749,10.699727102077846,10.280206265310454,10.518844943473745,10.301747189569337,10.695927115518382,10.362743065430255,10.350344632408737,14.085968326574534,15.616585576461375,10.719649679119641,10.684120572635052,10.015562984019803,10.260668089244016,13.949596347314062,10.045061936709534,11.096335811533287,10.305471824801247,12.632243352542247,10.708046939736384,11.525067597311175,10.686048447271041,10.365156423755465,10.133194801454579,12.73643437692432,10.607053500811416,10.49836617262013,14.589941279543122,14.085108065584944],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 75.65 <br>GDP per capita: 4604.21 <br>Pop.:     3,508,512","Country: Austria <br>Life Expectancy: 78.98 <br>GDP per capita: 32417.61 <br>Pop.:     8,148,312","Country: Belgium <br>Life Expectancy: 78.32 <br>GDP per capita: 30485.88 <br>Pop.:    10,311,970","Country: Bosnia and Herzegovina <br>Life Expectancy: 74.09 <br>GDP per capita: 6018.98 <br>Pop.:     4,165,416","Country: Bulgaria <br>Life Expectancy: 72.14 <br>GDP per capita: 7696.78 <br>Pop.:     7,661,799","Country: Croatia <br>Life Expectancy: 74.88 <br>GDP per capita: 11628.39 <br>Pop.:     4,481,020","Country: Czech Republic <br>Life Expectancy: 75.51 <br>GDP per capita: 17596.21 <br>Pop.:    10,256,295","Country: Denmark <br>Life Expectancy: 77.18 <br>GDP per capita: 32166.5 <br>Pop.:     5,374,693","Country: Finland <br>Life Expectancy: 78.37 <br>GDP per capita: 28204.59 <br>Pop.:     5,193,039","Country: France <br>Life Expectancy: 79.59 <br>GDP per capita: 28926.03 <br>Pop.:    59,925,035","Country: Germany <br>Life Expectancy: 78.67 <br>GDP per capita: 30035.8 <br>Pop.:    82,350,671","Country: Greece <br>Life Expectancy: 78.26 <br>GDP per capita: 22514.25 <br>Pop.:    10,603,863","Country: Hungary <br>Life Expectancy: 72.59 <br>GDP per capita: 14843.94 <br>Pop.:    10,083,313","Country: Iceland <br>Life Expectancy: 80.5 <br>GDP per capita: 31163.2 <br>Pop.:       288,030","Country: Ireland <br>Life Expectancy: 77.78 <br>GDP per capita: 34077.05 <br>Pop.:     3,879,155","Country: Italy <br>Life Expectancy: 80.24 <br>GDP per capita: 27968.1 <br>Pop.:    57,926,999","Country: Montenegro <br>Life Expectancy: 73.98 <br>GDP per capita: 6557.19 <br>Pop.:       720,230","Country: Netherlands <br>Life Expectancy: 78.53 <br>GDP per capita: 33724.76 <br>Pop.:    16,122,830","Country: Norway <br>Life Expectancy: 79.05 <br>GDP per capita: 44683.98 <br>Pop.:     4,535,591","Country: Poland <br>Life Expectancy: 74.67 <br>GDP per capita: 12002.24 <br>Pop.:    38,625,976","Country: Portugal <br>Life Expectancy: 77.29 <br>GDP per capita: 19970.91 <br>Pop.:    10,433,867","Country: Romania <br>Life Expectancy: 71.32 <br>GDP per capita: 7885.36 <br>Pop.:    22,404,337","Country: Serbia <br>Life Expectancy: 73.21 <br>GDP per capita: 7236.08 <br>Pop.:    10,111,559","Country: Slovak Republic <br>Life Expectancy: 73.8 <br>GDP per capita: 13638.78 <br>Pop.:     5,410,052","Country: Slovenia <br>Life Expectancy: 76.66 <br>GDP per capita: 20660.02 <br>Pop.:     2,011,497","Country: Spain <br>Life Expectancy: 79.78 <br>GDP per capita: 24835.47 <br>Pop.:    40,152,517","Country: Sweden <br>Life Expectancy: 80.04 <br>GDP per capita: 29341.63 <br>Pop.:     8,954,175","Country: Switzerland <br>Life Expectancy: 80.62 <br>GDP per capita: 34480.96 <br>Pop.:     7,361,757","Country: Turkey <br>Life Expectancy: 70.84 <br>GDP per capita: 6508.09 <br>Pop.:    67,308,928","Country: United Kingdom <br>Life Expectancy: 78.47 <br>GDP per capita: 29479 <br>Pop.:    59,912,431"],"frame":"2002","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.235370587342629,10.552050922117749,10.699727102077846,10.280206265310454,10.518844943473745,10.301747189569337,10.695927115518382,10.362743065430255,10.350344632408737,14.085968326574534,15.616585576461375,10.719649679119641,10.684120572635052,10.015562984019803,10.260668089244016,13.949596347314062,10.045061936709534,11.096335811533287,10.305471824801247,12.632243352542247,10.708046939736384,11.525067597311175,10.686048447271041,10.365156423755465,10.133194801454579,12.73643437692432,10.607053500811416,10.49836617262013,14.589941279543122,14.085108065584944]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.4869651144323957,4.3652970283719954],"y":[80.370000000000005,79.109999999999999],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[11.330031538163158,10.262639372796965],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 80.37 <br>GDP per capita: 30687.75 <br>Pop.:    19,546,792","Country: New Zealand <br>Life Expectancy: 79.11 <br>GDP per capita: 23189.8 <br>Pop.:     3,908,037"],"frame":"2002","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[11.330031538163158,10.262639372796965]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]},{"name":"2007","data":[{"x":[3.7940254450966644,3.6809906556268164,3.1587498285200959,4.0993301562976825,3.0853023521971163,2.6335398473202094,3.3100759930113757,2.8488148736349985,3.2314858313133699,2.9939420450679588,2.443344140046372,3.5602125331291146,3.1888582353745463,3.3185811659560813,3.7467261069384517,4.0847224390037145,2.8071083194109296,2.8393558343569567,4.120787226641542,2.8766506063906259,3.1230701584328973,2.9743524119826992,2.7628523540039867,3.1653183196828425,3.195714676047237,2.6175322269121151,4.0812572446605149,3.0190207459573766,2.8804419458658828,3.0181100381010961,3.2560322165243099,4.0396913096789095,3.5820832842930348,2.9157614843495785,3.6822408118633683,2.7921653017164396,3.3040545722906871,3.884802303432406,2.9360553118387509,3.2036950046605677,3.2336235137236495,2.9357796251727324,2.9666771427490164,3.9670637023386344,3.4153732150271123,3.6545115842375888,3.0443367476975203,2.9459459204926648,3.8508252467512323,3.0238202200422353,3.1042178448294138,2.6718291573166399],"y":[72.301000000000002,42.731000000000002,56.728000000000002,50.728000000000002,52.295000000000002,49.579999999999998,50.43,44.741,50.651000000000003,65.152000000000001,46.462000000000003,55.322000000000003,48.328000000000003,54.790999999999997,71.337999999999994,51.579000000000001,58.039999999999999,52.947000000000003,56.734999999999999,59.448,60.021999999999998,56.006999999999998,46.387999999999998,54.109999999999999,42.591999999999999,45.677999999999997,73.951999999999998,59.442999999999998,48.302999999999997,54.466999999999999,64.164000000000001,72.801000000000002,71.164000000000001,42.082000000000001,52.905999999999999,56.866999999999997,46.859000000000002,76.441999999999993,46.241999999999997,65.528000000000006,63.061999999999998,42.567999999999998,48.158999999999999,49.338999999999999,58.555999999999997,39.613,52.517000000000003,58.420000000000002,73.923000000000002,51.542000000000002,42.384,43.487000000000002],"mode":"markers","marker":{"color":"rgba(127,59,8,1)","size":[12.270996529686874,10.843638991804848,10.547273347637471,10.107779699609916,10.973710603587682,10.568581324359265,11.203729403842495,10.294104080545504,10.694733506807975,10.044429231268918,14.405510100712366,10.255307156252311,11.22537352665868,10.029783089987387,15.474201052683679,10.033525197990903,10.33079328351058,15.218070969840483,10.095203126221623,10.111139658987542,11.557078329172434,10.674872357478861,10.096375303485605,12.42640598090242,10.133273428926811,10.213900236700315,10.407941644673997,11.304154226907077,10.905517379137951,10.817110342035306,10.219095860891894,10.08128053514246,12.299933009287487,11.357664726459722,10.136169472567667,10.876017470906024,19.212188007462345,10.050376389398643,10.600665905981769,10.009525936670522,10.833197440950308,10.415288945134765,10.618287810424615,12.998888442788031,12.88252394731888,10.073239238034423,12.599049454681737,10.385054020194103,10.697282825137252,11.986871654078467,10.797606360728926,10.836176685015339],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Algeria <br>Life Expectancy: 72.3 <br>GDP per capita: 6223.37 <br>Pop.:    33,333,216","Country: Angola <br>Life Expectancy: 42.73 <br>GDP per capita: 4797.23 <br>Pop.:    12,420,476","Country: Benin <br>Life Expectancy: 56.73 <br>GDP per capita: 1441.28 <br>Pop.:     8,078,314","Country: Botswana <br>Life Expectancy: 50.73 <br>GDP per capita: 12569.85 <br>Pop.:     1,639,131","Country: Burkina Faso <br>Life Expectancy: 52.3 <br>GDP per capita: 1217.03 <br>Pop.:    14,326,203","Country: Burundi <br>Life Expectancy: 49.58 <br>GDP per capita: 430.07 <br>Pop.:     8,390,505","Country: Cameroon <br>Life Expectancy: 50.43 <br>GDP per capita: 2042.1 <br>Pop.:    17,696,293","Country: Central African Republic <br>Life Expectancy: 44.74 <br>GDP per capita: 706.02 <br>Pop.:     4,369,038","Country: Chad <br>Life Expectancy: 50.65 <br>GDP per capita: 1704.06 <br>Pop.:    10,238,807","Country: Comoros <br>Life Expectancy: 65.15 <br>GDP per capita: 986.15 <br>Pop.:       710,960","Country: Congo, Dem. Rep. <br>Life Expectancy: 46.46 <br>GDP per capita: 277.55 <br>Pop.:    64,606,759","Country: Congo, Rep. <br>Life Expectancy: 55.32 <br>GDP per capita: 3632.56 <br>Pop.:     3,800,610","Country: Cote d'Ivoire <br>Life Expectancy: 48.33 <br>GDP per capita: 1544.75 <br>Pop.:    18,013,409","Country: Djibouti <br>Life Expectancy: 54.79 <br>GDP per capita: 2082.48 <br>Pop.:       496,374","Country: Egypt <br>Life Expectancy: 71.34 <br>GDP per capita: 5581.18 <br>Pop.:    80,264,543","Country: Equatorial Guinea <br>Life Expectancy: 51.58 <br>GDP per capita: 12154.09 <br>Pop.:       551,201","Country: Eritrea <br>Life Expectancy: 58.04 <br>GDP per capita: 641.37 <br>Pop.:     4,906,585","Country: Ethiopia <br>Life Expectancy: 52.95 <br>GDP per capita: 690.81 <br>Pop.:    76,511,887","Country: Gabon <br>Life Expectancy: 56.74 <br>GDP per capita: 13206.48 <br>Pop.:     1,454,867","Country: Gambia <br>Life Expectancy: 59.45 <br>GDP per capita: 752.75 <br>Pop.:     1,688,359","Country: Ghana <br>Life Expectancy: 60.02 <br>GDP per capita: 1327.61 <br>Pop.:    22,873,338","Country: Guinea <br>Life Expectancy: 56.01 <br>GDP per capita: 942.65 <br>Pop.:     9,947,814","Country: Guinea-Bissau <br>Life Expectancy: 46.39 <br>GDP per capita: 579.23 <br>Pop.:     1,472,041","Country: Kenya <br>Life Expectancy: 54.11 <br>GDP per capita: 1463.25 <br>Pop.:    35,610,177","Country: Lesotho <br>Life Expectancy: 42.59 <br>GDP per capita: 1569.33 <br>Pop.:     2,012,649","Country: Liberia <br>Life Expectancy: 45.68 <br>GDP per capita: 414.51 <br>Pop.:     3,193,942","Country: Libya <br>Life Expectancy: 73.95 <br>GDP per capita: 12057.5 <br>Pop.:     6,036,914","Country: Madagascar <br>Life Expectancy: 59.44 <br>GDP per capita: 1044.77 <br>Pop.:    19,167,654","Country: Malawi <br>Life Expectancy: 48.3 <br>GDP per capita: 759.35 <br>Pop.:    13,327,079","Country: Mali <br>Life Expectancy: 54.47 <br>GDP per capita: 1042.58 <br>Pop.:    12,031,795","Country: Mauritania <br>Life Expectancy: 64.16 <br>GDP per capita: 1803.15 <br>Pop.:     3,270,065","Country: Mauritius <br>Life Expectancy: 72.8 <br>GDP per capita: 10956.99 <br>Pop.:     1,250,882","Country: Morocco <br>Life Expectancy: 71.16 <br>GDP per capita: 3820.18 <br>Pop.:    33,757,175","Country: Mozambique <br>Life Expectancy: 42.08 <br>GDP per capita: 823.69 <br>Pop.:    19,951,656","Country: Namibia <br>Life Expectancy: 52.91 <br>GDP per capita: 4811.06 <br>Pop.:     2,055,080","Country: Niger <br>Life Expectancy: 56.87 <br>GDP per capita: 619.68 <br>Pop.:    12,894,865","Country: Nigeria <br>Life Expectancy: 46.86 <br>GDP per capita: 2013.98 <br>Pop.:   135,031,164","Country: Reunion <br>Life Expectancy: 76.44 <br>GDP per capita: 7670.12 <br>Pop.:       798,094","Country: Rwanda <br>Life Expectancy: 46.24 <br>GDP per capita: 863.09 <br>Pop.:     8,860,588","Country: Sao Tome and Principe <br>Life Expectancy: 65.53 <br>GDP per capita: 1598.44 <br>Pop.:       199,579","Country: Senegal <br>Life Expectancy: 63.06 <br>GDP per capita: 1712.47 <br>Pop.:    12,267,493","Country: Sierra Leone <br>Life Expectancy: 42.57 <br>GDP per capita: 862.54 <br>Pop.:     6,144,562","Country: Somalia <br>Life Expectancy: 48.16 <br>GDP per capita: 926.14 <br>Pop.:     9,118,773","Country: South Africa <br>Life Expectancy: 49.34 <br>GDP per capita: 9269.66 <br>Pop.:    43,997,828","Country: Sudan <br>Life Expectancy: 58.56 <br>GDP per capita: 2602.39 <br>Pop.:    42,292,929","Country: Swaziland <br>Life Expectancy: 39.61 <br>GDP per capita: 4513.48 <br>Pop.:     1,133,066","Country: Tanzania <br>Life Expectancy: 52.52 <br>GDP per capita: 1107.48 <br>Pop.:    38,139,640","Country: Togo <br>Life Expectancy: 58.42 <br>GDP per capita: 882.97 <br>Pop.:     5,701,579","Country: Tunisia <br>Life Expectancy: 73.92 <br>GDP per capita: 7092.92 <br>Pop.:    10,276,158","Country: Uganda <br>Life Expectancy: 51.54 <br>GDP per capita: 1056.38 <br>Pop.:    29,170,398","Country: Zambia <br>Life Expectancy: 42.38 <br>GDP per capita: 1271.21 <br>Pop.:    11,746,035","Country: Zimbabwe <br>Life Expectancy: 43.49 <br>GDP per capita: 469.71 <br>Pop.:    12,311,143"],"frame":"2007","type":"scatter","name":"Africa","textfont":{"color":"rgba(127,59,8,1)","size":[12.270996529686874,10.843638991804848,10.547273347637471,10.107779699609916,10.973710603587682,10.568581324359265,11.203729403842495,10.294104080545504,10.694733506807975,10.044429231268918,14.405510100712366,10.255307156252311,11.22537352665868,10.029783089987387,15.474201052683679,10.033525197990903,10.33079328351058,15.218070969840483,10.095203126221623,10.111139658987542,11.557078329172434,10.674872357478861,10.096375303485605,12.42640598090242,10.133273428926811,10.213900236700315,10.407941644673997,11.304154226907077,10.905517379137951,10.817110342035306,10.219095860891894,10.08128053514246,12.299933009287487,11.357664726459722,10.136169472567667,10.876017470906024,19.212188007462345,10.050376389398643,10.600665905981769,10.009525936670522,10.833197440950308,10.415288945134765,10.618287810424615,12.998888442788031,12.88252394731888,10.073239238034423,12.599049454681737,10.385054020194103,10.697282825137252,11.986871654078467,10.797606360728926,10.836176685015339]},"error_y":{"color":"rgba(127,59,8,1)","width":[]},"error_x":{"color":"rgba(127,59,8,1)","width":[]},"line":{"color":"rgba(127,59,8,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.1065097720176862,3.5823062593168782,3.957406173408569,4.5601366924251883,4.1196398143870931,3.8455061110473117,3.9843049975871763,3.9517309708016475,3.7799840633073747,3.8371629195761865,3.7580298117512663,3.7148366998460376,3.0797733480287044,3.550024106620056,3.8645633037284566,4.0783688975107708,3.4392254438054342,3.991632953509189,3.6204315729333021,3.8697540590018766,4.2862028478952521,4.2554777630339444,4.6329798832790043,4.0257752637018411,4.0575065679833457],"y":[75.319999999999993,65.554000000000002,72.390000000000001,80.653000000000006,78.552999999999997,72.888999999999996,78.781999999999996,78.272999999999996,72.234999999999999,74.994,71.878,70.259,60.915999999999997,70.197999999999993,72.566999999999993,76.194999999999993,72.899000000000001,75.537000000000006,71.751999999999995,71.421000000000006,78.745999999999995,69.819000000000003,78.242000000000004,76.384,73.747],"mode":"markers","marker":{"color":"rgba(165,0,38,1)","size":[12.746632059759518,10.618313678316955,22.96470343532625,12.274881832513952,11.107386725297623,13.014567661690831,10.278054111270166,10.775147842948616,10.631996360051591,10.934770689229971,10.469558691216148,10.854044300308908,10.576246752118708,10.506693449857204,10.185656456939702,17.415067513397887,10.383264221405618,10.217192147822894,10.450956946503027,11.953042661921849,10.264990962144426,10.068020749083123,30.549613114046156,10.231206061434909,11.776260871392221],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Argentina <br>Life Expectancy: 75.32 <br>GDP per capita: 12779.38 <br>Pop.:    40,301,927","Country: Bolivia <br>Life Expectancy: 65.55 <br>GDP per capita: 3822.14 <br>Pop.:     9,119,152","Country: Brazil <br>Life Expectancy: 72.39 <br>GDP per capita: 9065.8 <br>Pop.:   190,010,647","Country: Canada <br>Life Expectancy: 80.65 <br>GDP per capita: 36319.24 <br>Pop.:    33,390,141","Country: Chile <br>Life Expectancy: 78.55 <br>GDP per capita: 13171.64 <br>Pop.:    16,284,741","Country: Colombia <br>Life Expectancy: 72.89 <br>GDP per capita: 7006.58 <br>Pop.:    44,227,550","Country: Costa Rica <br>Life Expectancy: 78.78 <br>GDP per capita: 9645.06 <br>Pop.:     4,133,884","Country: Cuba <br>Life Expectancy: 78.27 <br>GDP per capita: 8948.1 <br>Pop.:    11,416,987","Country: Dominican Republic <br>Life Expectancy: 72.24 <br>GDP per capita: 6025.37 <br>Pop.:     9,319,622","Country: Ecuador <br>Life Expectancy: 74.99 <br>GDP per capita: 6873.26 <br>Pop.:    13,755,680","Country: El Salvador <br>Life Expectancy: 71.88 <br>GDP per capita: 5728.35 <br>Pop.:     6,939,688","Country: Guatemala <br>Life Expectancy: 70.26 <br>GDP per capita: 5186.05 <br>Pop.:    12,572,928","Country: Haiti <br>Life Expectancy: 60.92 <br>GDP per capita: 1201.64 <br>Pop.:     8,502,814","Country: Honduras <br>Life Expectancy: 70.2 <br>GDP per capita: 3548.33 <br>Pop.:     7,483,763","Country: Jamaica <br>Life Expectancy: 72.57 <br>GDP per capita: 7320.88 <br>Pop.:     2,780,132","Country: Mexico <br>Life Expectancy: 76.19 <br>GDP per capita: 11977.57 <br>Pop.:   108,700,891","Country: Nicaragua <br>Life Expectancy: 72.9 <br>GDP per capita: 2749.32 <br>Pop.:     5,675,356","Country: Panama <br>Life Expectancy: 75.54 <br>GDP per capita: 9809.19 <br>Pop.:     3,242,173","Country: Paraguay <br>Life Expectancy: 71.75 <br>GDP per capita: 4172.84 <br>Pop.:     6,667,147","Country: Peru <br>Life Expectancy: 71.42 <br>GDP per capita: 7408.91 <br>Pop.:    28,674,757","Country: Puerto Rico <br>Life Expectancy: 78.75 <br>GDP per capita: 19328.71 <br>Pop.:     3,942,491","Country: Trinidad and Tobago <br>Life Expectancy: 69.82 <br>GDP per capita: 18008.51 <br>Pop.:     1,056,608","Country: United States <br>Life Expectancy: 78.24 <br>GDP per capita: 42951.65 <br>Pop.:   301,139,947","Country: Uruguay <br>Life Expectancy: 76.38 <br>GDP per capita: 10611.46 <br>Pop.:     3,447,496","Country: Venezuela <br>Life Expectancy: 73.75 <br>GDP per capita: 11415.81 <br>Pop.:    26,084,662"],"frame":"2007","type":"scatter","name":"Americas","textfont":{"color":"rgba(165,0,38,1)","size":[12.746632059759518,10.618313678316955,22.96470343532625,12.274881832513952,11.107386725297623,13.014567661690831,10.278054111270166,10.775147842948616,10.631996360051591,10.934770689229971,10.469558691216148,10.854044300308908,10.576246752118708,10.506693449857204,10.185656456939702,17.415067513397887,10.383264221405618,10.217192147822894,10.450956946503027,11.953042661921849,10.264990962144426,10.068020749083123,30.549613114046156,10.231206061434909,11.776260871392221]},"error_y":{"color":"rgba(165,0,38,1)","width":[]},"error_x":{"color":"rgba(165,0,38,1)","width":[]},"line":{"color":"rgba(165,0,38,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[2.9888176454912858,4.4741586701859664,3.1434063610570009,3.2339547372751722,3.6954041667466049,4.5990636726886356,3.3895577312128795,3.5490831898821575,4.0646718823630357,3.6504106831196688,4.406936435530084,4.5004569709846161,3.6550866594992835,3.2022336270366805,4.3682522837381041,4.6749253140699576,4.0195756382230385,4.095227107013149,3.4907690059237622,2.9749719942980688,3.0379679438446519,4.3486201061894318,3.4159656754035375,3.5038561648270914,4.3355548175826542,4.6734188707962172,3.5988009435983197,3.6216485631534296,4.4581583777244909,3.8726454573379581,3.3876703191654678,3.4807755960325997,3.3580814739680283],"y":[43.828000000000003,75.635000000000005,64.061999999999998,59.722999999999999,72.960999999999999,82.207999999999998,64.697999999999993,70.650000000000006,70.963999999999999,59.545000000000002,80.745000000000005,82.602999999999994,72.534999999999997,67.296999999999997,78.623000000000005,77.587999999999994,71.992999999999995,74.241,66.802999999999997,62.069000000000003,63.784999999999997,75.640000000000001,65.483000000000004,71.688000000000002,72.777000000000001,79.971999999999994,72.396000000000001,74.143000000000001,78.400000000000006,70.616,74.248999999999995,73.421999999999997,62.698],"mode":"markers","marker":{"color":"rgba(64,0,75,1)","size":[12.172487432221772,10.044266311324286,20.26445666996646,10.960445971564345,100,10.472338226961952,85.783800493679365,25.253660609164903,14.736319560187283,11.872837248257337,10.434544280710814,18.69597735732042,10.40905273549037,11.586317033119437,13.343358811286093,10.166916022101949,10.263543110956533,11.690031651463162,10.192071898999099,13.255803162281207,11.96853834846976,10.214647948469672,21.549133875507721,16.212203421268025,11.87975810388607,10.306660655800668,11.386780301969308,11.314193767508629,11.577619483280925,14.437001358883384,15.815316853792227,10.270167338986031,11.511922476315512],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Afghanistan <br>Life Expectancy: 43.83 <br>GDP per capita: 974.58 <br>Pop.:    31,889,923","Country: Bahrain <br>Life Expectancy: 75.64 <br>GDP per capita: 29796.05 <br>Pop.:       708,573","Country: Bangladesh <br>Life Expectancy: 64.06 <br>GDP per capita: 1391.25 <br>Pop.:   150,448,339","Country: Cambodia <br>Life Expectancy: 59.72 <br>GDP per capita: 1713.78 <br>Pop.:    14,131,858","Country: China <br>Life Expectancy: 72.96 <br>GDP per capita: 4959.11 <br>Pop.: 1,318,683,096","Country: Hong Kong, China <br>Life Expectancy: 82.21 <br>GDP per capita: 39724.98 <br>Pop.:     6,980,412","Country: India <br>Life Expectancy: 64.7 <br>GDP per capita: 2452.21 <br>Pop.: 1,110,396,331","Country: Indonesia <br>Life Expectancy: 70.65 <br>GDP per capita: 3540.65 <br>Pop.:   223,547,000","Country: Iran <br>Life Expectancy: 70.96 <br>GDP per capita: 11605.71 <br>Pop.:    69,453,570","Country: Iraq <br>Life Expectancy: 59.55 <br>GDP per capita: 4471.06 <br>Pop.:    27,499,638","Country: Israel <br>Life Expectancy: 80.75 <br>GDP per capita: 25523.28 <br>Pop.:     6,426,679","Country: Japan <br>Life Expectancy: 82.6 <br>GDP per capita: 31656.07 <br>Pop.:   127,467,972","Country: Jordan <br>Life Expectancy: 72.53 <br>GDP per capita: 4519.46 <br>Pop.:     6,053,193","Country: Korea, Dem. Rep. <br>Life Expectancy: 67.3 <br>GDP per capita: 1593.07 <br>Pop.:    23,301,725","Country: Korea, Rep. <br>Life Expectancy: 78.62 <br>GDP per capita: 23348.14 <br>Pop.:    49,044,790","Country: Kuwait <br>Life Expectancy: 77.59 <br>GDP per capita: 47306.99 <br>Pop.:     2,505,559","Country: Lebanon <br>Life Expectancy: 71.99 <br>GDP per capita: 10461.06 <br>Pop.:     3,921,278","Country: Malaysia <br>Life Expectancy: 74.24 <br>GDP per capita: 12451.66 <br>Pop.:    24,821,286","Country: Mongolia <br>Life Expectancy: 66.8 <br>GDP per capita: 3095.77 <br>Pop.:     2,874,127","Country: Myanmar <br>Life Expectancy: 62.07 <br>GDP per capita: 944 <br>Pop.:    47,761,980","Country: Nepal <br>Life Expectancy: 63.78 <br>GDP per capita: 1091.36 <br>Pop.:    28,901,790","Country: Oman <br>Life Expectancy: 75.64 <br>GDP per capita: 22316.19 <br>Pop.:     3,204,897","Country: Pakistan <br>Life Expectancy: 65.48 <br>GDP per capita: 2605.95 <br>Pop.:   169,270,617","Country: Philippines <br>Life Expectancy: 71.69 <br>GDP per capita: 3190.48 <br>Pop.:    91,077,287","Country: Saudi Arabia <br>Life Expectancy: 72.78 <br>GDP per capita: 21654.83 <br>Pop.:    27,601,038","Country: Singapore <br>Life Expectancy: 79.97 <br>GDP per capita: 47143.18 <br>Pop.:     4,553,009","Country: Sri Lanka <br>Life Expectancy: 72.4 <br>GDP per capita: 3970.1 <br>Pop.:    20,378,239","Country: Syria <br>Life Expectancy: 74.14 <br>GDP per capita: 4184.55 <br>Pop.:    19,314,747","Country: Taiwan <br>Life Expectancy: 78.4 <br>GDP per capita: 28718.28 <br>Pop.:    23,174,294","Country: Thailand <br>Life Expectancy: 70.62 <br>GDP per capita: 7458.4 <br>Pop.:    65,068,149","Country: Vietnam <br>Life Expectancy: 74.25 <br>GDP per capita: 2441.58 <br>Pop.:    85,262,356","Country: West Bank and Gaza <br>Life Expectancy: 73.42 <br>GDP per capita: 3025.35 <br>Pop.:     4,018,332","Country: Yemen, Rep. <br>Life Expectancy: 62.7 <br>GDP per capita: 2280.77 <br>Pop.:    22,211,743"],"frame":"2007","type":"scatter","name":"Asia","textfont":{"color":"rgba(64,0,75,1)","size":[12.172487432221772,10.044266311324286,20.26445666996646,10.960445971564345,100,10.472338226961952,85.783800493679365,25.253660609164903,14.736319560187283,11.872837248257337,10.434544280710814,18.69597735732042,10.40905273549037,11.586317033119437,13.343358811286093,10.166916022101949,10.263543110956533,11.690031651463162,10.192071898999099,13.255803162281207,11.96853834846976,10.214647948469672,21.549133875507721,16.212203421268025,11.87975810388607,10.306660655800668,11.386780301969308,11.314193767508629,11.577619483280925,14.437001358883384,15.815316853792227,10.270167338986031,11.511922476315512]},"error_y":{"color":"rgba(64,0,75,1)","width":[]},"error_x":{"color":"rgba(64,0,75,1)","width":[]},"line":{"color":"rgba(64,0,75,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[3.7735692087621691,4.5578258006221848,4.5275345915133105,3.8719404594797928,4.0286034909483179,4.1649242825131747,4.3585688446278343,4.5475091108168488,4.5212307459814749,4.4838726922507623,4.5074561155365247,4.4399388911990529,4.2554882582210949,4.5584780356339154,4.6093381996914395,4.4559059795027833,3.9663246195778949,4.5658234281049346,4.6933504280025318,4.1872364943512697,4.3119582019159575,4.0337644468812863,3.9906289409349966,4.271337680163577,4.4110850532178922,4.4597100052953031,4.5296837260525233,4.574105601810623,3.927281872119107,4.5211807429313629],"y":[76.423000000000002,79.828999999999994,79.441000000000003,74.852000000000004,73.004999999999995,75.748000000000005,76.486000000000004,78.331999999999994,79.313000000000002,80.656999999999996,79.406000000000006,79.483000000000004,73.337999999999994,81.757000000000005,78.885000000000005,80.546000000000006,74.543000000000006,79.762,80.195999999999998,75.563000000000002,78.097999999999999,72.475999999999999,74.001999999999995,74.662999999999997,77.926000000000002,80.941000000000003,80.884,81.700999999999993,71.777000000000001,79.424999999999997],"mode":"markers","marker":{"color":"rgba(39,100,25,1)","size":[10.241650615422071,10.555563973005979,10.705204815976659,10.306605302606242,10.495711198625042,10.302586155618533,10.694046676727186,10.369119739777648,10.353444752561723,14.165065447796252,15.620020409395456,10.726640630593844,10.675438447977726,10.01651176916867,10.27636157302676,13.96466210812622,10.042639364227421,11.12689835094158,10.311773966857254,12.624890114069252,10.722309703837773,11.516312032410687,10.688690248434412,10.367712499133139,10.133041095666849,12.756615018612388,10.612303044884126,10.511532452050163,14.852696204692943,14.144065496927047],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Albania <br>Life Expectancy: 76.42 <br>GDP per capita: 5937.03 <br>Pop.:     3,600,523","Country: Austria <br>Life Expectancy: 79.83 <br>GDP per capita: 36126.49 <br>Pop.:     8,199,783","Country: Belgium <br>Life Expectancy: 79.44 <br>GDP per capita: 33692.61 <br>Pop.:    10,392,226","Country: Bosnia and Herzegovina <br>Life Expectancy: 74.85 <br>GDP per capita: 7446.3 <br>Pop.:     4,552,198","Country: Bulgaria <br>Life Expectancy: 73 <br>GDP per capita: 10680.79 <br>Pop.:     7,322,858","Country: Croatia <br>Life Expectancy: 75.75 <br>GDP per capita: 14619.22 <br>Pop.:     4,493,312","Country: Czech Republic <br>Life Expectancy: 76.49 <br>GDP per capita: 22833.31 <br>Pop.:    10,228,744","Country: Denmark <br>Life Expectancy: 78.33 <br>GDP per capita: 35278.42 <br>Pop.:     5,468,120","Country: Finland <br>Life Expectancy: 79.31 <br>GDP per capita: 33207.08 <br>Pop.:     5,238,460","Country: France <br>Life Expectancy: 80.66 <br>GDP per capita: 30470.02 <br>Pop.:    61,083,916","Country: Germany <br>Life Expectancy: 79.41 <br>GDP per capita: 32170.37 <br>Pop.:    82,400,996","Country: Greece <br>Life Expectancy: 79.48 <br>GDP per capita: 27538.41 <br>Pop.:    10,706,290","Country: Hungary <br>Life Expectancy: 73.34 <br>GDP per capita: 18008.94 <br>Pop.:     9,956,108","Country: Iceland <br>Life Expectancy: 81.76 <br>GDP per capita: 36180.79 <br>Pop.:       301,931","Country: Ireland <br>Life Expectancy: 78.89 <br>GDP per capita: 40676 <br>Pop.:     4,109,086","Country: Italy <br>Life Expectancy: 80.55 <br>GDP per capita: 28569.72 <br>Pop.:    58,147,733","Country: Montenegro <br>Life Expectancy: 74.54 <br>GDP per capita: 9253.9 <br>Pop.:       684,736","Country: Netherlands <br>Life Expectancy: 79.76 <br>GDP per capita: 36797.93 <br>Pop.:    16,570,613","Country: Norway <br>Life Expectancy: 80.2 <br>GDP per capita: 49357.19 <br>Pop.:     4,627,926","Country: Poland <br>Life Expectancy: 75.56 <br>GDP per capita: 15389.92 <br>Pop.:    38,518,241","Country: Portugal <br>Life Expectancy: 78.1 <br>GDP per capita: 20509.65 <br>Pop.:    10,642,836","Country: Romania <br>Life Expectancy: 72.48 <br>GDP per capita: 10808.48 <br>Pop.:    22,276,056","Country: Serbia <br>Life Expectancy: 74 <br>GDP per capita: 9786.53 <br>Pop.:    10,150,265","Country: Slovak Republic <br>Life Expectancy: 74.66 <br>GDP per capita: 18678.31 <br>Pop.:     5,447,502","Country: Slovenia <br>Life Expectancy: 77.93 <br>GDP per capita: 25768.26 <br>Pop.:     2,009,245","Country: Spain <br>Life Expectancy: 80.94 <br>GDP per capita: 28821.06 <br>Pop.:    40,448,191","Country: Sweden <br>Life Expectancy: 80.88 <br>GDP per capita: 33859.75 <br>Pop.:     9,031,088","Country: Switzerland <br>Life Expectancy: 81.7 <br>GDP per capita: 37506.42 <br>Pop.:     7,554,661","Country: Turkey <br>Life Expectancy: 71.78 <br>GDP per capita: 8458.28 <br>Pop.:    71,158,647","Country: United Kingdom <br>Life Expectancy: 79.42 <br>GDP per capita: 33203.26 <br>Pop.:    60,776,238"],"frame":"2007","type":"scatter","name":"Europe","textfont":{"color":"rgba(39,100,25,1)","size":[10.241650615422071,10.555563973005979,10.705204815976659,10.306605302606242,10.495711198625042,10.302586155618533,10.694046676727186,10.369119739777648,10.353444752561723,14.165065447796252,15.620020409395456,10.726640630593844,10.675438447977726,10.01651176916867,10.27636157302676,13.96466210812622,10.042639364227421,11.12689835094158,10.311773966857254,12.624890114069252,10.722309703837773,11.516312032410687,10.688690248434412,10.367712499133139,10.133041095666849,12.756615018612388,10.612303044884126,10.511532452050163,14.852696204692943,14.144065496927047]},"error_y":{"color":"rgba(39,100,25,1)","width":[]},"error_x":{"color":"rgba(39,100,25,1)","width":[]},"line":{"color":"rgba(39,100,25,1)"},"xaxis":"x","yaxis":"y","visible":true},{"x":[4.5370047214526892,4.4011421122881123],"y":[81.234999999999999,80.203999999999994],"mode":"markers","marker":{"color":"rgba(49,54,149,1)","size":[11.390598170818464,10.276817844425953],"sizemode":"diameter","symbol":"circle","line":{"color":"#FFFFFF","width":2}},"text":["Country: Australia <br>Life Expectancy: 81.24 <br>GDP per capita: 34435.37 <br>Pop.:    20,434,176","Country: New Zealand <br>Life Expectancy: 80.2 <br>GDP per capita: 25185.01 <br>Pop.:     4,115,771"],"frame":"2007","type":"scatter","name":"Oceania","textfont":{"color":"rgba(49,54,149,1)","size":[11.390598170818464,10.276817844425953]},"error_y":{"color":"rgba(49,54,149,1)","width":[]},"error_x":{"color":"rgba(49,54,149,1)","width":[]},"line":{"color":"rgba(49,54,149,1)"},"xaxis":"x","yaxis":"y","visible":true}],"traces":[0,1,2,3,4]}],"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>

 ]]></description>
  <category>data-visualization</category>
  <category>economia</category>
  <category>repost</category>
  <category>tutorial-R</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/repost-gapminder/index.html</guid>
  <pubDate>Mon, 06 May 2019 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/gapminder.png" medium="image" type="image/png" height="89" width="144"/>
</item>
<item>
  <title>MQO - teoria assintótica</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index.html</link>
  <description><![CDATA[ 




<section id="disclaimer" class="level1">
<h1>Disclaimer</h1>
<p>Este é um repost antigo que fiz ainda na época do mestrado em economia. Apesar de intuitivo o código dos loops abaixo é muito ineficiente. De maneira geral, <code>for</code>-loops são melhores do que loops feitos com <code>repeat</code>; melhor ainda é montar funções e usar <code>parallel::mclapply</code> ou <code>replicate</code>. Além disso, é importante pre-definir o tamanho do objeto antes de um loop, e.g., <code>x &lt;- vector("numeric", length = 10000)</code>.</p>
</section>
<section id="mínimos-quadrados" class="level1">
<h1>Mínimos Quadrados</h1>
<p>A maior parte dos resultados assintóticos dos estimadores de mínimos quadrados (MQO) são um misto da LGN, do TCL e de outros resultados de convergência como o método delta e o teorema de Slutsky. Um resultado simples que podemos visualizar através de uma simulação é a propriedade de não-viés dos estimadores de MQO. Em linhas gerais, desde que o termo de erro seja ortogonal às variáveis independentes, os estimadores de MQO não serão viesados, i.e., os estimadores <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cbeta%7D"> vão convergir para os verdadeiros <img src="https://latex.codecogs.com/png.latex?%5Cbeta">. Dizer que eles são ortogonais costuma ser o mesmo que dizer que eles são independentes. Isto é, na prática queremos que a esperança condicional de <img src="https://latex.codecogs.com/png.latex?u_%7Bt%7D">, o erro, dado <img src="https://latex.codecogs.com/png.latex?x_%7Bt%7D">, as variáveis explicativas, seja nulo:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D(u_%7Bt%7D%20%7C%20x_%7Bt%7D)%20=%200%0A"></p>
<p>Suponha que o modelo verdadeiro (o processo gerador de dados) seja da forma:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20y_%7Bt%7D%20=%205%20+%202.5x_%7B1t%7D%20-1.75x_%7B2t%7D%20+%205x_%7B3t%7D%20+%20u_%7Bt%7D%0A%5Cend%7Bequation%7D"> onde <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20x_%7B1%7D%20&amp;%20%5Csim%20N(0,1)%5C%5C%0A%20%20%20%20x_%7B2%7D%20&amp;%20%5Csim%20%5Ctext%7BBeta%7D(2,%205)%5C%5C%0A%20%20%20%20x_%7B3%7D%20&amp;%20%5Csim%20U(0,1)%5C%5C%0A%20%20%20%20u_%7Bt%7D%20&amp;%20%5Csim%20N(0,1)%0A%5Cend%7Balign%7D"></p>
<p>Se as variáveis <img src="https://latex.codecogs.com/png.latex?x_%7B1%7D,%20x_%7B2%7D"> e <img src="https://latex.codecogs.com/png.latex?x_%7B3%7D"> forem independentes de <img src="https://latex.codecogs.com/png.latex?u_%7Bt%7D"> então o modelo: <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20y_%7Bt%7D%20=%20%5Cbeta_%7B0%7D%20+%20%5Cbeta_%7B1%7Dx_%7B1t%7D%20+%20%5Cbeta_%7B2%7Dx_%7B2t%7D%20+%20%5Cbeta_%7B3%7Dx_%7B3t%7D%0A%5Cend%7Bequation%7D"> fornecerá estimativas consistentes para os betas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modelo verdadeiro (DGP)</span></span>
<span id="cb1-2">x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb1-3">x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbeta</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb1-4">x3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb1-5">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.75</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x3))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2 + x3)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.40891 -0.71728 -0.03212  0.67974  2.85561 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.19288    0.18462  28.128  &lt; 2e-16 ***
x1           2.55059    0.06534  39.035  &lt; 2e-16 ***
x2          -1.79698    0.42362  -4.242 3.41e-05 ***
x3           4.58214    0.24240  18.903  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9608 on 196 degrees of freedom
Multiple R-squared:  0.9122,    Adjusted R-squared:  0.9109 
F-statistic: 678.7 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Note que os valores estimados estão bastante próximos dos valores verdadeiros. Podemos ver o impacto que o tamanho da amostra tem sobre as estimativas fazendo um loop para diferentes tamanhos. Para conseguir resultados mais consistentes podemos gerar os valores do DGP várias vezes. Abaixo os dados são gerados e estimados 100 vezes para diferentes amostras com <img src="https://latex.codecogs.com/png.latex?n%20=%2010,%2050,%2010000">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb3-2">tabela <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb3-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (n <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>)) {</span>
<span id="cb3-4">    i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-5">    X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb3-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">repeat</span>{</span>
<span id="cb3-7"></span>
<span id="cb3-8">        x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n) </span>
<span id="cb3-9">        x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbeta</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb3-10">        x3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n)</span>
<span id="cb3-11">        y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.75</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n)</span>
<span id="cb3-12"></span>
<span id="cb3-13">        fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x3)</span>
<span id="cb3-14"></span>
<span id="cb3-15">        coeficientes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fit)</span>
<span id="cb3-16"></span>
<span id="cb3-17">        X[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coeficientes</span>
<span id="cb3-18"></span>
<span id="cb3-19">        i <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) {<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span>}</span>
<span id="cb3-21">    }</span>
<span id="cb3-22"></span>
<span id="cb3-23">    tabela <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(tabela, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colMeans</span>(X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb3-24"></span>
<span id="cb3-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(X[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb3-26">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", n = "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>.(n)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb3-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb3-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(X[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb3-29">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", n = "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>.(n)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb3-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb3-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(X[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb3-32">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", n = "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>.(n)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb3-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb3-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(X[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb3-35">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", n = "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>.(n)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb3-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb3-37">}</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A tabela abaixo mostra a média dos valores estimados para cada coeficiente</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-bordered table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">b0 = 5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">b1 = 2,5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">b2 = -1,75</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">b3 = 5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n = 10</td>
<td style="text-align: center;">5.092687</td>
<td style="text-align: center;">2.563573</td>
<td style="text-align: center;">-1.852012</td>
<td style="text-align: center;">4.862016</td>
</tr>
<tr class="even">
<td style="text-align: left;">n = 50</td>
<td style="text-align: center;">5.011683</td>
<td style="text-align: center;">2.510650</td>
<td style="text-align: center;">-1.792762</td>
<td style="text-align: center;">5.019113</td>
</tr>
<tr class="odd">
<td style="text-align: left;">n = 10000</td>
<td style="text-align: center;">4.995774</td>
<td style="text-align: center;">2.499198</td>
<td style="text-align: center;">-1.736876</td>
<td style="text-align: center;">5.003811</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="mqo-viesado" class="level1">
<h1>MQO viesado</h1>
<section id="processo-não-estacionário" class="level3">
<h3 class="anchored" data-anchor-id="processo-não-estacionário">Processo não-estacionário</h3>
<p>Um dos casos em que os estimadores de MQO se tornam viesados acontece quando o processo é auto-regressivo e não-estacionário, isto é, quando o DGP é da forma</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20y_%7Bt%7D%20=%20%5Cphi%20y_%7Bt-1%7D%20+%20u_%7Bt%7D%0A%5Cend%7Bequation%7D">
<p>em que <img src="https://latex.codecogs.com/png.latex?%7C%5Cphi%7C%20%5Cgeq%201">. O código abaixo simula o modelo acima mil vezes para diferentes valores de <img src="https://latex.codecogs.com/png.latex?%5Cphi">. Quando o processo é estacionário temos estimativas boas para o parâmetro, mas quando <img src="https://latex.codecogs.com/png.latex?%5Cphi%20=%201.1"> as estimativas tornam-se muito ruins. Quando <img src="https://latex.codecogs.com/png.latex?%5Cphi%20=%201"> temos um caso de raiz unitária que tem propriedades bastante específicas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dynlm)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb4-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(phi <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>)){</span>
<span id="cb4-4">    j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-5">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb4-6">    </span>
<span id="cb4-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">repeat</span>{</span>
<span id="cb4-8"></span>
<span id="cb4-9">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">99</span>) { </span>
<span id="cb4-11">        y[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-12">    }</span>
<span id="cb4-13">    </span>
<span id="cb4-14">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts</span>(y)</span>
<span id="cb4-15">    fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dynlm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(y))</span>
<span id="cb4-16">    phi_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fit)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb4-17">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x, phi_hat)</span>
<span id="cb4-18"></span>
<span id="cb4-19">    j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) {<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span>}</span>
<span id="cb4-21">    }</span>
<span id="cb4-22"></span>
<span id="cb4-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(phi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>.(phi)),</span>
<span id="cb4-25">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-26">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb4-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> phi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb4-28">}</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="erros-arma" class="level3">
<h3 class="anchored" data-anchor-id="erros-arma">Erros ARMA</h3>
<p>Quando os erros do modelo são autocorrelacionados os estimadores de MQO perdem algumas de suas boas propriedades. Ainda assim, desde que o erro seja ortogonal aos regressores os estimadores continuaram sendo não-viesados. Há, contudo, um caso em que os estimadores de MQO são viesados: quando algum dos regressores independentes é uma defasagem da variável depedente.</p>
<p>Isto acontece porque este tipo de autocorrelação implica que os regressores não são ortogonais aos erros. Tome o caso simples em que o erro <img src="https://latex.codecogs.com/png.latex?u_%7Bt%7D"> segue um processo AR(1) da forma</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20u_%7Bt%7D%20=%20%5Cphi%20u_%7Bt-1%7D%20+%20%5Ceta_%7Bt%7D%0A%5Cend%7Bequation%7D"> em que <img src="https://latex.codecogs.com/png.latex?%5Ceta_%7Bt%7D"> é ruído branco. E o modelo é <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20y_%7Bt%7D%20=%20%5Cbeta_%7B0%7D%20+%20%5Cbeta_%7B1%7Dy_%7Bt-1%7D%20+%20u_%7Bt%7D%0A%5Cend%7Bequation%7D"> Agora note que <img src="https://latex.codecogs.com/png.latex?y_%7Bt%20-%201%7D%20=%20%5Cbeta_%7B0%7D%20+%20%5Cbeta_%7B1%7Dy_%7Bt%20-%202%7D%20+%20u_%7Bt%20-%201%7D"> Reescrevendo a expressão do erro e substituindo na equação acima temos que: <img src="https://latex.codecogs.com/png.latex?y_%7Bt%20-%201%7D%20=%20%5Cbeta_%7B0%7D%20+%20%5Cbeta_%7B1%7Dy_%7Bt%20-%202%7D%20+%20%5Cfrac%7Bu_%7Bt%7D%20-%20%5Ceta_%7Bt%7D%7D%7B%5Cphi%7D"> logo <img src="https://latex.codecogs.com/png.latex?y_%7Bt%20-%201%7D%20%5Cpropto%20u_%7Bt%7D">, isto é, <img src="https://latex.codecogs.com/png.latex?y_%7Bt%20-%201%7D"> é correlacionado com o termo de erro <img src="https://latex.codecogs.com/png.latex?u_%7Bt%7D">.</p>
<p>Para exemplificar este resultado, o código abaixo simula a seguinte série 1000 vezes para diferentes valores de <img src="https://latex.codecogs.com/png.latex?%5Cphi">. O termo de erro segue um processo AR(1). Note como as estimativas <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cphi%7D"> são bastante ruins. Para remediar este problema teríamos que levar em conta a estrutura autoregressiva do erro no modelo.</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20y_%7Bt%7D%20&amp;%20=%20%5Cphi%20y_%7Bt-1%7D%20+%20u_%7Bt%7D%5C%5C%0A%20%20%20%20u_%7Bt%7D%20&amp;%20=%200.7u_%7Bt-1%7D%20+%20%5Ceta_%7Bt%7D%5C%5C%0A%5Cend%7Balign%7D">
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(phi <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) {</span>
<span id="cb5-4">    j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb5-5">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb5-6">    </span>
<span id="cb5-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">repeat</span>{</span>
<span id="cb5-8"></span>
<span id="cb5-9">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb5-10">    erro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arima.sim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ar =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb5-11"></span>
<span id="cb5-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">99</span>) { y[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> phi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>y[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> erro[i] }</span>
<span id="cb5-13">    </span>
<span id="cb5-14">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts</span>(y)</span>
<span id="cb5-15"></span>
<span id="cb5-16">    fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dynlm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(y))</span>
<span id="cb5-17">    </span>
<span id="cb5-18">    phi_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fit)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb5-19"></span>
<span id="cb5-20">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x, phi_hat)</span>
<span id="cb5-21"></span>
<span id="cb5-22">    j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) {<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span>}</span>
<span id="cb5-24">    }</span>
<span id="cb5-25"></span>
<span id="cb5-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(phi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>.(phi)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(phi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb5-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> phi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb5-28"></span>
<span id="cb5-29">}</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Este resultado não muda assintoticamente, isto é, não importa qual o tamanho da amostra: as estimativas de <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cphi%7D"> serão viesadas. Na verdade, os resultados vão piorando à medida que cresce o tamanho da amostra. Abaixo mostro isto para o caso de <img src="https://latex.codecogs.com/png.latex?%5Cphi%20=%200.5"> e n = <img src="https://latex.codecogs.com/png.latex?100,%20200,%20500,%2010000">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb6-2">phi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb6-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(n <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>)){</span>
<span id="cb6-4">    j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb6-5">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb6-6">    </span>
<span id="cb6-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">repeat</span>{</span>
<span id="cb6-8"></span>
<span id="cb6-9">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb6-10">    erro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arima.sim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ar =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb6-11"></span>
<span id="cb6-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(n<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)) { y[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> phi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>y[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> erro[i] }</span>
<span id="cb6-13">    </span>
<span id="cb6-14">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts</span>(y)</span>
<span id="cb6-15"></span>
<span id="cb6-16">    fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dynlm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(y))</span>
<span id="cb6-17">    </span>
<span id="cb6-18">    phi_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fit)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb6-19"></span>
<span id="cb6-20">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x, phi_hat)</span>
<span id="cb6-21"></span>
<span id="cb6-22">    j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) {<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span>}</span>
<span id="cb6-24">    }</span>
<span id="cb6-25"></span>
<span id="cb6-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x,</span>
<span id="cb6-27">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb6-28">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(phi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>.(phi)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", n = "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>.(n)),</span>
<span id="cb6-29">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb6-30">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb6-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> phi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb6-32"></span>
<span id="cb6-33">}</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Considerando a estrutura autoregressiva do modelo chegamos em estimativas melhores para os parâmetros. O código abaixo faz um ARMAX, isto é, uma estimativa de mínimos quadrados com erros ARMA. O modelo segue o processo <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20y_%7Bt%7D%20&amp;%20=%20%5Cbeta_%7B0%7D%20+%20%5Cbeta_%7B1%7Dy_%7Bt-1%7D%20+%20u_%7Bt%7D%5C%5C%0A%20%20%20%20u_%7Bt%7D%20&amp;%20=%20%5Cbeta_%7B2%7D%20u_%7Bt-1%7D%20+%20%5Ceta_%7Bt%7D%5C%5C%0A%5Cend%7Balign%7D"></p>
<p>onde os valores foram definidos como <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B0%7D%20=%200">, <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B1%7D%20=%200.5"> e <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B2%7D%20=%200.7">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb7-2">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb7-3">param <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-4">j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">repeat</span> {</span>
<span id="cb7-6"></span>
<span id="cb7-7">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-8">    erro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arima.sim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ar =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb7-9"></span>
<span id="cb7-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(n<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)) {</span>
<span id="cb7-11">        y[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> erro[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb7-12">    }</span>
<span id="cb7-13">    </span>
<span id="cb7-14">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts</span>(y)</span>
<span id="cb7-15">    ly <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(y, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-16">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts.intersect</span>(y, ly, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dframe =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-17">    fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arima</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xreg =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ly)</span>
<span id="cb7-18">    param[j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fit)</span>
<span id="cb7-19"></span>
<span id="cb7-20">    j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) {<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span>}</span>
<span id="cb7-22">}</span>
<span id="cb7-23"></span>
<span id="cb7-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(param[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", n = 1000"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> F)</span>
<span id="cb7-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb7-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(param[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", n = 1000"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> F)</span>
<span id="cb7-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb7-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(param[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bquote</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", n = 1000"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> F)</span>
<span id="cb7-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>econometria</category>
  <category>tutorial-R</category>
  <category>repost</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/repost-mqo-teoria-assintotica/index.html</guid>
  <pubDate>Sat, 23 Mar 2019 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/mqo-teoria-assintotica.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Teoria Assintótica - LGN e TCL</title>
  <dc:creator>Vinicius Oike</dc:creator>
  <link>https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index.html</link>
  <description><![CDATA[ 




<section id="disclaimer" class="level1">
<h1>Disclaimer</h1>
<p>Este é um repost antigo que fiz ainda na época do mestrado em economia. Apesar de intuitivo o código dos loops abaixo pode ser muito ineficiente. De maneira geral, <code>for</code>-loops são melhores do que loops feitos com <code>repeat</code>; melhor ainda é montar funções e usar <code>parallel::mclapply</code> ou <code>furrr::future_map</code>. Vale notar que é sempre bom pré-alocar (ou pré-definir) vetores antes de um <code>for</code>-loop</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bom</span></span>
<span id="cb1-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ruim</span></span>
<span id="cb1-4">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span></code></pre></div>
</div>
</section>
<section id="resultados-assintóticos" class="level1">
<h1>Resultados assintóticos</h1>
<section id="lei-dos-grande-números" class="level2">
<h2 class="anchored" data-anchor-id="lei-dos-grande-números">Lei dos Grande Números</h2>
<p>A Lei dos Grandes Números (LGN) é um resultado assintótico bastante utilizado em econometria. Numa definição informal, a LGN nos diz que uma média amostral converge para para a média verdadeira dos dados. Isto é, se temos uma sequência de variáveis aleatórias <img src="https://latex.codecogs.com/png.latex?x_%7B1%7D,%20x_%7B2%7D,%20%5Cdots%20,%20x_%7Bn%7D"> independentes e identicamente distribuídas:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%20=%201%7D%5E%7Bn%7D%20x_%7B1%7D%20%5Cto%20%5Cmathbb%7BE%7D(x)%0A%5Cend%7Bequation%7D">
<p>Vamos criar uma amostra de cinco observações a partir de uma distribuição uniforme e tirar a média destas observações. Lembre-se que este distribuição depende de dois parâmetros, digamos <img src="https://latex.codecogs.com/png.latex?a"> e <img src="https://latex.codecogs.com/png.latex?b">. A esperança de uma uniforme é simplesmente <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bb-a%7D%7B2%7D">. Podemos repetir este processo 1000 vezes e fazer um histograma dos resultados.</p>
<p>No código abaixo cria-se um vetor <img src="https://latex.codecogs.com/png.latex?x%20=%20(x_%7B1%7D,%20x_%7B2%7D,%20%5Cdots)"> genérico para armazenar valoes. O loop vai inserindo neste vetor a média de uma amostra de cinco observações a partir de uma distribuição uniforme com <img src="https://latex.codecogs.com/png.latex?a%20=%200"> e <img src="https://latex.codecogs.com/png.latex?b%20=%205">. A cada iteração do loop uma nova amostra é gerada e sua média é salva no vetor <img src="https://latex.codecogs.com/png.latex?x"> na posição <img src="https://latex.codecogs.com/png.latex?x_%7Bi%7D">. Depois de gerar estes valores faz-se um histograma deles.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cria um vetor para armazenar os valores</span></span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>){ <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#loop para gerar os valores</span></span>
<span id="cb2-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># computa a media de uma amostra com 5 observacoes</span></span>
<span id="cb2-5">  x[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) </span>
<span id="cb2-6"></span>
<span id="cb2-7">}</span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Histograma</span></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma da media das amostras para n = 5"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linha vertical</span></span>
<span id="cb2-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Podemos fazer o mesmo para diferentes tamanhos de amostra. O código abaixo simplesmente faz um loop do código acima; o loop de fora varia <code>n</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># para exibir 4 graficos</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (n <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)) { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop para os diferentes tamanhos de amostra</span></span>
<span id="cb3-4">  x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb3-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mesmo loop que o anterior</span></span>
<span id="cb3-6">    </span>
<span id="cb3-7">    x[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb3-8">    </span>
<span id="cb3-9">  }</span>
<span id="cb3-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotando o histograma</span></span>
<span id="cb3-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma para n = "</span>, n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>),</span>
<span id="cb3-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb3-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb3-14">}</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note que as escalas dos gráficos são diferentes. Como era de se esperar, à medida que cresce o tamanho da amostra os valores vão se acumulando em torno da média verdadeira.</p>
<p>Outra maneira de visualizar a LGN é fazendo o seguinte experimento: sorteie um número a partir de uma distribuição particular e grave seu valor. Agora sorteie dois números a partir da mesma distribuição, tire a média dos valores e grave o resultado. Agora faça o mesmo com três números, quatro números e assim por diante. O código abaixo faz isto para uma distribuição normal padrão.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb4-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (n <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>){</span>
<span id="cb4-3"></span>
<span id="cb4-4">    x[n] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n))</span>
<span id="cb4-5"></span>
<span id="cb4-6">}</span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"l"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb4-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="teorema-central-do-limite" class="level2">
<h2 class="anchored" data-anchor-id="teorema-central-do-limite">Teorema Central do Limite</h2>
<p>O segundo resultado importante que se usa em econometria é o Teorema Central do Limite (TCL). Existem algumas variantes do TCL que usam diferentes hipóteses, mas, novamente sendo informal, o TCL diz que se tivermos uma amostra qualquer <img src="https://latex.codecogs.com/png.latex?x_%7B1%7D,%20x_%7B2%7D,%20%5Cdots%20,%20x_%7Bn%7D">, então <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7Bn%7D%5Cfrac%7B%5Coverline%7Bx%7D%20-%20%5Cmu%7D%7B%5Csigma%7D"> segue uma distribuição normal padrão, onde <img src="https://latex.codecogs.com/png.latex?%5Coverline%7Bx%7D"> é a média amostral, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D(x)%20=%20%5Cmu"> e <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BVar%7D(x)%20=%20%5Csigma%5E%7B2%7D">. Para visualizar este resultado podemos novamente fazer o experimento usando a distribuição uniforme.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># para exibir 4 graficos</span></span>
<span id="cb5-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (n <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)){ <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop para os diferentes tamanhos de amostra</span></span>
<span id="cb5-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>){ <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mesmo loop que o anterior</span></span>
<span id="cb5-4"></span>
<span id="cb5-5">    x[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb5-6">    </span>
<span id="cb5-7">  }</span>
<span id="cb5-8"></span>
<span id="cb5-9">  x_normalizado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># transforma a variavel</span></span>
<span id="cb5-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plota o histograma usando a densidade da frequencia de cada observacao</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x_normalizado, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma para n = "</span>, n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>),</span>
<span id="cb5-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb5-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># superimpoe uma curva normal padrao </span></span>
<span id="cb5-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue4"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)  </span>
<span id="cb5-16">}</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note que este resultado vale para qualquer sequência de variáveis i.i.d (independentes e identicamente distribuídas). Considere, por exemplo, uma sequência de variáveis aleatórias independentes que segue uma distribuição beta.</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0Af(x)%20=%20%5Cfrac%7Bx%5E%7B%5Calpha%20-%201%7D(1-x)%5E%7B%5Cbeta%20-%201%7D%7D%7BB(%5Calpha,%20%5Cbeta)%7D%0A%5Cend%7Bequation%7D">
<p>onde <img src="https://latex.codecogs.com/png.latex?B(%5Calpha,%20%5Cbeta)%20=%20%5Cfrac%7B%5CGamma(%5Calpha)%5CGamma(%5Cbeta)%7D%7B%5CGamma(%5Calpha%20+%20%5Cbeta)%7D">. A esperança da distribuição beta é dada por</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Cmathbb%7BE%7D(x)%20=%20%5Cfrac%7B%5Calpha%7D%7B%5Calpha%20+%20%5Cbeta%7D%0A%5Cend%7Bequation%7D">
<p>Uma distribuição beta depende de dois parâmetros. Usando a função <code>dbeta</code> podemos simular algumas pdfs.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note que uma implicação do TCL é que, se <img src="https://latex.codecogs.com/png.latex?x_%7Bi%7D"> for i.i.d. com esperança igual a <img src="https://latex.codecogs.com/png.latex?%5Cmu">, então</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Csqrt%7BN%7D%20%5Cleft%20(%20%20%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%20=%201%7D%5E%7BN%7Dx_%7Bi%7D%20-%20%5Cmu%20%5Cright%20)%20%5Cto%20%5Ctext%7BN%7D(0,%20%5Csigma%5E%7B2%7D)%0A%5Cend%7Bequation%7D">
<p>Isto é, não precisamos saber qual a forma da variância da distribuição para aplicar o TCL. Os loops abaixo são essencialmente idênticos aos anteriores: a diferença é que desta vez os histogramas vão representar variáveis normais de média zero com variância <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E%7B2%7D">, que é aproximadamente igual à variância da distribuição beta.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># para exibir 4 graficos</span></span>
<span id="cb6-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (n <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)){ <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop para os diferentes tamanhos de amostra</span></span>
<span id="cb6-3"> </span>
<span id="cb6-4">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>){ <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mesmo loop que o anterior</span></span>
<span id="cb6-5"></span>
<span id="cb6-6">    x[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbeta</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb6-7">    </span>
<span id="cb6-8">  }</span>
<span id="cb6-9"></span>
<span id="cb6-10">  x_normalizado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># transforma a variavel</span></span>
<span id="cb6-11"></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x_normalizado, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma para n = "</span>, n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>),</span>
<span id="cb6-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plota o histograma usando a densidade da frequencia de cada observacao</span></span>
<span id="cb6-14">}</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<section id="dois-casos-anômalos" class="level3">
<h3 class="anchored" data-anchor-id="dois-casos-anômalos">Dois casos anômalos</h3>
<p>O TCL nos diz: <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Csqrt%7Bn%7D%20%5Cleft%20(%20%5Cfrac%7B%5Coverline%7Bx%7D%20-%20%5Cmu%7D%7B%5Csigma%7D%20%5Cright%20)%20%5Cto%20N(0,1)%0A%5Cend%7Bequation%7D"> O termo <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7Bn%7D"> é essencial para garantir este resultado. Qualquer transformação maior do que <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7Bn%7D"> faz a variância crescer indefinidamente; qualquer transformação menor do que <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7Bn%7D"> faz a variância diminuir indefinidamente, isto é, faz a distribuição colapsar num único ponto. Os dois códigos abaixo apresentam exemplos destes casos. O primeiro usa <img src="https://latex.codecogs.com/png.latex?n%5E%7B%5Cfrac%7B3%7D%7B4%7D%7D">, o segundo <img src="https://latex.codecogs.com/png.latex?n%5E%7B%5Cfrac%7B1%7D%7B4%7D%7D">.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># para exibir 4 graficos</span></span>
<span id="cb7-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (n <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)){ <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mesmo loop que o anterior</span></span>
<span id="cb7-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>){ </span>
<span id="cb7-4">    </span>
<span id="cb7-5">    x[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb7-6">    </span>
<span id="cb7-7">  }</span>
<span id="cb7-8">  </span>
<span id="cb7-9">  x_normalizado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># muda apenas o expoente de n</span></span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x_normalizado, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma para n = "</span>, n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>),</span>
<span id="cb7-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb7-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue4"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-14">}</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># para exibir 4 graficos</span></span>
<span id="cb8-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (n <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)){ <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mesmo loop que o anterior</span></span>
<span id="cb8-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>){ </span>
<span id="cb8-4">    </span>
<span id="cb8-5">    x[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb8-6">    </span>
<span id="cb8-7">  }</span>
<span id="cb8-8">  </span>
<span id="cb8-9">  x_normalizado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># muda apenas o expoente de n</span></span>
<span id="cb8-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(x_normalizado, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histograma para n = "</span>, n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>),</span>
<span id="cb8-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue4"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb8-14">}</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

 ]]></description>
  <category>econometria</category>
  <category>tutorial-R</category>
  <category>repost</category>
  <guid>https:://www.restateinsight.com/posts/general-posts/repost-teoria-assintotica/index.html</guid>
  <pubDate>Sat, 23 Mar 2019 03:00:00 GMT</pubDate>
  <media:content url="https:://www.restateinsight.com/static/repost-lgn.svg" medium="image" type="image/svg+xml"/>
</item>
</channel>
</rss>
